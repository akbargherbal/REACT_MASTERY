<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>24 Performance Optimization</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #8b5cf6;
            --bg-main: #0f172a;
            --bg-card: #1e293b;
            --bg-code: #0f172a;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #334155;
            --accent: #06b6d4;
            --success: #10b981;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            line-height: 1.7; 
            color: var(--text-primary); 
            background: var(--bg-main);
        }
        
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 20px; 
        }
        
        .home-btn { 
            position: fixed; 
            top: 20px; 
            right: 20px; 
            background: var(--accent);
            color: white; 
            width: 50px;
            height: 50px;
            border-radius: 50%;
            text-decoration: none; 
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(6, 182, 212, 0.4);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .home-btn:hover { 
            background: #0891b2;
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(6, 182, 212, 0.5);
        }
        
        .breadcrumb { 
            background: var(--bg-card);
            padding: 12px 0; 
            margin-bottom: 24px; 
            font-size: 14px;
            border-radius: 8px;
            border: 1px solid var(--border);
        }
        
        .breadcrumb a { 
            color: var(--accent);
            text-decoration: none;
            transition: color 0.2s;
        }
        
        .breadcrumb a:hover { 
            color: var(--primary);
            text-decoration: underline;
        }
        
        .content { 
            background: var(--bg-card);
            padding: 3rem; 
            border-radius: 16px; 
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border);
        }
        
        .file-list { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); 
            gap: 1.5rem; 
            margin: 2rem 0; 
        }
        
        .file-item { 
            padding: 1.5rem; 
            border: 1px solid var(--border);
            border-radius: 12px; 
            background: var(--bg-main);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .file-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .file-item:hover { 
            transform: translateY(-4px); 
            box-shadow: 0 8px 30px rgba(99, 102, 241, 0.3);
            border-color: var(--primary);
        }
        
        .file-item:hover::before {
            opacity: 1;
        }
        
        .file-item a { 
            color: var(--text-primary);
            text-decoration: none; 
            font-weight: 600; 
            display: block;
            font-size: 1.1rem;
        }
        
        .file-item a:hover { 
            color: var(--primary);
        }
        
        .file-type { 
            font-size: 13px; 
            color: var(--text-secondary);
            margin-top: 8px; 
            font-weight: 500;
        }
        
        /* Code Blocks */
        pre { 
            background: var(--bg-code);
            padding: 1.5rem; 
            border-radius: 12px; 
            overflow-x: auto;
            border: 1px solid var(--border);
            margin: 1.5rem 0;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            position: relative;
        }
        
        pre code { 
            background: none;
            padding: 0;
            font-family: 'Fira Code', 'Consolas', monospace;
            font-size: 0.9em;
            line-height: 1.6;
        }
        
        /* Copy Button */
        .copy-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: var(--primary);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.2s;
            opacity: 0.7;
            z-index: 10;
        }
        
        .copy-btn:hover {
            opacity: 1;
            background: var(--primary-dark);
            transform: translateY(-1px);
        }
        
        .copy-btn.copied {
            background: var(--success);
        }
        
        pre:hover .copy-btn {
            opacity: 1;
        }
        
        /* Inline Code */
        code { 
            background: var(--bg-code);
            color: #8b5cf6;
            padding: 3px 8px; 
            border-radius: 6px; 
            font-size: 1.1em;
            font-family: 'Fira Code', 'Consolas', monospace;
            border: 1px solid var(--border);
        }
        
        /* Headings */
        h1, h2, h3, h4, h5, h6 { 
            color: var(--text-primary);
            margin: 2rem 0 1rem 0;
            font-weight: 700;
            letter-spacing: -0.5px;
        }
        
        h1 { 
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            border-bottom: 3px solid var(--primary);
            padding-bottom: 12px;
            margin-bottom: 1.5rem;
        }
        
        h2 { 
            font-size: 2rem;
            color: var(--primary);
            border-bottom: 2px solid var(--border);
            padding-bottom: 8px;
        }
        
        h3 { 
            font-size: 1.5rem;
            color: var(--accent);
        }
        
        /* Links */
        a { 
            color: var(--accent);
            transition: color 0.2s;
        }
        
        a:hover { 
            color: var(--primary);
        }
        
        /* Paragraphs */
        p {
            margin: 1rem 0;
            color: var(--text-secondary);
        }
        
        /* Lists */
        ul, ol {
            margin: 1rem 0;
            padding-left: 2rem;
            color: var(--text-secondary);
        }
        
        li {
            margin: 0.5rem 0;
        }
        
        /* Tables */
        table { 
            border-collapse: collapse;
            width: 100%;
            margin: 1.5rem 0;
            background: var(--bg-main);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }
        
        th, td { 
            border: 1px solid var(--border);
            padding: 12px 16px;
            text-align: left;
        }
        
        th { 
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            font-weight: 600;
        }
        
        tr:hover {
            background: var(--bg-card);
        }
        
        /* Blockquotes */
        blockquote {
            border-left: 4px solid var(--primary);
            padding: 1rem 1.5rem;
            margin: 1.5rem 0;
            background: var(--bg-main);
            border-radius: 0 8px 8px 0;
            color: var(--text-secondary);
            font-style: italic;
        }
        
        /* Horizontal Rule */
        hr {
            border: none;
            border-top: 2px solid var(--border);
            margin: 2rem 0;
        }
        
        .footer { 
            text-align: center; 
            padding: 2rem; 
            color: var(--text-secondary);
            border-top: 1px solid var(--border);
            margin-top: 3rem; 
            font-size: 14px;
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--bg-main);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 6px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }
        
        @media (max-width: 768px) {
            .container { padding: 10px; }
            .file-list { grid-template-columns: 1fr; }
            .content { padding: 1.5rem; }
            h1 { font-size: 2rem; }
            h2 { font-size: 1.5rem; }
        }
    </style>
</head>
<body>
    <a href="../index.html" class="home-btn">üè†</a>
    <div class="container">
        <div class="breadcrumb">
            <div style="padding: 0 20px;">
                <a href="../index.html">üè† Home</a> <span style="color: #64748b;">/</span> <a href="index.html">06 Production-Ready Patterns</a>
            </div>
        </div>
        <div class="content">
            <h1 id="chapter-24-performance-optimization">Chapter 24: Performance Optimization</h1>
<h2 id="reactmemo-and-usememo-when-to-use-them">React.memo and useMemo: when to use them</h2>
<h2 id="the-anchor-a-product-dashboard-that-works-slowly">The Anchor: A Product Dashboard That Works... Slowly</h2>
<p>We're building a product analytics dashboard for an e-commerce platform. It displays:</p>
<ul>
<li>A list of products with sales metrics</li>
<li>A chart showing sales trends</li>
<li>Filter controls (category, date range, sort order)</li>
<li>A summary statistics panel</li>
</ul>
<p>The dashboard works correctly. Users can filter products, change date ranges, and see updated charts. But there's a problem: every interaction feels sluggish. Typing in the search box has noticeable lag. Changing a filter causes a visible freeze.</p>
<p>Let's build the naive implementation first, then diagnose why it's slow.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/ProductDashboard.tsx</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">Product</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">sales</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">SalesData</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">amount</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Simulated expensive calculation</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">calculateTrend</span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">SalesData</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üîÑ Calculating trend...&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// Simulate complex statistical analysis</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">1000000</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">sum</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">trend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">acc</span><span class="p">,</span><span class="w"> </span><span class="nx">curr</span><span class="p">,</span><span class="w"> </span><span class="nx">idx</span><span class="p">,</span><span class="w"> </span><span class="nx">arr</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">idx</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">acc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nx">curr</span><span class="p">.</span><span class="nx">amount</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">arr</span><span class="p">[</span><span class="nx">idx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">].</span><span class="nx">amount</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">trend</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Simulated expensive filtering</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">filterProducts</span><span class="p">(</span>
<span class="w">  </span><span class="nx">products</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="p">[],</span>
<span class="w">  </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<span class="w">  </span><span class="nx">searchTerm</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span>
<span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Product</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üîÑ Filtering products...&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// Simulate expensive operation</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">500000</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">sum</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">products</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">p</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">matchesCategory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">category</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">category</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">category</span><span class="p">;</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">matchesSearch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">includes</span><span class="p">(</span><span class="nx">searchTerm</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">());</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">matchesCategory</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">matchesSearch</span><span class="p">;</span>
<span class="w">  </span><span class="p">});</span>
<span class="p">}</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">ProductList</span><span class="p">({</span><span class="w"> </span><span class="nx">products</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">products</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="p">[]</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering ProductList&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;product-list&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">Products</span><span class="w"> </span><span class="p">({</span><span class="nx">products</span><span class="p">.</span><span class="nx">length</span><span class="p">})&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">products</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">product</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;product-card&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">h4</span><span class="p">&gt;{</span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="p">}&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Category</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">category</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Sales</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">sales</span><span class="p">}</span><span class="w"> </span><span class="nx">units</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">$</span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">revenue</span><span class="p">.</span><span class="nx">toLocaleString</span><span class="p">()}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">))}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">SalesChart</span><span class="p">({</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">SalesData</span><span class="p">[]</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering SalesChart&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">trend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">calculateTrend</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;sales-chart&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">Sales</span><span class="w"> </span><span class="nx">Trend</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Trend</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">trend</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;üìà&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;üìâ&#39;</span><span class="p">}</span><span class="w"> </span><span class="p">{</span><span class="nx">trend</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">2</span><span class="p">)}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;chart-placeholder&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">point</span><span class="p">,</span><span class="w"> </span><span class="nx">idx</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">idx</span><span class="p">}</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;chart-bar&quot;</span><span class="w"> </span><span class="na">style</span><span class="o">=</span><span class="p">{{</span><span class="w"> </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">point</span><span class="p">.</span><span class="nx">amount</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">10</span><span class="si">}</span><span class="sb">px`</span><span class="w"> </span><span class="p">}}&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="nx">point</span><span class="p">.</span><span class="nx">amount</span><span class="p">}</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">))}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">StatsSummary</span><span class="p">({</span><span class="w"> </span><span class="nx">products</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">products</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="p">[]</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering StatsSummary&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">totalSales</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">products</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">sales</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">totalRevenue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">products</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">revenue</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;stats-summary&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">Summary</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Total</span><span class="w"> </span><span class="nx">Products</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">products</span><span class="p">.</span><span class="nx">length</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Total</span><span class="w"> </span><span class="nx">Sales</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">totalSales</span><span class="p">}</span><span class="w"> </span><span class="nx">units</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Total</span><span class="w"> </span><span class="nx">Revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">$</span><span class="p">{</span><span class="nx">totalRevenue</span><span class="p">.</span><span class="nx">toLocaleString</span><span class="p">()}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductDashboard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">setCategory</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">searchTerm</span><span class="p">,</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">sortOrder</span><span class="p">,</span><span class="w"> </span><span class="nx">setSortOrder</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="o">&lt;</span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="o">&gt;</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Mock data</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">allProducts</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Laptop Pro&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;electronics&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">sales</span><span class="o">:</span><span class="w"> </span><span class="kt">150</span><span class="p">,</span><span class="w"> </span><span class="nx">revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">225000</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Desk Chair&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;furniture&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">sales</span><span class="o">:</span><span class="w"> </span><span class="kt">300</span><span class="p">,</span><span class="w"> </span><span class="nx">revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">45000</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Coffee Maker&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;appliances&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">sales</span><span class="o">:</span><span class="w"> </span><span class="kt">500</span><span class="p">,</span><span class="w"> </span><span class="nx">revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">50000</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Monitor 4K&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;electronics&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">sales</span><span class="o">:</span><span class="w"> </span><span class="kt">200</span><span class="p">,</span><span class="w"> </span><span class="nx">revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">100000</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Standing Desk&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;furniture&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">sales</span><span class="o">:</span><span class="w"> </span><span class="kt">100</span><span class="p">,</span><span class="w"> </span><span class="nx">revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">50000</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="p">];</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">salesData</span><span class="o">:</span><span class="w"> </span><span class="kt">SalesData</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;2024-01&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">amount</span><span class="o">:</span><span class="w"> </span><span class="kt">1000</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;2024-02&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">amount</span><span class="o">:</span><span class="w"> </span><span class="kt">1200</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;2024-03&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">amount</span><span class="o">:</span><span class="w"> </span><span class="kt">1100</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;2024-04&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">amount</span><span class="o">:</span><span class="w"> </span><span class="kt">1400</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;2024-05&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">amount</span><span class="o">:</span><span class="w"> </span><span class="kt">1600</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="p">];</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filteredProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">filterProducts</span><span class="p">(</span><span class="nx">allProducts</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">searchTerm</span><span class="p">);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">sortedProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[...</span><span class="nx">filteredProducts</span><span class="p">].</span><span class="nx">sort</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">revenue</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">a.revenue</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">a.revenue</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">revenue</span><span class="p">;</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering ProductDashboard&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;dashboard&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Product</span><span class="w"> </span><span class="nx">Analytics</span><span class="w"> </span><span class="nx">Dashboard</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;controls&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">          </span><span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Search products...&quot;</span>
<span class="w">          </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">searchTerm</span><span class="p">}</span>
<span class="w">          </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">        </span><span class="p">/&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">select</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">category</span><span class="p">}</span><span class="w"> </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setCategory</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;all&quot;</span><span class="p">&gt;</span><span class="nx">All</span><span class="w"> </span><span class="nx">Categories</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;electronics&quot;</span><span class="p">&gt;</span><span class="nx">Electronics</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;furniture&quot;</span><span class="p">&gt;</span><span class="nx">Furniture</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;appliances&quot;</span><span class="p">&gt;</span><span class="nx">Appliances</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSortOrder</span><span class="p">(</span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="nx">Sort</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;‚Üë&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;‚Üì&#39;</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;dashboard-grid&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">ProductList</span><span class="w"> </span><span class="na">products</span><span class="o">=</span><span class="p">{</span><span class="nx">sortedProducts</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">SalesChart</span><span class="w"> </span><span class="na">data</span><span class="o">=</span><span class="p">{</span><span class="nx">salesData</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">StatsSummary</span><span class="w"> </span><span class="na">products</span><span class="o">=</span><span class="p">{</span><span class="nx">sortedProducts</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="the-failure-every-keystroke-triggers-everything">The Failure: Every Keystroke Triggers Everything</h3>
<p>Let's interact with this dashboard and observe what happens.</p>
<p><strong>User Action</strong>: Type "Laptop" in the search box, one character at a time.</p>
<p><strong>Browser Behavior</strong>:
- Noticeable lag between keystrokes
- UI feels unresponsive
- Each character typed causes a visible freeze (~200-300ms)</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Browser Console Output (typing &quot;L&quot;, then &quot;a&quot;, then &quot;p&quot;):</span>

üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductDashboard
üîÑ<span class="w"> </span>Filtering<span class="w"> </span>products...
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductList
üé®<span class="w"> </span>Rendering<span class="w"> </span>SalesChart
üîÑ<span class="w"> </span>Calculating<span class="w"> </span>trend...
üé®<span class="w"> </span>Rendering<span class="w"> </span>StatsSummary

üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductDashboard
üîÑ<span class="w"> </span>Filtering<span class="w"> </span>products...
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductList
üé®<span class="w"> </span>Rendering<span class="w"> </span>SalesChart
üîÑ<span class="w"> </span>Calculating<span class="w"> </span>trend...
üé®<span class="w"> </span>Rendering<span class="w"> </span>StatsSummary

üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductDashboard
üîÑ<span class="w"> </span>Filtering<span class="w"> </span>products...
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductList
üé®<span class="w"> </span>Rendering<span class="w"> </span>SalesChart
üîÑ<span class="w"> </span>Calculating<span class="w"> </span>trend...
üé®<span class="w"> </span>Rendering<span class="w"> </span>StatsSummary
</code></pre></div>

<h3 id="diagnostic-analysis-reading-the-performance-failure">Diagnostic Analysis: Reading the Performance Failure</h3>
<p><strong>React DevTools - Profiler Tab</strong>:
- Recorded interaction: Typing "Laptop" (6 characters)
- Total renders: 6 (one per keystroke)
- Each render took ~250ms
- Total time: 1.5 seconds for 6 characters
- Components that rendered each time:
  - <code>ProductDashboard</code> ‚úì (expected - state changed)
  - <code>ProductList</code> ‚úì (expected - filtered products changed)
  - <code>SalesChart</code> ‚úó (unexpected - sales data never changed)
  - <code>StatsSummary</code> ‚úì (expected - filtered products changed)</p>
<p><strong>React DevTools - Components Tab</strong>:
- <code>SalesChart</code> props: <code>{ data: Array(5) }</code>
- Props comparison: <code>data</code> array reference changes every render
- Reason for re-render: "Props changed"
- But the actual data inside the array is identical</p>
<p><strong>Chrome Performance Tab</strong>:
- Main thread blocked for ~250ms per keystroke
- Breakdown per render:
  - <code>filterProducts</code>: ~100ms (expensive filtering)
  - <code>calculateTrend</code>: ~120ms (expensive calculation)
  - React reconciliation: ~30ms
- Total: ~250ms of blocked main thread</p>
<p><strong>Let's parse this evidence</strong>:</p>
<ol>
<li><strong>What the user experiences</strong>:</li>
<li>Expected: Instant feedback when typing</li>
<li>
<p>Actual: 250ms lag per keystroke, feels sluggish</p>
</li>
<li>
<p><strong>What the console reveals</strong>:</p>
</li>
<li>Every state change triggers a full re-render of all components</li>
<li><code>calculateTrend</code> runs on every keystroke, even though sales data never changes</li>
<li>
<p><code>filterProducts</code> runs on every keystroke (expected, but could be optimized)</p>
</li>
<li>
<p><strong>What DevTools shows</strong>:</p>
</li>
<li><code>SalesChart</code> re-renders unnecessarily</li>
<li>The <code>data</code> prop is a new array reference each render, even though contents are identical</li>
<li>
<p>Expensive calculations run repeatedly with the same inputs</p>
</li>
<li>
<p><strong>Root cause identified</strong>: </p>
</li>
<li>React re-renders all child components when parent state changes</li>
<li>Expensive calculations run on every render, even with unchanged inputs</li>
<li>
<p>New object/array references created each render trigger unnecessary child re-renders</p>
</li>
<li>
<p><strong>Why the current approach can't solve this</strong>:</p>
</li>
<li>React's default behavior is to re-render everything when state changes</li>
<li>Without optimization, every component recalculates everything every time</li>
<li>
<p>We need to tell React: "Skip this work if the inputs haven't changed"</p>
</li>
<li>
<p><strong>What we need</strong>:</p>
</li>
<li>A way to skip re-rendering components when their props haven't changed</li>
<li>A way to cache expensive calculation results</li>
<li>A way to preserve object/array references across renders</li>
</ol>
<h2 id="reactmemo-preventing-unnecessary-component-re-renders">React.memo: Preventing Unnecessary Component Re-renders</h2>
<p><code>React.memo</code> is a higher-order component that tells React: "Only re-render this component if its props have actually changed."</p>
<h3 id="how-reactmemo-works">How React.memo Works</h3>
<p>Without <code>React.memo</code>, React's default behavior:
1. Parent state changes
2. Parent re-renders
3. All child components re-render, regardless of whether their props changed</p>
<p>With <code>React.memo</code>:
1. Parent state changes
2. Parent re-renders
3. React compares child's new props with previous props (shallow comparison)
4. If props are identical, skip re-rendering the child
5. If props changed, re-render the child</p>
<h3 id="iteration-1-memoizing-saleschart">Iteration 1: Memoizing SalesChart</h3>
<p>The <code>SalesChart</code> component receives <code>data</code> that never changes. Let's prevent it from re-rendering unnecessarily.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/ProductDashboard.tsx (updated)</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">memo</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="c1">// ... (Product, SalesData interfaces unchanged)</span>
<span class="c1">// ... (calculateTrend, filterProducts functions unchanged)</span>

<span class="c1">// Wrap SalesChart with React.memo</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">SalesChart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">memo</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="nx">SalesChart</span><span class="p">({</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">SalesData</span><span class="p">[]</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering SalesChart&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">trend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">calculateTrend</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;sales-chart&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">Sales</span><span class="w"> </span><span class="nx">Trend</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Trend</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">trend</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;üìà&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;üìâ&#39;</span><span class="p">}</span><span class="w"> </span><span class="p">{</span><span class="nx">trend</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">2</span><span class="p">)}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;chart-placeholder&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">point</span><span class="p">,</span><span class="w"> </span><span class="nx">idx</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">idx</span><span class="p">}</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;chart-bar&quot;</span><span class="w"> </span><span class="na">style</span><span class="o">=</span><span class="p">{{</span><span class="w"> </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">point</span><span class="p">.</span><span class="nx">amount</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">10</span><span class="si">}</span><span class="sb">px`</span><span class="w"> </span><span class="p">}}&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="nx">point</span><span class="p">.</span><span class="nx">amount</span><span class="p">}</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">))}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// ... (ProductList, StatsSummary unchanged)</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductDashboard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">setCategory</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">searchTerm</span><span class="p">,</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">sortOrder</span><span class="p">,</span><span class="w"> </span><span class="nx">setSortOrder</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="o">&lt;</span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="o">&gt;</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">allProducts</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Laptop Pro&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;electronics&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">sales</span><span class="o">:</span><span class="w"> </span><span class="kt">150</span><span class="p">,</span><span class="w"> </span><span class="nx">revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">225000</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Desk Chair&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;furniture&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">sales</span><span class="o">:</span><span class="w"> </span><span class="kt">300</span><span class="p">,</span><span class="w"> </span><span class="nx">revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">45000</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Coffee Maker&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;appliances&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">sales</span><span class="o">:</span><span class="w"> </span><span class="kt">500</span><span class="p">,</span><span class="w"> </span><span class="nx">revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">50000</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Monitor 4K&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;electronics&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">sales</span><span class="o">:</span><span class="w"> </span><span class="kt">200</span><span class="p">,</span><span class="w"> </span><span class="nx">revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">100000</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Standing Desk&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;furniture&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">sales</span><span class="o">:</span><span class="w"> </span><span class="kt">100</span><span class="p">,</span><span class="w"> </span><span class="nx">revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">50000</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="p">];</span>

<span class="w">  </span><span class="c1">// Move salesData outside component or use useMemo to maintain reference</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">salesData</span><span class="o">:</span><span class="w"> </span><span class="kt">SalesData</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;2024-01&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">amount</span><span class="o">:</span><span class="w"> </span><span class="kt">1000</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;2024-02&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">amount</span><span class="o">:</span><span class="w"> </span><span class="kt">1200</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;2024-03&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">amount</span><span class="o">:</span><span class="w"> </span><span class="kt">1100</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;2024-04&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">amount</span><span class="o">:</span><span class="w"> </span><span class="kt">1400</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;2024-05&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">amount</span><span class="o">:</span><span class="w"> </span><span class="kt">1600</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="p">];</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filteredProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">filterProducts</span><span class="p">(</span><span class="nx">allProducts</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">searchTerm</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">sortedProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[...</span><span class="nx">filteredProducts</span><span class="p">].</span><span class="nx">sort</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">revenue</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">a.revenue</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">a.revenue</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">revenue</span><span class="p">;</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering ProductDashboard&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;dashboard&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Product</span><span class="w"> </span><span class="nx">Analytics</span><span class="w"> </span><span class="nx">Dashboard</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;controls&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">          </span><span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Search products...&quot;</span>
<span class="w">          </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">searchTerm</span><span class="p">}</span>
<span class="w">          </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">        </span><span class="p">/&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">select</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">category</span><span class="p">}</span><span class="w"> </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setCategory</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;all&quot;</span><span class="p">&gt;</span><span class="nx">All</span><span class="w"> </span><span class="nx">Categories</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;electronics&quot;</span><span class="p">&gt;</span><span class="nx">Electronics</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;furniture&quot;</span><span class="p">&gt;</span><span class="nx">Furniture</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;appliances&quot;</span><span class="p">&gt;</span><span class="nx">Appliances</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSortOrder</span><span class="p">(</span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="nx">Sort</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;‚Üë&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;‚Üì&#39;</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;dashboard-grid&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">ProductList</span><span class="w"> </span><span class="na">products</span><span class="o">=</span><span class="p">{</span><span class="nx">sortedProducts</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">SalesChart</span><span class="w"> </span><span class="na">data</span><span class="o">=</span><span class="p">{</span><span class="nx">salesData</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">StatsSummary</span><span class="w"> </span><span class="na">products</span><span class="o">=</span><span class="p">{</span><span class="nx">sortedProducts</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>User Action</strong>: Type "Laptop" in the search box again.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Browser Console Output (typing &quot;L&quot;, then &quot;a&quot;, then &quot;p&quot;):</span>

üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductDashboard
üîÑ<span class="w"> </span>Filtering<span class="w"> </span>products...
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductList
üé®<span class="w"> </span>Rendering<span class="w"> </span>SalesChart
üîÑ<span class="w"> </span>Calculating<span class="w"> </span>trend...
üé®<span class="w"> </span>Rendering<span class="w"> </span>StatsSummary

üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductDashboard
üîÑ<span class="w"> </span>Filtering<span class="w"> </span>products...
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductList
üé®<span class="w"> </span>Rendering<span class="w"> </span>StatsSummary

üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductDashboard
üîÑ<span class="w"> </span>Filtering<span class="w"> </span>products...
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductList
üé®<span class="w"> </span>Rendering<span class="w"> </span>StatsSummary
</code></pre></div>

<h3 id="the-failure-reactmemo-didnt-work">The Failure: React.memo Didn't Work!</h3>
<p><strong>Browser Behavior</strong>:
- <code>SalesChart</code> still renders on the first keystroke
- But then stops re-rendering on subsequent keystrokes
- Performance improved slightly, but still sluggish</p>
<p><strong>React DevTools - Profiler</strong>:
- First render: ~250ms (SalesChart rendered)
- Subsequent renders: ~130ms (SalesChart skipped)
- Improvement: ~48% faster after first render</p>
<p><strong>Why did SalesChart render on the first keystroke?</strong></p>
<p>The problem is that <code>salesData</code> is defined inside the component function. Every time <code>ProductDashboard</code> re-renders, a new <code>salesData</code> array is created with a new reference. Even though the contents are identical, React's shallow comparison sees different references and considers the props "changed."</p>
<h3 id="understanding-reactmemos-comparison">Understanding React.memo's Comparison</h3>
<p><code>React.memo</code> uses <strong>shallow comparison</strong> by default:
- Primitive values (string, number, boolean): Compares by value
- Objects and arrays: Compares by reference</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// These are different references, even with identical contents</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">arr1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">];</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">arr2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">];</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr1</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">arr2</span><span class="p">);</span><span class="w"> </span><span class="c1">// false</span>

<span class="c1">// These are the same reference</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">arr3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">arr1</span><span class="p">;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr1</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">arr3</span><span class="p">);</span><span class="w"> </span><span class="c1">// true</span>
</code></pre></div>

<p>Every render creates a new <code>salesData</code> array, so <code>React.memo</code> sees it as a prop change.</p>
<h3 id="solution-1-move-static-data-outside-component">Solution 1: Move Static Data Outside Component</h3>
<p>If data doesn't depend on props or state, define it outside the component.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/ProductDashboard.tsx (updated)</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">memo</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="c1">// ... (interfaces unchanged)</span>

<span class="c1">// Move static data outside component</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">SALES_DATA</span><span class="o">:</span><span class="w"> </span><span class="kt">SalesData</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;2024-01&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">amount</span><span class="o">:</span><span class="w"> </span><span class="kt">1000</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;2024-02&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">amount</span><span class="o">:</span><span class="w"> </span><span class="kt">1200</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;2024-03&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">amount</span><span class="o">:</span><span class="w"> </span><span class="kt">1100</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;2024-04&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">amount</span><span class="o">:</span><span class="w"> </span><span class="kt">1400</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;2024-05&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">amount</span><span class="o">:</span><span class="w"> </span><span class="kt">1600</span><span class="w"> </span><span class="p">},</span>
<span class="p">];</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">ALL_PRODUCTS</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Laptop Pro&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;electronics&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">sales</span><span class="o">:</span><span class="w"> </span><span class="kt">150</span><span class="p">,</span><span class="w"> </span><span class="nx">revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">225000</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Desk Chair&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;furniture&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">sales</span><span class="o">:</span><span class="w"> </span><span class="kt">300</span><span class="p">,</span><span class="w"> </span><span class="nx">revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">45000</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Coffee Maker&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;appliances&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">sales</span><span class="o">:</span><span class="w"> </span><span class="kt">500</span><span class="p">,</span><span class="w"> </span><span class="nx">revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">50000</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Monitor 4K&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;electronics&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">sales</span><span class="o">:</span><span class="w"> </span><span class="kt">200</span><span class="p">,</span><span class="w"> </span><span class="nx">revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">100000</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Standing Desk&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;furniture&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">sales</span><span class="o">:</span><span class="w"> </span><span class="kt">100</span><span class="p">,</span><span class="w"> </span><span class="nx">revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">50000</span><span class="w"> </span><span class="p">},</span>
<span class="p">];</span>

<span class="c1">// ... (calculateTrend, filterProducts unchanged)</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">SalesChart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">memo</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="nx">SalesChart</span><span class="p">({</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">SalesData</span><span class="p">[]</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering SalesChart&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">trend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">calculateTrend</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;sales-chart&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">Sales</span><span class="w"> </span><span class="nx">Trend</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Trend</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">trend</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;üìà&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;üìâ&#39;</span><span class="p">}</span><span class="w"> </span><span class="p">{</span><span class="nx">trend</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">2</span><span class="p">)}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;chart-placeholder&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">point</span><span class="p">,</span><span class="w"> </span><span class="nx">idx</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">idx</span><span class="p">}</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;chart-bar&quot;</span><span class="w"> </span><span class="na">style</span><span class="o">=</span><span class="p">{{</span><span class="w"> </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">point</span><span class="p">.</span><span class="nx">amount</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">10</span><span class="si">}</span><span class="sb">px`</span><span class="w"> </span><span class="p">}}&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="nx">point</span><span class="p">.</span><span class="nx">amount</span><span class="p">}</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">))}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// ... (ProductList, StatsSummary unchanged)</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductDashboard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">setCategory</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">searchTerm</span><span class="p">,</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">sortOrder</span><span class="p">,</span><span class="w"> </span><span class="nx">setSortOrder</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="o">&lt;</span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="o">&gt;</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filteredProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">filterProducts</span><span class="p">(</span><span class="nx">ALL_PRODUCTS</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">searchTerm</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">sortedProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[...</span><span class="nx">filteredProducts</span><span class="p">].</span><span class="nx">sort</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">revenue</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">a.revenue</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">a.revenue</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">revenue</span><span class="p">;</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering ProductDashboard&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;dashboard&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Product</span><span class="w"> </span><span class="nx">Analytics</span><span class="w"> </span><span class="nx">Dashboard</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;controls&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">          </span><span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Search products...&quot;</span>
<span class="w">          </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">searchTerm</span><span class="p">}</span>
<span class="w">          </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">        </span><span class="p">/&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">select</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">category</span><span class="p">}</span><span class="w"> </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setCategory</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;all&quot;</span><span class="p">&gt;</span><span class="nx">All</span><span class="w"> </span><span class="nx">Categories</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;electronics&quot;</span><span class="p">&gt;</span><span class="nx">Electronics</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;furniture&quot;</span><span class="p">&gt;</span><span class="nx">Furniture</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;appliances&quot;</span><span class="p">&gt;</span><span class="nx">Appliances</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSortOrder</span><span class="p">(</span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="nx">Sort</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;‚Üë&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;‚Üì&#39;</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;dashboard-grid&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">ProductList</span><span class="w"> </span><span class="na">products</span><span class="o">=</span><span class="p">{</span><span class="nx">sortedProducts</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">SalesChart</span><span class="w"> </span><span class="na">data</span><span class="o">=</span><span class="p">{</span><span class="nx">SALES_DATA</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">StatsSummary</span><span class="w"> </span><span class="na">products</span><span class="o">=</span><span class="p">{</span><span class="nx">sortedProducts</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>User Action</strong>: Type "Laptop" in the search box.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Browser Console Output (typing &quot;L&quot;, then &quot;a&quot;, then &quot;p&quot;):</span>

üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductDashboard
üîÑ<span class="w"> </span>Filtering<span class="w"> </span>products...
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductList
üé®<span class="w"> </span>Rendering<span class="w"> </span>StatsSummary

üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductDashboard
üîÑ<span class="w"> </span>Filtering<span class="w"> </span>products...
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductList
üé®<span class="w"> </span>Rendering<span class="w"> </span>StatsSummary

üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductDashboard
üîÑ<span class="w"> </span>Filtering<span class="w"> </span>products...
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductList
üé®<span class="w"> </span>Rendering<span class="w"> </span>StatsSummary
</code></pre></div>

<p><strong>Expected vs. Actual Improvement</strong>:
- <code>SalesChart</code> no longer renders on any keystroke
- <code>calculateTrend</code> no longer runs (saved ~120ms per keystroke)
- Performance: ~130ms per keystroke (down from 250ms)
- Improvement: 48% faster</p>
<p><strong>React DevTools - Profiler</strong>:
- Each render now takes ~130ms (vs. 250ms before)
- <code>SalesChart</code> shows "Did not render" for all typing interactions
- Main thread blocked time reduced by ~120ms per keystroke</p>
<p><strong>Limitation preview</strong>: We still have <code>filterProducts</code> running on every keystroke, taking ~100ms. And we're still creating new arrays for <code>sortedProducts</code> on every render. Let's address those next.</p>
<h2 id="usememo-caching-expensive-calculations">useMemo: Caching Expensive Calculations</h2>
<p><code>useMemo</code> tells React: "Only recalculate this value if its dependencies change."</p>
<h3 id="how-usememo-works">How useMemo Works</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">memoizedValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Expensive calculation</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">expensiveFunction</span><span class="p">(</span><span class="nx">dependency1</span><span class="p">,</span><span class="w"> </span><span class="nx">dependency2</span><span class="p">);</span>
<span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">dependency1</span><span class="p">,</span><span class="w"> </span><span class="nx">dependency2</span><span class="p">]);</span>
</code></pre></div>

<p>React will:
1. Run the calculation on first render
2. Cache the result
3. On subsequent renders, check if dependencies changed
4. If dependencies unchanged, return cached result
5. If dependencies changed, recalculate and cache new result</p>
<h3 id="iteration-2-memoizing-filtered-products">Iteration 2: Memoizing Filtered Products</h3>
<p>The <code>filterProducts</code> function runs on every render, even when <code>category</code> and <code>searchTerm</code> haven't changed (e.g., when clicking the sort button).</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/ProductDashboard.tsx (updated)</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">memo</span><span class="p">,</span><span class="w"> </span><span class="nx">useMemo</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="c1">// ... (interfaces, static data, helper functions unchanged)</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">SalesChart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">memo</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="nx">SalesChart</span><span class="p">({</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">SalesData</span><span class="p">[]</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering SalesChart&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Memoize the expensive trend calculation</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">trend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üîÑ Calculating trend...&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">calculateTrend</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">data</span><span class="p">]);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;sales-chart&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">Sales</span><span class="w"> </span><span class="nx">Trend</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Trend</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">trend</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;üìà&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;üìâ&#39;</span><span class="p">}</span><span class="w"> </span><span class="p">{</span><span class="nx">trend</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">2</span><span class="p">)}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;chart-placeholder&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">point</span><span class="p">,</span><span class="w"> </span><span class="nx">idx</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">idx</span><span class="p">}</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;chart-bar&quot;</span><span class="w"> </span><span class="na">style</span><span class="o">=</span><span class="p">{{</span><span class="w"> </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">point</span><span class="p">.</span><span class="nx">amount</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">10</span><span class="si">}</span><span class="sb">px`</span><span class="w"> </span><span class="p">}}&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="nx">point</span><span class="p">.</span><span class="nx">amount</span><span class="p">}</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">))}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// ... (ProductList, StatsSummary unchanged)</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductDashboard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">setCategory</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">searchTerm</span><span class="p">,</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">sortOrder</span><span class="p">,</span><span class="w"> </span><span class="nx">setSortOrder</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="o">&lt;</span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="o">&gt;</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Memoize filtered products - only recalculate when category or searchTerm changes</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filteredProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üîÑ Filtering products...&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">filterProducts</span><span class="p">(</span><span class="nx">ALL_PRODUCTS</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">searchTerm</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">searchTerm</span><span class="p">]);</span>

<span class="w">  </span><span class="c1">// Memoize sorted products - only recalculate when filteredProducts or sortOrder changes</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">sortedProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üîÑ Sorting products...&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[...</span><span class="nx">filteredProducts</span><span class="p">].</span><span class="nx">sort</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">revenue</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">a.revenue</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">a.revenue</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">revenue</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">filteredProducts</span><span class="p">,</span><span class="w"> </span><span class="nx">sortOrder</span><span class="p">]);</span>

<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering ProductDashboard&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;dashboard&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Product</span><span class="w"> </span><span class="nx">Analytics</span><span class="w"> </span><span class="nx">Dashboard</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;controls&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">          </span><span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Search products...&quot;</span>
<span class="w">          </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">searchTerm</span><span class="p">}</span>
<span class="w">          </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">        </span><span class="p">/&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">select</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">category</span><span class="p">}</span><span class="w"> </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setCategory</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;all&quot;</span><span class="p">&gt;</span><span class="nx">All</span><span class="w"> </span><span class="nx">Categories</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;electronics&quot;</span><span class="p">&gt;</span><span class="nx">Electronics</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;furniture&quot;</span><span class="p">&gt;</span><span class="nx">Furniture</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;appliances&quot;</span><span class="p">&gt;</span><span class="nx">Appliances</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSortOrder</span><span class="p">(</span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="nx">Sort</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;‚Üë&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;‚Üì&#39;</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;dashboard-grid&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">ProductList</span><span class="w"> </span><span class="na">products</span><span class="o">=</span><span class="p">{</span><span class="nx">sortedProducts</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">SalesChart</span><span class="w"> </span><span class="na">data</span><span class="o">=</span><span class="p">{</span><span class="nx">SALES_DATA</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">StatsSummary</span><span class="w"> </span><span class="na">products</span><span class="o">=</span><span class="p">{</span><span class="nx">sortedProducts</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>User Action 1</strong>: Type "Laptop" in the search box.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Browser Console Output (typing &quot;L&quot;, then &quot;a&quot;, then &quot;p&quot;):</span>

üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductDashboard
üîÑ<span class="w"> </span>Filtering<span class="w"> </span>products...
üîÑ<span class="w"> </span>Sorting<span class="w"> </span>products...
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductList
üé®<span class="w"> </span>Rendering<span class="w"> </span>StatsSummary

üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductDashboard
üîÑ<span class="w"> </span>Filtering<span class="w"> </span>products...
üîÑ<span class="w"> </span>Sorting<span class="w"> </span>products...
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductList
üé®<span class="w"> </span>Rendering<span class="w"> </span>StatsSummary

üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductDashboard
üîÑ<span class="w"> </span>Filtering<span class="w"> </span>products...
üîÑ<span class="w"> </span>Sorting<span class="w"> </span>products...
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductList
üé®<span class="w"> </span>Rendering<span class="w"> </span>StatsSummary
</code></pre></div>

<p><strong>User Action 2</strong>: Click the sort button (without changing search or category).</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Browser Console Output:</span>

üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductDashboard
üîÑ<span class="w"> </span>Sorting<span class="w"> </span>products...
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductList
üé®<span class="w"> </span>Rendering<span class="w"> </span>StatsSummary
</code></pre></div>

<p><strong>Expected vs. Actual Improvement</strong>:</p>
<p><strong>Typing in search</strong>:
- Still runs filtering and sorting (expected - dependencies changed)
- Performance: ~130ms per keystroke (unchanged from before)
- But now we have the foundation for further optimization</p>
<p><strong>Clicking sort button</strong>:
- Before: Ran filtering (~100ms) + sorting (~10ms) = ~110ms
- After: Only runs sorting (~10ms)
- Improvement: 91% faster for sort-only operations</p>
<p><strong>React DevTools - Profiler</strong>:
- Sort button click: 10ms (vs. 110ms before)
- Filtering only runs when <code>category</code> or <code>searchTerm</code> changes
- Sorting only runs when <code>filteredProducts</code> or <code>sortOrder</code> changes</p>
<h3 id="the-subtle-bug-usememo-dependency-arrays">The Subtle Bug: useMemo Dependency Arrays</h3>
<p>Let's introduce a common mistake to understand how dependency arrays work.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// ‚ùå WRONG: Missing dependency</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">filteredProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">filterProducts</span><span class="p">(</span><span class="nx">ALL_PRODUCTS</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">searchTerm</span><span class="p">);</span>
<span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">category</span><span class="p">]);</span><span class="w"> </span><span class="c1">// Missing searchTerm!</span>

<span class="c1">// What happens:</span>
<span class="c1">// - Changing category triggers recalculation ‚úì</span>
<span class="c1">// - Changing searchTerm does NOT trigger recalculation ‚úó</span>
<span class="c1">// - filteredProducts becomes stale when searchTerm changes</span>
</code></pre></div>

<p><strong>User Action</strong>: Type "Laptop" in search box.</p>
<p><strong>Browser Behavior</strong>:
- Products don't filter as you type
- Console shows no "Filtering products..." message
- UI shows all products regardless of search term</p>
<p><strong>React DevTools - Components Tab</strong>:
- <code>searchTerm</code> state updates correctly
- <code>filteredProducts</code> value doesn't change
- Reason: useMemo dependencies don't include <code>searchTerm</code></p>
<p><strong>The Rule</strong>: Include ALL values from component scope that the memoized function uses. React's ESLint plugin (<code>eslint-plugin-react-hooks</code>) will warn you about missing dependencies.</p>
<h3 id="iteration-3-memoizing-child-components">Iteration 3: Memoizing Child Components</h3>
<p>Now let's memoize <code>ProductList</code> and <code>StatsSummary</code> to prevent unnecessary re-renders when their props haven't changed.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/ProductDashboard.tsx (updated)</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">memo</span><span class="p">,</span><span class="w"> </span><span class="nx">useMemo</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="c1">// ... (interfaces, static data, helper functions unchanged)</span>

<span class="c1">// Memoize ProductList</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">ProductList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">memo</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductList</span><span class="p">({</span><span class="w"> </span><span class="nx">products</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">products</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="p">[]</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering ProductList&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;product-list&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">Products</span><span class="w"> </span><span class="p">({</span><span class="nx">products</span><span class="p">.</span><span class="nx">length</span><span class="p">})&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">products</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">product</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;product-card&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">h4</span><span class="p">&gt;{</span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="p">}&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Category</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">category</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Sales</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">sales</span><span class="p">}</span><span class="w"> </span><span class="nx">units</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">$</span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">revenue</span><span class="p">.</span><span class="nx">toLocaleString</span><span class="p">()}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">))}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">});</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">SalesChart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">memo</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="nx">SalesChart</span><span class="p">({</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">SalesData</span><span class="p">[]</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering SalesChart&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">trend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üîÑ Calculating trend...&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">calculateTrend</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">data</span><span class="p">]);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;sales-chart&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">Sales</span><span class="w"> </span><span class="nx">Trend</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Trend</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">trend</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;üìà&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;üìâ&#39;</span><span class="p">}</span><span class="w"> </span><span class="p">{</span><span class="nx">trend</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">2</span><span class="p">)}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;chart-placeholder&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">point</span><span class="p">,</span><span class="w"> </span><span class="nx">idx</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">idx</span><span class="p">}</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;chart-bar&quot;</span><span class="w"> </span><span class="na">style</span><span class="o">=</span><span class="p">{{</span><span class="w"> </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">point</span><span class="p">.</span><span class="nx">amount</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">10</span><span class="si">}</span><span class="sb">px`</span><span class="w"> </span><span class="p">}}&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="nx">point</span><span class="p">.</span><span class="nx">amount</span><span class="p">}</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">))}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// Memoize StatsSummary</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">StatsSummary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">memo</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="nx">StatsSummary</span><span class="p">({</span><span class="w"> </span><span class="nx">products</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">products</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="p">[]</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering StatsSummary&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Memoize expensive calculations inside the component</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">totalSales</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üîÑ Calculating total sales...&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">products</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">sales</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">products</span><span class="p">]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">totalRevenue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üîÑ Calculating total revenue...&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">products</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">revenue</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">products</span><span class="p">]);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;stats-summary&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">Summary</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Total</span><span class="w"> </span><span class="nx">Products</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">products</span><span class="p">.</span><span class="nx">length</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Total</span><span class="w"> </span><span class="nx">Sales</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">totalSales</span><span class="p">}</span><span class="w"> </span><span class="nx">units</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Total</span><span class="w"> </span><span class="nx">Revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">$</span><span class="p">{</span><span class="nx">totalRevenue</span><span class="p">.</span><span class="nx">toLocaleString</span><span class="p">()}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">});</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductDashboard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">setCategory</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">searchTerm</span><span class="p">,</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">sortOrder</span><span class="p">,</span><span class="w"> </span><span class="nx">setSortOrder</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="o">&lt;</span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="o">&gt;</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filteredProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üîÑ Filtering products...&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">filterProducts</span><span class="p">(</span><span class="nx">ALL_PRODUCTS</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">searchTerm</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">searchTerm</span><span class="p">]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">sortedProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üîÑ Sorting products...&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[...</span><span class="nx">filteredProducts</span><span class="p">].</span><span class="nx">sort</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">revenue</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">a.revenue</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">a.revenue</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">revenue</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">filteredProducts</span><span class="p">,</span><span class="w"> </span><span class="nx">sortOrder</span><span class="p">]);</span>

<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering ProductDashboard&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;dashboard&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Product</span><span class="w"> </span><span class="nx">Analytics</span><span class="w"> </span><span class="nx">Dashboard</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;controls&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">          </span><span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Search products...&quot;</span>
<span class="w">          </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">searchTerm</span><span class="p">}</span>
<span class="w">          </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">        </span><span class="p">/&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">select</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">category</span><span class="p">}</span><span class="w"> </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setCategory</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;all&quot;</span><span class="p">&gt;</span><span class="nx">All</span><span class="w"> </span><span class="nx">Categories</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;electronics&quot;</span><span class="p">&gt;</span><span class="nx">Electronics</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;furniture&quot;</span><span class="p">&gt;</span><span class="nx">Furniture</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;appliances&quot;</span><span class="p">&gt;</span><span class="nx">Appliances</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSortOrder</span><span class="p">(</span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="nx">Sort</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;‚Üë&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;‚Üì&#39;</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;dashboard-grid&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">ProductList</span><span class="w"> </span><span class="na">products</span><span class="o">=</span><span class="p">{</span><span class="nx">sortedProducts</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">SalesChart</span><span class="w"> </span><span class="na">data</span><span class="o">=</span><span class="p">{</span><span class="nx">SALES_DATA</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">StatsSummary</span><span class="w"> </span><span class="na">products</span><span class="o">=</span><span class="p">{</span><span class="nx">sortedProducts</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>User Action</strong>: Click the sort button.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Browser Console Output:</span>

üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductDashboard
üîÑ<span class="w"> </span>Sorting<span class="w"> </span>products...
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductList
üé®<span class="w"> </span>Rendering<span class="w"> </span>StatsSummary
üîÑ<span class="w"> </span>Calculating<span class="w"> </span>total<span class="w"> </span>sales...
üîÑ<span class="w"> </span>Calculating<span class="w"> </span>total<span class="w"> </span>revenue...
</code></pre></div>

<p><strong>Wait, that's wrong!</strong> <code>ProductList</code> and <code>StatsSummary</code> still re-rendered, even though we wrapped them with <code>React.memo</code>.</p>
<h3 id="the-failure-reactmemo-doesnt-work-with-new-array-references">The Failure: React.memo Doesn't Work with New Array References</h3>
<p><strong>Diagnostic Analysis</strong>:</p>
<p><strong>React DevTools - Components Tab</strong>:
- <code>ProductList</code> props: <code>{ products: Array(5) }</code>
- Props comparison: <code>products</code> array reference changed
- Reason: <code>sortedProducts</code> is a new array every time we sort</p>
<p><strong>The Problem</strong>: Even though <code>useMemo</code> caches the sorted array, when we click the sort button, <code>sortOrder</code> changes, so <code>useMemo</code> recalculates and returns a <strong>new array reference</strong>. <code>React.memo</code> sees a different reference and re-renders the component.</p>
<p><strong>This is actually correct behavior!</strong> The sorted array contents DID change (the order is different), so the components SHOULD re-render.</p>
<p>Let's verify this is working correctly by testing a scenario where the array contents truly don't change.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Add a new state that doesn&#39;t affect products</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductDashboard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">setCategory</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">searchTerm</span><span class="p">,</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">sortOrder</span><span class="p">,</span><span class="w"> </span><span class="nx">setSortOrder</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="o">&lt;</span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="o">&gt;</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">theme</span><span class="p">,</span><span class="w"> </span><span class="nx">setTheme</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="o">&lt;</span><span class="s1">&#39;light&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;dark&#39;</span><span class="o">&gt;</span><span class="p">(</span><span class="s1">&#39;light&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// ‚Üê New state</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filteredProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üîÑ Filtering products...&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">filterProducts</span><span class="p">(</span><span class="nx">ALL_PRODUCTS</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">searchTerm</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">searchTerm</span><span class="p">]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">sortedProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üîÑ Sorting products...&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[...</span><span class="nx">filteredProducts</span><span class="p">].</span><span class="nx">sort</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">revenue</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">a.revenue</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">a.revenue</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">revenue</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">filteredProducts</span><span class="p">,</span><span class="w"> </span><span class="nx">sortOrder</span><span class="p">]);</span>

<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering ProductDashboard&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`dashboard theme-</span><span class="si">${</span><span class="nx">theme</span><span class="si">}</span><span class="sb">`</span><span class="p">}&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Product</span><span class="w"> </span><span class="nx">Analytics</span><span class="w"> </span><span class="nx">Dashboard</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;controls&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">          </span><span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Search products...&quot;</span>
<span class="w">          </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">searchTerm</span><span class="p">}</span>
<span class="w">          </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">        </span><span class="p">/&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">select</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">category</span><span class="p">}</span><span class="w"> </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setCategory</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;all&quot;</span><span class="p">&gt;</span><span class="nx">All</span><span class="w"> </span><span class="nx">Categories</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;electronics&quot;</span><span class="p">&gt;</span><span class="nx">Electronics</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;furniture&quot;</span><span class="p">&gt;</span><span class="nx">Furniture</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;appliances&quot;</span><span class="p">&gt;</span><span class="nx">Appliances</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSortOrder</span><span class="p">(</span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="nx">Sort</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;‚Üë&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;‚Üì&#39;</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setTheme</span><span class="p">(</span><span class="nx">theme</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;light&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;dark&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;light&#39;</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="nx">Theme</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">theme</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;dashboard-grid&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">ProductList</span><span class="w"> </span><span class="na">products</span><span class="o">=</span><span class="p">{</span><span class="nx">sortedProducts</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">SalesChart</span><span class="w"> </span><span class="na">data</span><span class="o">=</span><span class="p">{</span><span class="nx">SALES_DATA</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">StatsSummary</span><span class="w"> </span><span class="na">products</span><span class="o">=</span><span class="p">{</span><span class="nx">sortedProducts</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>User Action</strong>: Click the theme button.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Browser Console Output:</span>

üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductDashboard
</code></pre></div>

<p><strong>Expected vs. Actual Improvement</strong>:
- Parent re-renders (expected - state changed)
- No child components re-render (expected - their props didn't change)
- No expensive calculations run (expected - dependencies didn't change)
- Performance: ~5ms (just React reconciliation)</p>
<p><strong>React DevTools - Profiler</strong>:
- <code>ProductDashboard</code> rendered
- <code>ProductList</code>, <code>SalesChart</code>, <code>StatsSummary</code> all show "Did not render"
- Total render time: ~5ms</p>
<p><strong>This is the power of React.memo + useMemo working together</strong>:
1. <code>useMemo</code> preserves array references when dependencies don't change
2. <code>React.memo</code> skips re-rendering when props (array references) don't change
3. Result: Changing unrelated state doesn't trigger expensive child re-renders</p>
<h3 id="when-to-apply-reactmemo-and-usememo">When to Apply React.memo and useMemo</h3>
<p><strong>React.memo</strong>:</p>
<p><strong>Use when</strong>:
- Component is expensive to render (complex UI, many elements)
- Component receives the same props frequently
- Component is rendered often due to parent re-renders
- Props are primitive values or stable references</p>
<p><strong>Don't use when</strong>:
- Component is cheap to render (simple UI)
- Props change on every render anyway
- Component rarely re-renders
- You're wrapping every component "just in case" (premature optimization)</p>
<p><strong>useMemo</strong>:</p>
<p><strong>Use when</strong>:
- Calculation is expensive (loops, complex math, data transformations)
- Result is used as a prop for a memoized child component
- Result is used in a dependency array of another hook
- You've measured and confirmed it's a bottleneck</p>
<p><strong>Don't use when</strong>:
- Calculation is cheap (simple arithmetic, single array access)
- Result changes on every render anyway
- You're memoizing everything "just in case" (premature optimization)
- The memoization overhead exceeds the calculation cost</p>
<h3 id="common-failure-modes-and-their-signatures">Common Failure Modes and Their Signatures</h3>
<h4 id="symptom-reactmemo-doesnt-prevent-re-renders">Symptom: React.memo doesn't prevent re-renders</h4>
<p><strong>Browser behavior</strong>:
Memoized component still re-renders on every parent render</p>
<p><strong>Console pattern</strong>:</p>
<div class="codehilite"><pre><span></span><code>üé®<span class="w"> </span>Rendering<span class="w"> </span>MemoizedComponent
üé®<span class="w"> </span>Rendering<span class="w"> </span>MemoizedComponent
üé®<span class="w"> </span>Rendering<span class="w"> </span>MemoizedComponent
</code></pre></div>

<p><strong>DevTools clues</strong>:
- Component wrapped with <code>memo</code> in Components tab
- Props show different object/array references each render
- Reason: "Props changed"</p>
<p><strong>Root cause</strong>: Props contain new object/array references on each render</p>
<p><strong>Solution</strong>: 
- Move static data outside component
- Use <code>useMemo</code> to preserve references
- Use <code>useCallback</code> for function props (next section)</p>
<h4 id="symptom-usememo-dependencies-cause-infinite-loops">Symptom: useMemo dependencies cause infinite loops</h4>
<p><strong>Browser behavior</strong>:
Browser freezes, tab becomes unresponsive</p>
<p><strong>Console pattern</strong>:</p>
<div class="codehilite"><pre><span></span><code>üîÑ<span class="w"> </span>Calculating<span class="w"> </span>value...
üîÑ<span class="w"> </span>Calculating<span class="w"> </span>value...
üîÑ<span class="w"> </span>Calculating<span class="w"> </span>value...
<span class="o">[</span>Repeats<span class="w"> </span>infinitely<span class="o">]</span>
</code></pre></div>

<p><strong>DevTools clues</strong>:
- React DevTools shows component rendered 1000+ times
- Profiler shows continuous rendering
- Main thread blocked</p>
<p><strong>Root cause</strong>: Memoized value is used in its own dependency array, or dependency is an object that changes every render</p>
<p><strong>Solution</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// ‚ùå WRONG: Creates infinite loop</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">expensiveCalc</span><span class="p">()</span><span class="w"> </span><span class="p">};</span>
<span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">value</span><span class="p">]);</span><span class="w"> </span><span class="c1">// value depends on itself!</span>

<span class="c1">// ‚úì CORRECT: Stable dependencies</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">expensiveCalc</span><span class="p">(</span><span class="nx">input</span><span class="p">)</span><span class="w"> </span><span class="p">};</span>
<span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">input</span><span class="p">]);</span>
</code></pre></div>

<h4 id="symptom-stale-values-in-memoized-calculations">Symptom: Stale values in memoized calculations</h4>
<p><strong>Browser behavior</strong>:
UI shows outdated data, doesn't update when it should</p>
<p><strong>Console pattern</strong>:</p>
<div class="codehilite"><pre><span></span><code>üé®<span class="w"> </span>Rendering<span class="w"> </span>Component
<span class="o">[</span>No<span class="w"> </span><span class="s2">&quot;Calculating...&quot;</span><span class="w"> </span>message<span class="w"> </span>when<span class="w"> </span>expected<span class="o">]</span>
</code></pre></div>

<p><strong>DevTools clues</strong>:
- State/props show updated values
- Memoized value shows old value
- Dependency array missing required dependencies</p>
<p><strong>Root cause</strong>: Missing dependencies in <code>useMemo</code> array</p>
<p><strong>Solution</strong>: Include ALL values from component scope that the calculation uses. Enable ESLint rule <code>react-hooks/exhaustive-deps</code>.</p>
<h3 id="performance-impact-summary">Performance Impact Summary</h3>
<p><strong>Before optimization</strong>:
- Typing in search: 250ms per keystroke
- Clicking sort: 110ms
- Changing theme: 250ms</p>
<p><strong>After optimization</strong>:
- Typing in search: 130ms per keystroke (48% faster)
- Clicking sort: 10ms (91% faster)
- Changing theme: 5ms (98% faster)</p>
<p><strong>Trade-offs</strong>:
- Code complexity: Moderate increase (memoization logic)
- Memory usage: Slight increase (cached values)
- Maintenance: Must keep dependency arrays correct
- Bundle size: No change (React.memo and useMemo are built-in)</p>
<p><strong>Limitation preview</strong>: We've optimized component re-renders and expensive calculations, but we're still creating new function references on every render. When we pass functions as props to memoized components, they'll re-render unnecessarily. Let's address that next with <code>useCallback</code>.</p>
<h2 id="usecallback-probably-not-as-often-as-you-think">useCallback: probably not as often as you think</h2>
<h2 id="the-failure-memoized-components-re-render-due-to-function-props">The Failure: Memoized Components Re-render Due to Function Props</h2>
<p>Let's add interactive features to our dashboard: users can click products to view details, and delete products from the list.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/ProductDashboard.tsx (updated)</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">memo</span><span class="p">,</span><span class="w"> </span><span class="nx">useMemo</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="c1">// ... (interfaces, static data unchanged)</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">ProductListProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">products</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">onProductClick</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">productId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onProductDelete</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">productId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">ProductList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">memo</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductList</span><span class="p">({</span><span class="w"> </span>
<span class="w">  </span><span class="nx">products</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="nx">onProductClick</span><span class="p">,</span>
<span class="w">  </span><span class="nx">onProductDelete</span><span class="w"> </span>
<span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">ProductListProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering ProductList&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;product-list&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">Products</span><span class="w"> </span><span class="p">({</span><span class="nx">products</span><span class="p">.</span><span class="nx">length</span><span class="p">})&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">products</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">product</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span>
<span class="w">          </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="w"> </span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;product-card&quot;</span>
<span class="w">          </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">onProductClick</span><span class="p">(</span><span class="nx">product</span><span class="p">.</span><span class="nx">id</span><span class="p">)}</span>
<span class="w">        </span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">h4</span><span class="p">&gt;{</span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="p">}&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Category</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">category</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Sales</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">sales</span><span class="p">}</span><span class="w"> </span><span class="nx">units</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">$</span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">revenue</span><span class="p">.</span><span class="nx">toLocaleString</span><span class="p">()}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span>
<span class="w">            </span><span class="na">onClick</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nx">e</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>
<span class="w">              </span><span class="nx">onProductDelete</span><span class="p">(</span><span class="nx">product</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
<span class="w">            </span><span class="p">}}</span>
<span class="w">          </span><span class="p">&gt;</span>
<span class="w">            </span><span class="nx">Delete</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">))}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// ... (SalesChart, StatsSummary unchanged)</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductDashboard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">setCategory</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">searchTerm</span><span class="p">,</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">sortOrder</span><span class="p">,</span><span class="w"> </span><span class="nx">setSortOrder</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="o">&lt;</span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="o">&gt;</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">theme</span><span class="p">,</span><span class="w"> </span><span class="nx">setTheme</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="o">&lt;</span><span class="s1">&#39;light&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;dark&#39;</span><span class="o">&gt;</span><span class="p">(</span><span class="s1">&#39;light&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">selectedProductId</span><span class="p">,</span><span class="w"> </span><span class="nx">setSelectedProductId</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">string</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="na">null</span><span class="p">&gt;(</span><span class="kc">null</span><span class="p">);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filteredProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üîÑ Filtering products...&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">filterProducts</span><span class="p">(</span><span class="nx">ALL_PRODUCTS</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">searchTerm</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">searchTerm</span><span class="p">]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">sortedProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üîÑ Sorting products...&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[...</span><span class="nx">filteredProducts</span><span class="p">].</span><span class="nx">sort</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">revenue</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">a.revenue</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">a.revenue</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">revenue</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">filteredProducts</span><span class="p">,</span><span class="w"> </span><span class="nx">sortOrder</span><span class="p">]);</span>

<span class="w">  </span><span class="c1">// Event handlers defined inline</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleProductClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">productId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üìç Product clicked:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">productId</span><span class="p">);</span>
<span class="w">    </span><span class="nx">setSelectedProductId</span><span class="p">(</span><span class="nx">productId</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleProductDelete</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">productId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üóëÔ∏è Product deleted:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">productId</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// In real app, would call API to delete</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering ProductDashboard&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`dashboard theme-</span><span class="si">${</span><span class="nx">theme</span><span class="si">}</span><span class="sb">`</span><span class="p">}&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Product</span><span class="w"> </span><span class="nx">Analytics</span><span class="w"> </span><span class="nx">Dashboard</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;controls&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">          </span><span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Search products...&quot;</span>
<span class="w">          </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">searchTerm</span><span class="p">}</span>
<span class="w">          </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">        </span><span class="p">/&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">select</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">category</span><span class="p">}</span><span class="w"> </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setCategory</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;all&quot;</span><span class="p">&gt;</span><span class="nx">All</span><span class="w"> </span><span class="nx">Categories</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;electronics&quot;</span><span class="p">&gt;</span><span class="nx">Electronics</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;furniture&quot;</span><span class="p">&gt;</span><span class="nx">Furniture</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;appliances&quot;</span><span class="p">&gt;</span><span class="nx">Appliances</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSortOrder</span><span class="p">(</span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="nx">Sort</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;‚Üë&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;‚Üì&#39;</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setTheme</span><span class="p">(</span><span class="nx">theme</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;light&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;dark&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;light&#39;</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="nx">Theme</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">theme</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;dashboard-grid&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">ProductList</span><span class="w"> </span>
<span class="w">          </span><span class="na">products</span><span class="o">=</span><span class="p">{</span><span class="nx">sortedProducts</span><span class="p">}</span>
<span class="w">          </span><span class="na">onProductClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleProductClick</span><span class="p">}</span>
<span class="w">          </span><span class="na">onProductDelete</span><span class="o">=</span><span class="p">{</span><span class="nx">handleProductDelete</span><span class="p">}</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">SalesChart</span><span class="w"> </span><span class="na">data</span><span class="o">=</span><span class="p">{</span><span class="nx">SALES_DATA</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">StatsSummary</span><span class="w"> </span><span class="na">products</span><span class="o">=</span><span class="p">{</span><span class="nx">sortedProducts</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="nx">selectedProductId</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;product-detail&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Selected</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">selectedProductId</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">)}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>User Action</strong>: Click the theme button (which doesn't affect products at all).</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Browser Console Output:</span>

üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductDashboard
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductList
</code></pre></div>

<h3 id="diagnostic-analysis-function-references-break-memoization">Diagnostic Analysis: Function References Break Memoization</h3>
<p><strong>Browser Behavior</strong>:
- Clicking theme button causes <code>ProductList</code> to re-render
- Even though <code>products</code> array didn't change
- Performance degraded back to pre-optimization levels</p>
<p><strong>React DevTools - Components Tab</strong>:
- <code>ProductList</code> props:
  - <code>products</code>: Array(5) [same reference as before]
  - <code>onProductClick</code>: function [different reference]
  - <code>onProductDelete</code>: function [different reference]
- Reason for re-render: "Props changed"
- Specifically: <code>onProductClick</code> and <code>onProductDelete</code> changed</p>
<p><strong>React DevTools - Profiler</strong>:
- Theme button click took ~80ms (vs. 5ms before adding handlers)
- <code>ProductList</code> rendered unnecessarily
- All product cards re-rendered</p>
<p><strong>Let's parse this evidence</strong>:</p>
<ol>
<li><strong>What the user experiences</strong>:</li>
<li>Expected: Instant theme change (5ms)</li>
<li>
<p>Actual: Noticeable lag (80ms)</p>
</li>
<li>
<p><strong>What the console reveals</strong>:</p>
</li>
<li><code>ProductList</code> renders even though products didn't change</li>
<li>
<p>The memoization we added earlier is now broken</p>
</li>
<li>
<p><strong>What DevTools shows</strong>:</p>
</li>
<li><code>products</code> prop has the same reference (good)</li>
<li><code>onProductClick</code> and <code>onProductDelete</code> have different references (bad)</li>
<li>
<p>React.memo sees different function references and considers props "changed"</p>
</li>
<li>
<p><strong>Root cause identified</strong>:</p>
</li>
<li>Every render creates new function instances for <code>handleProductClick</code> and <code>handleProductDelete</code></li>
<li>Even though the function logic is identical, JavaScript creates new function objects</li>
<li>
<p><code>React.memo</code> compares by reference, sees different functions, triggers re-render</p>
</li>
<li>
<p><strong>Why the current approach can't solve this</strong>:</p>
</li>
<li>Functions defined in component body are recreated on every render</li>
<li>This is JavaScript's default behavior, not a React issue</li>
<li>
<p>We need to preserve function references across renders</p>
</li>
<li>
<p><strong>What we need</strong>:</p>
</li>
<li>A way to create a function once and reuse the same reference</li>
<li>Only create a new function when its dependencies actually change</li>
<li>This is what <code>useCallback</code> provides</li>
</ol>
<h2 id="usecallback-memoizing-function-references">useCallback: Memoizing Function References</h2>
<p><code>useCallback</code> is like <code>useMemo</code>, but specifically for functions. It tells React: "Only create a new function if dependencies change."</p>
<h3 id="how-usecallback-works">How useCallback Works</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">memoizedCallback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">(</span>
<span class="w">  </span><span class="p">(</span><span class="nx">arg</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Function logic</span>
<span class="w">    </span><span class="nx">doSomething</span><span class="p">(</span><span class="nx">arg</span><span class="p">,</span><span class="w"> </span><span class="nx">dependency</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="p">[</span><span class="nx">dependency</span><span class="p">]</span>
<span class="p">);</span>
</code></pre></div>

<p>React will:
1. Create the function on first render
2. Cache the function reference
3. On subsequent renders, check if dependencies changed
4. If dependencies unchanged, return the same function reference
5. If dependencies changed, create a new function and cache it</p>
<h3 id="usecallback-vs-usememo-for-functions">useCallback vs. useMemo for Functions</h3>
<p>These are equivalent:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Using useCallback</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">handleClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;clicked&#39;</span><span class="p">);</span>
<span class="p">},</span><span class="w"> </span><span class="p">[]);</span>

<span class="c1">// Using useMemo (more verbose)</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">handleClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;clicked&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">},</span><span class="w"> </span><span class="p">[]);</span>
</code></pre></div>

<p><code>useCallback</code> is syntactic sugar for <code>useMemo</code> that returns a function.</p>
<h3 id="iteration-1-memoizing-event-handlers">Iteration 1: Memoizing Event Handlers</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/ProductDashboard.tsx (updated)</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">memo</span><span class="p">,</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">,</span><span class="w"> </span><span class="nx">useCallback</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="c1">// ... (interfaces, static data, child components unchanged)</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductDashboard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">setCategory</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">searchTerm</span><span class="p">,</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">sortOrder</span><span class="p">,</span><span class="w"> </span><span class="nx">setSortOrder</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="o">&lt;</span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="o">&gt;</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">theme</span><span class="p">,</span><span class="w"> </span><span class="nx">setTheme</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="o">&lt;</span><span class="s1">&#39;light&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;dark&#39;</span><span class="o">&gt;</span><span class="p">(</span><span class="s1">&#39;light&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">selectedProductId</span><span class="p">,</span><span class="w"> </span><span class="nx">setSelectedProductId</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">string</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="na">null</span><span class="p">&gt;(</span><span class="kc">null</span><span class="p">);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filteredProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üîÑ Filtering products...&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">filterProducts</span><span class="p">(</span><span class="nx">ALL_PRODUCTS</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">searchTerm</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">searchTerm</span><span class="p">]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">sortedProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üîÑ Sorting products...&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[...</span><span class="nx">filteredProducts</span><span class="p">].</span><span class="nx">sort</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">revenue</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">a.revenue</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">a.revenue</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">revenue</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">filteredProducts</span><span class="p">,</span><span class="w"> </span><span class="nx">sortOrder</span><span class="p">]);</span>

<span class="w">  </span><span class="c1">// Memoize event handlers</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleProductClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">((</span><span class="nx">productId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üìç Product clicked:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">productId</span><span class="p">);</span>
<span class="w">    </span><span class="nx">setSelectedProductId</span><span class="p">(</span><span class="nx">productId</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span><span class="w"> </span><span class="c1">// No dependencies - function logic doesn&#39;t depend on any props/state</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleProductDelete</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">((</span><span class="nx">productId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üóëÔ∏è Product deleted:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">productId</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// In real app, would call API to delete</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span><span class="w"> </span><span class="c1">// No dependencies</span>

<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering ProductDashboard&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`dashboard theme-</span><span class="si">${</span><span class="nx">theme</span><span class="si">}</span><span class="sb">`</span><span class="p">}&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Product</span><span class="w"> </span><span class="nx">Analytics</span><span class="w"> </span><span class="nx">Dashboard</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;controls&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">          </span><span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Search products...&quot;</span>
<span class="w">          </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">searchTerm</span><span class="p">}</span>
<span class="w">          </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">        </span><span class="p">/&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">select</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">category</span><span class="p">}</span><span class="w"> </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setCategory</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;all&quot;</span><span class="p">&gt;</span><span class="nx">All</span><span class="w"> </span><span class="nx">Categories</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;electronics&quot;</span><span class="p">&gt;</span><span class="nx">Electronics</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;furniture&quot;</span><span class="p">&gt;</span><span class="nx">Furniture</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;appliances&quot;</span><span class="p">&gt;</span><span class="nx">Appliances</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSortOrder</span><span class="p">(</span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="nx">Sort</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;‚Üë&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;‚Üì&#39;</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setTheme</span><span class="p">(</span><span class="nx">theme</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;light&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;dark&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;light&#39;</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="nx">Theme</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">theme</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;dashboard-grid&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">ProductList</span><span class="w"> </span>
<span class="w">          </span><span class="na">products</span><span class="o">=</span><span class="p">{</span><span class="nx">sortedProducts</span><span class="p">}</span>
<span class="w">          </span><span class="na">onProductClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleProductClick</span><span class="p">}</span>
<span class="w">          </span><span class="na">onProductDelete</span><span class="o">=</span><span class="p">{</span><span class="nx">handleProductDelete</span><span class="p">}</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">SalesChart</span><span class="w"> </span><span class="na">data</span><span class="o">=</span><span class="p">{</span><span class="nx">SALES_DATA</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">StatsSummary</span><span class="w"> </span><span class="na">products</span><span class="o">=</span><span class="p">{</span><span class="nx">sortedProducts</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="nx">selectedProductId</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;product-detail&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Selected</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">selectedProductId</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">)}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>User Action</strong>: Click the theme button.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Browser Console Output:</span>

üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductDashboard
</code></pre></div>

<p><strong>Expected vs. Actual Improvement</strong>:
- Parent re-renders (expected - state changed)
- <code>ProductList</code> does NOT re-render (expected - props unchanged)
- Performance: ~5ms (back to optimized level)</p>
<p><strong>React DevTools - Components Tab</strong>:
- <code>ProductList</code> props:
  - <code>products</code>: Array(5) [same reference]
  - <code>onProductClick</code>: function [same reference]
  - <code>onProductDelete</code>: function [same reference]
- Result: "Did not render"</p>
<p><strong>React DevTools - Profiler</strong>:
- Theme button click: 5ms (vs. 80ms before useCallback)
- <code>ProductList</code> shows "Did not render"
- Improvement: 94% faster</p>
<h3 id="the-failure-usecallback-with-stale-closures">The Failure: useCallback with Stale Closures</h3>
<p>Let's add a feature: when deleting a product, show a confirmation with the product name.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/ProductDashboard.tsx (updated)</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductDashboard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">setCategory</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">searchTerm</span><span class="p">,</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">sortOrder</span><span class="p">,</span><span class="w"> </span><span class="nx">setSortOrder</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="o">&lt;</span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="o">&gt;</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">theme</span><span class="p">,</span><span class="w"> </span><span class="nx">setTheme</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="o">&lt;</span><span class="s1">&#39;light&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;dark&#39;</span><span class="o">&gt;</span><span class="p">(</span><span class="s1">&#39;light&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">selectedProductId</span><span class="p">,</span><span class="w"> </span><span class="nx">setSelectedProductId</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">string</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="na">null</span><span class="p">&gt;(</span><span class="kc">null</span><span class="p">);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filteredProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üîÑ Filtering products...&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">filterProducts</span><span class="p">(</span><span class="nx">ALL_PRODUCTS</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">searchTerm</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">searchTerm</span><span class="p">]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">sortedProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üîÑ Sorting products...&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[...</span><span class="nx">filteredProducts</span><span class="p">].</span><span class="nx">sort</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">revenue</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">a.revenue</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">a.revenue</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">revenue</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">filteredProducts</span><span class="p">,</span><span class="w"> </span><span class="nx">sortOrder</span><span class="p">]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleProductClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">((</span><span class="nx">productId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üìç Product clicked:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">productId</span><span class="p">);</span>
<span class="w">    </span><span class="nx">setSelectedProductId</span><span class="p">(</span><span class="nx">productId</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">  </span><span class="c1">// ‚ùå WRONG: Missing dependency</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleProductDelete</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">((</span><span class="nx">productId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">sortedProducts</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">p</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">productId</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">product</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">confirm</span><span class="p">(</span><span class="sb">`Delete </span><span class="si">${</span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">?`</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üóëÔ∏è Product deleted:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">productId</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span><span class="w"> </span><span class="c1">// Missing sortedProducts dependency!</span>

<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering ProductDashboard&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`dashboard theme-</span><span class="si">${</span><span class="nx">theme</span><span class="si">}</span><span class="sb">`</span><span class="p">}&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Product</span><span class="w"> </span><span class="nx">Analytics</span><span class="w"> </span><span class="nx">Dashboard</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;controls&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">          </span><span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Search products...&quot;</span>
<span class="w">          </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">searchTerm</span><span class="p">}</span>
<span class="w">          </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">        </span><span class="p">/&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">select</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">category</span><span class="p">}</span><span class="w"> </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setCategory</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;all&quot;</span><span class="p">&gt;</span><span class="nx">All</span><span class="w"> </span><span class="nx">Categories</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;electronics&quot;</span><span class="p">&gt;</span><span class="nx">Electronics</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;furniture&quot;</span><span class="p">&gt;</span><span class="nx">Furniture</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;appliances&quot;</span><span class="p">&gt;</span><span class="nx">Appliances</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSortOrder</span><span class="p">(</span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="nx">Sort</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;‚Üë&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;‚Üì&#39;</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setTheme</span><span class="p">(</span><span class="nx">theme</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;light&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;dark&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;light&#39;</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="nx">Theme</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">theme</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;dashboard-grid&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">ProductList</span><span class="w"> </span>
<span class="w">          </span><span class="na">products</span><span class="o">=</span><span class="p">{</span><span class="nx">sortedProducts</span><span class="p">}</span>
<span class="w">          </span><span class="na">onProductClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleProductClick</span><span class="p">}</span>
<span class="w">          </span><span class="na">onProductDelete</span><span class="o">=</span><span class="p">{</span><span class="nx">handleProductDelete</span><span class="p">}</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">SalesChart</span><span class="w"> </span><span class="na">data</span><span class="o">=</span><span class="p">{</span><span class="nx">SALES_DATA</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">StatsSummary</span><span class="w"> </span><span class="na">products</span><span class="o">=</span><span class="p">{</span><span class="nx">sortedProducts</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="nx">selectedProductId</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;product-detail&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Selected</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">selectedProductId</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">)}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>User Action</strong>: 
1. Load the dashboard (shows all products)
2. Type "Laptop" in search (filters to one product)
3. Click delete on the Laptop product</p>
<p><strong>Browser Behavior</strong>:
- Confirmation dialog shows: "Delete undefined?"
- Product name is missing from the confirmation</p>
<p><strong>Browser Console</strong>:</p>
<div class="codehilite"><pre><span></span><code>üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductDashboard
üîÑ<span class="w"> </span>Filtering<span class="w"> </span>products...
üîÑ<span class="w"> </span>Sorting<span class="w"> </span>products...

<span class="o">[</span>User<span class="w"> </span>types<span class="w"> </span><span class="s2">&quot;Laptop&quot;</span><span class="o">]</span>
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductDashboard
üîÑ<span class="w"> </span>Filtering<span class="w"> </span>products...
üîÑ<span class="w"> </span>Sorting<span class="w"> </span>products...

<span class="o">[</span>User<span class="w"> </span>clicks<span class="w"> </span>delete<span class="o">]</span>
üóëÔ∏è<span class="w"> </span>Product<span class="w"> </span>deleted:<span class="w"> </span><span class="m">1</span>
</code></pre></div>

<h3 id="diagnostic-analysis-stale-closure-in-usecallback">Diagnostic Analysis: Stale Closure in useCallback</h3>
<p><strong>React DevTools - Components Tab</strong>:
- <code>handleProductDelete</code> function created on first render
- At that time, <code>sortedProducts</code> contained all 5 products
- Function "closed over" that initial array
- When user filters to "Laptop", <code>sortedProducts</code> changes
- But <code>handleProductDelete</code> still references the old array (empty dependency array)
- When function runs, it searches the old array, finds nothing</p>
<p><strong>The Problem</strong>: This is the classic "stale closure" issue. The function captured <code>sortedProducts</code> from the first render and never updated.</p>
<p><strong>Why it happens</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// First render: sortedProducts = [all 5 products]</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">handleProductDelete</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">((</span><span class="nx">productId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">sortedProducts</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">p</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">productId</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// sortedProducts here refers to the array from first render</span>
<span class="p">},</span><span class="w"> </span><span class="p">[]);</span><span class="w"> </span><span class="c1">// Empty array means &quot;never recreate this function&quot;</span>

<span class="c1">// Second render: sortedProducts = [only Laptop]</span>
<span class="c1">// But handleProductDelete still uses the old sortedProducts!</span>
</code></pre></div>

<h3 id="iteration-2-fixing-the-stale-closure">Iteration 2: Fixing the Stale Closure</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/ProductDashboard.tsx (updated)</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductDashboard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">setCategory</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">searchTerm</span><span class="p">,</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">sortOrder</span><span class="p">,</span><span class="w"> </span><span class="nx">setSortOrder</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="o">&lt;</span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="o">&gt;</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">theme</span><span class="p">,</span><span class="w"> </span><span class="nx">setTheme</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="o">&lt;</span><span class="s1">&#39;light&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;dark&#39;</span><span class="o">&gt;</span><span class="p">(</span><span class="s1">&#39;light&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">selectedProductId</span><span class="p">,</span><span class="w"> </span><span class="nx">setSelectedProductId</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">string</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="na">null</span><span class="p">&gt;(</span><span class="kc">null</span><span class="p">);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filteredProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üîÑ Filtering products...&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">filterProducts</span><span class="p">(</span><span class="nx">ALL_PRODUCTS</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">searchTerm</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">searchTerm</span><span class="p">]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">sortedProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üîÑ Sorting products...&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[...</span><span class="nx">filteredProducts</span><span class="p">].</span><span class="nx">sort</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">revenue</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">a.revenue</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">a.revenue</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">revenue</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">filteredProducts</span><span class="p">,</span><span class="w"> </span><span class="nx">sortOrder</span><span class="p">]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleProductClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">((</span><span class="nx">productId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üìç Product clicked:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">productId</span><span class="p">);</span>
<span class="w">    </span><span class="nx">setSelectedProductId</span><span class="p">(</span><span class="nx">productId</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">  </span><span class="c1">// ‚úì CORRECT: Include sortedProducts in dependencies</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleProductDelete</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">((</span><span class="nx">productId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">sortedProducts</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">p</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">productId</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">product</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">confirm</span><span class="p">(</span><span class="sb">`Delete </span><span class="si">${</span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">?`</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üóëÔ∏è Product deleted:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">productId</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">sortedProducts</span><span class="p">]);</span><span class="w"> </span><span class="c1">// Now function updates when sortedProducts changes</span>

<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering ProductDashboard&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`dashboard theme-</span><span class="si">${</span><span class="nx">theme</span><span class="si">}</span><span class="sb">`</span><span class="p">}&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Product</span><span class="w"> </span><span class="nx">Analytics</span><span class="w"> </span><span class="nx">Dashboard</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;controls&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">          </span><span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Search products...&quot;</span>
<span class="w">          </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">searchTerm</span><span class="p">}</span>
<span class="w">          </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">        </span><span class="p">/&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">select</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">category</span><span class="p">}</span><span class="w"> </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setCategory</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;all&quot;</span><span class="p">&gt;</span><span class="nx">All</span><span class="w"> </span><span class="nx">Categories</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;electronics&quot;</span><span class="p">&gt;</span><span class="nx">Electronics</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;furniture&quot;</span><span class="p">&gt;</span><span class="nx">Furniture</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;appliances&quot;</span><span class="p">&gt;</span><span class="nx">Appliances</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSortOrder</span><span class="p">(</span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="nx">Sort</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;‚Üë&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;‚Üì&#39;</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setTheme</span><span class="p">(</span><span class="nx">theme</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;light&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;dark&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;light&#39;</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="nx">Theme</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">theme</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;dashboard-grid&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">ProductList</span><span class="w"> </span>
<span class="w">          </span><span class="na">products</span><span class="o">=</span><span class="p">{</span><span class="nx">sortedProducts</span><span class="p">}</span>
<span class="w">          </span><span class="na">onProductClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleProductClick</span><span class="p">}</span>
<span class="w">          </span><span class="na">onProductDelete</span><span class="o">=</span><span class="p">{</span><span class="nx">handleProductDelete</span><span class="p">}</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">SalesChart</span><span class="w"> </span><span class="na">data</span><span class="o">=</span><span class="p">{</span><span class="nx">SALES_DATA</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">StatsSummary</span><span class="w"> </span><span class="na">products</span><span class="o">=</span><span class="p">{</span><span class="nx">sortedProducts</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="nx">selectedProductId</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;product-detail&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Selected</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">selectedProductId</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">)}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>User Action</strong>: Same as before - filter to "Laptop", then click delete.</p>
<p><strong>Browser Behavior</strong>:
- Confirmation dialog shows: "Delete Laptop Pro?"
- Product name appears correctly</p>
<p><strong>But wait...</strong> Now we have a new problem!</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Browser Console Output (typing &quot;Laptop&quot;):</span>

üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductDashboard
üîÑ<span class="w"> </span>Filtering<span class="w"> </span>products...
üîÑ<span class="w"> </span>Sorting<span class="w"> </span>products...
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductList

üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductDashboard
üîÑ<span class="w"> </span>Filtering<span class="w"> </span>products...
üîÑ<span class="w"> </span>Sorting<span class="w"> </span>products...
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductList
</code></pre></div>

<h3 id="the-trade-off-correctness-vs-performance">The Trade-off: Correctness vs. Performance</h3>
<p><strong>React DevTools - Profiler</strong>:
- Typing in search: Each keystroke causes <code>ProductList</code> to re-render
- Reason: <code>handleProductDelete</code> gets a new reference when <code>sortedProducts</code> changes
- Performance: Back to ~130ms per keystroke</p>
<p><strong>The Dilemma</strong>:
- Without <code>sortedProducts</code> in dependencies: Function has stale data (bug)
- With <code>sortedProducts</code> in dependencies: Function recreates on every filter/sort, breaking memoization</p>
<p><strong>This is the fundamental trade-off with useCallback</strong>: You must choose between correctness and performance. Correctness always wins.</p>
<h3 id="when-usecallback-actually-helps">When useCallback Actually Helps</h3>
<p><code>useCallback</code> is only beneficial when:
1. The function is passed to a memoized child component
2. The function's dependencies are stable (don't change often)
3. The child component is expensive to render</p>
<p>In our case:
- ‚úì Function passed to memoized <code>ProductList</code>
- ‚úó Dependencies change frequently (<code>sortedProducts</code> changes on every filter/sort)
- ‚úì <code>ProductList</code> is moderately expensive</p>
<p><strong>Result</strong>: <code>useCallback</code> helps for theme changes, but not for filter/sort operations.</p>
<h3 id="iteration-3-optimizing-with-stable-references">Iteration 3: Optimizing with Stable References</h3>
<p>One solution: Pass the product ID only, and let the child component handle the lookup.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/ProductDashboard.tsx (updated)</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">memo</span><span class="p">,</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">,</span><span class="w"> </span><span class="nx">useCallback</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="c1">// ... (interfaces, static data unchanged)</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">ProductListProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">products</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">onProductClick</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">productId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onProductDelete</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">productId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">productName</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span><span class="w"> </span><span class="c1">// ‚Üê Changed</span>
<span class="p">}</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">ProductList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">memo</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductList</span><span class="p">({</span><span class="w"> </span>
<span class="w">  </span><span class="nx">products</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="nx">onProductClick</span><span class="p">,</span>
<span class="w">  </span><span class="nx">onProductDelete</span><span class="w"> </span>
<span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">ProductListProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering ProductList&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;product-list&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">Products</span><span class="w"> </span><span class="p">({</span><span class="nx">products</span><span class="p">.</span><span class="nx">length</span><span class="p">})&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">products</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">product</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span>
<span class="w">          </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="w"> </span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;product-card&quot;</span>
<span class="w">          </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">onProductClick</span><span class="p">(</span><span class="nx">product</span><span class="p">.</span><span class="nx">id</span><span class="p">)}</span>
<span class="w">        </span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">h4</span><span class="p">&gt;{</span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="p">}&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Category</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">category</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Sales</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">sales</span><span class="p">}</span><span class="w"> </span><span class="nx">units</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">$</span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">revenue</span><span class="p">.</span><span class="nx">toLocaleString</span><span class="p">()}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span>
<span class="w">            </span><span class="na">onClick</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nx">e</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>
<span class="w">              </span><span class="nx">onProductDelete</span><span class="p">(</span><span class="nx">product</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span><span class="w"> </span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span><span class="w"> </span><span class="c1">// ‚Üê Pass name directly</span>
<span class="w">            </span><span class="p">}}</span>
<span class="w">          </span><span class="p">&gt;</span>
<span class="w">            </span><span class="nx">Delete</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">))}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// ... (SalesChart, StatsSummary unchanged)</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductDashboard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">setCategory</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">searchTerm</span><span class="p">,</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">sortOrder</span><span class="p">,</span><span class="w"> </span><span class="nx">setSortOrder</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="o">&lt;</span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="o">&gt;</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">theme</span><span class="p">,</span><span class="w"> </span><span class="nx">setTheme</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="o">&lt;</span><span class="s1">&#39;light&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;dark&#39;</span><span class="o">&gt;</span><span class="p">(</span><span class="s1">&#39;light&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">selectedProductId</span><span class="p">,</span><span class="w"> </span><span class="nx">setSelectedProductId</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">string</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="na">null</span><span class="p">&gt;(</span><span class="kc">null</span><span class="p">);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filteredProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üîÑ Filtering products...&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">filterProducts</span><span class="p">(</span><span class="nx">ALL_PRODUCTS</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">searchTerm</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">category</span><span class="p">,</span><span class="w"> </span><span class="nx">searchTerm</span><span class="p">]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">sortedProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üîÑ Sorting products...&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[...</span><span class="nx">filteredProducts</span><span class="p">].</span><span class="nx">sort</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">revenue</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">a.revenue</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">a.revenue</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">revenue</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">filteredProducts</span><span class="p">,</span><span class="w"> </span><span class="nx">sortOrder</span><span class="p">]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleProductClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">((</span><span class="nx">productId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üìç Product clicked:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">productId</span><span class="p">);</span>
<span class="w">    </span><span class="nx">setSelectedProductId</span><span class="p">(</span><span class="nx">productId</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">  </span><span class="c1">// Now function doesn&#39;t depend on sortedProducts</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleProductDelete</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">((</span><span class="nx">productId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">productName</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">confirm</span><span class="p">(</span><span class="sb">`Delete </span><span class="si">${</span><span class="nx">productName</span><span class="si">}</span><span class="sb">?`</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üóëÔ∏è Product deleted:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">productId</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span><span class="w"> </span><span class="c1">// No dependencies - stable reference</span>

<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering ProductDashboard&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`dashboard theme-</span><span class="si">${</span><span class="nx">theme</span><span class="si">}</span><span class="sb">`</span><span class="p">}&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Product</span><span class="w"> </span><span class="nx">Analytics</span><span class="w"> </span><span class="nx">Dashboard</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;controls&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">          </span><span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Search products...&quot;</span>
<span class="w">          </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">searchTerm</span><span class="p">}</span>
<span class="w">          </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">        </span><span class="p">/&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">select</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">category</span><span class="p">}</span><span class="w"> </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setCategory</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;all&quot;</span><span class="p">&gt;</span><span class="nx">All</span><span class="w"> </span><span class="nx">Categories</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;electronics&quot;</span><span class="p">&gt;</span><span class="nx">Electronics</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;furniture&quot;</span><span class="p">&gt;</span><span class="nx">Furniture</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;appliances&quot;</span><span class="p">&gt;</span><span class="nx">Appliances</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSortOrder</span><span class="p">(</span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;desc&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="nx">Sort</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">sortOrder</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;asc&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;‚Üë&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;‚Üì&#39;</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setTheme</span><span class="p">(</span><span class="nx">theme</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;light&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;dark&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;light&#39;</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="nx">Theme</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">theme</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;dashboard-grid&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">ProductList</span><span class="w"> </span>
<span class="w">          </span><span class="na">products</span><span class="o">=</span><span class="p">{</span><span class="nx">sortedProducts</span><span class="p">}</span>
<span class="w">          </span><span class="na">onProductClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleProductClick</span><span class="p">}</span>
<span class="w">          </span><span class="na">onProductDelete</span><span class="o">=</span><span class="p">{</span><span class="nx">handleProductDelete</span><span class="p">}</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">SalesChart</span><span class="w"> </span><span class="na">data</span><span class="o">=</span><span class="p">{</span><span class="nx">SALES_DATA</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">StatsSummary</span><span class="w"> </span><span class="na">products</span><span class="o">=</span><span class="p">{</span><span class="nx">sortedProducts</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="nx">selectedProductId</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;product-detail&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Selected</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">selectedProductId</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">)}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>User Action</strong>: Click theme button.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Browser Console Output:</span>

üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductDashboard
</code></pre></div>

<p><strong>Expected vs. Actual Improvement</strong>:
- Theme change: 5ms (ProductList doesn't re-render)
- Filter/sort: ProductList re-renders (expected - products changed)
- Delete confirmation: Shows correct product name
- No stale closure issues</p>
<p><strong>This is the pattern</strong>: When possible, design your component APIs to avoid dependencies in callbacks.</p>
<h2 id="when-not-to-use-usecallback">When NOT to Use useCallback</h2>
<h3 id="anti-pattern-1-wrapping-every-function">Anti-pattern 1: Wrapping Every Function</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// ‚ùå WRONG: Unnecessary useCallback</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">MyComponent</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;clicked&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">  </span><span class="c1">// This button is not in a memoized child component</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleClick</span><span class="p">}&gt;</span><span class="nx">Click</span><span class="w"> </span><span class="nx">me</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;;</span>
<span class="p">}</span>

<span class="c1">// ‚úì CORRECT: No useCallback needed</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">MyComponent</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;clicked&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleClick</span><span class="p">}&gt;</span><span class="nx">Click</span><span class="w"> </span><span class="nx">me</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;;</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Why</strong>: Creating a new function on each render is cheap. <code>useCallback</code> adds overhead (dependency comparison, cache lookup). Only use it when passing to memoized children.</p>
<h3 id="anti-pattern-2-usecallback-with-unstable-dependencies">Anti-pattern 2: useCallback with Unstable Dependencies</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// ‚ùå WRONG: Dependencies change every render anyway</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">MyComponent</span><span class="p">({</span><span class="w"> </span><span class="nx">items</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">items</span><span class="o">:</span><span class="w"> </span><span class="kt">Item</span><span class="p">[]</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">items</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">items</span><span class="p">]);</span><span class="w"> </span><span class="c1">// items is a new array every render</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">MemoizedChild</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleClick</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;;</span>
<span class="p">}</span>

<span class="c1">// ‚úì BETTER: Accept that memoization won&#39;t help here</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">MyComponent</span><span class="p">({</span><span class="w"> </span><span class="nx">items</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">items</span><span class="o">:</span><span class="w"> </span><span class="kt">Item</span><span class="p">[]</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">items</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">MemoizedChild</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleClick</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;;</span>
<span class="p">}</span>

<span class="c1">// ‚úì BEST: If items is expensive to render, memoize items instead</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">MyComponent</span><span class="p">({</span><span class="w"> </span><span class="nx">items</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">items</span><span class="o">:</span><span class="w"> </span><span class="kt">Item</span><span class="p">[]</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">memoizedItems</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">items</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="nx">items</span><span class="p">]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">memoizedItems</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">memoizedItems</span><span class="p">]);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">MemoizedChild</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleClick</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;;</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="anti-pattern-3-premature-optimization">Anti-pattern 3: Premature Optimization</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// ‚ùå WRONG: Optimizing before measuring</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">MyComponent</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;clicked&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleChange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">((</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleSubmit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;submitted&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">  </span><span class="c1">// None of these are passed to memoized children!</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">form</span><span class="w"> </span><span class="na">onSubmit</span><span class="o">=</span><span class="p">{</span><span class="nx">handleSubmit</span><span class="p">}&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">input</span><span class="w"> </span><span class="na">onChange</span><span class="o">=</span><span class="p">{</span><span class="nx">handleChange</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleClick</span><span class="p">}&gt;</span><span class="nx">Submit</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// ‚úì CORRECT: No optimization until proven necessary</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">MyComponent</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;clicked&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleChange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleSubmit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;submitted&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">form</span><span class="w"> </span><span class="na">onSubmit</span><span class="o">=</span><span class="p">{</span><span class="nx">handleSubmit</span><span class="p">}&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">input</span><span class="w"> </span><span class="na">onChange</span><span class="o">=</span><span class="p">{</span><span class="nx">handleChange</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleClick</span><span class="p">}&gt;</span><span class="nx">Submit</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="when-to-apply-usecallback">When to Apply useCallback</h3>
<p><strong>Use when</strong>:
- Function is passed as a prop to a <code>React.memo</code> component
- Function is used in a dependency array of another hook
- Function is expensive to create (rare)
- You've measured and confirmed it's a bottleneck</p>
<p><strong>Don't use when</strong>:
- Function is only used in JSX event handlers
- Function dependencies change frequently anyway
- Component is not memoized
- You're "just being safe" without measuring</p>
<h3 id="common-failure-modes-and-their-signatures_1">Common Failure Modes and Their Signatures</h3>
<h4 id="symptom-usecallback-doesnt-prevent-re-renders">Symptom: useCallback doesn't prevent re-renders</h4>
<p><strong>Browser behavior</strong>:
Memoized child component still re-renders when parent renders</p>
<p><strong>Console pattern</strong>:</p>
<div class="codehilite"><pre><span></span><code>üé®<span class="w"> </span>Rendering<span class="w"> </span>Parent
üé®<span class="w"> </span>Rendering<span class="w"> </span>MemoizedChild
üé®<span class="w"> </span>Rendering<span class="w"> </span>Parent
üé®<span class="w"> </span>Rendering<span class="w"> </span>MemoizedChild
</code></pre></div>

<p><strong>DevTools clues</strong>:
- Child component wrapped with <code>memo</code>
- Function prop wrapped with <code>useCallback</code>
- But child still re-renders
- Reason: "Props changed"</p>
<p><strong>Root cause</strong>: Function dependencies change frequently, creating new function references</p>
<p><strong>Solution</strong>: 
- Redesign component API to avoid dependencies
- Accept that memoization won't help in this case
- Consider if the child component is actually expensive enough to warrant optimization</p>
<h4 id="symptom-stale-values-in-callback">Symptom: Stale values in callback</h4>
<p><strong>Browser behavior</strong>:
Function uses outdated state/props values</p>
<p><strong>Console pattern</strong>:</p>
<div class="codehilite"><pre><span></span><code>üìç<span class="w"> </span>Expected<span class="w"> </span>value:<span class="w"> </span><span class="m">5</span>
üìç<span class="w"> </span>Actual<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>
</code></pre></div>

<p><strong>DevTools clues</strong>:
- State/props show current values
- Function behavior uses old values
- Empty or incomplete dependency array</p>
<p><strong>Root cause</strong>: Missing dependencies in <code>useCallback</code> array</p>
<p><strong>Solution</strong>: Include ALL values from component scope that the function uses. Enable ESLint rule <code>react-hooks/exhaustive-deps</code>.</p>
<h4 id="symptom-infinite-loop-with-usecallback">Symptom: Infinite loop with useCallback</h4>
<p><strong>Browser behavior</strong>:
Browser freezes, tab becomes unresponsive</p>
<p><strong>Console pattern</strong>:</p>
<div class="codehilite"><pre><span></span><code>üé®<span class="w"> </span>Rendering<span class="w"> </span>Component
üé®<span class="w"> </span>Rendering<span class="w"> </span>Component
üé®<span class="w"> </span>Rendering<span class="w"> </span>Component
<span class="o">[</span>Repeats<span class="w"> </span>infinitely<span class="o">]</span>
</code></pre></div>

<p><strong>DevTools clues</strong>:
- Component rendered 1000+ times
- Profiler shows continuous rendering
- Callback in dependency array of useEffect</p>
<p><strong>Root cause</strong>: Callback recreates on every render, triggering effect, which updates state, causing re-render</p>
<p><strong>Solution</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// ‚ùå WRONG: Creates infinite loop</span>
<span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">callback</span><span class="p">();</span>
<span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">callback</span><span class="p">]);</span><span class="w"> </span><span class="c1">// callback recreates every render</span>

<span class="c1">// ‚úì CORRECT: Stable callback</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">callback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// logic</span>
<span class="p">},</span><span class="w"> </span><span class="p">[]);</span><span class="w"> </span><span class="c1">// Empty dependencies if possible</span>

<span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">callback</span><span class="p">();</span>
<span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">callback</span><span class="p">]);</span>
</code></pre></div>

<h3 id="performance-impact-summary_1">Performance Impact Summary</h3>
<p><strong>useCallback benefits</strong>:
- Prevents re-renders of memoized children when function props don't change
- Enables stable references for hook dependencies
- Minimal memory overhead (one cached function reference)</p>
<p><strong>useCallback costs</strong>:
- Code complexity (dependency arrays to maintain)
- Slight performance overhead (dependency comparison on each render)
- Risk of stale closures if dependencies incorrect</p>
<p><strong>When it matters</strong>:
- Large lists with memoized items
- Expensive child components
- Functions passed through multiple component layers</p>
<p><strong>When it doesn't matter</strong>:
- Simple event handlers
- Functions not passed to memoized components
- Functions with frequently changing dependencies</p>
<p><strong>Limitation preview</strong>: We've optimized component re-renders and function references, but our entire application bundle loads upfront. Users download code for features they might never use. Let's address that with code splitting.</p>
<h2 id="code-splitting-strategies">Code splitting strategies</h2>
<h2 id="the-failure-everything-loads-upfront">The Failure: Everything Loads Upfront</h2>
<p>Our dashboard has grown. We've added:
- A complex data visualization library (Recharts)
- A rich text editor for product descriptions
- A PDF export feature
- An admin panel for advanced settings</p>
<p>Most users never use these features, but they download all the code anyway.</p>
<p>Let's measure the impact.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Build the application</span>
npm<span class="w"> </span>run<span class="w"> </span>build

<span class="c1"># Output:</span>
dist/assets/index-a1b2c3d4.js<span class="w">    </span><span class="m">847</span>.23<span class="w"> </span>kB<span class="w"> </span>‚îÇ<span class="w"> </span>gzip:<span class="w"> </span><span class="m">284</span>.15<span class="w"> </span>kB
dist/assets/vendor-e5f6g7h8.js<span class="w">   </span><span class="m">1</span>,234.56<span class="w"> </span>kB<span class="w"> </span>‚îÇ<span class="w"> </span>gzip:<span class="w"> </span><span class="m">412</span>.34<span class="w"> </span>kB

Total<span class="w"> </span>bundle<span class="w"> </span>size:<span class="w"> </span><span class="m">2</span>,081.79<span class="w"> </span>kB<span class="w"> </span><span class="o">(</span><span class="m">696</span>.49<span class="w"> </span>kB<span class="w"> </span>gzipped<span class="o">)</span>
</code></pre></div>

<h3 id="diagnostic-analysis-bundle-size-impact">Diagnostic Analysis: Bundle Size Impact</h3>
<p><strong>Network Tab</strong>:
- Initial page load downloads 2.08 MB of JavaScript
- On 3G connection: ~8 seconds to download
- On 4G connection: ~2 seconds to download
- Parse and execute time: ~1.5 seconds on mid-range device</p>
<p><strong>Lighthouse Report</strong>:
- Performance score: 62/100
- Time to Interactive (TTI): 4.2s
- Total Blocking Time (TBT): 890ms
- First Contentful Paint (FCP): 1.8s</p>
<p><strong>Bundle Analyzer</strong> (using <code>rollup-plugin-visualizer</code>):</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Install bundle analyzer</span>
npm<span class="w"> </span>install<span class="w"> </span>--save-dev<span class="w"> </span>rollup-plugin-visualizer

<span class="c1"># Add to vite.config.ts</span>
import<span class="w"> </span><span class="o">{</span><span class="w"> </span>visualizer<span class="w"> </span><span class="o">}</span><span class="w"> </span>from<span class="w"> </span><span class="s1">&#39;rollup-plugin-visualizer&#39;</span><span class="p">;</span>

<span class="nb">export</span><span class="w"> </span>default<span class="w"> </span>defineConfig<span class="o">({</span>
<span class="w">  </span>plugins:<span class="w"> </span><span class="o">[</span>
<span class="w">    </span>react<span class="o">()</span>,
<span class="w">    </span>visualizer<span class="o">({</span><span class="w"> </span>open:<span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="o">})</span>
<span class="w">  </span><span class="o">]</span>
<span class="o">})</span><span class="p">;</span>

<span class="c1"># Build and analyze</span>
npm<span class="w"> </span>run<span class="w"> </span>build
</code></pre></div>

<p><strong>Bundle Analyzer Output</strong>:
- <code>recharts</code>: 412 kB (20% of bundle)
- <code>react-quill</code> (rich text editor): 287 kB (14% of bundle)
- <code>jspdf</code> (PDF export): 198 kB (10% of bundle)
- Admin panel components: 156 kB (8% of bundle)
- Core dashboard: 1,028 kB (48% of bundle)</p>
<p><strong>Let's parse this evidence</strong>:</p>
<ol>
<li><strong>What the user experiences</strong>:</li>
<li>Expected: Fast initial load</li>
<li>
<p>Actual: 4+ second wait before interactive</p>
</li>
<li>
<p><strong>What the metrics reveal</strong>:</p>
</li>
<li>52% of the bundle is features most users never use</li>
<li>Users pay the cost (download, parse, execute) upfront</li>
<li>
<p>Mobile users on slow connections suffer most</p>
</li>
<li>
<p><strong>What the bundle analyzer shows</strong>:</p>
</li>
<li>Large third-party libraries loaded immediately</li>
<li>Admin features loaded for all users (even non-admins)</li>
<li>
<p>Visualization library loaded even if user never views charts</p>
</li>
<li>
<p><strong>Root cause identified</strong>:</p>
</li>
<li>All imports are static (<code>import X from 'y'</code>)</li>
<li>Webpack/Vite bundles everything into initial chunk</li>
<li>
<p>No code splitting strategy</p>
</li>
<li>
<p><strong>Why the current approach can't solve this</strong>:</p>
</li>
<li>Static imports are resolved at build time</li>
<li>All imported code goes into the main bundle</li>
<li>
<p>No way to defer loading until needed</p>
</li>
<li>
<p><strong>What we need</strong>:</p>
</li>
<li>Load core features immediately</li>
<li>Defer optional features until user needs them</li>
<li>Split code into smaller chunks that load on demand</li>
</ol>
<h2 id="reactlazy-and-suspense-route-based-code-splitting">React.lazy and Suspense: Route-Based Code Splitting</h2>
<p>The most effective code splitting strategy: split by route. Users only download code for the pages they visit.</p>
<h3 id="how-reactlazy-works">How React.lazy Works</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// Static import - loads immediately</span>
<span class="k">import</span><span class="w"> </span><span class="nx">AdminPanel</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./AdminPanel&#39;</span><span class="p">;</span>

<span class="c1">// Dynamic import - loads on demand</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">AdminPanel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">React</span><span class="p">.</span><span class="nx">lazy</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="k">import</span><span class="p">(</span><span class="s1">&#39;./AdminPanel&#39;</span><span class="p">));</span>
</code></pre></div>

<p><code>React.lazy</code> takes a function that returns a dynamic <code>import()</code>. This creates a separate bundle chunk that loads only when the component is rendered.</p>
<h3 id="iteration-1-splitting-the-admin-panel">Iteration 1: Splitting the Admin Panel</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/App.tsx (before)</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">BrowserRouter</span><span class="p">,</span><span class="w"> </span><span class="nx">Routes</span><span class="p">,</span><span class="w"> </span><span class="nx">Route</span><span class="p">,</span><span class="w"> </span><span class="nx">Link</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react-router-dom&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">ProductDashboard</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./components/ProductDashboard&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">AdminPanel</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./components/AdminPanel&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Analytics</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./components/Analytics&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">App</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">BrowserRouter</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">nav</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">Link</span><span class="w"> </span><span class="na">to</span><span class="o">=</span><span class="s">&quot;/&quot;</span><span class="p">&gt;</span><span class="nx">Dashboard</span><span class="p">&lt;/</span><span class="nt">Link</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">Link</span><span class="w"> </span><span class="na">to</span><span class="o">=</span><span class="s">&quot;/analytics&quot;</span><span class="p">&gt;</span><span class="nx">Analytics</span><span class="p">&lt;/</span><span class="nt">Link</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">Link</span><span class="w"> </span><span class="na">to</span><span class="o">=</span><span class="s">&quot;/admin&quot;</span><span class="p">&gt;</span><span class="nx">Admin</span><span class="p">&lt;/</span><span class="nt">Link</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">nav</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">Routes</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">Route</span><span class="w"> </span><span class="na">path</span><span class="o">=</span><span class="s">&quot;/&quot;</span><span class="w"> </span><span class="na">element</span><span class="o">=</span><span class="p">{&lt;</span><span class="nt">ProductDashboard</span><span class="w"> </span><span class="p">/&gt;}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">Route</span><span class="w"> </span><span class="na">path</span><span class="o">=</span><span class="s">&quot;/analytics&quot;</span><span class="w"> </span><span class="na">element</span><span class="o">=</span><span class="p">{&lt;</span><span class="nt">Analytics</span><span class="w"> </span><span class="p">/&gt;}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">Route</span><span class="w"> </span><span class="na">path</span><span class="o">=</span><span class="s">&quot;/admin&quot;</span><span class="w"> </span><span class="na">element</span><span class="o">=</span><span class="p">{&lt;</span><span class="nt">AdminPanel</span><span class="w"> </span><span class="p">/&gt;}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">Routes</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">BrowserRouter</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/App.tsx (after - with code splitting)</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">lazy</span><span class="p">,</span><span class="w"> </span><span class="nx">Suspense</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">BrowserRouter</span><span class="p">,</span><span class="w"> </span><span class="nx">Routes</span><span class="p">,</span><span class="w"> </span><span class="nx">Route</span><span class="p">,</span><span class="w"> </span><span class="nx">Link</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react-router-dom&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">ProductDashboard</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./components/ProductDashboard&#39;</span><span class="p">;</span>

<span class="c1">// Lazy load heavy components</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">Analytics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">lazy</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="k">import</span><span class="p">(</span><span class="s1">&#39;./components/Analytics&#39;</span><span class="p">));</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">AdminPanel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">lazy</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="k">import</span><span class="p">(</span><span class="s1">&#39;./components/AdminPanel&#39;</span><span class="p">));</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">LoadingFallback</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;loading-container&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;spinner&quot;</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Loading</span><span class="p">...&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">App</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">BrowserRouter</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">nav</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">Link</span><span class="w"> </span><span class="na">to</span><span class="o">=</span><span class="s">&quot;/&quot;</span><span class="p">&gt;</span><span class="nx">Dashboard</span><span class="p">&lt;/</span><span class="nt">Link</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">Link</span><span class="w"> </span><span class="na">to</span><span class="o">=</span><span class="s">&quot;/analytics&quot;</span><span class="p">&gt;</span><span class="nx">Analytics</span><span class="p">&lt;/</span><span class="nt">Link</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">Link</span><span class="w"> </span><span class="na">to</span><span class="o">=</span><span class="s">&quot;/admin&quot;</span><span class="p">&gt;</span><span class="nx">Admin</span><span class="p">&lt;/</span><span class="nt">Link</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">nav</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">Suspense</span><span class="w"> </span><span class="na">fallback</span><span class="o">=</span><span class="p">{&lt;</span><span class="nt">LoadingFallback</span><span class="w"> </span><span class="p">/&gt;}&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">Routes</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">Route</span><span class="w"> </span><span class="na">path</span><span class="o">=</span><span class="s">&quot;/&quot;</span><span class="w"> </span><span class="na">element</span><span class="o">=</span><span class="p">{&lt;</span><span class="nt">ProductDashboard</span><span class="w"> </span><span class="p">/&gt;}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">Route</span><span class="w"> </span><span class="na">path</span><span class="o">=</span><span class="s">&quot;/analytics&quot;</span><span class="w"> </span><span class="na">element</span><span class="o">=</span><span class="p">{&lt;</span><span class="nt">Analytics</span><span class="w"> </span><span class="p">/&gt;}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">Route</span><span class="w"> </span><span class="na">path</span><span class="o">=</span><span class="s">&quot;/admin&quot;</span><span class="w"> </span><span class="na">element</span><span class="o">=</span><span class="p">{&lt;</span><span class="nt">AdminPanel</span><span class="w"> </span><span class="p">/&gt;}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">Routes</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">Suspense</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">BrowserRouter</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Important</strong>: Components loaded with <code>React.lazy</code> must be default exports.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/AdminPanel.tsx</span>
<span class="c1">// ‚ùå WRONG: Named export</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">AdminPanel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span><span class="nx">Admin</span><span class="w"> </span><span class="nx">Panel</span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;;</span>
<span class="p">}</span>

<span class="c1">// ‚úì CORRECT: Default export</span>
<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">AdminPanel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span><span class="nx">Admin</span><span class="w"> </span><span class="nx">Panel</span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;;</span>
<span class="p">}</span>

<span class="c1">// ‚úì ALSO CORRECT: Named export with default</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">AdminPanel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span><span class="nx">Admin</span><span class="w"> </span><span class="nx">Panel</span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;;</span>
<span class="p">}</span>
<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="nx">AdminPanel</span><span class="p">;</span>
</code></pre></div>

<p><strong>Build the application again</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Build with code splitting</span>
npm<span class="w"> </span>run<span class="w"> </span>build

<span class="c1"># Output:</span>
dist/assets/index-a1b2c3d4.js<span class="w">           </span><span class="m">487</span>.23<span class="w"> </span>kB<span class="w"> </span>‚îÇ<span class="w"> </span>gzip:<span class="w"> </span><span class="m">162</span>.15<span class="w"> </span>kB
dist/assets/Analytics-b2c3d4e5.js<span class="w">       </span><span class="m">412</span>.45<span class="w"> </span>kB<span class="w"> </span>‚îÇ<span class="w"> </span>gzip:<span class="w"> </span><span class="m">138</span>.22<span class="w"> </span>kB
dist/assets/AdminPanel-c3d4e5f6.js<span class="w">      </span><span class="m">156</span>.78<span class="w"> </span>kB<span class="w"> </span>‚îÇ<span class="w"> </span>gzip:<span class="w"> </span><span class="m">52</span>.34<span class="w"> </span>kB
dist/assets/vendor-e5f6g7h8.js<span class="w">          </span><span class="m">1</span>,025.33<span class="w"> </span>kB<span class="w"> </span>‚îÇ<span class="w"> </span>gzip:<span class="w"> </span><span class="m">342</span>.12<span class="w"> </span>kB

Initial<span class="w"> </span>bundle:<span class="w"> </span><span class="m">1</span>,512.56<span class="w"> </span>kB<span class="w"> </span><span class="o">(</span><span class="m">504</span>.27<span class="w"> </span>kB<span class="w"> </span>gzipped<span class="o">)</span>
Lazy<span class="w"> </span>chunks:<span class="w"> </span><span class="m">569</span>.23<span class="w"> </span>kB<span class="w"> </span><span class="o">(</span><span class="m">190</span>.56<span class="w"> </span>kB<span class="w"> </span>gzipped<span class="o">)</span>
</code></pre></div>

<p><strong>Expected vs. Actual Improvement</strong>:</p>
<p><strong>Initial load</strong>:
- Before: 2,081.79 kB (696.49 kB gzipped)
- After: 1,512.56 kB (504.27 kB gzipped)
- Improvement: 27% smaller initial bundle</p>
<p><strong>Network Tab</strong>:
- Initial page load: 1.51 MB (vs. 2.08 MB before)
- On 3G: ~6 seconds (vs. 8 seconds before)
- On 4G: ~1.5 seconds (vs. 2 seconds before)</p>
<p><strong>Lighthouse Report</strong>:
- Performance score: 78/100 (vs. 62/100 before)
- TTI: 2.8s (vs. 4.2s before)
- TBT: 420ms (vs. 890ms before)
- FCP: 1.2s (vs. 1.8s before)</p>
<p><strong>User Experience</strong>:
1. User loads homepage: Downloads 1.51 MB
2. User clicks "Analytics": Downloads additional 412 kB
3. User clicks "Admin": Downloads additional 157 kB</p>
<p><strong>React DevTools - Network Tab</strong>:
- Initial load: <code>index.js</code>, <code>vendor.js</code>
- Navigate to /analytics: <code>Analytics.js</code> loads
- Navigate to /admin: <code>AdminPanel.js</code> loads
- Navigate back to /: No additional downloads (already cached)</p>
<h3 id="suspense-handling-loading-states">Suspense: Handling Loading States</h3>
<p><code>Suspense</code> is React's way of handling asynchronous component loading. It shows a fallback UI while the lazy component loads.</p>
<p><strong>How Suspense Works</strong>:
1. React starts rendering the lazy component
2. Component is not loaded yet (dynamic import in progress)
3. React "suspends" rendering and shows the fallback
4. When import completes, React resumes rendering the actual component</p>
<p><strong>Suspense Boundaries</strong>:
You can have multiple Suspense boundaries at different levels:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Coarse-grained: One boundary for entire route</span>
<span class="p">&lt;</span><span class="nt">Suspense</span><span class="w"> </span><span class="na">fallback</span><span class="o">=</span><span class="p">{&lt;</span><span class="nt">PageLoader</span><span class="w"> </span><span class="p">/&gt;}&gt;</span>
<span class="w">  </span><span class="p">&lt;</span><span class="nt">Routes</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">Route</span><span class="w"> </span><span class="na">path</span><span class="o">=</span><span class="s">&quot;/analytics&quot;</span><span class="w"> </span><span class="na">element</span><span class="o">=</span><span class="p">{&lt;</span><span class="nt">Analytics</span><span class="w"> </span><span class="p">/&gt;}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">Route</span><span class="w"> </span><span class="na">path</span><span class="o">=</span><span class="s">&quot;/admin&quot;</span><span class="w"> </span><span class="na">element</span><span class="o">=</span><span class="p">{&lt;</span><span class="nt">AdminPanel</span><span class="w"> </span><span class="p">/&gt;}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">  </span><span class="p">&lt;/</span><span class="nt">Routes</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">Suspense</span><span class="p">&gt;</span>

<span class="c1">// Fine-grained: Separate boundaries for each route</span>
<span class="p">&lt;</span><span class="nt">Routes</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">&lt;</span><span class="nt">Route</span><span class="w"> </span>
<span class="w">    </span><span class="na">path</span><span class="o">=</span><span class="s">&quot;/analytics&quot;</span><span class="w"> </span>
<span class="w">    </span><span class="na">element</span><span class="o">=</span><span class="p">{</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">Suspense</span><span class="w"> </span><span class="na">fallback</span><span class="o">=</span><span class="p">{&lt;</span><span class="nt">AnalyticsLoader</span><span class="w"> </span><span class="p">/&gt;}&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">Analytics</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">Suspense</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span>
<span class="w">  </span><span class="p">/&gt;</span>
<span class="w">  </span><span class="p">&lt;</span><span class="nt">Route</span><span class="w"> </span>
<span class="w">    </span><span class="na">path</span><span class="o">=</span><span class="s">&quot;/admin&quot;</span><span class="w"> </span>
<span class="w">    </span><span class="na">element</span><span class="o">=</span><span class="p">{</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">Suspense</span><span class="w"> </span><span class="na">fallback</span><span class="o">=</span><span class="p">{&lt;</span><span class="nt">AdminLoader</span><span class="w"> </span><span class="p">/&gt;}&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">AdminPanel</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">Suspense</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span>
<span class="w">  </span><span class="p">/&gt;</span>
<span class="p">&lt;/</span><span class="nt">Routes</span><span class="p">&gt;</span>
</code></pre></div>

<h3 id="iteration-2-component-level-code-splitting">Iteration 2: Component-Level Code Splitting</h3>
<p>Not just routes‚Äîsplit heavy components within a page.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/ProductDashboard.tsx (before)</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">AdvancedChart</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./AdvancedChart&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Heavy charting library</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">RichTextEditor</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./RichTextEditor&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Heavy editor</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">PDFExporter</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./PDFExporter&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Heavy PDF library</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductDashboard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">showChart</span><span class="p">,</span><span class="w"> </span><span class="nx">setShowChart</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">showEditor</span><span class="p">,</span><span class="w"> </span><span class="nx">setShowEditor</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Dashboard</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setShowChart</span><span class="p">(</span><span class="kc">true</span><span class="p">)}&gt;</span>
<span class="w">        </span><span class="nx">Show</span><span class="w"> </span><span class="nx">Advanced</span><span class="w"> </span><span class="nx">Chart</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="nx">showChart</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">AdvancedChart</span><span class="w"> </span><span class="na">data</span><span class="o">=</span><span class="p">{</span><span class="nx">data</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;}</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setShowEditor</span><span class="p">(</span><span class="kc">true</span><span class="p">)}&gt;</span>
<span class="w">        </span><span class="nx">Edit</span><span class="w"> </span><span class="nx">Description</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="nx">showEditor</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">RichTextEditor</span><span class="w"> </span><span class="p">/&gt;}</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">PDFExporter</span><span class="w"> </span><span class="na">data</span><span class="o">=</span><span class="p">{</span><span class="nx">data</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/ProductDashboard.tsx (after - with code splitting)</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">lazy</span><span class="p">,</span><span class="w"> </span><span class="nx">Suspense</span><span class="p">,</span><span class="w"> </span><span class="nx">useState</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="c1">// Lazy load heavy components</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">AdvancedChart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">lazy</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="k">import</span><span class="p">(</span><span class="s1">&#39;./AdvancedChart&#39;</span><span class="p">));</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">RichTextEditor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">lazy</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="k">import</span><span class="p">(</span><span class="s1">&#39;./RichTextEditor&#39;</span><span class="p">));</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">PDFExporter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">lazy</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="k">import</span><span class="p">(</span><span class="s1">&#39;./PDFExporter&#39;</span><span class="p">));</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductDashboard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">showChart</span><span class="p">,</span><span class="w"> </span><span class="nx">setShowChart</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">showEditor</span><span class="p">,</span><span class="w"> </span><span class="nx">setShowEditor</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Dashboard</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setShowChart</span><span class="p">(</span><span class="kc">true</span><span class="p">)}&gt;</span>
<span class="w">        </span><span class="nx">Show</span><span class="w"> </span><span class="nx">Advanced</span><span class="w"> </span><span class="nx">Chart</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="nx">showChart</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">Suspense</span><span class="w"> </span><span class="na">fallback</span><span class="o">=</span><span class="p">{&lt;</span><span class="nt">div</span><span class="p">&gt;</span><span class="nx">Loading</span><span class="w"> </span><span class="nx">chart</span><span class="p">...&lt;/</span><span class="nt">div</span><span class="p">&gt;}&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">AdvancedChart</span><span class="w"> </span><span class="na">data</span><span class="o">=</span><span class="p">{</span><span class="nx">data</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">Suspense</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">)}</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setShowEditor</span><span class="p">(</span><span class="kc">true</span><span class="p">)}&gt;</span>
<span class="w">        </span><span class="nx">Edit</span><span class="w"> </span><span class="nx">Description</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="nx">showEditor</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">Suspense</span><span class="w"> </span><span class="na">fallback</span><span class="o">=</span><span class="p">{&lt;</span><span class="nt">div</span><span class="p">&gt;</span><span class="nx">Loading</span><span class="w"> </span><span class="nx">editor</span><span class="p">...&lt;/</span><span class="nt">div</span><span class="p">&gt;}&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">RichTextEditor</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">Suspense</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">)}</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">Suspense</span><span class="w"> </span><span class="na">fallback</span><span class="o">=</span><span class="p">{&lt;</span><span class="nt">div</span><span class="p">&gt;</span><span class="nx">Loading</span><span class="w"> </span><span class="nx">PDF</span><span class="w"> </span><span class="nx">tools</span><span class="p">...&lt;/</span><span class="nt">div</span><span class="p">&gt;}&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">PDFExporter</span><span class="w"> </span><span class="na">data</span><span class="o">=</span><span class="p">{</span><span class="nx">data</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">Suspense</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>User Experience</strong>:
1. User loads dashboard: Core UI appears immediately
2. User clicks "Show Advanced Chart": Brief loading indicator, then chart appears
3. Chart code (412 kB) only downloads when needed</p>
<h3 id="iteration-3-prefetching-for-better-ux">Iteration 3: Prefetching for Better UX</h3>
<p>The problem with lazy loading: users see loading spinners. Solution: prefetch likely-needed code.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/ProductDashboard.tsx (with prefetching)</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">lazy</span><span class="p">,</span><span class="w"> </span><span class="nx">Suspense</span><span class="p">,</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useEffect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">AdvancedChart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">lazy</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="k">import</span><span class="p">(</span><span class="s1">&#39;./AdvancedChart&#39;</span><span class="p">));</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">RichTextEditor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">lazy</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="k">import</span><span class="p">(</span><span class="s1">&#39;./RichTextEditor&#39;</span><span class="p">));</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductDashboard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">showChart</span><span class="p">,</span><span class="w"> </span><span class="nx">setShowChart</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">showEditor</span><span class="p">,</span><span class="w"> </span><span class="nx">setShowEditor</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Prefetch chart when user hovers over button</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">prefetchChart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">import</span><span class="p">(</span><span class="s1">&#39;./AdvancedChart&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="c1">// Prefetch editor when user focuses on button</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">prefetchEditor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">import</span><span class="p">(</span><span class="s1">&#39;./RichTextEditor&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="c1">// Prefetch on idle (when browser has free time)</span>
<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;requestIdleCallback&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">window</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">requestIdleCallback</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">import</span><span class="p">(</span><span class="s1">&#39;./AdvancedChart&#39;</span><span class="p">);</span>
<span class="w">        </span><span class="k">import</span><span class="p">(</span><span class="s1">&#39;./RichTextEditor&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Dashboard</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span>
<span class="w">        </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setShowChart</span><span class="p">(</span><span class="kc">true</span><span class="p">)}</span>
<span class="w">        </span><span class="na">onMouseEnter</span><span class="o">=</span><span class="p">{</span><span class="nx">prefetchChart</span><span class="p">}</span>
<span class="w">        </span><span class="na">onFocus</span><span class="o">=</span><span class="p">{</span><span class="nx">prefetchChart</span><span class="p">}</span>
<span class="w">      </span><span class="p">&gt;</span>
<span class="w">        </span><span class="nx">Show</span><span class="w"> </span><span class="nx">Advanced</span><span class="w"> </span><span class="nx">Chart</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="nx">showChart</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">Suspense</span><span class="w"> </span><span class="na">fallback</span><span class="o">=</span><span class="p">{&lt;</span><span class="nt">div</span><span class="p">&gt;</span><span class="nx">Loading</span><span class="w"> </span><span class="nx">chart</span><span class="p">...&lt;/</span><span class="nt">div</span><span class="p">&gt;}&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">AdvancedChart</span><span class="w"> </span><span class="na">data</span><span class="o">=</span><span class="p">{</span><span class="nx">data</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">Suspense</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">)}</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span>
<span class="w">        </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setShowEditor</span><span class="p">(</span><span class="kc">true</span><span class="p">)}</span>
<span class="w">        </span><span class="na">onMouseEnter</span><span class="o">=</span><span class="p">{</span><span class="nx">prefetchEditor</span><span class="p">}</span>
<span class="w">        </span><span class="na">onFocus</span><span class="o">=</span><span class="p">{</span><span class="nx">prefetchEditor</span><span class="p">}</span>
<span class="w">      </span><span class="p">&gt;</span>
<span class="w">        </span><span class="nx">Edit</span><span class="w"> </span><span class="nx">Description</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="nx">showEditor</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">Suspense</span><span class="w"> </span><span class="na">fallback</span><span class="o">=</span><span class="p">{&lt;</span><span class="nt">div</span><span class="p">&gt;</span><span class="nx">Loading</span><span class="w"> </span><span class="nx">editor</span><span class="p">...&lt;/</span><span class="nt">div</span><span class="p">&gt;}&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">RichTextEditor</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">Suspense</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">)}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Prefetching Strategies</strong>:</p>
<ol>
<li><strong>On hover/focus</strong>: Start loading when user shows intent</li>
<li><strong>On idle</strong>: Load during browser idle time</li>
<li><strong>On route change</strong>: Prefetch next likely route</li>
<li><strong>On viewport</strong>: Load when element enters viewport</li>
</ol>
<h3 id="iteration-4-vendor-code-splitting">Iteration 4: Vendor Code Splitting</h3>
<p>Split large third-party libraries into separate chunks.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// vite.config.ts</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">defineConfig</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;vite&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="nx">react</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@vitejs/plugin-react&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="nx">defineConfig</span><span class="p">({</span>
<span class="w">  </span><span class="nx">plugins</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nx">react</span><span class="p">()],</span>
<span class="w">  </span><span class="nx">build</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">rollupOptions</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">output</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">manualChunks</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="c1">// Split React and React DOM into separate chunk</span>
<span class="w">          </span><span class="s1">&#39;react-vendor&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;react&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;react-dom&#39;</span><span class="p">],</span>

<span class="w">          </span><span class="c1">// Split React Router into separate chunk</span>
<span class="w">          </span><span class="s1">&#39;router&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;react-router-dom&#39;</span><span class="p">],</span>

<span class="w">          </span><span class="c1">// Split large UI libraries</span>
<span class="w">          </span><span class="s1">&#39;ui-vendor&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;recharts&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;react-quill&#39;</span><span class="p">],</span>

<span class="w">          </span><span class="c1">// Split utility libraries</span>
<span class="w">          </span><span class="s1">&#39;utils&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;date-fns&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;lodash-es&#39;</span><span class="p">],</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">  </span><span class="p">},</span>
<span class="p">});</span>
</code></pre></div>

<p><strong>Build output with vendor splitting</strong>:</p>
<div class="codehilite"><pre><span></span><code>npm<span class="w"> </span>run<span class="w"> </span>build

<span class="c1"># Output:</span>
dist/assets/index-a1b2c3d4.js<span class="w">           </span><span class="m">287</span>.23<span class="w"> </span>kB<span class="w"> </span>‚îÇ<span class="w"> </span>gzip:<span class="w"> </span><span class="m">95</span>.15<span class="w"> </span>kB
dist/assets/react-vendor-b2c3d4e5.js<span class="w">    </span><span class="m">142</span>.45<span class="w"> </span>kB<span class="w"> </span>‚îÇ<span class="w"> </span>gzip:<span class="w"> </span><span class="m">47</span>.22<span class="w"> </span>kB
dist/assets/router-c3d4e5f6.js<span class="w">          </span><span class="m">45</span>.78<span class="w"> </span>kB<span class="w"> </span>‚îÇ<span class="w"> </span>gzip:<span class="w"> </span><span class="m">15</span>.34<span class="w"> </span>kB
dist/assets/ui-vendor-d4e5f6g7.js<span class="w">       </span><span class="m">699</span>.12<span class="w"> </span>kB<span class="w"> </span>‚îÇ<span class="w"> </span>gzip:<span class="w"> </span><span class="m">233</span>.45<span class="w"> </span>kB
dist/assets/utils-e5f6g7h8.js<span class="w">           </span><span class="m">87</span>.34<span class="w"> </span>kB<span class="w"> </span>‚îÇ<span class="w"> </span>gzip:<span class="w"> </span><span class="m">29</span>.12<span class="w"> </span>kB
dist/assets/Analytics-f6g7h8i9.js<span class="w">       </span><span class="m">412</span>.45<span class="w"> </span>kB<span class="w"> </span>‚îÇ<span class="w"> </span>gzip:<span class="w"> </span><span class="m">138</span>.22<span class="w"> </span>kB
dist/assets/AdminPanel-g7h8i9j0.js<span class="w">      </span><span class="m">156</span>.78<span class="w"> </span>kB<span class="w"> </span>‚îÇ<span class="w"> </span>gzip:<span class="w"> </span><span class="m">52</span>.34<span class="w"> </span>kB
</code></pre></div>

<p><strong>Benefits of vendor splitting</strong>:
- React vendor chunk (142 kB) cached across all pages
- UI vendor chunk (699 kB) only loads when needed
- When you update your code, users don't re-download React
- Better long-term caching</p>
<h3 id="the-failure-over-splitting">The Failure: Over-Splitting</h3>
<p>Let's split EVERYTHING into tiny chunks.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// vite.config.ts (over-aggressive splitting)</span>
<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="nx">defineConfig</span><span class="p">({</span>
<span class="w">  </span><span class="nx">plugins</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nx">react</span><span class="p">()],</span>
<span class="w">  </span><span class="nx">build</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">rollupOptions</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">output</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">manualChunks</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">id</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="c1">// Split every node_module into its own chunk</span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">id</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s1">&#39;node_modules&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="nx">id</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;node_modules/&#39;</span><span class="p">)[</span><span class="mf">1</span><span class="p">].</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="mf">0</span><span class="p">];</span>
<span class="w">          </span><span class="p">}</span>

<span class="w">          </span><span class="c1">// Split every component into its own chunk</span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">id</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s1">&#39;src/components&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="nx">id</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;components/&#39;</span><span class="p">)[</span><span class="mf">1</span><span class="p">].</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mf">0</span><span class="p">];</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">  </span><span class="p">},</span>
<span class="p">});</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>npm<span class="w"> </span>run<span class="w"> </span>build

<span class="c1"># Output: 147 separate chunk files!</span>
dist/assets/Button-a1b2c3d4.js<span class="w">          </span><span class="m">2</span>.34<span class="w"> </span>kB
dist/assets/Input-b2c3d4e5.js<span class="w">           </span><span class="m">3</span>.12<span class="w"> </span>kB
dist/assets/Modal-c3d4e5f6.js<span class="w">           </span><span class="m">4</span>.56<span class="w"> </span>kB
dist/assets/Card-d4e5f6g7.js<span class="w">            </span><span class="m">2</span>.89<span class="w"> </span>kB
<span class="o">[</span>...<span class="w"> </span><span class="m">143</span><span class="w"> </span>more<span class="w"> </span>files<span class="w"> </span>...<span class="o">]</span>
</code></pre></div>

<p><strong>Network Tab</strong>:
- Initial page load: 47 separate HTTP requests
- Each request has overhead (DNS, TCP, TLS handshake)
- Total download time: 3.2 seconds (vs. 1.5 seconds with reasonable splitting)
- HTTP/2 helps, but too many requests still hurts</p>
<p><strong>The Problem</strong>: Over-splitting creates more overhead than it saves.</p>
<p><strong>The Rule</strong>: Aim for 5-10 chunks for most applications. Each chunk should be at least 20-30 kB.</p>
<h3 id="when-to-apply-code-splitting">When to Apply Code Splitting</h3>
<p><strong>Route-based splitting</strong> (always do this):
- Split each major route into its own chunk
- Users only download code for pages they visit
- Biggest performance win for least effort</p>
<p><strong>Component-based splitting</strong> (selective):
- Split heavy components (charts, editors, maps)
- Split components behind user actions (modals, tabs)
- Split components below the fold</p>
<p><strong>Vendor splitting</strong> (for production):
- Split React/React DOM (changes rarely)
- Split large UI libraries (recharts, material-ui)
- Split utility libraries (lodash, date-fns)</p>
<p><strong>Don't split</strong>:
- Small components (&lt;10 kB)
- Components used on every page
- Components above the fold
- Core application logic</p>
<h3 id="common-failure-modes-and-their-signatures_2">Common Failure Modes and Their Signatures</h3>
<h4 id="symptom-suspense-fallback-flashes-briefly">Symptom: Suspense fallback flashes briefly</h4>
<p><strong>Browser behavior</strong>:
Loading spinner appears for &lt;100ms, then content appears</p>
<p><strong>Console pattern</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="o">[</span>Suspense<span class="o">]</span><span class="w"> </span>Fallback<span class="w"> </span>shown
<span class="o">[</span>Suspense<span class="o">]</span><span class="w"> </span>Content<span class="w"> </span>rendered
<span class="o">[</span>Time<span class="w"> </span>elapsed:<span class="w"> </span>45ms<span class="o">]</span>
</code></pre></div>

<p><strong>DevTools clues</strong>:
- Network tab shows chunk loaded from cache
- Very fast load time (&lt;100ms)</p>
<p><strong>Root cause</strong>: Component already cached, but Suspense still shows fallback</p>
<p><strong>Solution</strong>: Use <code>startTransition</code> to avoid showing fallback for fast loads:</p>
<div class="codehilite"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">lazy</span><span class="p">,</span><span class="w"> </span><span class="nx">Suspense</span><span class="p">,</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useTransition</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">HeavyComponent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">lazy</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="k">import</span><span class="p">(</span><span class="s1">&#39;./HeavyComponent&#39;</span><span class="p">));</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">App</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">show</span><span class="p">,</span><span class="w"> </span><span class="nx">setShow</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">isPending</span><span class="p">,</span><span class="w"> </span><span class="nx">startTransition</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useTransition</span><span class="p">();</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">startTransition</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">setShow</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleClick</span><span class="p">}</span><span class="w"> </span><span class="na">disabled</span><span class="o">=</span><span class="p">{</span><span class="nx">isPending</span><span class="p">}&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">isPending</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;Loading...&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Show Component&#39;</span><span class="p">}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="nx">show</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">Suspense</span><span class="w"> </span><span class="na">fallback</span><span class="o">=</span><span class="p">{&lt;</span><span class="nt">div</span><span class="p">&gt;</span><span class="nx">Loading</span><span class="p">...&lt;/</span><span class="nt">div</span><span class="p">&gt;}&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">HeavyComponent</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">Suspense</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">)}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h4 id="symptom-lazy-component-fails-to-load">Symptom: Lazy component fails to load</h4>
<p><strong>Browser behavior</strong>:
Error boundary catches error, shows error UI</p>
<p><strong>Console pattern</strong>:</p>
<div class="codehilite"><pre><span></span><code>ChunkLoadError:<span class="w"> </span>Loading<span class="w"> </span>chunk<span class="w"> </span><span class="m">5</span><span class="w"> </span>failed.
<span class="o">(</span>error:<span class="w"> </span>https://example.com/assets/Analytics-abc123.js<span class="o">)</span>
</code></pre></div>

<p><strong>DevTools clues</strong>:
- Network tab shows 404 or network error for chunk
- Chunk file missing or wrong path</p>
<p><strong>Root cause</strong>: 
- Build output path doesn't match runtime path
- CDN cache issue
- Network failure</p>
<p><strong>Solution</strong>: Add error boundary with retry logic:</p>
<div class="codehilite"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">lazy</span><span class="p">,</span><span class="w"> </span><span class="nx">Suspense</span><span class="p">,</span><span class="w"> </span><span class="nx">Component</span><span class="p">,</span><span class="w"> </span><span class="nx">ReactNode</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">Props</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">children</span><span class="o">:</span><span class="w"> </span><span class="kt">ReactNode</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">State</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">hasError</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="kt">Error</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nx">LazyLoadErrorBoundary</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nx">Component</span><span class="p">&lt;</span><span class="nt">Props</span><span class="err">,</span><span class="w"> </span><span class="na">State</span><span class="p">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">props</span><span class="o">:</span><span class="w"> </span><span class="kt">Props</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">hasError</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="kt">null</span><span class="w"> </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">static</span><span class="w"> </span><span class="nx">getDerivedStateFromError</span><span class="p">(</span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="kt">Error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">hasError</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="w"> </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nx">handleRetry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="w"> </span><span class="nx">hasError</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="kt">null</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="nx">render</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">hasError</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;error-container&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">Failed</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">load</span><span class="w"> </span><span class="nx">component</span><span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">error</span><span class="o">?</span><span class="p">.</span><span class="nx">message</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleRetry</span><span class="p">}&gt;</span><span class="nx">Retry</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">children</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Usage</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">App</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">LazyLoadErrorBoundary</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">Suspense</span><span class="w"> </span><span class="na">fallback</span><span class="o">=</span><span class="p">{&lt;</span><span class="nt">div</span><span class="p">&gt;</span><span class="nx">Loading</span><span class="p">...&lt;/</span><span class="nt">div</span><span class="p">&gt;}&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">LazyComponent</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">Suspense</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">LazyLoadErrorBoundary</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h4 id="symptom-preloading-doesnt-work">Symptom: Preloading doesn't work</h4>
<p><strong>Browser behavior</strong>:
User clicks button, sees loading spinner despite prefetch attempt</p>
<p><strong>Console pattern</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="o">[</span>Prefetch<span class="o">]</span><span class="w"> </span>Starting<span class="w"> </span>import
<span class="o">[</span>User<span class="w"> </span>clicks<span class="w"> </span>button<span class="o">]</span>
<span class="o">[</span>Suspense<span class="o">]</span><span class="w"> </span>Fallback<span class="w"> </span>shown
<span class="o">[</span>Suspense<span class="o">]</span><span class="w"> </span>Content<span class="w"> </span>rendered
</code></pre></div>

<p><strong>DevTools clues</strong>:
- Network tab shows chunk loading AFTER button click
- Prefetch import() call not visible in network tab</p>
<p><strong>Root cause</strong>: Prefetch import() not actually executed (conditional logic, timing issue)</p>
<p><strong>Solution</strong>: Ensure prefetch runs unconditionally:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// ‚ùå WRONG: Prefetch inside conditional</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">App</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">show</span><span class="p">,</span><span class="w"> </span><span class="nx">setShow</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">show</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// This runs AFTER user clicks, too late!</span>
<span class="w">    </span><span class="k">import</span><span class="p">(</span><span class="s1">&#39;./HeavyComponent&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setShow</span><span class="p">(</span><span class="kc">true</span><span class="p">)}&gt;</span><span class="nx">Show</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;;</span>
<span class="p">}</span>

<span class="c1">// ‚úì CORRECT: Prefetch on hover/focus</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">App</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">show</span><span class="p">,</span><span class="w"> </span><span class="nx">setShow</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">prefetch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">import</span><span class="p">(</span><span class="s1">&#39;./HeavyComponent&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span>
<span class="w">      </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setShow</span><span class="p">(</span><span class="kc">true</span><span class="p">)}</span>
<span class="w">      </span><span class="na">onMouseEnter</span><span class="o">=</span><span class="p">{</span><span class="nx">prefetch</span><span class="p">}</span>
<span class="w">      </span><span class="na">onFocus</span><span class="o">=</span><span class="p">{</span><span class="nx">prefetch</span><span class="p">}</span>
<span class="w">    </span><span class="p">&gt;</span>
<span class="w">      </span><span class="nx">Show</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="performance-impact-summary_2">Performance Impact Summary</h3>
<p><strong>Before code splitting</strong>:
- Initial bundle: 2,081 kB (696 kB gzipped)
- TTI: 4.2s
- Lighthouse score: 62/100</p>
<p><strong>After route-based splitting</strong>:
- Initial bundle: 1,512 kB (504 kB gzipped)
- TTI: 2.8s
- Lighthouse score: 78/100
- Improvement: 27% smaller, 33% faster TTI</p>
<p><strong>After component-based splitting</strong>:
- Initial bundle: 1,156 kB (385 kB gzipped)
- TTI: 2.1s
- Lighthouse score: 85/100
- Improvement: 44% smaller, 50% faster TTI</p>
<p><strong>After vendor splitting</strong>:
- Initial bundle: 1,156 kB (385 kB gzipped)
- Better caching (React vendor chunk cached separately)
- Faster subsequent page loads</p>
<p><strong>Trade-offs</strong>:
- Code complexity: Moderate increase (lazy imports, Suspense boundaries)
- Network requests: More requests, but smaller total size
- User experience: Brief loading states, but faster initial load
- Caching: Better long-term caching with vendor splitting</p>
<p><strong>Limitation preview</strong>: We've optimized bundle size and loading, but we haven't systematically identified what's actually slow. Let's learn how to profile and fix real performance bottlenecks.</p>
<h2 id="analyzing-and-fixing-performance-bottlenecks">Analyzing and fixing performance bottlenecks</h2>
<h2 id="the-failure-it-feels-slow-without-metrics">The Failure: "It Feels Slow" Without Metrics</h2>
<p>Our dashboard is live. Users complain: "It feels slow." But what's actually slow? Where should we optimize?</p>
<p>Without measurement, optimization is guesswork. Let's learn to diagnose performance issues systematically.</p>
<h2 id="the-performance-profiling-toolkit">The Performance Profiling Toolkit</h2>
<h3 id="tool-1-react-devtools-profiler">Tool 1: React DevTools Profiler</h3>
<p><strong>What it measures</strong>:
- Which components rendered
- How long each render took
- Why each component rendered
- Render count and timing</p>
<p><strong>How to use it</strong>:
1. Open React DevTools
2. Click "Profiler" tab
3. Click record button (‚è∫)
4. Interact with your app
5. Click stop button (‚èπ)
6. Analyze the flame graph</p>
<h3 id="tool-2-chrome-performance-tab">Tool 2: Chrome Performance Tab</h3>
<p><strong>What it measures</strong>:
- JavaScript execution time
- Layout and paint operations
- Network activity
- Main thread blocking</p>
<p><strong>How to use it</strong>:
1. Open Chrome DevTools
2. Click "Performance" tab
3. Click record button (‚è∫)
4. Interact with your app
5. Click stop button (‚èπ)
6. Analyze the timeline</p>
<h3 id="tool-3-lighthouse">Tool 3: Lighthouse</h3>
<p><strong>What it measures</strong>:
- Core Web Vitals (LCP, FID, CLS)
- Time to Interactive (TTI)
- Total Blocking Time (TBT)
- First Contentful Paint (FCP)</p>
<p><strong>How to use it</strong>:
1. Open Chrome DevTools
2. Click "Lighthouse" tab
3. Select "Performance"
4. Click "Analyze page load"</p>
<h2 id="iteration-1-profiling-a-slow-interaction">Iteration 1: Profiling a Slow Interaction</h2>
<p>Let's profile our dashboard's filter interaction.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/ProductDashboard.tsx</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">memo</span><span class="p">,</span><span class="w"> </span><span class="nx">useMemo</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">Product</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">sales</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Simulate expensive filtering</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">filterProducts</span><span class="p">(</span><span class="nx">products</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="p">[],</span><span class="w"> </span><span class="nx">searchTerm</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Product</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üîÑ Filtering products...&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Simulate expensive operation</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">1000000</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">sum</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">products</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">p</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span>
<span class="w">    </span><span class="nx">p</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">includes</span><span class="p">(</span><span class="nx">searchTerm</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">())</span><span class="w"> </span><span class="o">||</span>
<span class="w">    </span><span class="nx">p</span><span class="p">.</span><span class="nx">description</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">includes</span><span class="p">(</span><span class="nx">searchTerm</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">())</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Expensive component that renders product details</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">ProductCard</span><span class="p">({</span><span class="w"> </span><span class="nx">product</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">product</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering ProductCard:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Simulate expensive rendering</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">100000</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">sum</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;product-card&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;{</span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="p">}&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;{</span><span class="nx">product</span><span class="p">.</span><span class="nx">category</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Sales</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">sales</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">$</span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">revenue</span><span class="p">.</span><span class="nx">toLocaleString</span><span class="p">()}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;{</span><span class="nx">product</span><span class="p">.</span><span class="nx">description</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">ProductList</span><span class="p">({</span><span class="w"> </span><span class="nx">products</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">products</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="p">[]</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering ProductList&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;product-list&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">products</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">product</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">ProductCard</span><span class="w"> </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="w"> </span><span class="na">product</span><span class="o">=</span><span class="p">{</span><span class="nx">product</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">))}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductDashboard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">searchTerm</span><span class="p">,</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Mock data - 50 products</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">allProducts</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Array</span><span class="p">.</span><span class="kr">from</span><span class="p">({</span><span class="w"> </span><span class="nx">length</span><span class="o">:</span><span class="w"> </span><span class="kt">50</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">(</span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
<span class="w">    </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">i</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
<span class="w">    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="sb">`Product </span><span class="si">${</span><span class="nx">i</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
<span class="w">    </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;electronics&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;furniture&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;appliances&#39;</span><span class="p">][</span><span class="nx">i</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mf">3</span><span class="p">],</span>
<span class="w">    </span><span class="nx">sales</span><span class="o">:</span><span class="w"> </span><span class="kt">Math.floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1000</span><span class="p">),</span>
<span class="w">    </span><span class="nx">revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">Math.floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">100000</span><span class="p">),</span>
<span class="w">    </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="sb">`Description for product </span><span class="si">${</span><span class="nx">i</span><span class="si">}</span><span class="sb">. This is a great product with many features.`</span><span class="p">,</span>
<span class="w">  </span><span class="p">}));</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filteredProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">filterProducts</span><span class="p">(</span><span class="nx">allProducts</span><span class="p">,</span><span class="w"> </span><span class="nx">searchTerm</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;dashboard&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Product</span><span class="w"> </span><span class="nx">Dashboard</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">        </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">        </span><span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Search products...&quot;</span>
<span class="w">        </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">searchTerm</span><span class="p">}</span>
<span class="w">        </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">      </span><span class="p">/&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">ProductList</span><span class="w"> </span><span class="na">products</span><span class="o">=</span><span class="p">{</span><span class="nx">filteredProducts</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>User Action</strong>: Type "Product 1" in the search box.</p>
<p><strong>Browser Behavior</strong>:
- Noticeable lag between keystrokes
- UI freezes briefly on each keystroke
- Takes ~2 seconds to type 9 characters</p>
<h3 id="diagnostic-analysis-react-devtools-profiler">Diagnostic Analysis: React DevTools Profiler</h3>
<p><strong>Step 1: Record the interaction</strong>
1. Open React DevTools ‚Üí Profiler tab
2. Click record (‚è∫)
3. Type "Product 1" in search box
4. Click stop (‚èπ)</p>
<p><strong>Profiler Output</strong>:</p>
<p><strong>Flame Graph View</strong>:</p>
<div class="codehilite"><pre><span></span><code>ProductDashboard (1,247ms)
‚îú‚îÄ ProductList (1,156ms)
‚îÇ  ‚îú‚îÄ ProductCard (23ms) √ó 50 components
‚îÇ  ‚îú‚îÄ ProductCard (24ms)
‚îÇ  ‚îú‚îÄ ProductCard (22ms)
‚îÇ  ‚îî‚îÄ ... (47 more)
‚îî‚îÄ input (2ms)
</code></pre></div>

<p><strong>Ranked View</strong> (sorted by render time):
1. <code>ProductList</code>: 1,156ms (93% of total time)
2. <code>ProductCard</code> (Product 0): 23ms
3. <code>ProductCard</code> (Product 1): 24ms
4. <code>ProductCard</code> (Product 2): 22ms
... (50 total ProductCard renders)</p>
<p><strong>Interactions Timeline</strong>:
- Keystroke 1 ("P"): 1,247ms
- Keystroke 2 ("r"): 1,198ms
- Keystroke 3 ("o"): 1,223ms
... (9 total keystrokes)</p>
<p><strong>Why Each Component Rendered</strong>:
- <code>ProductDashboard</code>: State changed (searchTerm)
- <code>ProductList</code>: Props changed (products array)
- <code>ProductCard</code> (all 50): Parent re-rendered</p>
<h3 id="diagnostic-analysis-chrome-performance-tab">Diagnostic Analysis: Chrome Performance Tab</h3>
<p><strong>Step 1: Record the interaction</strong>
1. Open Chrome DevTools ‚Üí Performance tab
2. Click record (‚è∫)
3. Type "Product 1" in search box
4. Click stop (‚èπ)</p>
<p><strong>Performance Timeline</strong>:</p>
<p><strong>Main Thread Activity</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="k">[Keystroke 1]</span>
<span class="na">‚îú‚îÄ Event</span><span class="o">:</span><span class="w"> </span><span class="s">input (2ms)</span>
<span class="na">‚îú‚îÄ React</span><span class="o">:</span><span class="w"> </span><span class="s">Render phase (1,156ms)</span>
<span class="na">‚îÇ  ‚îú‚îÄ filterProducts (120ms)</span>
<span class="na">‚îÇ  ‚îî‚îÄ ProductCard √ó 50 (1,036ms)</span>
<span class="na">‚îú‚îÄ React</span><span class="o">:</span><span class="w"> </span><span class="s">Commit phase (45ms)</span>
<span class="na">‚îú‚îÄ Layout (23ms)</span>
<span class="na">‚îî‚îÄ Paint (12ms)</span>

<span class="na">Total</span><span class="o">:</span><span class="w"> </span><span class="s">1,358ms of blocked main thread</span>
</code></pre></div>

<p><strong>Breakdown</strong>:
- JavaScript execution: 1,201ms (88%)
- Rendering (layout + paint): 35ms (3%)
- Idle: 122ms (9%)</p>
<p><strong>Long Tasks</strong> (&gt;50ms):
- Task 1: 1,201ms (React render)
- Task 2: 45ms (React commit)</p>
<h3 id="lets-parse-this-evidence">Let's Parse This Evidence</h3>
<p><strong>What the user experiences</strong>:
- Expected: Instant feedback (&lt;100ms)
- Actual: 1.2+ second lag per keystroke</p>
<p><strong>What React DevTools reveals</strong>:
- <code>ProductList</code> takes 93% of render time
- All 50 <code>ProductCard</code> components re-render on every keystroke
- Each <code>ProductCard</code> takes ~23ms to render
- Total: 50 √ó 23ms = 1,150ms</p>
<p><strong>What Chrome Performance shows</strong>:
- Main thread blocked for 1.2+ seconds
- JavaScript execution dominates (88% of time)
- <code>filterProducts</code> takes 120ms
- <code>ProductCard</code> rendering takes 1,036ms</p>
<p><strong>Root causes identified</strong>:
1. <strong>Expensive filtering</strong>: <code>filterProducts</code> runs on every keystroke (120ms)
2. <strong>Unnecessary re-renders</strong>: All 50 <code>ProductCard</code> components re-render, even if product data unchanged
3. <strong>Expensive rendering</strong>: Each <code>ProductCard</code> has expensive logic (23ms √ó 50 = 1,150ms)</p>
<p><strong>Optimization priorities</strong> (by impact):
1. Memoize <code>ProductCard</code> to prevent unnecessary re-renders (saves ~1,150ms)
2. Memoize <code>filterProducts</code> result (saves ~120ms)
3. Optimize <code>ProductCard</code> rendering logic (saves ~23ms per card)</p>
<h3 id="iteration-2-memoizing-productcard">Iteration 2: Memoizing ProductCard</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/ProductDashboard.tsx (updated)</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">memo</span><span class="p">,</span><span class="w"> </span><span class="nx">useMemo</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="c1">// ... (interfaces, filterProducts unchanged)</span>

<span class="c1">// Memoize ProductCard</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">ProductCard</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">memo</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductCard</span><span class="p">({</span><span class="w"> </span><span class="nx">product</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">product</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering ProductCard:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Simulate expensive rendering</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">100000</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">sum</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;product-card&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;{</span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="p">}&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;{</span><span class="nx">product</span><span class="p">.</span><span class="nx">category</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Sales</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">sales</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">$</span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">revenue</span><span class="p">.</span><span class="nx">toLocaleString</span><span class="p">()}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;{</span><span class="nx">product</span><span class="p">.</span><span class="nx">description</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// ... (ProductList, ProductDashboard unchanged)</span>
</code></pre></div>

<p><strong>User Action</strong>: Type "Product 1" in the search box.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Browser Console Output (typing &quot;P&quot;, then &quot;r&quot;):</span>

üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductCard:<span class="w"> </span>Product<span class="w"> </span><span class="m">0</span>
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductCard:<span class="w"> </span>Product<span class="w"> </span><span class="m">1</span>
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductCard:<span class="w"> </span>Product<span class="w"> </span><span class="m">2</span>
...<span class="w"> </span><span class="o">(</span><span class="m">50</span><span class="w"> </span>cards<span class="w"> </span>render<span class="w"> </span>on<span class="w"> </span>first<span class="w"> </span>keystroke<span class="o">)</span>

üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductCard:<span class="w"> </span>Product<span class="w"> </span><span class="m">0</span>
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductCard:<span class="w"> </span>Product<span class="w"> </span><span class="m">1</span>
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductCard:<span class="w"> </span>Product<span class="w"> </span><span class="m">2</span>
...<span class="w"> </span><span class="o">(</span><span class="m">50</span><span class="w"> </span>cards<span class="w"> </span>render<span class="w"> </span>on<span class="w"> </span>second<span class="w"> </span>keystroke<span class="w"> </span>too!<span class="o">)</span>
</code></pre></div>

<h3 id="the-failure-reactmemo-doesnt-help">The Failure: React.memo Doesn't Help</h3>
<p><strong>React DevTools Profiler</strong>:
- Still 1,247ms per keystroke
- All 50 <code>ProductCard</code> components still re-render
- No improvement</p>
<p><strong>Why?</strong> The <code>products</code> array is a new reference on every render. Even though the product objects inside are the same, the array itself is new.</p>
<h3 id="iteration-3-memoizing-the-filtered-products-array">Iteration 3: Memoizing the Filtered Products Array</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/ProductDashboard.tsx (updated)</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">memo</span><span class="p">,</span><span class="w"> </span><span class="nx">useMemo</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="c1">// ... (interfaces, filterProducts, ProductCard unchanged)</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">ProductList</span><span class="p">({</span><span class="w"> </span><span class="nx">products</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">products</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="p">[]</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering ProductList&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;product-list&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">products</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">product</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">ProductCard</span><span class="w"> </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="w"> </span><span class="na">product</span><span class="o">=</span><span class="p">{</span><span class="nx">product</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">))}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductDashboard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">searchTerm</span><span class="p">,</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">allProducts</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Array</span><span class="p">.</span><span class="kr">from</span><span class="p">({</span><span class="w"> </span><span class="nx">length</span><span class="o">:</span><span class="w"> </span><span class="kt">50</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">(</span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
<span class="w">    </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">i</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
<span class="w">    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="sb">`Product </span><span class="si">${</span><span class="nx">i</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
<span class="w">    </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;electronics&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;furniture&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;appliances&#39;</span><span class="p">][</span><span class="nx">i</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mf">3</span><span class="p">],</span>
<span class="w">    </span><span class="nx">sales</span><span class="o">:</span><span class="w"> </span><span class="kt">Math.floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1000</span><span class="p">),</span>
<span class="w">    </span><span class="nx">revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">Math.floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">100000</span><span class="p">),</span>
<span class="w">    </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="sb">`Description for product </span><span class="si">${</span><span class="nx">i</span><span class="si">}</span><span class="sb">. This is a great product with many features.`</span><span class="p">,</span>
<span class="w">  </span><span class="p">}));</span>

<span class="w">  </span><span class="c1">// Memoize filtered products</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filteredProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üîÑ Filtering products...&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">filterProducts</span><span class="p">(</span><span class="nx">allProducts</span><span class="p">,</span><span class="w"> </span><span class="nx">searchTerm</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">searchTerm</span><span class="p">]);</span><span class="w"> </span><span class="c1">// Only re-filter when searchTerm changes</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;dashboard&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Product</span><span class="w"> </span><span class="nx">Dashboard</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">        </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">        </span><span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Search products...&quot;</span>
<span class="w">        </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">searchTerm</span><span class="p">}</span>
<span class="w">        </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">      </span><span class="p">/&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">ProductList</span><span class="w"> </span><span class="na">products</span><span class="o">=</span><span class="p">{</span><span class="nx">filteredProducts</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>User Action</strong>: Type "Product 1" in the search box.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Browser Console Output (typing &quot;P&quot;, then &quot;r&quot;):</span>

üîÑ<span class="w"> </span>Filtering<span class="w"> </span>products...
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductCard:<span class="w"> </span>Product<span class="w"> </span><span class="m">0</span>
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductCard:<span class="w"> </span>Product<span class="w"> </span><span class="m">1</span>
...<span class="w"> </span><span class="o">(</span><span class="m">50</span><span class="w"> </span>cards<span class="w"> </span>render<span class="w"> </span>on<span class="w"> </span>first<span class="w"> </span>keystroke<span class="o">)</span>

üîÑ<span class="w"> </span>Filtering<span class="w"> </span>products...
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductCard:<span class="w"> </span>Product<span class="w"> </span><span class="m">0</span>
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductCard:<span class="w"> </span>Product<span class="w"> </span><span class="m">1</span>
...<span class="w"> </span><span class="o">(</span><span class="m">50</span><span class="w"> </span>cards<span class="w"> </span>still<span class="w"> </span>render<span class="w"> </span>on<span class="w"> </span>second<span class="w"> </span>keystroke!<span class="o">)</span>
</code></pre></div>

<h3 id="the-failure-still-re-rendering-everything">The Failure: Still Re-rendering Everything</h3>
<p><strong>Why?</strong> Even though we memoized <code>filteredProducts</code>, the array contents change on every keystroke (different products match the search term). So the array reference changes, and all <code>ProductCard</code> components re-render.</p>
<p><strong>This is actually correct behavior!</strong> When the filtered results change, we SHOULD re-render the cards.</p>
<p>But we can still optimize: only re-render cards that actually changed.</p>
<h3 id="iteration-4-stable-product-references">Iteration 4: Stable Product References</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/ProductDashboard.tsx (updated)</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">memo</span><span class="p">,</span><span class="w"> </span><span class="nx">useMemo</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="c1">// ... (interfaces, filterProducts unchanged)</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">ProductCard</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">memo</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductCard</span><span class="p">({</span><span class="w"> </span><span class="nx">product</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">product</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering ProductCard:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Simulate expensive rendering</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">100000</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">sum</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;product-card&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;{</span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="p">}&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;{</span><span class="nx">product</span><span class="p">.</span><span class="nx">category</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Sales</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">sales</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">$</span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">revenue</span><span class="p">.</span><span class="nx">toLocaleString</span><span class="p">()}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;{</span><span class="nx">product</span><span class="p">.</span><span class="nx">description</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">});</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">ProductList</span><span class="p">({</span><span class="w"> </span><span class="nx">products</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">products</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="p">[]</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering ProductList&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;product-list&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">products</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">product</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">ProductCard</span><span class="w"> </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="w"> </span><span class="na">product</span><span class="o">=</span><span class="p">{</span><span class="nx">product</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">))}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductDashboard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">searchTerm</span><span class="p">,</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Move allProducts outside component to maintain stable references</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">allProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span>
<span class="w">    </span><span class="nb">Array</span><span class="p">.</span><span class="kr">from</span><span class="p">({</span><span class="w"> </span><span class="nx">length</span><span class="o">:</span><span class="w"> </span><span class="kt">50</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">(</span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
<span class="w">      </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">i</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
<span class="w">      </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="sb">`Product </span><span class="si">${</span><span class="nx">i</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
<span class="w">      </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;electronics&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;furniture&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;appliances&#39;</span><span class="p">][</span><span class="nx">i</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mf">3</span><span class="p">],</span>
<span class="w">      </span><span class="nx">sales</span><span class="o">:</span><span class="w"> </span><span class="kt">Math.floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1000</span><span class="p">),</span>
<span class="w">      </span><span class="nx">revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">Math.floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">100000</span><span class="p">),</span>
<span class="w">      </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="sb">`Description for product </span><span class="si">${</span><span class="nx">i</span><span class="si">}</span><span class="sb">. This is a great product with many features.`</span><span class="p">,</span>
<span class="w">    </span><span class="p">}))</span>
<span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="p">[]);</span><span class="w"> </span><span class="c1">// Empty deps - create once</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filteredProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üîÑ Filtering products...&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">filterProducts</span><span class="p">(</span><span class="nx">allProducts</span><span class="p">,</span><span class="w"> </span><span class="nx">searchTerm</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">allProducts</span><span class="p">,</span><span class="w"> </span><span class="nx">searchTerm</span><span class="p">]);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;dashboard&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Product</span><span class="w"> </span><span class="nx">Dashboard</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">        </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">        </span><span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Search products...&quot;</span>
<span class="w">        </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">searchTerm</span><span class="p">}</span>
<span class="w">        </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">      </span><span class="p">/&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">ProductList</span><span class="w"> </span><span class="na">products</span><span class="o">=</span><span class="p">{</span><span class="nx">filteredProducts</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>User Action</strong>: Type "Product 1" in the search box.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Browser Console Output (typing &quot;P&quot;, then &quot;r&quot;, then &quot;o&quot;):</span>

üîÑ<span class="w"> </span>Filtering<span class="w"> </span>products...
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductCard:<span class="w"> </span>Product<span class="w"> </span><span class="m">0</span>
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductCard:<span class="w"> </span>Product<span class="w"> </span><span class="m">1</span>
...<span class="w"> </span><span class="o">(</span><span class="m">50</span><span class="w"> </span>cards<span class="w"> </span>render<span class="w"> </span>on<span class="w"> </span>first<span class="w"> </span>keystroke<span class="o">)</span>

üîÑ<span class="w"> </span>Filtering<span class="w"> </span>products...
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductCard:<span class="w"> </span>Product<span class="w"> </span><span class="m">10</span>
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductCard:<span class="w"> </span>Product<span class="w"> </span><span class="m">11</span>
...<span class="w"> </span><span class="o">(</span>only<span class="w"> </span><span class="m">10</span><span class="w"> </span>cards<span class="w"> </span>render<span class="w"> </span>-<span class="w"> </span>those<span class="w"> </span>matching<span class="w"> </span><span class="s2">&quot;Pr&quot;</span><span class="o">)</span>

üîÑ<span class="w"> </span>Filtering<span class="w"> </span>products...
üé®<span class="w"> </span>Rendering<span class="w"> </span>ProductCard:<span class="w"> </span>Product<span class="w"> </span><span class="m">10</span>
...<span class="w"> </span><span class="o">(</span>only<span class="w"> </span><span class="m">1</span><span class="w"> </span>card<span class="w"> </span>renders<span class="w"> </span>-<span class="w"> </span><span class="s2">&quot;Product 10&quot;</span><span class="w"> </span>matches<span class="w"> </span><span class="s2">&quot;Pro&quot;</span><span class="o">)</span>
</code></pre></div>

<p><strong>Expected vs. Actual Improvement</strong>:</p>
<p><strong>React DevTools Profiler</strong>:
- First keystroke ("P"): 1,247ms (all 50 cards render)
- Second keystroke ("r"): 287ms (only 10 cards render)
- Third keystroke ("o"): 45ms (only 1 card renders)
- Improvement: 77-96% faster after first keystroke</p>
<p><strong>Chrome Performance Tab</strong>:
- Main thread blocked: 45ms (vs. 1,247ms before)
- JavaScript execution: 32ms (vs. 1,201ms before)
- Improvement: 96% reduction in main thread blocking</p>
<p><strong>Why it works now</strong>:
1. <code>allProducts</code> array created once, stable references
2. Product objects inside array have stable references
3. When filtering, we return the SAME product objects
4. <code>React.memo</code> compares product objects by reference
5. Only cards with different product objects re-render</p>
<h3 id="iteration-5-optimizing-the-expensive-rendering">Iteration 5: Optimizing the Expensive Rendering</h3>
<p>Even with memoization, each <code>ProductCard</code> takes 23ms to render. Let's optimize the rendering logic.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/ProductDashboard.tsx (updated)</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">memo</span><span class="p">,</span><span class="w"> </span><span class="nx">useMemo</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="c1">// ... (interfaces, filterProducts unchanged)</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">ProductCard</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">memo</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductCard</span><span class="p">({</span><span class="w"> </span><span class="nx">product</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">product</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üé® Rendering ProductCard:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// ‚ùå REMOVED: Expensive simulation</span>
<span class="w">  </span><span class="c1">// let sum = 0;</span>
<span class="w">  </span><span class="c1">// for (let i = 0; i &lt; 100000; i++) {</span>
<span class="w">  </span><span class="c1">//   sum += Math.random();</span>
<span class="w">  </span><span class="c1">// }</span>

<span class="w">  </span><span class="c1">// ‚úì OPTIMIZED: Memoize expensive calculations</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">formattedRevenue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// If this were actually expensive...</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">product</span><span class="p">.</span><span class="nx">revenue</span><span class="p">.</span><span class="nx">toLocaleString</span><span class="p">();</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">product</span><span class="p">.</span><span class="nx">revenue</span><span class="p">]);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;product-card&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;{</span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="p">}&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;{</span><span class="nx">product</span><span class="p">.</span><span class="nx">category</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Sales</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">sales</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">$</span><span class="p">{</span><span class="nx">formattedRevenue</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;{</span><span class="nx">product</span><span class="p">.</span><span class="nx">description</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// ... (ProductList, ProductDashboard unchanged)</span>
</code></pre></div>

<p><strong>Expected vs. Actual Improvement</strong>:</p>
<p><strong>React DevTools Profiler</strong>:
- First keystroke: 156ms (vs. 1,247ms before optimization)
- Subsequent keystrokes: 12-45ms
- Improvement: 87-99% faster</p>
<p><strong>Chrome Performance Tab</strong>:
- Main thread blocked: 12ms (vs. 1,247ms before)
- JavaScript execution: 8ms (vs. 1,201ms before)
- Improvement: 99% reduction</p>
<p><strong>Lighthouse Score</strong>:
- Before: 62/100
- After: 94/100
- TTI: 0.8s (vs. 4.2s before)
- TBT: 45ms (vs. 890ms before)</p>
<h2 id="real-world-performance-patterns">Real-World Performance Patterns</h2>
<h3 id="pattern-1-virtualization-for-long-lists">Pattern 1: Virtualization for Long Lists</h3>
<p>When rendering 1000+ items, even optimized components are slow. Solution: only render visible items.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Install react-window</span>
<span class="c1">// npm install react-window</span>

<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">FixedSizeList</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react-window&#39;</span><span class="p">;</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">VirtualizedProductList</span><span class="p">({</span><span class="w"> </span><span class="nx">products</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">products</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="p">[]</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">Row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">({</span><span class="w"> </span><span class="nx">index</span><span class="p">,</span><span class="w"> </span><span class="nx">style</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">index</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="nx">style</span><span class="o">:</span><span class="w"> </span><span class="kt">React.CSSProperties</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">style</span><span class="o">=</span><span class="p">{</span><span class="nx">style</span><span class="p">}&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">ProductCard</span><span class="w"> </span><span class="na">product</span><span class="o">=</span><span class="p">{</span><span class="nx">products</span><span class="p">[</span><span class="nx">index</span><span class="p">]}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">FixedSizeList</span>
<span class="w">      </span><span class="na">height</span><span class="o">=</span><span class="p">{</span><span class="mf">600</span><span class="p">}</span>
<span class="w">      </span><span class="na">itemCount</span><span class="o">=</span><span class="p">{</span><span class="nx">products</span><span class="p">.</span><span class="nx">length</span><span class="p">}</span>
<span class="w">      </span><span class="na">itemSize</span><span class="o">=</span><span class="p">{</span><span class="mf">120</span><span class="p">}</span>
<span class="w">      </span><span class="na">width</span><span class="o">=</span><span class="s">&quot;100%&quot;</span>
<span class="w">    </span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">Row</span><span class="p">}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">FixedSizeList</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Performance Impact</strong>:
- Before: Render 1000 items = 23 seconds
- After: Render ~10 visible items = 230ms
- Improvement: 99% faster</p>
<h3 id="pattern-2-debouncing-expensive-operations">Pattern 2: Debouncing Expensive Operations</h3>
<p>Don't run expensive operations on every keystroke. Wait for user to stop typing.</p>
<div class="codehilite"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">,</span><span class="w"> </span><span class="nx">useEffect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">useDebounce</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">&gt;(</span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kt">T</span><span class="p">,</span><span class="w"> </span><span class="nx">delay</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">T</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">debouncedValue</span><span class="p">,</span><span class="w"> </span><span class="nx">setDebouncedValue</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>

<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">timer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">setTimeout</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">setDebouncedValue</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="nx">delay</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">timer</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">value</span><span class="p">,</span><span class="w"> </span><span class="nx">delay</span><span class="p">]);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">debouncedValue</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductDashboard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">searchTerm</span><span class="p">,</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">debouncedSearchTerm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useDebounce</span><span class="p">(</span><span class="nx">searchTerm</span><span class="p">,</span><span class="w"> </span><span class="mf">300</span><span class="p">);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">allProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span>
<span class="w">    </span><span class="nb">Array</span><span class="p">.</span><span class="kr">from</span><span class="p">({</span><span class="w"> </span><span class="nx">length</span><span class="o">:</span><span class="w"> </span><span class="kt">50</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">(</span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
<span class="w">      </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">i</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
<span class="w">      </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="sb">`Product </span><span class="si">${</span><span class="nx">i</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
<span class="w">      </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;electronics&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;furniture&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;appliances&#39;</span><span class="p">][</span><span class="nx">i</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mf">3</span><span class="p">],</span>
<span class="w">      </span><span class="nx">sales</span><span class="o">:</span><span class="w"> </span><span class="kt">Math.floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1000</span><span class="p">),</span>
<span class="w">      </span><span class="nx">revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">Math.floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">100000</span><span class="p">),</span>
<span class="w">      </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="sb">`Description for product </span><span class="si">${</span><span class="nx">i</span><span class="si">}</span><span class="sb">. This is a great product with many features.`</span><span class="p">,</span>
<span class="w">    </span><span class="p">}))</span>
<span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">  </span><span class="c1">// Filter using debounced value</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filteredProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;üîÑ Filtering products...&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">filterProducts</span><span class="p">(</span><span class="nx">allProducts</span><span class="p">,</span><span class="w"> </span><span class="nx">debouncedSearchTerm</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">allProducts</span><span class="p">,</span><span class="w"> </span><span class="nx">debouncedSearchTerm</span><span class="p">]);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;dashboard&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Product</span><span class="w"> </span><span class="nx">Dashboard</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">        </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">        </span><span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Search products...&quot;</span>
<span class="w">        </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">searchTerm</span><span class="p">}</span>
<span class="w">        </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">      </span><span class="p">/&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Searching</span><span class="w"> </span><span class="k">for</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">debouncedSearchTerm</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;(all products)&#39;</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">ProductList</span><span class="w"> </span><span class="na">products</span><span class="o">=</span><span class="p">{</span><span class="nx">filteredProducts</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Performance Impact</strong>:
- Before: Filter on every keystroke (9 filters for "Product 1")
- After: Filter once after user stops typing (1 filter)
- Improvement: 89% fewer expensive operations</p>
<p><strong>User Experience</strong>:
- Input updates immediately (instant feedback)
- Results update after 300ms pause
- Feels responsive while reducing work</p>
<h3 id="pattern-3-web-workers-for-heavy-computation">Pattern 3: Web Workers for Heavy Computation</h3>
<p>Move expensive calculations off the main thread.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/workers/filter.worker.ts</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Product</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types&#39;</span><span class="p">;</span>

<span class="nx">self</span><span class="p">.</span><span class="nx">onmessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="o">:</span><span class="w"> </span><span class="kt">MessageEvent</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">products</span><span class="p">,</span><span class="w"> </span><span class="nx">searchTerm</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Expensive filtering logic runs in worker thread</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filtered</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">products</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">p</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span>
<span class="w">    </span><span class="nx">p</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">includes</span><span class="p">(</span><span class="nx">searchTerm</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">())</span><span class="w"> </span><span class="o">||</span>
<span class="w">    </span><span class="nx">p</span><span class="p">.</span><span class="nx">description</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">includes</span><span class="p">(</span><span class="nx">searchTerm</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">())</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="nx">self</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">(</span><span class="nx">filtered</span><span class="p">);</span>
<span class="p">};</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/ProductDashboard.tsx</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useEffect</span><span class="p">,</span><span class="w"> </span><span class="nx">useMemo</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductDashboard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">searchTerm</span><span class="p">,</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">filteredProducts</span><span class="p">,</span><span class="w"> </span><span class="nx">setFilteredProducts</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">Product</span><span class="err">[]</span><span class="p">&gt;([]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">allProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span>
<span class="w">    </span><span class="nb">Array</span><span class="p">.</span><span class="kr">from</span><span class="p">({</span><span class="w"> </span><span class="nx">length</span><span class="o">:</span><span class="w"> </span><span class="kt">50</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">(</span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
<span class="w">      </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">i</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
<span class="w">      </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="sb">`Product </span><span class="si">${</span><span class="nx">i</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
<span class="w">      </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;electronics&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;furniture&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;appliances&#39;</span><span class="p">][</span><span class="nx">i</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mf">3</span><span class="p">],</span>
<span class="w">      </span><span class="nx">sales</span><span class="o">:</span><span class="w"> </span><span class="kt">Math.floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1000</span><span class="p">),</span>
<span class="w">      </span><span class="nx">revenue</span><span class="o">:</span><span class="w"> </span><span class="kt">Math.floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">100000</span><span class="p">),</span>
<span class="w">      </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="sb">`Description for product </span><span class="si">${</span><span class="nx">i</span><span class="si">}</span><span class="sb">. This is a great product with many features.`</span><span class="p">,</span>
<span class="w">    </span><span class="p">}))</span>
<span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">worker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Worker</span><span class="p">(</span>
<span class="w">      </span><span class="ow">new</span><span class="w"> </span><span class="nx">URL</span><span class="p">(</span><span class="s1">&#39;../workers/filter.worker.ts&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">url</span><span class="p">),</span>
<span class="w">      </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;module&#39;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="nx">worker</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">({</span><span class="w"> </span><span class="nx">products</span><span class="o">:</span><span class="w"> </span><span class="kt">allProducts</span><span class="p">,</span><span class="w"> </span><span class="nx">searchTerm</span><span class="w"> </span><span class="p">});</span>

<span class="w">    </span><span class="nx">worker</span><span class="p">.</span><span class="nx">onmessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="o">:</span><span class="w"> </span><span class="kt">MessageEvent</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">setFilteredProducts</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">worker</span><span class="p">.</span><span class="nx">terminate</span><span class="p">();</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">allProducts</span><span class="p">,</span><span class="w"> </span><span class="nx">searchTerm</span><span class="p">]);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;dashboard&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Product</span><span class="w"> </span><span class="nx">Dashboard</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">        </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">        </span><span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Search products...&quot;</span>
<span class="w">        </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">searchTerm</span><span class="p">}</span>
<span class="w">        </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSearchTerm</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">      </span><span class="p">/&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">ProductList</span><span class="w"> </span><span class="na">products</span><span class="o">=</span><span class="p">{</span><span class="nx">filteredProducts</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Performance Impact</strong>:
- Main thread: No longer blocked by filtering
- UI remains responsive during expensive operations
- Filtering happens in parallel with rendering</p>
<p><strong>Trade-offs</strong>:
- Setup complexity (worker files, message passing)
- Communication overhead (serializing data)
- Only worth it for truly expensive operations (&gt;50ms)</p>
<h2 id="common-performance-anti-patterns">Common Performance Anti-Patterns</h2>
<h3 id="anti-pattern-1-premature-optimization">Anti-pattern 1: Premature Optimization</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// ‚ùå WRONG: Optimizing before measuring</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">MyComponent</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">value1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">b</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">]);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">value2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">c</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">d</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="nx">c</span><span class="p">,</span><span class="w"> </span><span class="nx">d</span><span class="p">]);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">value3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">e</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">f</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="nx">e</span><span class="p">,</span><span class="w"> </span><span class="nx">f</span><span class="p">]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;clicked&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleClick</span><span class="p">}&gt;{</span><span class="nx">value1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">value2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">value3</span><span class="p">}&lt;/</span><span class="nt">div</span><span class="p">&gt;;</span>
<span class="p">}</span>

<span class="c1">// ‚úì CORRECT: Optimize only proven bottlenecks</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">MyComponent</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">value1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">b</span><span class="p">;</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">value2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">c</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">d</span><span class="p">;</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">value3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">e</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">f</span><span class="p">;</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;clicked&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleClick</span><span class="p">}&gt;{</span><span class="nx">value1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">value2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">value3</span><span class="p">}&lt;/</span><span class="nt">div</span><span class="p">&gt;;</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="anti-pattern-2-optimizing-the-wrong-thing">Anti-pattern 2: Optimizing the Wrong Thing</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// ‚ùå WRONG: Optimizing cheap operations</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">sortedItems</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">items</span><span class="p">.</span><span class="nx">sort</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">a</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
<span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">items</span><span class="p">]);</span><span class="w"> </span><span class="c1">// Sorting 5 items is cheap, useMemo overhead not worth it</span>

<span class="c1">// ‚úì CORRECT: Optimize expensive operations</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">sortedItems</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">items</span><span class="p">.</span><span class="nx">sort</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Complex sorting logic with multiple comparisons</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">expensiveCompare</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">);</span>
<span class="w">  </span><span class="p">});</span>
<span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">items</span><span class="p">]);</span><span class="w"> </span><span class="c1">// Expensive comparison, useMemo helps</span>
</code></pre></div>

<h3 id="anti-pattern-3-creating-new-objects-in-render">Anti-pattern 3: Creating New Objects in Render</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// ‚ùå WRONG: New object on every render</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">MyComponent</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">ChildComponent</span><span class="w"> </span><span class="na">config</span><span class="o">=</span><span class="p">{{</span><span class="w"> </span><span class="nx">theme</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;dark&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;large&#39;</span><span class="w"> </span><span class="p">}}</span><span class="w"> </span><span class="p">/&gt;;</span>
<span class="p">}</span>

<span class="c1">// ‚úì CORRECT: Stable object reference</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">CONFIG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">theme</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;dark&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;large&#39;</span><span class="w"> </span><span class="p">};</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">MyComponent</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">ChildComponent</span><span class="w"> </span><span class="na">config</span><span class="o">=</span><span class="p">{</span><span class="nx">CONFIG</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;;</span>
<span class="p">}</span>

<span class="c1">// ‚úì ALSO CORRECT: Memoize if config depends on props/state</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">MyComponent</span><span class="p">({</span><span class="w"> </span><span class="nx">theme</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span><span class="w"> </span><span class="nx">theme</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="w"> </span><span class="p">}),</span><span class="w"> </span><span class="p">[</span><span class="nx">theme</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="p">]);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">ChildComponent</span><span class="w"> </span><span class="na">config</span><span class="o">=</span><span class="p">{</span><span class="nx">config</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;;</span>
<span class="p">}</span>
</code></pre></div>

<h2 id="performance-optimization-checklist">Performance Optimization Checklist</h2>
<p><strong>Before optimizing</strong>:
- [ ] Profile with React DevTools Profiler
- [ ] Profile with Chrome Performance tab
- [ ] Run Lighthouse audit
- [ ] Identify the actual bottleneck (don't guess)
- [ ] Measure baseline performance</p>
<p><strong>Optimization strategies</strong> (in order of impact):
1. [ ] Code splitting (route-based, component-based)
2. [ ] Memoize expensive calculations (useMemo)
3. [ ] Memoize expensive components (React.memo)
4. [ ] Virtualize long lists (react-window)
5. [ ] Debounce expensive operations
6. [ ] Optimize expensive rendering logic
7. [ ] Use Web Workers for heavy computation</p>
<p><strong>After optimizing</strong>:
- [ ] Profile again to measure improvement
- [ ] Verify user experience improved
- [ ] Check for regressions (new bugs)
- [ ] Document why optimization was needed</p>
<p><strong>Limitation preview</strong>: We've learned to identify and fix performance bottlenecks, but we need a systematic decision framework. When should we optimize? What technique should we use? Let's create a flowchart.</p>
<h2 id="the-performance-optimization-flowchart">The performance optimization flowchart</h2>
<h2 id="the-performance-optimization-decision-framework">The Performance Optimization Decision Framework</h2>
<p>Performance optimization is not about applying every technique everywhere. It's about making informed decisions based on measurement and trade-offs.</p>
<h3 id="step-1-should-you-optimize">Step 1: Should You Optimize?</h3>
<p><strong>Start here</strong>: Is there a performance problem?</p>
<p><strong>Measure first</strong>:
- Run Lighthouse audit
- Profile with React DevTools
- Profile with Chrome Performance tab
- Get real user metrics (if in production)</p>
<p><strong>Decision criteria</strong>:</p>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Good</th>
<th>Needs Improvement</th>
<th>Poor</th>
</tr>
</thead>
<tbody>
<tr>
<td>Lighthouse Score</td>
<td>90-100</td>
<td>50-89</td>
<td>0-49</td>
</tr>
<tr>
<td>Time to Interactive (TTI)</td>
<td>&lt;3.8s</td>
<td>3.8-7.3s</td>
<td>&gt;7.3s</td>
</tr>
<tr>
<td>Total Blocking Time (TBT)</td>
<td>&lt;200ms</td>
<td>200-600ms</td>
<td>&gt;600ms</td>
</tr>
<tr>
<td>First Contentful Paint (FCP)</td>
<td>&lt;1.8s</td>
<td>1.8-3.0s</td>
<td>&gt;3.0s</td>
</tr>
<tr>
<td>Largest Contentful Paint (LCP)</td>
<td>&lt;2.5s</td>
<td>2.5-4.0s</td>
<td>&gt;4.0s</td>
</tr>
</tbody>
</table>
<p><strong>If metrics are "Good"</strong>: Don't optimize. Focus on features.</p>
<p><strong>If metrics are "Needs Improvement" or "Poor"</strong>: Continue to Step 2.</p>
<h3 id="step-2-whats-the-bottleneck">Step 2: What's the Bottleneck?</h3>
<p>Use profiling tools to identify the actual problem.</p>
<p><strong>React DevTools Profiler</strong> reveals:
- Which components are slow to render
- Which components render unnecessarily
- Why components rendered (props changed, state changed, parent rendered)</p>
<p><strong>Chrome Performance Tab</strong> reveals:
- JavaScript execution time
- Layout and paint operations
- Network activity
- Main thread blocking</p>
<p><strong>Bundle Analyzer</strong> reveals:
- Large dependencies
- Duplicate code
- Unused code</p>
<p><strong>Common bottlenecks</strong>:</p>
<table>
<thead>
<tr>
<th>Symptom</th>
<th>Likely Cause</th>
<th>Tool to Confirm</th>
</tr>
</thead>
<tbody>
<tr>
<td>Slow initial load</td>
<td>Large bundle size</td>
<td>Bundle analyzer, Network tab</td>
</tr>
<tr>
<td>Slow page transitions</td>
<td>No code splitting</td>
<td>Bundle analyzer, Network tab</td>
</tr>
<tr>
<td>Laggy interactions</td>
<td>Expensive renders</td>
<td>React Profiler, Performance tab</td>
</tr>
<tr>
<td>Unresponsive UI</td>
<td>Main thread blocked</td>
<td>Performance tab</td>
</tr>
<tr>
<td>Slow data fetching</td>
<td>Network waterfall</td>
<td>Network tab</td>
</tr>
<tr>
<td>Memory leaks</td>
<td>Unmounted components</td>
<td>Memory profiler</td>
</tr>
</tbody>
</table>
<h3 id="step-3-choose-the-right-optimization">Step 3: Choose the Right Optimization</h3>
<p>Based on the bottleneck, choose the appropriate technique.</p>
<h2 id="the-optimization-flowchart">The Optimization Flowchart</h2>
<div class="codehilite"><pre><span></span><code>‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ<span class="w"> </span><span class="nv">Is</span><span class="w"> </span><span class="nv">there</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">performance</span><span class="w"> </span><span class="nv">problem</span>?<span class="w">     </span>‚îÇ
‚îÇ<span class="w"> </span><span class="ss">(</span><span class="nv">Measure</span><span class="w"> </span><span class="nv">with</span><span class="w"> </span><span class="nv">Lighthouse</span><span class="o">/</span><span class="nv">Profiler</span><span class="ss">)</span><span class="w">  </span>‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
<span class="w">              </span>‚îÇ
<span class="w">              </span>‚îú‚îÄ<span class="w"> </span><span class="nv">No</span><span class="w"> </span>‚Üí<span class="w"> </span><span class="nv">Don</span><span class="err">&#39;t optimize</span>
<span class="err">              ‚îÇ</span>
<span class="err">              ‚îî‚îÄ Yes</span>
<span class="err">                 ‚îÇ</span>
<span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>
‚îÇ<span class="w"> </span><span class="nv">What</span><span class="err">&#39;s the bottleneck?              ‚îÇ</span>
<span class="err">‚îÇ (Profile to identify)               ‚îÇ</span>
<span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>
<span class="err">              ‚îÇ</span>
<span class="err">              ‚îú‚îÄ Large bundle size</span>
<span class="err">              ‚îÇ  ‚îÇ</span>
<span class="err">              ‚îÇ  ‚îî‚îÄ Is it route-specific code?</span>
<span class="err">              ‚îÇ     ‚îú‚îÄ Yes ‚Üí Route-based code splitting</span>
<span class="err">              ‚îÇ     ‚îî‚îÄ No ‚Üí Is it a heavy component?</span>
<span class="err">              ‚îÇ        ‚îú‚îÄ Yes ‚Üí Component-based code splitting</span>
<span class="err">              ‚îÇ        ‚îî‚îÄ No ‚Üí Vendor code splitting</span>
<span class="err">              ‚îÇ</span>
<span class="err">              ‚îú‚îÄ Slow component renders</span>
<span class="err">              ‚îÇ  ‚îÇ</span>
<span class="err">              ‚îÇ  ‚îî‚îÄ Are components rendering unnecessarily?</span>
<span class="err">              ‚îÇ     ‚îú‚îÄ Yes ‚Üí Are props changing?</span>
<span class="err">              ‚îÇ     ‚îÇ  ‚îú‚îÄ Yes ‚Üí useMemo to stabilize props</span>
<span class="err">              ‚îÇ     ‚îÇ  ‚îî‚îÄ No ‚Üí React.memo to skip renders</span>
<span class="err">              ‚îÇ     ‚îî‚îÄ No ‚Üí Is rendering logic expensive?</span>
<span class="err">              ‚îÇ        ‚îú‚îÄ Yes ‚Üí useMemo for calculations</span>
<span class="err">              ‚îÇ        ‚îî‚îÄ No ‚Üí Optimize rendering logic</span>
<span class="err">              ‚îÇ</span>
<span class="err">              ‚îú‚îÄ Long lists (1000+ items)</span>
<span class="err">              ‚îÇ  ‚îÇ</span>
<span class="err">              ‚îÇ  ‚îî‚îÄ Virtualization (react-window)</span>
<span class="err">              ‚îÇ</span>
<span class="err">              ‚îú‚îÄ Expensive operations on every keystroke</span>
<span class="err">              ‚îÇ  ‚îÇ</span>
<span class="err">              ‚îÇ  ‚îî‚îÄ Debouncing</span>
<span class="err">              ‚îÇ</span>
<span class="err">              ‚îú‚îÄ Heavy computation blocking UI</span>
<span class="err">              ‚îÇ  ‚îÇ</span>
<span class="err">              ‚îÇ  ‚îî‚îÄ Web Workers</span>
<span class="err">              ‚îÇ</span>
<span class="err">              ‚îî‚îÄ Slow data fetching</span>
<span class="err">                 ‚îÇ</span>
<span class="err">                 ‚îî‚îÄ See Chapter 13 (React Query)</span>
</code></pre></div>

<h2 id="decision-matrix-which-technique-when">Decision Matrix: Which Technique When?</h2>
<h3 id="bundle-size-optimization">Bundle Size Optimization</h3>
<table>
<thead>
<tr>
<th>Scenario</th>
<th>Technique</th>
<th>When to Use</th>
<th>Impact</th>
<th>Complexity</th>
</tr>
</thead>
<tbody>
<tr>
<td>Large initial bundle</td>
<td>Route-based splitting</td>
<td>Always</td>
<td>High</td>
<td>Low</td>
</tr>
<tr>
<td>Heavy component</td>
<td>Component-based splitting</td>
<td>Component &gt;50 kB</td>
<td>Medium</td>
<td>Low</td>
</tr>
<tr>
<td>Large dependencies</td>
<td>Vendor splitting</td>
<td>Dependencies &gt;100 kB</td>
<td>Medium</td>
<td>Low</td>
</tr>
<tr>
<td>Unused code</td>
<td>Tree shaking</td>
<td>Always (automatic)</td>
<td>Medium</td>
<td>None</td>
</tr>
</tbody>
</table>
<h3 id="render-optimization">Render Optimization</h3>
<table>
<thead>
<tr>
<th>Scenario</th>
<th>Technique</th>
<th>When to Use</th>
<th>Impact</th>
<th>Complexity</th>
</tr>
</thead>
<tbody>
<tr>
<td>Unnecessary re-renders</td>
<td>React.memo</td>
<td>Expensive component, stable props</td>
<td>High</td>
<td>Low</td>
</tr>
<tr>
<td>Expensive calculations</td>
<td>useMemo</td>
<td>Calculation &gt;10ms</td>
<td>High</td>
<td>Low</td>
</tr>
<tr>
<td>Function props</td>
<td>useCallback</td>
<td>Passed to memoized child</td>
<td>Medium</td>
<td>Low</td>
</tr>
<tr>
<td>Long lists</td>
<td>Virtualization</td>
<td>1000+ items</td>
<td>Very High</td>
<td>Medium</td>
</tr>
<tr>
<td>Expensive operations</td>
<td>Debouncing</td>
<td>User input triggers expensive work</td>
<td>High</td>
<td>Low</td>
</tr>
<tr>
<td>Heavy computation</td>
<td>Web Workers</td>
<td>Computation &gt;50ms</td>
<td>High</td>
<td>High</td>
</tr>
</tbody>
</table>
<h3 id="trade-off-analysis">Trade-off Analysis</h3>
<p><strong>React.memo</strong>:
- ‚úÖ Prevents unnecessary renders
- ‚úÖ Low complexity
- ‚ùå Adds memory overhead
- ‚ùå Requires stable props
- <strong>Use when</strong>: Component is expensive AND props are stable</p>
<p><strong>useMemo</strong>:
- ‚úÖ Caches expensive calculations
- ‚úÖ Stabilizes references
- ‚ùå Adds memory overhead
- ‚ùå Requires correct dependencies
- <strong>Use when</strong>: Calculation is expensive OR result used in dependencies</p>
<p><strong>useCallback</strong>:
- ‚úÖ Stabilizes function references
- ‚úÖ Enables React.memo optimization
- ‚ùå Adds memory overhead
- ‚ùå Requires correct dependencies
- <strong>Use when</strong>: Function passed to memoized child</p>
<p><strong>Code splitting</strong>:
- ‚úÖ Reduces initial bundle
- ‚úÖ Improves TTI
- ‚ùå Adds loading states
- ‚ùå More network requests
- <strong>Use when</strong>: Code not needed immediately</p>
<p><strong>Virtualization</strong>:
- ‚úÖ Handles massive lists
- ‚úÖ Constant performance
- ‚ùå Complex setup
- ‚ùå Accessibility challenges
- <strong>Use when</strong>: Rendering 1000+ items</p>
<p><strong>Debouncing</strong>:
- ‚úÖ Reduces expensive operations
- ‚úÖ Simple to implement
- ‚ùå Delayed feedback
- ‚ùå Requires tuning delay
- <strong>Use when</strong>: Expensive operation triggered by user input</p>
<p><strong>Web Workers</strong>:
- ‚úÖ Doesn't block main thread
- ‚úÖ Parallel computation
- ‚ùå Complex setup
- ‚ùå Communication overhead
- <strong>Use when</strong>: Computation &gt;50ms AND can be parallelized</p>
<h2 id="the-complete-journey-from-slow-to-fast">The Complete Journey: From Slow to Fast</h2>
<p>Let's trace our dashboard's evolution through all optimizations.</p>
<h3 id="iteration-0-naive-implementation">Iteration 0: Naive Implementation</h3>
<p><strong>Characteristics</strong>:
- No memoization
- No code splitting
- Expensive rendering logic
- All code in main bundle</p>
<p><strong>Performance</strong>:
- Bundle size: 2,081 kB
- TTI: 4.2s
- Keystroke lag: 1,247ms
- Lighthouse score: 62/100</p>
<h3 id="iteration-1-route-based-code-splitting">Iteration 1: Route-Based Code Splitting</h3>
<p><strong>Changes</strong>:
- Split admin panel and analytics into separate chunks
- Lazy load with React.lazy and Suspense</p>
<p><strong>Performance</strong>:
- Bundle size: 1,512 kB (27% smaller)
- TTI: 2.8s (33% faster)
- Keystroke lag: 1,247ms (unchanged)
- Lighthouse score: 78/100</p>
<p><strong>Lesson</strong>: Code splitting improves initial load, not runtime performance.</p>
<h3 id="iteration-2-component-memoization">Iteration 2: Component Memoization</h3>
<p><strong>Changes</strong>:
- Wrapped ProductCard with React.memo
- Memoized filteredProducts with useMemo
- Stabilized product object references</p>
<p><strong>Performance</strong>:
- Bundle size: 1,512 kB (unchanged)
- TTI: 2.8s (unchanged)
- Keystroke lag: 45ms (96% faster)
- Lighthouse score: 85/100</p>
<p><strong>Lesson</strong>: Memoization improves runtime performance, not initial load.</p>
<h3 id="iteration-3-optimized-rendering-logic">Iteration 3: Optimized Rendering Logic</h3>
<p><strong>Changes</strong>:
- Removed expensive simulation code
- Memoized expensive calculations within components</p>
<p><strong>Performance</strong>:
- Bundle size: 1,512 kB (unchanged)
- TTI: 2.8s (unchanged)
- Keystroke lag: 12ms (99% faster)
- Lighthouse score: 94/100</p>
<p><strong>Lesson</strong>: Optimizing the actual work is more effective than caching.</p>
<h3 id="iteration-4-debouncing">Iteration 4: Debouncing</h3>
<p><strong>Changes</strong>:
- Debounced search input (300ms delay)
- Reduced number of filter operations</p>
<p><strong>Performance</strong>:
- Bundle size: 1,512 kB (unchanged)
- TTI: 2.8s (unchanged)
- Keystroke lag: 0ms (instant input feedback)
- Filter operations: 1 (vs. 9 before)
- Lighthouse score: 94/100</p>
<p><strong>Lesson</strong>: Debouncing improves perceived performance and reduces work.</p>
<h3 id="final-implementation-production-ready">Final Implementation: Production-Ready</h3>
<p><strong>All optimizations applied</strong>:
- Route-based code splitting
- Component-based code splitting
- React.memo for expensive components
- useMemo for expensive calculations
- Stable object references
- Optimized rendering logic
- Debounced expensive operations</p>
<p><strong>Final Performance</strong>:
- Bundle size: 1,512 kB (27% smaller than baseline)
- TTI: 2.8s (33% faster than baseline)
- Keystroke lag: 0ms (instant feedback)
- Filter operations: 89% fewer
- Lighthouse score: 94/100 (vs. 62/100 baseline)</p>
<p><strong>Performance Improvement Summary</strong>:</p>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Before</th>
<th>After</th>
<th>Improvement</th>
</tr>
</thead>
<tbody>
<tr>
<td>Bundle size</td>
<td>2,081 kB</td>
<td>1,512 kB</td>
<td>27% smaller</td>
</tr>
<tr>
<td>TTI</td>
<td>4.2s</td>
<td>2.8s</td>
<td>33% faster</td>
</tr>
<tr>
<td>Keystroke lag</td>
<td>1,247ms</td>
<td>0ms</td>
<td>100% faster</td>
</tr>
<tr>
<td>Lighthouse</td>
<td>62/100</td>
<td>94/100</td>
<td>52% better</td>
</tr>
</tbody>
</table>
<h2 id="when-not-to-optimize">When NOT to Optimize</h2>
<p><strong>Don't optimize if</strong>:
- Metrics are already good (Lighthouse &gt;90)
- Component renders &lt;10ms
- Bundle size &lt;500 kB
- Users aren't complaining
- You haven't measured the problem</p>
<p><strong>Don't optimize by</strong>:
- Wrapping every component with React.memo
- Memoizing every calculation with useMemo
- Using useCallback for every function
- Splitting every component into separate chunks
- Applying every technique "just in case"</p>
<p><strong>The Rule</strong>: Measure first, optimize second, measure again.</p>
<h2 id="the-professional-react-developers-performance-mindset">The Professional React Developer's Performance Mindset</h2>
<p><strong>1. Performance is a feature</strong>: Users notice slow apps. Fast apps feel better.</p>
<p><strong>2. Measure, don't guess</strong>: Profiling reveals the truth. Intuition often misleads.</p>
<p><strong>3. Optimize the right thing</strong>: 80% of slowness comes from 20% of code. Find that 20%.</p>
<p><strong>4. Trade-offs exist</strong>: Every optimization has costs. Choose wisely.</p>
<p><strong>5. Premature optimization is evil</strong>: Don't optimize until you have a problem.</p>
<p><strong>6. User experience matters most</strong>: Perceived performance &gt; actual performance.</p>
<p><strong>7. Maintenance matters</strong>: Complex optimizations must be worth the maintenance burden.</p>
<h2 id="the-complete-performance-optimization-checklist">The Complete Performance Optimization Checklist</h2>
<p><strong>Phase 1: Measurement</strong>
- [ ] Run Lighthouse audit
- [ ] Profile with React DevTools Profiler
- [ ] Profile with Chrome Performance tab
- [ ] Analyze bundle with bundle analyzer
- [ ] Identify the actual bottleneck
- [ ] Document baseline metrics</p>
<p><strong>Phase 2: Bundle Optimization</strong>
- [ ] Implement route-based code splitting
- [ ] Implement component-based code splitting for heavy components
- [ ] Configure vendor code splitting
- [ ] Verify tree shaking is working
- [ ] Measure bundle size improvement</p>
<p><strong>Phase 3: Render Optimization</strong>
- [ ] Identify components that render unnecessarily
- [ ] Apply React.memo to expensive components
- [ ] Stabilize props with useMemo
- [ ] Stabilize callbacks with useCallback
- [ ] Optimize expensive rendering logic
- [ ] Measure render time improvement</p>
<p><strong>Phase 4: Interaction Optimization</strong>
- [ ] Identify expensive operations triggered by user input
- [ ] Implement debouncing for expensive operations
- [ ] Consider virtualization for long lists
- [ ] Consider Web Workers for heavy computation
- [ ] Measure interaction responsiveness</p>
<p><strong>Phase 5: Verification</strong>
- [ ] Re-run Lighthouse audit
- [ ] Re-profile with React DevTools
- [ ] Re-profile with Chrome Performance tab
- [ ] Verify user experience improved
- [ ] Check for regressions
- [ ] Document final metrics</p>
<p><strong>Phase 6: Maintenance</strong>
- [ ] Document why optimizations were needed
- [ ] Document trade-offs made
- [ ] Set up performance budgets
- [ ] Monitor performance in production
- [ ] Review optimizations periodically</p>
<h2 id="lessons-learned-the-performance-journey">Lessons Learned: The Performance Journey</h2>
<p><strong>From naive to professional</strong>:</p>
<ol>
<li>
<p><strong>Start simple</strong>: Don't optimize prematurely. Build features first.</p>
</li>
<li>
<p><strong>Measure everything</strong>: You can't improve what you don't measure.</p>
</li>
<li>
<p><strong>Optimize strategically</strong>: Focus on the biggest bottlenecks first.</p>
</li>
<li>
<p><strong>Understand trade-offs</strong>: Every optimization has costs. Choose wisely.</p>
</li>
<li>
<p><strong>Maintain balance</strong>: Code complexity vs. performance gain.</p>
</li>
<li>
<p><strong>Think about users</strong>: Perceived performance matters more than benchmarks.</p>
</li>
<li>
<p><strong>Keep learning</strong>: Performance optimization is a continuous journey.</p>
</li>
</ol>
<p><strong>The ultimate lesson</strong>: Performance optimization is not about applying every technique everywhere. It's about making informed decisions based on measurement, understanding trade-offs, and prioritizing user experience.</p>
        </div>
        <div class="footer">
            Generated on 2025-12-03 12:42:36 | Made with ‚ù§Ô∏è by GitHub Pages Generator
        </div>
    </div>
    <script>
        // Syntax highlighting for code blocks
        document.addEventListener('DOMContentLoaded', (event) => {
            // Highlight code blocks
            document.querySelectorAll('pre code').forEach((block) => {
                hljs.highlightElement(block);
            });
            
            // Add copy buttons to code blocks
            document.querySelectorAll('pre').forEach((pre) => {
                const button = document.createElement('button');
                button.className = 'copy-btn';
                button.textContent = 'Copy';
                
                button.addEventListener('click', () => {
                    const code = pre.querySelector('code').textContent;
                    navigator.clipboard.writeText(code).then(() => {
                        button.textContent = 'Copied!';
                        button.classList.add('copied');
                        setTimeout(() => {
                            button.textContent = 'Copy';
                            button.classList.remove('copied');
                        }, 2000);
                    }).catch(err => {
                        console.error('Failed to copy:', err);
                        button.textContent = 'Error';
                        setTimeout(() => {
                            button.textContent = 'Copy';
                        }, 2000);
                    });
                });
                
                pre.appendChild(button);
            });
        });
    </script>
</body>
</html>