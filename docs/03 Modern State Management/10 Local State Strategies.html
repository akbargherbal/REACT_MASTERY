<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>10 Local State Strategies</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #8b5cf6;
            --bg-main: #0f172a;
            --bg-card: #1e293b;
            --bg-code: #0f172a;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #334155;
            --accent: #06b6d4;
            --success: #10b981;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            line-height: 1.7; 
            color: var(--text-primary); 
            background: var(--bg-main);
        }
        
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 20px; 
        }
        
        .home-btn { 
            position: fixed; 
            top: 20px; 
            right: 20px; 
            background: var(--accent);
            color: white; 
            width: 50px;
            height: 50px;
            border-radius: 50%;
            text-decoration: none; 
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(6, 182, 212, 0.4);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .home-btn:hover { 
            background: #0891b2;
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(6, 182, 212, 0.5);
        }
        
        .breadcrumb { 
            background: var(--bg-card);
            padding: 12px 0; 
            margin-bottom: 24px; 
            font-size: 14px;
            border-radius: 8px;
            border: 1px solid var(--border);
        }
        
        .breadcrumb a { 
            color: var(--accent);
            text-decoration: none;
            transition: color 0.2s;
        }
        
        .breadcrumb a:hover { 
            color: var(--primary);
            text-decoration: underline;
        }
        
        .content { 
            background: var(--bg-card);
            padding: 3rem; 
            border-radius: 16px; 
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border);
        }
        
        .file-list { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); 
            gap: 1.5rem; 
            margin: 2rem 0; 
        }
        
        .file-item { 
            padding: 1.5rem; 
            border: 1px solid var(--border);
            border-radius: 12px; 
            background: var(--bg-main);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .file-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .file-item:hover { 
            transform: translateY(-4px); 
            box-shadow: 0 8px 30px rgba(99, 102, 241, 0.3);
            border-color: var(--primary);
        }
        
        .file-item:hover::before {
            opacity: 1;
        }
        
        .file-item a { 
            color: var(--text-primary);
            text-decoration: none; 
            font-weight: 600; 
            display: block;
            font-size: 1.1rem;
        }
        
        .file-item a:hover { 
            color: var(--primary);
        }
        
        .file-type { 
            font-size: 13px; 
            color: var(--text-secondary);
            margin-top: 8px; 
            font-weight: 500;
        }
        
        /* Code Blocks */
        pre { 
            background: var(--bg-code);
            padding: 1.5rem; 
            border-radius: 12px; 
            overflow-x: auto;
            border: 1px solid var(--border);
            margin: 1.5rem 0;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            position: relative;
        }
        
        pre code { 
            background: none;
            padding: 0;
            font-family: 'Fira Code', 'Consolas', monospace;
            font-size: 0.9em;
            line-height: 1.6;
        }
        
        /* Copy Button */
        .copy-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: var(--primary);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.2s;
            opacity: 0.7;
            z-index: 10;
        }
        
        .copy-btn:hover {
            opacity: 1;
            background: var(--primary-dark);
            transform: translateY(-1px);
        }
        
        .copy-btn.copied {
            background: var(--success);
        }
        
        pre:hover .copy-btn {
            opacity: 1;
        }
        
        /* Inline Code */
        code { 
            background: var(--bg-code);
            color: #8b5cf6;
            padding: 3px 8px; 
            border-radius: 6px; 
            font-size: 1.1em;
            font-family: 'Fira Code', 'Consolas', monospace;
            border: 1px solid var(--border);
        }
        
        /* Headings */
        h1, h2, h3, h4, h5, h6 { 
            color: var(--text-primary);
            margin: 2rem 0 1rem 0;
            font-weight: 700;
            letter-spacing: -0.5px;
        }
        
        h1 { 
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            border-bottom: 3px solid var(--primary);
            padding-bottom: 12px;
            margin-bottom: 1.5rem;
        }
        
        h2 { 
            font-size: 2rem;
            color: var(--primary);
            border-bottom: 2px solid var(--border);
            padding-bottom: 8px;
        }
        
        h3 { 
            font-size: 1.5rem;
            color: var(--accent);
        }
        
        /* Links */
        a { 
            color: var(--accent);
            transition: color 0.2s;
        }
        
        a:hover { 
            color: var(--primary);
        }
        
        /* Paragraphs */
        p {
            margin: 1rem 0;
            color: var(--text-secondary);
        }
        
        /* Lists */
        ul, ol {
            margin: 1rem 0;
            padding-left: 2rem;
            color: var(--text-secondary);
        }
        
        li {
            margin: 0.5rem 0;
        }
        
        /* Tables */
        table { 
            border-collapse: collapse;
            width: 100%;
            margin: 1.5rem 0;
            background: var(--bg-main);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }
        
        th, td { 
            border: 1px solid var(--border);
            padding: 12px 16px;
            text-align: left;
        }
        
        th { 
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            font-weight: 600;
        }
        
        tr:hover {
            background: var(--bg-card);
        }
        
        /* Blockquotes */
        blockquote {
            border-left: 4px solid var(--primary);
            padding: 1rem 1.5rem;
            margin: 1.5rem 0;
            background: var(--bg-main);
            border-radius: 0 8px 8px 0;
            color: var(--text-secondary);
            font-style: italic;
        }
        
        /* Horizontal Rule */
        hr {
            border: none;
            border-top: 2px solid var(--border);
            margin: 2rem 0;
        }
        
        .footer { 
            text-align: center; 
            padding: 2rem; 
            color: var(--text-secondary);
            border-top: 1px solid var(--border);
            margin-top: 3rem; 
            font-size: 14px;
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--bg-main);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 6px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }
        
        @media (max-width: 768px) {
            .container { padding: 10px; }
            .file-list { grid-template-columns: 1fr; }
            .content { padding: 1.5rem; }
            h1 { font-size: 2rem; }
            h2 { font-size: 1.5rem; }
        }
    </style>
</head>
<body>
    <a href="../index.html" class="home-btn">üè†</a>
    <div class="container">
        <div class="breadcrumb">
            <div style="padding: 0 20px;">
                <a href="../index.html">üè† Home</a> <span style="color: #64748b;">/</span> <a href="index.html">03 Modern State Management</a>
            </div>
        </div>
        <div class="content">
            <h1 id="chapter-10-local-state-strategies">Chapter 10: Local State Strategies</h1>
<h2 id="when-usestate-is-enough-most-of-the-time">When useState is enough (most of the time)</h2>
<h2 id="when-usestate-is-enough-most-of-the-time_1">When useState is enough (most of the time)</h2>
<p>Before we dive into complex state management patterns, let's establish a critical truth: <strong>most of your state management problems don't need complex solutions</strong>. The React community has a tendency to reach for sophisticated tools prematurely. We're going to start by understanding when the simplest tool‚Äî<code>useState</code>‚Äîis exactly what you need.</p>
<h3 id="phase-1-the-reference-implementation">Phase 1: The Reference Implementation</h3>
<p>We're building a <strong>Task Board</strong> application‚Äîa realistic, multi-feature UI that will serve as our testing ground for state management patterns throughout this chapter. This isn't a toy example. It's the kind of component you'd build in a real application: multiple pieces of related state, user interactions, and enough complexity to expose the limitations of each approach.</p>
<p><strong>Project Structure</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="nx">src</span><span class="o">/</span>
<span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">components</span><span class="o">/</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">TaskBoard</span><span class="p">.</span><span class="nx">tsx</span><span class="w">          </span><span class="err">‚Üê</span><span class="w"> </span><span class="nx">Our</span><span class="w"> </span><span class="nx">reference</span><span class="w"> </span><span class="nx">implementation</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">TaskList</span><span class="p">.</span><span class="nx">tsx</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">TaskItem</span><span class="p">.</span><span class="nx">tsx</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">TaskForm</span><span class="p">.</span><span class="nx">tsx</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">FilterBar</span><span class="p">.</span><span class="nx">tsx</span>
<span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">types</span><span class="o">/</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">task</span><span class="p">.</span><span class="nx">ts</span>
<span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">App</span><span class="p">.</span><span class="nx">tsx</span>
</code></pre></div>

<p>Let's start with the domain model:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/types/task.ts</span>
<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">TaskStatus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;todo&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;in-progress&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;done&#39;</span><span class="p">;</span>
<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">TaskPriority</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;low&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;medium&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;high&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">Task</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskStatus</span><span class="p">;</span>
<span class="w">  </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskPriority</span><span class="p">;</span>
<span class="w">  </span><span class="nx">assignee</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">createdAt</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dueDate?</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">TaskFilters</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskStatus</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskPriority</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">assignee</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">searchQuery</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p>Now, our initial implementation using only <code>useState</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/TaskBoard.tsx - Version 1: Pure useState</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Task</span><span class="p">,</span><span class="w"> </span><span class="nx">TaskFilters</span><span class="p">,</span><span class="w"> </span><span class="nx">TaskStatus</span><span class="p">,</span><span class="w"> </span><span class="nx">TaskPriority</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/task&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskList</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./TaskList&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskForm</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./TaskForm&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">FilterBar</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./FilterBar&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TaskBoard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// State: Each piece of data gets its own useState</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">tasks</span><span class="p">,</span><span class="w"> </span><span class="nx">setTasks</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">Task</span><span class="err">[]</span><span class="p">&gt;([</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Implement user authentication&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Add JWT-based auth flow&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;in-progress&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;high&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">assignee</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">createdAt</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="s1">&#39;2024-01-15&#39;</span><span class="p">),</span>
<span class="w">      </span><span class="nx">dueDate</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="s1">&#39;2024-02-01&#39;</span><span class="p">),</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Write API documentation&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Document all REST endpoints&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;todo&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;medium&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">assignee</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">createdAt</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="s1">&#39;2024-01-16&#39;</span><span class="p">),</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Fix mobile responsive issues&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Dashboard breaks on small screens&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;done&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;high&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">assignee</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">createdAt</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="s1">&#39;2024-01-10&#39;</span><span class="p">),</span>
<span class="w">      </span><span class="nx">dueDate</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="s1">&#39;2024-01-20&#39;</span><span class="p">),</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">  </span><span class="p">]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">filters</span><span class="p">,</span><span class="w"> </span><span class="nx">setFilters</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">TaskFilters</span><span class="p">&gt;({</span>
<span class="w">    </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">assignee</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">searchQuery</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">isFormOpen</span><span class="p">,</span><span class="w"> </span><span class="nx">setIsFormOpen</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">editingTask</span><span class="p">,</span><span class="w"> </span><span class="nx">setEditingTask</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">Task</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="na">null</span><span class="p">&gt;(</span><span class="kc">null</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Derived state: filtered tasks</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filteredTasks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">tasks</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">task</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">filters</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">task</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">filters</span><span class="p">.</span><span class="nx">status</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">filters</span><span class="p">.</span><span class="nx">priority</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">task</span><span class="p">.</span><span class="nx">priority</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">filters</span><span class="p">.</span><span class="nx">priority</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">filters</span><span class="p">.</span><span class="nx">assignee</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">task</span><span class="p">.</span><span class="nx">assignee</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">filters</span><span class="p">.</span><span class="nx">assignee</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">filters</span><span class="p">.</span><span class="nx">searchQuery</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">filters</span><span class="p">.</span><span class="nx">searchQuery</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="nx">task</span><span class="p">.</span><span class="nx">title</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">includes</span><span class="p">(</span><span class="nx">query</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
<span class="w">        </span><span class="nx">task</span><span class="p">.</span><span class="nx">description</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">includes</span><span class="p">(</span><span class="nx">query</span><span class="p">)</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="c1">// Actions: Functions that modify state</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">addTask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">taskData</span><span class="o">:</span><span class="w"> </span><span class="kt">Omit</span><span class="p">&lt;</span><span class="nt">Task</span><span class="err">,</span><span class="w"> </span><span class="err">&#39;</span><span class="na">id</span><span class="err">&#39;</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="err">&#39;</span><span class="na">createdAt</span><span class="err">&#39;</span><span class="p">&gt;)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">newTask</span><span class="o">:</span><span class="w"> </span><span class="kt">Task</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="p">...</span><span class="nx">taskData</span><span class="p">,</span>
<span class="w">      </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">crypto.randomUUID</span><span class="p">(),</span>
<span class="w">      </span><span class="nx">createdAt</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(),</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="nx">setTasks</span><span class="p">((</span><span class="nx">prev</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[...</span><span class="nx">prev</span><span class="p">,</span><span class="w"> </span><span class="nx">newTask</span><span class="p">]);</span>
<span class="w">    </span><span class="nx">setIsFormOpen</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">updateTask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">taskId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">updates</span><span class="o">:</span><span class="w"> </span><span class="kt">Partial</span><span class="p">&lt;</span><span class="nt">Task</span><span class="p">&gt;)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setTasks</span><span class="p">((</span><span class="nx">prev</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span>
<span class="w">      </span><span class="nx">prev</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">task</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span>
<span class="w">        </span><span class="nx">task</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">taskId</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="nx">task</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="nx">updates</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">task</span>
<span class="w">      </span><span class="p">)</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">    </span><span class="nx">setEditingTask</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
<span class="w">    </span><span class="nx">setIsFormOpen</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">deleteTask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">taskId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setTasks</span><span class="p">((</span><span class="nx">prev</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">prev</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">task</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">task</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">taskId</span><span class="p">));</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">updateTaskStatus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">taskId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskStatus</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setTasks</span><span class="p">((</span><span class="nx">prev</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span>
<span class="w">      </span><span class="nx">prev</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">task</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span>
<span class="w">        </span><span class="nx">task</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">taskId</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="nx">task</span><span class="p">,</span><span class="w"> </span><span class="nx">status</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">task</span>
<span class="w">      </span><span class="p">)</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">updateFilters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">newFilters</span><span class="o">:</span><span class="w"> </span><span class="kt">Partial</span><span class="p">&lt;</span><span class="nt">TaskFilters</span><span class="p">&gt;)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setFilters</span><span class="p">((</span><span class="nx">prev</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span><span class="w"> </span><span class="p">...</span><span class="nx">prev</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="nx">newFilters</span><span class="w"> </span><span class="p">}));</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">clearFilters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setFilters</span><span class="p">({</span>
<span class="w">      </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">assignee</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">searchQuery</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">openEditForm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">task</span><span class="o">:</span><span class="w"> </span><span class="kt">Task</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setEditingTask</span><span class="p">(</span><span class="nx">task</span><span class="p">);</span>
<span class="w">    </span><span class="nx">setIsFormOpen</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">closeForm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setIsFormOpen</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">    </span><span class="nx">setEditingTask</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-board&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">header</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;board-header&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Task</span><span class="w"> </span><span class="nx">Board</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setIsFormOpen</span><span class="p">(</span><span class="kc">true</span><span class="p">)}&gt;</span>
<span class="w">          </span><span class="nx">Add</span><span class="w"> </span><span class="nx">Task</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">header</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">FilterBar</span>
<span class="w">        </span><span class="na">filters</span><span class="o">=</span><span class="p">{</span><span class="nx">filters</span><span class="p">}</span>
<span class="w">        </span><span class="na">onFilterChange</span><span class="o">=</span><span class="p">{</span><span class="nx">updateFilters</span><span class="p">}</span>
<span class="w">        </span><span class="na">onClearFilters</span><span class="o">=</span><span class="p">{</span><span class="nx">clearFilters</span><span class="p">}</span>
<span class="w">        </span><span class="na">taskCount</span><span class="o">=</span><span class="p">{</span><span class="nx">filteredTasks</span><span class="p">.</span><span class="nx">length</span><span class="p">}</span>
<span class="w">        </span><span class="na">totalCount</span><span class="o">=</span><span class="p">{</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">length</span><span class="p">}</span>
<span class="w">      </span><span class="p">/&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">TaskList</span>
<span class="w">        </span><span class="na">tasks</span><span class="o">=</span><span class="p">{</span><span class="nx">filteredTasks</span><span class="p">}</span>
<span class="w">        </span><span class="na">onStatusChange</span><span class="o">=</span><span class="p">{</span><span class="nx">updateTaskStatus</span><span class="p">}</span>
<span class="w">        </span><span class="na">onEdit</span><span class="o">=</span><span class="p">{</span><span class="nx">openEditForm</span><span class="p">}</span>
<span class="w">        </span><span class="na">onDelete</span><span class="o">=</span><span class="p">{</span><span class="nx">deleteTask</span><span class="p">}</span>
<span class="w">      </span><span class="p">/&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="nx">isFormOpen</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">TaskForm</span>
<span class="w">          </span><span class="na">task</span><span class="o">=</span><span class="p">{</span><span class="nx">editingTask</span><span class="p">}</span>
<span class="w">          </span><span class="na">onSubmit</span><span class="o">=</span><span class="p">{</span><span class="nx">editingTask</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>
<span class="w">            </span><span class="p">(</span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">updateTask</span><span class="p">(</span><span class="nx">editingTask</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span>
<span class="w">            </span><span class="nx">addTask</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">          </span><span class="na">onCancel</span><span class="o">=</span><span class="p">{</span><span class="nx">closeForm</span><span class="p">}</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">)}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>The supporting components:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/FilterBar.tsx</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskFilters</span><span class="p">,</span><span class="w"> </span><span class="nx">TaskStatus</span><span class="p">,</span><span class="w"> </span><span class="nx">TaskPriority</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/task&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">FilterBarProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">filters</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskFilters</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onFilterChange</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">filters</span><span class="o">:</span><span class="w"> </span><span class="kt">Partial</span><span class="p">&lt;</span><span class="nt">TaskFilters</span><span class="p">&gt;)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onClearFilters</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="nx">taskCount</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">totalCount</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">FilterBar</span><span class="p">({</span>
<span class="w">  </span><span class="nx">filters</span><span class="p">,</span>
<span class="w">  </span><span class="nx">onFilterChange</span><span class="p">,</span>
<span class="w">  </span><span class="nx">onClearFilters</span><span class="p">,</span>
<span class="w">  </span><span class="nx">taskCount</span><span class="p">,</span>
<span class="w">  </span><span class="nx">totalCount</span><span class="p">,</span>
<span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">FilterBarProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;filter-bar&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;filter-group&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span><span class="nx">Status</span><span class="o">:</span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">select</span>
<span class="w">          </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">filters</span><span class="p">.</span><span class="nx">status</span><span class="p">}</span>
<span class="w">          </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">onFilterChange</span><span class="p">({</span><span class="w"> </span>
<span class="w">            </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">e.target.value</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">TaskStatus</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="w"> </span>
<span class="w">          </span><span class="p">})}</span>
<span class="w">        </span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;all&quot;</span><span class="p">&gt;</span><span class="nx">All</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;todo&quot;</span><span class="p">&gt;</span><span class="nx">To</span><span class="w"> </span><span class="nx">Do</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;in-progress&quot;</span><span class="p">&gt;</span><span class="nx">In</span><span class="w"> </span><span class="nx">Progress</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;done&quot;</span><span class="p">&gt;</span><span class="nx">Done</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;filter-group&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span><span class="nx">Priority</span><span class="o">:</span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">select</span>
<span class="w">          </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">filters</span><span class="p">.</span><span class="nx">priority</span><span class="p">}</span>
<span class="w">          </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">onFilterChange</span><span class="p">({</span><span class="w"> </span>
<span class="w">            </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="kt">e.target.value</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">TaskPriority</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="w"> </span>
<span class="w">          </span><span class="p">})}</span>
<span class="w">        </span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;all&quot;</span><span class="p">&gt;</span><span class="nx">All</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;low&quot;</span><span class="p">&gt;</span><span class="nx">Low</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;medium&quot;</span><span class="p">&gt;</span><span class="nx">Medium</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;high&quot;</span><span class="p">&gt;</span><span class="nx">High</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;filter-group&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span><span class="nx">Search</span><span class="o">:</span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">          </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">filters</span><span class="p">.</span><span class="nx">searchQuery</span><span class="p">}</span>
<span class="w">          </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">onFilterChange</span><span class="p">({</span><span class="w"> </span><span class="nx">searchQuery</span><span class="o">:</span><span class="w"> </span><span class="kt">e.target.value</span><span class="w"> </span><span class="p">})}</span>
<span class="w">          </span><span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Search tasks...&quot;</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">onClearFilters</span><span class="p">}&gt;</span><span class="nx">Clear</span><span class="w"> </span><span class="nx">Filters</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-count&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="nx">Showing</span><span class="w"> </span><span class="p">{</span><span class="nx">taskCount</span><span class="p">}</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="p">{</span><span class="nx">totalCount</span><span class="p">}</span><span class="w"> </span><span class="nx">tasks</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/TaskList.tsx</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Task</span><span class="p">,</span><span class="w"> </span><span class="nx">TaskStatus</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/task&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskItem</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./TaskItem&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">TaskListProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">tasks</span><span class="o">:</span><span class="w"> </span><span class="kt">Task</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">onStatusChange</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">taskId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskStatus</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onEdit</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">task</span><span class="o">:</span><span class="w"> </span><span class="kt">Task</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onDelete</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">taskId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TaskList</span><span class="p">({</span><span class="w"> </span>
<span class="w">  </span><span class="nx">tasks</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="nx">onStatusChange</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="nx">onEdit</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="nx">onDelete</span><span class="w"> </span>
<span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">TaskListProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;empty-state&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">No</span><span class="w"> </span><span class="nx">tasks</span><span class="w"> </span><span class="nx">found</span><span class="p">.</span><span class="w"> </span><span class="nx">Create</span><span class="w"> </span><span class="nx">one</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">get</span><span class="w"> </span><span class="nx">started</span><span class="o">!</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-list&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">task</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">TaskItem</span>
<span class="w">          </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">task</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span>
<span class="w">          </span><span class="na">task</span><span class="o">=</span><span class="p">{</span><span class="nx">task</span><span class="p">}</span>
<span class="w">          </span><span class="na">onStatusChange</span><span class="o">=</span><span class="p">{</span><span class="nx">onStatusChange</span><span class="p">}</span>
<span class="w">          </span><span class="na">onEdit</span><span class="o">=</span><span class="p">{</span><span class="nx">onEdit</span><span class="p">}</span>
<span class="w">          </span><span class="na">onDelete</span><span class="o">=</span><span class="p">{</span><span class="nx">onDelete</span><span class="p">}</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">))}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/TaskItem.tsx</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Task</span><span class="p">,</span><span class="w"> </span><span class="nx">TaskStatus</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/task&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">TaskItemProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">task</span><span class="o">:</span><span class="w"> </span><span class="kt">Task</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onStatusChange</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">taskId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskStatus</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onEdit</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">task</span><span class="o">:</span><span class="w"> </span><span class="kt">Task</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onDelete</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">taskId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TaskItem</span><span class="p">({</span><span class="w"> </span>
<span class="w">  </span><span class="nx">task</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="nx">onStatusChange</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="nx">onEdit</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="nx">onDelete</span><span class="w"> </span>
<span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">TaskItemProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">priorityColors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">low</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;#4caf50&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">medium</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;#ff9800&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">high</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;#f44336&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-item&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-header&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;{</span><span class="nx">task</span><span class="p">.</span><span class="nx">title</span><span class="p">}&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;priority-badge&quot;</span>
<span class="w">          </span><span class="na">style</span><span class="o">=</span><span class="p">{{</span><span class="w"> </span><span class="nx">backgroundColor</span><span class="o">:</span><span class="w"> </span><span class="kt">priorityColors</span><span class="p">[</span><span class="nx">task</span><span class="p">.</span><span class="nx">priority</span><span class="p">]</span><span class="w"> </span><span class="p">}}</span>
<span class="w">        </span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">{</span><span class="nx">task</span><span class="p">.</span><span class="nx">priority</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-description&quot;</span><span class="p">&gt;{</span><span class="nx">task</span><span class="p">.</span><span class="nx">description</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-meta&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">span</span><span class="p">&gt;</span><span class="nx">Assignee</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">task</span><span class="p">.</span><span class="nx">assignee</span><span class="p">}&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">task</span><span class="p">.</span><span class="nx">dueDate</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">span</span><span class="p">&gt;</span><span class="nx">Due</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">task</span><span class="p">.</span><span class="nx">dueDate</span><span class="p">.</span><span class="nx">toLocaleDateString</span><span class="p">()}&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-actions&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">select</span>
<span class="w">          </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">task</span><span class="p">.</span><span class="nx">status</span><span class="p">}</span>
<span class="w">          </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">onStatusChange</span><span class="p">(</span><span class="nx">task</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">TaskStatus</span><span class="p">)}</span>
<span class="w">        </span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;todo&quot;</span><span class="p">&gt;</span><span class="nx">To</span><span class="w"> </span><span class="nx">Do</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;in-progress&quot;</span><span class="p">&gt;</span><span class="nx">In</span><span class="w"> </span><span class="nx">Progress</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;done&quot;</span><span class="p">&gt;</span><span class="nx">Done</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">onEdit</span><span class="p">(</span><span class="nx">task</span><span class="p">)}&gt;</span><span class="nx">Edit</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">onDelete</span><span class="p">(</span><span class="nx">task</span><span class="p">.</span><span class="nx">id</span><span class="p">)}&gt;</span><span class="nx">Delete</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/TaskForm.tsx</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Task</span><span class="p">,</span><span class="w"> </span><span class="nx">TaskStatus</span><span class="p">,</span><span class="w"> </span><span class="nx">TaskPriority</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/task&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">TaskFormProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">task?</span><span class="o">:</span><span class="w"> </span><span class="kt">Task</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onSubmit</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">taskData</span><span class="o">:</span><span class="w"> </span><span class="kt">Omit</span><span class="p">&lt;</span><span class="nt">Task</span><span class="err">,</span><span class="w"> </span><span class="err">&#39;</span><span class="na">id</span><span class="err">&#39;</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="err">&#39;</span><span class="na">createdAt</span><span class="err">&#39;</span><span class="p">&gt;)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onCancel</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TaskForm</span><span class="p">({</span><span class="w"> </span><span class="nx">task</span><span class="p">,</span><span class="w"> </span><span class="nx">onSubmit</span><span class="p">,</span><span class="w"> </span><span class="nx">onCancel</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">TaskFormProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">formData</span><span class="p">,</span><span class="w"> </span><span class="nx">setFormData</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">({</span>
<span class="w">    </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">task?.title</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="kt">task?.description</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">task?.status</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;todo&#39;</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">TaskStatus</span><span class="p">,</span>
<span class="w">    </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="kt">task?.priority</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;medium&#39;</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">TaskPriority</span><span class="p">,</span>
<span class="w">    </span><span class="nx">assignee</span><span class="o">:</span><span class="w"> </span><span class="kt">task?.assignee</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">dueDate</span><span class="o">:</span><span class="w"> </span><span class="kt">task?.dueDate?.toISOString</span><span class="p">().</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleSubmit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="o">:</span><span class="w"> </span><span class="kt">React.FormEvent</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
<span class="w">    </span><span class="nx">onSubmit</span><span class="p">({</span>
<span class="w">      </span><span class="p">...</span><span class="nx">formData</span><span class="p">,</span>
<span class="w">      </span><span class="nx">dueDate</span><span class="o">:</span><span class="w"> </span><span class="kt">formData.dueDate</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="nx">formData</span><span class="p">.</span><span class="nx">dueDate</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">undefined</span><span class="p">,</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;modal-overlay&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">form</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-form&quot;</span><span class="w"> </span><span class="na">onSubmit</span><span class="o">=</span><span class="p">{</span><span class="nx">handleSubmit</span><span class="p">}&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;{</span><span class="nx">task</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;Edit Task&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;New Task&#39;</span><span class="p">}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Title</span><span class="o">:</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">            </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">            </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">formData</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span>
<span class="w">            </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setFormData</span><span class="p">({</span><span class="w"> </span><span class="p">...</span><span class="nx">formData</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">e.target.value</span><span class="w"> </span><span class="p">})}</span>
<span class="w">            </span><span class="na">required</span>
<span class="w">          </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Description</span><span class="o">:</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">textarea</span>
<span class="w">            </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">formData</span><span class="p">.</span><span class="nx">description</span><span class="p">}</span>
<span class="w">            </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setFormData</span><span class="p">({</span><span class="w"> </span><span class="p">...</span><span class="nx">formData</span><span class="p">,</span><span class="w"> </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="kt">e.target.value</span><span class="w"> </span><span class="p">})}</span>
<span class="w">            </span><span class="na">required</span>
<span class="w">          </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Status</span><span class="o">:</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">select</span>
<span class="w">            </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">formData</span><span class="p">.</span><span class="nx">status</span><span class="p">}</span>
<span class="w">            </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setFormData</span><span class="p">({</span><span class="w"> </span>
<span class="w">              </span><span class="p">...</span><span class="nx">formData</span><span class="p">,</span><span class="w"> </span>
<span class="w">              </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">e.target.value</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">TaskStatus</span><span class="w"> </span>
<span class="w">            </span><span class="p">})}</span>
<span class="w">          </span><span class="p">&gt;</span>
<span class="w">            </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;todo&quot;</span><span class="p">&gt;</span><span class="nx">To</span><span class="w"> </span><span class="nx">Do</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">            </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;in-progress&quot;</span><span class="p">&gt;</span><span class="nx">In</span><span class="w"> </span><span class="nx">Progress</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">            </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;done&quot;</span><span class="p">&gt;</span><span class="nx">Done</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Priority</span><span class="o">:</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">select</span>
<span class="w">            </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">formData</span><span class="p">.</span><span class="nx">priority</span><span class="p">}</span>
<span class="w">            </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setFormData</span><span class="p">({</span><span class="w"> </span>
<span class="w">              </span><span class="p">...</span><span class="nx">formData</span><span class="p">,</span><span class="w"> </span>
<span class="w">              </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="kt">e.target.value</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">TaskPriority</span><span class="w"> </span>
<span class="w">            </span><span class="p">})}</span>
<span class="w">          </span><span class="p">&gt;</span>
<span class="w">            </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;low&quot;</span><span class="p">&gt;</span><span class="nx">Low</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">            </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;medium&quot;</span><span class="p">&gt;</span><span class="nx">Medium</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">            </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;high&quot;</span><span class="p">&gt;</span><span class="nx">High</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Assignee</span><span class="o">:</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">            </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">            </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">formData</span><span class="p">.</span><span class="nx">assignee</span><span class="p">}</span>
<span class="w">            </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setFormData</span><span class="p">({</span><span class="w"> </span><span class="p">...</span><span class="nx">formData</span><span class="p">,</span><span class="w"> </span><span class="nx">assignee</span><span class="o">:</span><span class="w"> </span><span class="kt">e.target.value</span><span class="w"> </span><span class="p">})}</span>
<span class="w">            </span><span class="na">required</span>
<span class="w">          </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Due</span><span class="w"> </span><span class="nb">Date</span><span class="o">:</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">            </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;date&quot;</span>
<span class="w">            </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">formData</span><span class="p">.</span><span class="nx">dueDate</span><span class="p">}</span>
<span class="w">            </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setFormData</span><span class="p">({</span><span class="w"> </span><span class="p">...</span><span class="nx">formData</span><span class="p">,</span><span class="w"> </span><span class="nx">dueDate</span><span class="o">:</span><span class="w"> </span><span class="kt">e.target.value</span><span class="w"> </span><span class="p">})}</span>
<span class="w">          </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;form-actions&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span><span class="p">&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="nx">task</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;Update&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Create&#39;</span><span class="p">}</span><span class="w"> </span><span class="nx">Task</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">onCancel</span><span class="p">}&gt;</span>
<span class="w">            </span><span class="nx">Cancel</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="what-makes-this-work">What Makes This Work</h3>
<p>This implementation uses <strong>only <code>useState</code></strong>, and it works perfectly well. Let's understand why:</p>
<p><strong>1. Clear State Ownership</strong></p>
<p>Each piece of state has a clear owner and purpose:
- <code>tasks</code>: The source of truth for all task data
- <code>filters</code>: Current filter selections
- <code>isFormOpen</code>: Modal visibility
- <code>editingTask</code>: Which task is being edited (if any)</p>
<p><strong>2. Predictable State Updates</strong></p>
<p>Every state change happens through a dedicated function:
- <code>addTask</code>, <code>updateTask</code>, <code>deleteTask</code> for task mutations
- <code>updateFilters</code>, <code>clearFilters</code> for filter changes
- <code>openEditForm</code>, <code>closeForm</code> for UI state</p>
<p><strong>3. Derived State is Computed, Not Stored</strong></p>
<p>Notice <code>filteredTasks</code> is not in state‚Äîit's computed from <code>tasks</code> and <code>filters</code>. This is crucial. Storing derived state creates synchronization problems.</p>
<p><strong>4. Props Flow Downward</strong></p>
<p>Data flows down through props. Child components receive:
- Data they need to display
- Callbacks to trigger state changes in the parent</p>
<p>This is the <strong>React mental model</strong>: state lives at the top, flows down through props, and changes bubble up through callbacks.</p>
<h3 id="when-usestate-is-enough">When useState is Enough</h3>
<p>This pattern works well when:</p>
<p>‚úÖ <strong>State is localized</strong>: All related state lives in one component
‚úÖ <strong>Updates are simple</strong>: Each action changes one or two pieces of state
‚úÖ <strong>No complex interdependencies</strong>: State changes don't trigger cascading updates
‚úÖ <strong>Component tree is shallow</strong>: Props don't need to drill through many levels</p>
<p>For our TaskBoard, all these conditions are true. The state is self-contained, updates are straightforward, and the component tree is only 2-3 levels deep.</p>
<h3 id="the-real-world-test">The Real-World Test</h3>
<p>Let's verify this works by running through realistic user interactions:</p>
<p><strong>Scenario 1: Filtering tasks</strong>
1. User selects "Status: In Progress"
2. <code>updateFilters</code> is called with <code>{ status: 'in-progress' }</code>
3. <code>filters</code> state updates
4. <code>filteredTasks</code> recomputes automatically
5. <code>TaskList</code> re-renders with filtered data</p>
<p><strong>Scenario 2: Editing a task</strong>
1. User clicks "Edit" on a task
2. <code>openEditForm</code> is called with the task object
3. <code>editingTask</code> state updates to that task
4. <code>isFormOpen</code> state updates to <code>true</code>
5. <code>TaskForm</code> renders with pre-filled data
6. User submits changes
7. <code>updateTask</code> is called
8. <code>tasks</code> state updates with new data
9. <code>editingTask</code> resets to <code>null</code>
10. <code>isFormOpen</code> resets to <code>false</code></p>
<p><strong>Browser Console</strong> (with React DevTools):</p>
<div class="codehilite"><pre><span></span><code><span class="o">[</span><span class="n">TaskBoard</span><span class="o">]</span><span class="w"> </span><span class="n">Rendered</span>
<span class="o">[</span><span class="n">FilterBar</span><span class="o">]</span><span class="w"> </span><span class="n">Rendered</span>
<span class="o">[</span><span class="n">TaskList</span><span class="o">]</span><span class="w"> </span><span class="n">Rendered</span>
<span class="o">[</span><span class="n">TaskItem</span><span class="o">]</span><span class="w"> </span><span class="n">Rendered</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="n">task</span><span class="p">)</span>

<span class="o">//</span><span class="w"> </span><span class="k">After</span><span class="w"> </span><span class="nl">filtering</span><span class="p">:</span>
<span class="o">[</span><span class="n">TaskBoard</span><span class="o">]</span><span class="w"> </span><span class="n">Re</span><span class="o">-</span><span class="n">rendered</span><span class="w"> </span><span class="p">(</span><span class="n">filters</span><span class="w"> </span><span class="n">changed</span><span class="p">)</span>
<span class="o">[</span><span class="n">FilterBar</span><span class="o">]</span><span class="w"> </span><span class="n">Re</span><span class="o">-</span><span class="n">rendered</span><span class="w"> </span><span class="p">(</span><span class="n">filters</span><span class="w"> </span><span class="n">prop</span><span class="w"> </span><span class="n">changed</span><span class="p">)</span>
<span class="o">[</span><span class="n">TaskList</span><span class="o">]</span><span class="w"> </span><span class="n">Re</span><span class="o">-</span><span class="n">rendered</span><span class="w"> </span><span class="p">(</span><span class="n">tasks</span><span class="w"> </span><span class="n">prop</span><span class="w"> </span><span class="n">changed</span><span class="p">)</span>
<span class="o">[</span><span class="n">TaskItem</span><span class="o">]</span><span class="w"> </span><span class="n">Rendered</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="ow">in</span><span class="o">-</span><span class="n">progress</span><span class="w"> </span><span class="n">task</span><span class="p">)</span>

<span class="o">//</span><span class="w"> </span><span class="k">After</span><span class="w"> </span><span class="nl">editing</span><span class="p">:</span>
<span class="o">[</span><span class="n">TaskBoard</span><span class="o">]</span><span class="w"> </span><span class="n">Re</span><span class="o">-</span><span class="n">rendered</span><span class="w"> </span><span class="p">(</span><span class="n">editingTask</span><span class="w"> </span><span class="n">changed</span><span class="p">)</span>
<span class="o">[</span><span class="n">TaskForm</span><span class="o">]</span><span class="w"> </span><span class="n">Rendered</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="n">mounted</span><span class="p">)</span>
<span class="o">//</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="n">edits</span><span class="w"> </span><span class="p">...</span>
<span class="o">[</span><span class="n">TaskBoard</span><span class="o">]</span><span class="w"> </span><span class="n">Re</span><span class="o">-</span><span class="n">rendered</span><span class="w"> </span><span class="p">(</span><span class="n">tasks</span><span class="w"> </span><span class="n">changed</span><span class="p">)</span>
<span class="o">[</span><span class="n">TaskList</span><span class="o">]</span><span class="w"> </span><span class="n">Re</span><span class="o">-</span><span class="n">rendered</span><span class="w"> </span><span class="p">(</span><span class="n">tasks</span><span class="w"> </span><span class="n">prop</span><span class="w"> </span><span class="n">changed</span><span class="p">)</span>
<span class="o">[</span><span class="n">TaskItem</span><span class="o">]</span><span class="w"> </span><span class="n">Re</span><span class="o">-</span><span class="n">rendered</span><span class="w"> </span><span class="p">(</span><span class="n">task</span><span class="w"> </span><span class="n">prop</span><span class="w"> </span><span class="n">changed</span><span class="p">)</span>
<span class="o">[</span><span class="n">TaskForm</span><span class="o">]</span><span class="w"> </span><span class="n">Unmounted</span>
</code></pre></div>

<p>Everything re-renders exactly when it should. No unnecessary updates. No stale data. No bugs.</p>
<h3 id="the-simplicity-advantage">The Simplicity Advantage</h3>
<p>This approach has significant benefits:</p>
<p><strong>1. Easy to understand</strong>: Any React developer can read this code and understand it immediately</p>
<p><strong>2. Easy to debug</strong>: React DevTools shows exactly what state exists and when it changes</p>
<p><strong>3. Easy to test</strong>: Each function is pure and testable in isolation</p>
<p><strong>4. Easy to modify</strong>: Adding a new piece of state or a new action is straightforward</p>
<p><strong>5. No external dependencies</strong>: No libraries to learn, no abstractions to understand</p>
<h3 id="when-to-stick-with-usestate">When to Stick with useState</h3>
<p>Most components in most applications should use this pattern. Reach for more complex solutions only when you encounter specific problems that <code>useState</code> cannot solve efficiently.</p>
<p><strong>Signs that useState is working</strong>:
- Code is easy to read and modify
- No performance issues
- No prop drilling through more than 2-3 levels
- State updates are predictable and debuggable
- Team members understand the code without explanation</p>
<p>If all these are true, <strong>don't change anything</strong>. The best code is the simplest code that works.</p>
<h2 id="usereducer-for-complex-state-logic">useReducer for complex state logic</h2>
<h2 id="usereducer-for-complex-state-logic_1">useReducer for complex state logic</h2>
<h3 id="phase-2-when-usestate-shows-its-limits">Phase 2: When useState Shows Its Limits</h3>
<p>Our TaskBoard works well, but let's add a realistic feature that will expose the limitations of multiple <code>useState</code> calls: <strong>undo/redo functionality</strong>.</p>
<p>Users want to undo accidental deletions or revert changes. This is a common requirement in task management applications. Let's try to implement it with our current approach.</p>
<h3 id="the-failure-state-synchronization-hell">The Failure: State Synchronization Hell</h3>
<p>Here's what happens when we try to add undo/redo with <code>useState</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/TaskBoard.tsx - Attempting undo/redo with useState</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Task</span><span class="p">,</span><span class="w"> </span><span class="nx">TaskFilters</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/task&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">HistoryEntry</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">tasks</span><span class="o">:</span><span class="w"> </span><span class="kt">Task</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">filters</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskFilters</span><span class="p">;</span>
<span class="w">  </span><span class="nx">isFormOpen</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">editingTask</span><span class="o">:</span><span class="w"> </span><span class="kt">Task</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TaskBoard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">tasks</span><span class="p">,</span><span class="w"> </span><span class="nx">setTasks</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">Task</span><span class="err">[]</span><span class="p">&gt;([</span><span class="cm">/* initial tasks */</span><span class="p">]);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">filters</span><span class="p">,</span><span class="w"> </span><span class="nx">setFilters</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">TaskFilters</span><span class="p">&gt;({</span><span class="cm">/* initial filters */</span><span class="p">});</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">isFormOpen</span><span class="p">,</span><span class="w"> </span><span class="nx">setIsFormOpen</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">editingTask</span><span class="p">,</span><span class="w"> </span><span class="nx">setEditingTask</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">Task</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="na">null</span><span class="p">&gt;(</span><span class="kc">null</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Undo/redo state</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">history</span><span class="p">,</span><span class="w"> </span><span class="nx">setHistory</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">HistoryEntry</span><span class="err">[]</span><span class="p">&gt;([]);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">historyIndex</span><span class="p">,</span><span class="w"> </span><span class="nx">setHistoryIndex</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Try to save state to history before each change</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">saveToHistory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">entry</span><span class="o">:</span><span class="w"> </span><span class="kt">HistoryEntry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">tasks</span><span class="p">,</span>
<span class="w">      </span><span class="nx">filters</span><span class="p">,</span>
<span class="w">      </span><span class="nx">isFormOpen</span><span class="p">,</span>
<span class="w">      </span><span class="nx">editingTask</span><span class="p">,</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="c1">// Remove any &quot;future&quot; history if we&#39;re not at the end</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">newHistory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">history</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">historyIndex</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">);</span>
<span class="w">    </span><span class="nx">setHistory</span><span class="p">([...</span><span class="nx">newHistory</span><span class="p">,</span><span class="w"> </span><span class="nx">entry</span><span class="p">]);</span>
<span class="w">    </span><span class="nx">setHistoryIndex</span><span class="p">(</span><span class="nx">newHistory</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">addTask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">taskData</span><span class="o">:</span><span class="w"> </span><span class="kt">Omit</span><span class="p">&lt;</span><span class="nt">Task</span><span class="err">,</span><span class="w"> </span><span class="err">&#39;</span><span class="na">id</span><span class="err">&#39;</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="err">&#39;</span><span class="na">createdAt</span><span class="err">&#39;</span><span class="p">&gt;)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">saveToHistory</span><span class="p">();</span><span class="w"> </span><span class="c1">// Save before change</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">newTask</span><span class="o">:</span><span class="w"> </span><span class="kt">Task</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="p">...</span><span class="nx">taskData</span><span class="p">,</span>
<span class="w">      </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">crypto.randomUUID</span><span class="p">(),</span>
<span class="w">      </span><span class="nx">createdAt</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(),</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="nx">setTasks</span><span class="p">((</span><span class="nx">prev</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[...</span><span class="nx">prev</span><span class="p">,</span><span class="w"> </span><span class="nx">newTask</span><span class="p">]);</span>
<span class="w">    </span><span class="nx">setIsFormOpen</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">deleteTask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">taskId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">saveToHistory</span><span class="p">();</span><span class="w"> </span><span class="c1">// Save before change</span>
<span class="w">    </span><span class="nx">setTasks</span><span class="p">((</span><span class="nx">prev</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">prev</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">task</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">task</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">taskId</span><span class="p">));</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">undo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">historyIndex</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">previousState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">history</span><span class="p">[</span><span class="nx">historyIndex</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">];</span>

<span class="w">      </span><span class="c1">// Now we need to restore ALL state</span>
<span class="w">      </span><span class="nx">setTasks</span><span class="p">(</span><span class="nx">previousState</span><span class="p">.</span><span class="nx">tasks</span><span class="p">);</span>
<span class="w">      </span><span class="nx">setFilters</span><span class="p">(</span><span class="nx">previousState</span><span class="p">.</span><span class="nx">filters</span><span class="p">);</span>
<span class="w">      </span><span class="nx">setIsFormOpen</span><span class="p">(</span><span class="nx">previousState</span><span class="p">.</span><span class="nx">isFormOpen</span><span class="p">);</span>
<span class="w">      </span><span class="nx">setEditingTask</span><span class="p">(</span><span class="nx">previousState</span><span class="p">.</span><span class="nx">editingTask</span><span class="p">);</span>
<span class="w">      </span><span class="nx">setHistoryIndex</span><span class="p">(</span><span class="nx">historyIndex</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">redo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">historyIndex</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">history</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">nextState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">history</span><span class="p">[</span><span class="nx">historyIndex</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">];</span>

<span class="w">      </span><span class="c1">// Restore ALL state again</span>
<span class="w">      </span><span class="nx">setTasks</span><span class="p">(</span><span class="nx">nextState</span><span class="p">.</span><span class="nx">tasks</span><span class="p">);</span>
<span class="w">      </span><span class="nx">setFilters</span><span class="p">(</span><span class="nx">nextState</span><span class="p">.</span><span class="nx">filters</span><span class="p">);</span>
<span class="w">      </span><span class="nx">setIsFormOpen</span><span class="p">(</span><span class="nx">nextState</span><span class="p">.</span><span class="nx">isFormOpen</span><span class="p">);</span>
<span class="w">      </span><span class="nx">setEditingTask</span><span class="p">(</span><span class="nx">nextState</span><span class="p">.</span><span class="nx">editingTask</span><span class="p">);</span>
<span class="w">      </span><span class="nx">setHistoryIndex</span><span class="p">(</span><span class="nx">historyIndex</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="c1">// ... rest of component</span>
<span class="p">}</span>
</code></pre></div>

<p>Let's run this and see what happens:</p>
<p><strong>Browser Behavior</strong>:
1. User adds a task
2. User deletes a task
3. User clicks "Undo"
4. The deleted task reappears ‚úì
5. User clicks "Undo" again
6. The added task disappears ‚úì
7. User changes a filter
8. User clicks "Undo"
9. <strong>Nothing happens</strong> ‚ùå</p>
<p><strong>Browser Console</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">Warning</span><span class="o">:</span><span class="w"> </span><span class="n">Cannot</span><span class="w"> </span><span class="n">update</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="n">rendering</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">component</span><span class="o">.</span>
<span class="w">  </span><span class="n">at</span><span class="w"> </span><span class="n">TaskBoard</span><span class="w"> </span><span class="o">(</span><span class="n">TaskBoard</span><span class="o">.</span><span class="na">tsx</span><span class="o">:</span><span class="mi">45</span><span class="o">)</span>

<span class="n">Warning</span><span class="o">:</span><span class="w"> </span><span class="n">Maximum</span><span class="w"> </span><span class="n">update</span><span class="w"> </span><span class="n">depth</span><span class="w"> </span><span class="n">exceeded</span><span class="o">.</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">happen</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">component</span><span class="w"> </span>
<span class="n">calls</span><span class="w"> </span><span class="n">setState</span><span class="w"> </span><span class="n">inside</span><span class="w"> </span><span class="n">useEffect</span><span class="o">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">useEffect</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">doesn</span><span class="err">&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span>
<span class="n">dependency</span><span class="w"> </span><span class="n">array</span><span class="o">,</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">dependencies</span><span class="w"> </span><span class="n">changes</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">every</span><span class="w"> </span><span class="n">render</span><span class="o">.</span>
<span class="w">  </span><span class="n">at</span><span class="w"> </span><span class="n">TaskBoard</span><span class="w"> </span><span class="o">(</span><span class="n">TaskBoard</span><span class="o">.</span><span class="na">tsx</span><span class="o">:</span><span class="mi">52</span><span class="o">)</span>
</code></pre></div>

<p><strong>React DevTools Evidence</strong>:
- Component tree: <code>TaskBoard</code> highlighted in red (error state)
- State inspection:
  - <code>history</code>: Array with 3 entries
  - <code>historyIndex</code>: 1
  - <code>tasks</code>: Correct data
  - <code>filters</code>: <strong>Not in history</strong> - this is the problem
- Render count: 847 renders in 2 seconds (infinite loop)</p>
<h3 id="diagnostic-analysis-reading-the-failure">Diagnostic Analysis: Reading the Failure</h3>
<p><strong>What the user experiences</strong>:
- Expected: Undo should revert the filter change
- Actual: Undo does nothing, then the app freezes</p>
<p><strong>What the console reveals</strong>:
- Key indicator: "Maximum update depth exceeded"
- Error location: Inside <code>saveToHistory</code> function
- This means we're triggering infinite state updates</p>
<p><strong>What DevTools shows</strong>:
- Component state: <code>history</code> array keeps growing
- Render behavior: Component re-renders continuously
- The problem: <code>saveToHistory</code> reads current state, but that state is stale by the time it executes</p>
<p><strong>Root cause identified</strong>: </p>
<p>When we call <code>saveToHistory()</code> before a state update, we're reading the current state values. But React batches state updates, so by the time <code>saveToHistory</code> executes, the state hasn't actually changed yet. We're saving the old state, then updating to the new state, then trying to save again, creating an infinite loop.</p>
<p>Additionally, we have <strong>four separate pieces of state</strong> that must stay synchronized:
1. <code>tasks</code>
2. <code>filters</code>
3. <code>isFormOpen</code>
4. <code>editingTask</code></p>
<p>Every action must update the right combination of these, and every undo/redo must restore all of them atomically. With <code>useState</code>, there's no way to guarantee this happens correctly.</p>
<p><strong>Why the current approach can't solve this</strong>:</p>
<p><code>useState</code> is designed for independent pieces of state. When you have multiple related pieces of state that must change together, you need a different tool.</p>
<p><strong>What we need</strong>: </p>
<p>A way to manage all related state as a single unit, with a clear definition of how each action transforms that state. We need <code>useReducer</code>.</p>
<h3 id="iteration-1-refactoring-to-usereducer">Iteration 1: Refactoring to useReducer</h3>
<p><code>useReducer</code> is React's built-in solution for complex state logic. It's based on the reducer pattern from Redux, but simpler and built into React.</p>
<p><strong>The mental model</strong>:
- All state lives in a single object
- Actions describe what happened
- A reducer function defines how each action transforms the state
- State updates are atomic and predictable</p>
<p>Let's refactor our TaskBoard:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/types/task.ts - Add action types</span>
<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">TaskStatus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;todo&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;in-progress&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;done&#39;</span><span class="p">;</span>
<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">TaskPriority</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;low&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;medium&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;high&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">Task</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskStatus</span><span class="p">;</span>
<span class="w">  </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskPriority</span><span class="p">;</span>
<span class="w">  </span><span class="nx">assignee</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">createdAt</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dueDate?</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">TaskFilters</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskStatus</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskPriority</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">assignee</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">searchQuery</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// New: State shape</span>
<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">TaskBoardState</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">tasks</span><span class="o">:</span><span class="w"> </span><span class="kt">Task</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">filters</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskFilters</span><span class="p">;</span>
<span class="w">  </span><span class="nx">isFormOpen</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">editingTask</span><span class="o">:</span><span class="w"> </span><span class="kt">Task</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">  </span><span class="nx">history</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskBoardState</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">historyIndex</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// New: Action types</span>
<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">TaskBoardAction</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;ADD_TASK&#39;</span><span class="p">;</span><span class="w"> </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="kt">Omit</span><span class="o">&lt;</span><span class="nx">Task</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;id&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;createdAt&#39;</span><span class="o">&gt;</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;UPDATE_TASK&#39;</span><span class="p">;</span><span class="w"> </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w"> </span><span class="nx">updates</span><span class="o">:</span><span class="w"> </span><span class="kt">Partial</span><span class="o">&lt;</span><span class="nx">Task</span><span class="o">&gt;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;DELETE_TASK&#39;</span><span class="p">;</span><span class="w"> </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;UPDATE_TASK_STATUS&#39;</span><span class="p">;</span><span class="w"> </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w"> </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskStatus</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;UPDATE_FILTERS&#39;</span><span class="p">;</span><span class="w"> </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="kt">Partial</span><span class="o">&lt;</span><span class="nx">TaskFilters</span><span class="o">&gt;</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;CLEAR_FILTERS&#39;</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;OPEN_FORM&#39;</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;OPEN_EDIT_FORM&#39;</span><span class="p">;</span><span class="w"> </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="kt">Task</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;CLOSE_FORM&#39;</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;UNDO&#39;</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;REDO&#39;</span><span class="w"> </span><span class="p">};</span>
</code></pre></div>

<p>Now the reducer function‚Äîthe heart of our state management:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/reducers/taskBoardReducer.ts</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskBoardState</span><span class="p">,</span><span class="w"> </span><span class="nx">TaskBoardAction</span><span class="p">,</span><span class="w"> </span><span class="nx">Task</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/task&#39;</span><span class="p">;</span>

<span class="c1">// Helper: Save current state to history before making changes</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">saveToHistory</span><span class="p">(</span><span class="nx">state</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskBoardState</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">TaskBoardState</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Don&#39;t save history entries to history (avoid nested history)</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">stateToSave</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskBoardState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">...</span><span class="nx">state</span><span class="p">,</span>
<span class="w">    </span><span class="nx">history</span><span class="o">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">    </span><span class="nx">historyIndex</span><span class="o">:</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="p">,</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="c1">// Remove any &quot;future&quot; history if we&#39;re not at the end</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">newHistory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">historyIndex</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">...</span><span class="nx">state</span><span class="p">,</span>
<span class="w">    </span><span class="nx">history</span><span class="o">:</span><span class="w"> </span><span class="p">[...</span><span class="nx">newHistory</span><span class="p">,</span><span class="w"> </span><span class="nx">stateToSave</span><span class="p">],</span>
<span class="w">    </span><span class="nx">historyIndex</span><span class="o">:</span><span class="w"> </span><span class="kt">newHistory.length</span><span class="p">,</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">taskBoardReducer</span><span class="p">(</span>
<span class="w">  </span><span class="nx">state</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskBoardState</span><span class="p">,</span>
<span class="w">  </span><span class="nx">action</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskBoardAction</span>
<span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">TaskBoardState</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">action</span><span class="p">.</span><span class="kr">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;ADD_TASK&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">stateWithHistory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">saveToHistory</span><span class="p">(</span><span class="nx">state</span><span class="p">);</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">newTask</span><span class="o">:</span><span class="w"> </span><span class="kt">Task</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">...</span><span class="nx">action</span><span class="p">.</span><span class="nx">payload</span><span class="p">,</span>
<span class="w">        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">crypto.randomUUID</span><span class="p">(),</span>
<span class="w">        </span><span class="nx">createdAt</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(),</span>
<span class="w">      </span><span class="p">};</span>

<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">...</span><span class="nx">stateWithHistory</span><span class="p">,</span>
<span class="w">        </span><span class="nx">tasks</span><span class="o">:</span><span class="w"> </span><span class="p">[...</span><span class="nx">stateWithHistory</span><span class="p">.</span><span class="nx">tasks</span><span class="p">,</span><span class="w"> </span><span class="nx">newTask</span><span class="p">],</span>
<span class="w">        </span><span class="nx">isFormOpen</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
<span class="w">      </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;UPDATE_TASK&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">stateWithHistory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">saveToHistory</span><span class="p">(</span><span class="nx">state</span><span class="p">);</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">...</span><span class="nx">stateWithHistory</span><span class="p">,</span>
<span class="w">        </span><span class="nx">tasks</span><span class="o">:</span><span class="w"> </span><span class="kt">stateWithHistory.tasks.map</span><span class="p">((</span><span class="nx">task</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span>
<span class="w">          </span><span class="nx">task</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">action</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">id</span>
<span class="w">            </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="nx">task</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="nx">action</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">updates</span><span class="w"> </span><span class="p">}</span>
<span class="w">            </span><span class="o">:</span><span class="w"> </span><span class="nx">task</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">        </span><span class="nx">editingTask</span><span class="o">:</span><span class="w"> </span><span class="kt">null</span><span class="p">,</span>
<span class="w">        </span><span class="nx">isFormOpen</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
<span class="w">      </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;DELETE_TASK&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">stateWithHistory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">saveToHistory</span><span class="p">(</span><span class="nx">state</span><span class="p">);</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">...</span><span class="nx">stateWithHistory</span><span class="p">,</span>
<span class="w">        </span><span class="nx">tasks</span><span class="o">:</span><span class="w"> </span><span class="kt">stateWithHistory.tasks.filter</span><span class="p">(</span>
<span class="w">          </span><span class="p">(</span><span class="nx">task</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">task</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">action</span><span class="p">.</span><span class="nx">payload</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;UPDATE_TASK_STATUS&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">stateWithHistory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">saveToHistory</span><span class="p">(</span><span class="nx">state</span><span class="p">);</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">...</span><span class="nx">stateWithHistory</span><span class="p">,</span>
<span class="w">        </span><span class="nx">tasks</span><span class="o">:</span><span class="w"> </span><span class="kt">stateWithHistory.tasks.map</span><span class="p">((</span><span class="nx">task</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span>
<span class="w">          </span><span class="nx">task</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">action</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">id</span>
<span class="w">            </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="nx">task</span><span class="p">,</span><span class="w"> </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">action.payload.status</span><span class="w"> </span><span class="p">}</span>
<span class="w">            </span><span class="o">:</span><span class="w"> </span><span class="nx">task</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;UPDATE_FILTERS&#39;</span><span class="o">:</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">...</span><span class="nx">state</span><span class="p">,</span>
<span class="w">        </span><span class="nx">filters</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="nx">state</span><span class="p">.</span><span class="nx">filters</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="nx">action</span><span class="p">.</span><span class="nx">payload</span><span class="w"> </span><span class="p">},</span>
<span class="w">      </span><span class="p">};</span>

<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;CLEAR_FILTERS&#39;</span><span class="o">:</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">...</span><span class="nx">state</span><span class="p">,</span>
<span class="w">        </span><span class="nx">filters</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">assignee</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">searchQuery</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">      </span><span class="p">};</span>

<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OPEN_FORM&#39;</span><span class="o">:</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">...</span><span class="nx">state</span><span class="p">,</span>
<span class="w">        </span><span class="nx">isFormOpen</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
<span class="w">        </span><span class="nx">editingTask</span><span class="o">:</span><span class="w"> </span><span class="kt">null</span><span class="p">,</span>
<span class="w">      </span><span class="p">};</span>

<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OPEN_EDIT_FORM&#39;</span><span class="o">:</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">...</span><span class="nx">state</span><span class="p">,</span>
<span class="w">        </span><span class="nx">isFormOpen</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
<span class="w">        </span><span class="nx">editingTask</span><span class="o">:</span><span class="w"> </span><span class="kt">action.payload</span><span class="p">,</span>
<span class="w">      </span><span class="p">};</span>

<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;CLOSE_FORM&#39;</span><span class="o">:</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">...</span><span class="nx">state</span><span class="p">,</span>
<span class="w">        </span><span class="nx">isFormOpen</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">editingTask</span><span class="o">:</span><span class="w"> </span><span class="kt">null</span><span class="p">,</span>
<span class="w">      </span><span class="p">};</span>

<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;UNDO&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">state</span><span class="p">.</span><span class="nx">historyIndex</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">previousState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">history</span><span class="p">[</span><span class="nx">state</span><span class="p">.</span><span class="nx">historyIndex</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">];</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="p">...</span><span class="nx">previousState</span><span class="p">,</span>
<span class="w">          </span><span class="nx">history</span><span class="o">:</span><span class="w"> </span><span class="kt">state.history</span><span class="p">,</span>
<span class="w">          </span><span class="nx">historyIndex</span><span class="o">:</span><span class="w"> </span><span class="kt">state.historyIndex</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">state</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;REDO&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">state</span><span class="p">.</span><span class="nx">historyIndex</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">nextState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">history</span><span class="p">[</span><span class="nx">state</span><span class="p">.</span><span class="nx">historyIndex</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">];</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="p">...</span><span class="nx">nextState</span><span class="p">,</span>
<span class="w">          </span><span class="nx">history</span><span class="o">:</span><span class="w"> </span><span class="kt">state.history</span><span class="p">,</span>
<span class="w">          </span><span class="nx">historyIndex</span><span class="o">:</span><span class="w"> </span><span class="kt">state.historyIndex</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">state</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">default</span><span class="o">:</span>
<span class="w">      </span><span class="kt">return</span><span class="w"> </span><span class="nx">state</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>Now the component becomes much simpler:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/TaskBoard.tsx - Version 2: Using useReducer</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useReducer</span><span class="p">,</span><span class="w"> </span><span class="nx">useMemo</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskBoardState</span><span class="p">,</span><span class="w"> </span><span class="nx">TaskStatus</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/task&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">taskBoardReducer</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../reducers/taskBoardReducer&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskList</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./TaskList&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskForm</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./TaskForm&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">FilterBar</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./FilterBar&#39;</span><span class="p">;</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">initialState</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskBoardState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">tasks</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Implement user authentication&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Add JWT-based auth flow&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;in-progress&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;high&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">assignee</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">createdAt</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="s1">&#39;2024-01-15&#39;</span><span class="p">),</span>
<span class="w">      </span><span class="nx">dueDate</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="s1">&#39;2024-02-01&#39;</span><span class="p">),</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Write API documentation&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Document all REST endpoints&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;todo&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;medium&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">assignee</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">createdAt</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="s1">&#39;2024-01-16&#39;</span><span class="p">),</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Fix mobile responsive issues&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Dashboard breaks on small screens&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;done&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;high&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">assignee</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">createdAt</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="s1">&#39;2024-01-10&#39;</span><span class="p">),</span>
<span class="w">      </span><span class="nx">dueDate</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="s1">&#39;2024-01-20&#39;</span><span class="p">),</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="nx">filters</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">assignee</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">searchQuery</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nx">isFormOpen</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
<span class="w">  </span><span class="nx">editingTask</span><span class="o">:</span><span class="w"> </span><span class="kt">null</span><span class="p">,</span>
<span class="w">  </span><span class="nx">history</span><span class="o">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">  </span><span class="nx">historyIndex</span><span class="o">:</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TaskBoard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">state</span><span class="p">,</span><span class="w"> </span><span class="nx">dispatch</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useReducer</span><span class="p">(</span><span class="nx">taskBoardReducer</span><span class="p">,</span><span class="w"> </span><span class="nx">initialState</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Derived state: filtered tasks</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filteredTasks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">task</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">state</span><span class="p">.</span><span class="nx">filters</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">task</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">filters</span><span class="p">.</span><span class="nx">status</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">state</span><span class="p">.</span><span class="nx">filters</span><span class="p">.</span><span class="nx">priority</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">task</span><span class="p">.</span><span class="nx">priority</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">filters</span><span class="p">.</span><span class="nx">priority</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">state</span><span class="p">.</span><span class="nx">filters</span><span class="p">.</span><span class="nx">assignee</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">task</span><span class="p">.</span><span class="nx">assignee</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">filters</span><span class="p">.</span><span class="nx">assignee</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">state</span><span class="p">.</span><span class="nx">filters</span><span class="p">.</span><span class="nx">searchQuery</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">filters</span><span class="p">.</span><span class="nx">searchQuery</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="nx">task</span><span class="p">.</span><span class="nx">title</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">includes</span><span class="p">(</span><span class="nx">query</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
<span class="w">          </span><span class="nx">task</span><span class="p">.</span><span class="nx">description</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">includes</span><span class="p">(</span><span class="nx">query</span><span class="p">)</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">,</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">filters</span><span class="p">]);</span>

<span class="w">  </span><span class="c1">// Keyboard shortcuts for undo/redo</span>
<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleKeyDown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="o">:</span><span class="w"> </span><span class="kt">KeyboardEvent</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="nx">e</span><span class="p">.</span><span class="nx">metaKey</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">ctrlKey</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">key</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;z&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">shiftKey</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nx">dispatch</span><span class="p">({</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;REDO&#39;</span><span class="w"> </span><span class="p">});</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nx">dispatch</span><span class="p">({</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;UNDO&#39;</span><span class="w"> </span><span class="p">});</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;keydown&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">handleKeyDown</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="s1">&#39;keydown&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">handleKeyDown</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-board&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">header</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;board-header&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Task</span><span class="w"> </span><span class="nx">Board</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;header-actions&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">dispatch</span><span class="p">({</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;OPEN_FORM&#39;</span><span class="w"> </span><span class="p">})}&gt;</span>
<span class="w">            </span><span class="nx">Add</span><span class="w"> </span><span class="nx">Task</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">            </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">dispatch</span><span class="p">({</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;UNDO&#39;</span><span class="w"> </span><span class="p">})}</span>
<span class="w">            </span><span class="na">disabled</span><span class="o">=</span><span class="p">{</span><span class="nx">state</span><span class="p">.</span><span class="nx">historyIndex</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">0</span><span class="p">}</span>
<span class="w">          </span><span class="p">&gt;</span>
<span class="w">            </span><span class="nx">Undo</span><span class="w"> </span><span class="p">(</span><span class="err">‚åò</span><span class="nx">Z</span><span class="p">)</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">            </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">dispatch</span><span class="p">({</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;REDO&#39;</span><span class="w"> </span><span class="p">})}</span>
<span class="w">            </span><span class="na">disabled</span><span class="o">=</span><span class="p">{</span><span class="nx">state</span><span class="p">.</span><span class="nx">historyIndex</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">}</span>
<span class="w">          </span><span class="p">&gt;</span>
<span class="w">            </span><span class="nx">Redo</span><span class="w"> </span><span class="p">(</span><span class="err">‚åò‚áß</span><span class="nx">Z</span><span class="p">)</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">header</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">FilterBar</span>
<span class="w">        </span><span class="na">filters</span><span class="o">=</span><span class="p">{</span><span class="nx">state</span><span class="p">.</span><span class="nx">filters</span><span class="p">}</span>
<span class="w">        </span><span class="na">onFilterChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">filters</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span>
<span class="w">          </span><span class="nx">dispatch</span><span class="p">({</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;UPDATE_FILTERS&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="kt">filters</span><span class="w"> </span><span class="p">})</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="na">onClearFilters</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">dispatch</span><span class="p">({</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;CLEAR_FILTERS&#39;</span><span class="w"> </span><span class="p">})}</span>
<span class="w">        </span><span class="na">taskCount</span><span class="o">=</span><span class="p">{</span><span class="nx">filteredTasks</span><span class="p">.</span><span class="nx">length</span><span class="p">}</span>
<span class="w">        </span><span class="na">totalCount</span><span class="o">=</span><span class="p">{</span><span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">length</span><span class="p">}</span>
<span class="w">      </span><span class="p">/&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">TaskList</span>
<span class="w">        </span><span class="na">tasks</span><span class="o">=</span><span class="p">{</span><span class="nx">filteredTasks</span><span class="p">}</span>
<span class="w">        </span><span class="na">onStatusChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">id</span><span class="p">,</span><span class="w"> </span><span class="nx">status</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span>
<span class="w">          </span><span class="nx">dispatch</span><span class="p">({</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;UPDATE_TASK_STATUS&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="p">,</span><span class="w"> </span><span class="nx">status</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">})</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="na">onEdit</span><span class="o">=</span><span class="p">{(</span><span class="nx">task</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span>
<span class="w">          </span><span class="nx">dispatch</span><span class="p">({</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;OPEN_EDIT_FORM&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="kt">task</span><span class="w"> </span><span class="p">})</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="na">onDelete</span><span class="o">=</span><span class="p">{(</span><span class="nx">id</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span>
<span class="w">          </span><span class="nx">dispatch</span><span class="p">({</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;DELETE_TASK&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="kt">id</span><span class="w"> </span><span class="p">})</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">/&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="nx">state</span><span class="p">.</span><span class="nx">isFormOpen</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">TaskForm</span>
<span class="w">          </span><span class="na">task</span><span class="o">=</span><span class="p">{</span><span class="nx">state</span><span class="p">.</span><span class="nx">editingTask</span><span class="p">}</span>
<span class="w">          </span><span class="na">onSubmit</span><span class="o">=</span><span class="p">{(</span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span>
<span class="w">            </span><span class="nx">state</span><span class="p">.</span><span class="nx">editingTask</span>
<span class="w">              </span><span class="o">?</span><span class="w"> </span><span class="nx">dispatch</span><span class="p">({</span>
<span class="w">                  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;UPDATE_TASK&#39;</span><span class="p">,</span>
<span class="w">                  </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">state.editingTask.id</span><span class="p">,</span><span class="w"> </span><span class="nx">updates</span><span class="o">:</span><span class="w"> </span><span class="kt">data</span><span class="w"> </span><span class="p">},</span>
<span class="w">                </span><span class="p">})</span>
<span class="w">              </span><span class="o">:</span><span class="w"> </span><span class="nx">dispatch</span><span class="p">({</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;ADD_TASK&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="kt">data</span><span class="w"> </span><span class="p">})</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">          </span><span class="na">onCancel</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">dispatch</span><span class="p">({</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;CLOSE_FORM&#39;</span><span class="w"> </span><span class="p">})}</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">)}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="verification-does-it-work">Verification: Does It Work?</h3>
<p>Let's run through the same scenario that failed before:</p>
<p><strong>User Actions</strong>:
1. Add a task ‚Üí "Write tests"
2. Delete a task ‚Üí "Fix mobile responsive issues"
3. Change filter ‚Üí Status: "In Progress"
4. Press ‚åòZ (Undo)
5. Press ‚åòZ (Undo)
6. Press ‚åòZ (Undo)</p>
<p><strong>Browser Console</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="o">[</span><span class="n">TaskBoard</span><span class="o">]</span><span class="w"> </span><span class="n">Rendered</span>
<span class="o">[</span><span class="n">TaskBoard</span><span class="o">]</span><span class="w"> </span><span class="k">Action</span><span class="w"> </span><span class="nl">dispatched</span><span class="p">:</span><span class="w"> </span><span class="n">ADD_TASK</span>
<span class="o">[</span><span class="n">TaskBoard</span><span class="o">]</span><span class="w"> </span><span class="k">State</span><span class="w"> </span><span class="n">updated</span><span class="p">,</span><span class="w"> </span><span class="n">re</span><span class="o">-</span><span class="n">rendering</span>
<span class="o">[</span><span class="n">TaskBoard</span><span class="o">]</span><span class="w"> </span><span class="k">Action</span><span class="w"> </span><span class="nl">dispatched</span><span class="p">:</span><span class="w"> </span><span class="n">DELETE_TASK</span>
<span class="o">[</span><span class="n">TaskBoard</span><span class="o">]</span><span class="w"> </span><span class="k">State</span><span class="w"> </span><span class="n">updated</span><span class="p">,</span><span class="w"> </span><span class="n">re</span><span class="o">-</span><span class="n">rendering</span>
<span class="o">[</span><span class="n">TaskBoard</span><span class="o">]</span><span class="w"> </span><span class="k">Action</span><span class="w"> </span><span class="nl">dispatched</span><span class="p">:</span><span class="w"> </span><span class="n">UPDATE_FILTERS</span>
<span class="o">[</span><span class="n">TaskBoard</span><span class="o">]</span><span class="w"> </span><span class="k">State</span><span class="w"> </span><span class="n">updated</span><span class="p">,</span><span class="w"> </span><span class="n">re</span><span class="o">-</span><span class="n">rendering</span>
<span class="o">[</span><span class="n">TaskBoard</span><span class="o">]</span><span class="w"> </span><span class="k">Action</span><span class="w"> </span><span class="nl">dispatched</span><span class="p">:</span><span class="w"> </span><span class="n">UNDO</span>
<span class="o">[</span><span class="n">TaskBoard</span><span class="o">]</span><span class="w"> </span><span class="k">State</span><span class="w"> </span><span class="n">updated</span><span class="p">,</span><span class="w"> </span><span class="n">re</span><span class="o">-</span><span class="n">rendering</span><span class="w"> </span><span class="p">(</span><span class="k">filter</span><span class="w"> </span><span class="n">reverted</span><span class="p">)</span>
<span class="o">[</span><span class="n">TaskBoard</span><span class="o">]</span><span class="w"> </span><span class="k">Action</span><span class="w"> </span><span class="nl">dispatched</span><span class="p">:</span><span class="w"> </span><span class="n">UNDO</span>
<span class="o">[</span><span class="n">TaskBoard</span><span class="o">]</span><span class="w"> </span><span class="k">State</span><span class="w"> </span><span class="n">updated</span><span class="p">,</span><span class="w"> </span><span class="n">re</span><span class="o">-</span><span class="n">rendering</span><span class="w"> </span><span class="p">(</span><span class="n">deleted</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">restored</span><span class="p">)</span>
<span class="o">[</span><span class="n">TaskBoard</span><span class="o">]</span><span class="w"> </span><span class="k">Action</span><span class="w"> </span><span class="nl">dispatched</span><span class="p">:</span><span class="w"> </span><span class="n">UNDO</span>
<span class="o">[</span><span class="n">TaskBoard</span><span class="o">]</span><span class="w"> </span><span class="k">State</span><span class="w"> </span><span class="n">updated</span><span class="p">,</span><span class="w"> </span><span class="n">re</span><span class="o">-</span><span class="n">rendering</span><span class="w"> </span><span class="p">(</span><span class="n">added</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">removed</span><span class="p">)</span>
</code></pre></div>

<p><strong>React DevTools Evidence</strong>:
- Component tree: <code>TaskBoard</code> rendering normally
- State inspection:
  - <code>state.tasks</code>: Array with 3 tasks (back to original)
  - <code>state.filters</code>: Back to default values
  - <code>state.history</code>: Array with 3 entries
  - <code>state.historyIndex</code>: 0 (at the beginning)
- Render count: 7 renders total (1 initial + 6 actions)
- No infinite loops, no errors</p>
<p><strong>Expected vs. Actual</strong>:
- ‚úÖ Filter change undone correctly
- ‚úÖ Deleted task restored
- ‚úÖ Added task removed
- ‚úÖ All state synchronized
- ‚úÖ No performance issues
- ‚úÖ Keyboard shortcuts work</p>
<h3 id="what-changed-and-why-it-works">What Changed and Why It Works</h3>
<p><strong>Before (useState)</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">tasks</span><span class="p">,</span><span class="w"> </span><span class="nx">setTasks</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">Task</span><span class="err">[]</span><span class="p">&gt;([]);</span>
<span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">filters</span><span class="p">,</span><span class="w"> </span><span class="nx">setFilters</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">TaskFilters</span><span class="p">&gt;({});</span>
<span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">isFormOpen</span><span class="p">,</span><span class="w"> </span><span class="nx">setIsFormOpen</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">editingTask</span><span class="p">,</span><span class="w"> </span><span class="nx">setEditingTask</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">Task</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="na">null</span><span class="p">&gt;(</span><span class="kc">null</span><span class="p">);</span>

<span class="c1">// Problem: Four separate pieces of state</span>
<span class="c1">// Problem: No guarantee they update together</span>
<span class="c1">// Problem: History must track all four separately</span>
</code></pre></div>

<p><strong>After (useReducer)</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">state</span><span class="p">,</span><span class="w"> </span><span class="nx">dispatch</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useReducer</span><span class="p">(</span><span class="nx">taskBoardReducer</span><span class="p">,</span><span class="w"> </span><span class="nx">initialState</span><span class="p">);</span>

<span class="c1">// Solution: One state object</span>
<span class="c1">// Solution: All updates are atomic</span>
<span class="c1">// Solution: History is built into the state</span>
</code></pre></div>

<h3 id="the-usereducer-mental-model">The useReducer Mental Model</h3>
<p>Think of <code>useReducer</code> as a state machine:</p>
<ol>
<li><strong>State</strong>: The current snapshot of your application</li>
<li><strong>Actions</strong>: Events that describe what happened</li>
<li><strong>Reducer</strong>: A pure function that computes the next state</li>
<li><strong>Dispatch</strong>: The function that sends actions to the reducer</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="nv">Current</span><span class="w"> </span><span class="nv">State</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">Action</span><span class="w"> </span>‚Üí<span class="w"> </span><span class="nv">Reducer</span><span class="w"> </span>‚Üí<span class="w"> </span><span class="k">Next</span><span class="w"> </span><span class="nv">State</span>
</code></pre></div>

<p>The reducer is <strong>pure</strong>: given the same state and action, it always returns the same next state. This makes it:
- Predictable
- Testable
- Debuggable
- Time-travel-able (undo/redo)</p>
<h3 id="when-to-use-usereducer">When to Use useReducer</h3>
<p>Use <code>useReducer</code> when you have:</p>
<p>‚úÖ <strong>Multiple related pieces of state</strong> that must update together
‚úÖ <strong>Complex update logic</strong> with many conditional branches
‚úÖ <strong>State transitions</strong> that depend on previous state
‚úÖ <strong>Need for undo/redo</strong> or time-travel debugging
‚úÖ <strong>Actions that need to be logged</strong> or replayed</p>
<p>Don't use <code>useReducer</code> when:</p>
<p>‚ùå State is simple and independent
‚ùå Updates are straightforward (just setting a value)
‚ùå You're adding complexity without solving a real problem</p>
<h3 id="common-failure-modes-with-usereducer">Common Failure Modes with useReducer</h3>
<h4 id="symptom-state-updates-but-component-doesnt-re-render">Symptom: State updates but component doesn't re-render</h4>
<p><strong>Root cause</strong>: Mutating state instead of returning a new object</p>
<p><strong>Wrong</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="k">case</span><span class="w"> </span><span class="s1">&#39;ADD_TASK&#39;</span><span class="o">:</span>
<span class="w">  </span><span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">newTask</span><span class="p">);</span><span class="w"> </span><span class="c1">// Mutation!</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">state</span><span class="p">;</span><span class="w"> </span><span class="c1">// Same reference, React won&#39;t re-render</span>
</code></pre></div>

<p><strong>Right</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="k">case</span><span class="w"> </span><span class="s1">&#39;ADD_TASK&#39;</span><span class="o">:</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">...</span><span class="nx">state</span><span class="p">,</span>
<span class="w">    </span><span class="nx">tasks</span><span class="o">:</span><span class="w"> </span><span class="p">[...</span><span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">,</span><span class="w"> </span><span class="nx">newTask</span><span class="p">],</span><span class="w"> </span><span class="c1">// New array</span>
<span class="w">  </span><span class="p">};</span>
</code></pre></div>

<h4 id="symptom-reducer-becomes-a-giant-switch-statement">Symptom: Reducer becomes a giant switch statement</h4>
<p><strong>Root cause</strong>: Too many actions, not enough abstraction</p>
<p><strong>Solution</strong>: Split into multiple reducers or extract helper functions</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Instead of one giant reducer:</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">taskBoardReducer</span><span class="p">(</span><span class="nx">state</span><span class="p">,</span><span class="w"> </span><span class="nx">action</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">action</span><span class="p">.</span><span class="kr">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;ADD_TASK&#39;</span><span class="o">:</span><span class="w"> </span><span class="cm">/* ... */</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;UPDATE_TASK&#39;</span><span class="o">:</span><span class="w"> </span><span class="cm">/* ... */</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;DELETE_TASK&#39;</span><span class="o">:</span><span class="w"> </span><span class="cm">/* ... */</span>
<span class="w">    </span><span class="c1">// ... 20 more cases</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Split into focused reducers:</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">tasksReducer</span><span class="p">(</span><span class="nx">tasks</span><span class="p">,</span><span class="w"> </span><span class="nx">action</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">action</span><span class="p">.</span><span class="kr">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;ADD_TASK&#39;</span><span class="o">:</span><span class="w"> </span><span class="cm">/* ... */</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;UPDATE_TASK&#39;</span><span class="o">:</span><span class="w"> </span><span class="cm">/* ... */</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;DELETE_TASK&#39;</span><span class="o">:</span><span class="w"> </span><span class="cm">/* ... */</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">filtersReducer</span><span class="p">(</span><span class="nx">filters</span><span class="p">,</span><span class="w"> </span><span class="nx">action</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">action</span><span class="p">.</span><span class="kr">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;UPDATE_FILTERS&#39;</span><span class="o">:</span><span class="w"> </span><span class="cm">/* ... */</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;CLEAR_FILTERS&#39;</span><span class="o">:</span><span class="w"> </span><span class="cm">/* ... */</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">taskBoardReducer</span><span class="p">(</span><span class="nx">state</span><span class="p">,</span><span class="w"> </span><span class="nx">action</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">tasks</span><span class="o">:</span><span class="w"> </span><span class="kt">tasksReducer</span><span class="p">(</span><span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">,</span><span class="w"> </span><span class="nx">action</span><span class="p">),</span>
<span class="w">    </span><span class="nx">filters</span><span class="o">:</span><span class="w"> </span><span class="kt">filtersReducer</span><span class="p">(</span><span class="nx">state</span><span class="p">.</span><span class="nx">filters</span><span class="p">,</span><span class="w"> </span><span class="nx">action</span><span class="p">),</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="testing-usereducer">Testing useReducer</h3>
<p>Reducers are pure functions, making them trivial to test:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/reducers/taskBoardReducer.test.ts</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">describe</span><span class="p">,</span><span class="w"> </span><span class="nx">it</span><span class="p">,</span><span class="w"> </span><span class="nx">expect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;vitest&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">taskBoardReducer</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./taskBoardReducer&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskBoardState</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/task&#39;</span><span class="p">;</span>

<span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;taskBoardReducer&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">initialState</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskBoardState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">tasks</span><span class="o">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">    </span><span class="nx">filters</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">assignee</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">searchQuery</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nx">isFormOpen</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
<span class="w">    </span><span class="nx">editingTask</span><span class="o">:</span><span class="w"> </span><span class="kt">null</span><span class="p">,</span>
<span class="w">    </span><span class="nx">history</span><span class="o">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">    </span><span class="nx">historyIndex</span><span class="o">:</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="p">,</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="nx">it</span><span class="p">(</span><span class="s1">&#39;adds a task&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;ADD_TASK&#39;</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kd">const</span><span class="p">,</span>
<span class="w">      </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Test task&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Test description&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;todo&#39;</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kd">const</span><span class="p">,</span>
<span class="w">        </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;medium&#39;</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kd">const</span><span class="p">,</span>
<span class="w">        </span><span class="nx">assignee</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">nextState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">taskBoardReducer</span><span class="p">(</span><span class="nx">initialState</span><span class="p">,</span><span class="w"> </span><span class="nx">action</span><span class="p">);</span>

<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">nextState</span><span class="p">.</span><span class="nx">tasks</span><span class="p">).</span><span class="nx">toHaveLength</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">nextState</span><span class="p">.</span><span class="nx">tasks</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">title</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="s1">&#39;Test task&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">nextState</span><span class="p">.</span><span class="nx">isFormOpen</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">nextState</span><span class="p">.</span><span class="nx">history</span><span class="p">).</span><span class="nx">toHaveLength</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span><span class="w"> </span><span class="c1">// History saved</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="nx">it</span><span class="p">(</span><span class="s1">&#39;deletes a task&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">stateWithTask</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskBoardState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="p">...</span><span class="nx">initialState</span><span class="p">,</span>
<span class="w">      </span><span class="nx">tasks</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Task to delete&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Will be deleted&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;todo&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;low&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">assignee</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">createdAt</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(),</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;DELETE_TASK&#39;</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kd">const</span><span class="p">,</span>
<span class="w">      </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">nextState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">taskBoardReducer</span><span class="p">(</span><span class="nx">stateWithTask</span><span class="p">,</span><span class="w"> </span><span class="nx">action</span><span class="p">);</span>

<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">nextState</span><span class="p">.</span><span class="nx">tasks</span><span class="p">).</span><span class="nx">toHaveLength</span><span class="p">(</span><span class="mf">0</span><span class="p">);</span>
<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">nextState</span><span class="p">.</span><span class="nx">history</span><span class="p">).</span><span class="nx">toHaveLength</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span><span class="w"> </span><span class="c1">// History saved</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="nx">it</span><span class="p">(</span><span class="s1">&#39;supports undo&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Start with a task</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">stateWithTask</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskBoardState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="p">...</span><span class="nx">initialState</span><span class="p">,</span>
<span class="w">      </span><span class="nx">tasks</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Original task&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Original&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;todo&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;low&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">assignee</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">createdAt</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(),</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="c1">// Delete the task</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">stateAfterDelete</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">taskBoardReducer</span><span class="p">(</span><span class="nx">stateWithTask</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;DELETE_TASK&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">stateAfterDelete</span><span class="p">.</span><span class="nx">tasks</span><span class="p">).</span><span class="nx">toHaveLength</span><span class="p">(</span><span class="mf">0</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Undo the deletion</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">stateAfterUndo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">taskBoardReducer</span><span class="p">(</span><span class="nx">stateAfterDelete</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;UNDO&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">stateAfterUndo</span><span class="p">.</span><span class="nx">tasks</span><span class="p">).</span><span class="nx">toHaveLength</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">stateAfterUndo</span><span class="p">.</span><span class="nx">tasks</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">title</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="s1">&#39;Original task&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="nx">it</span><span class="p">(</span><span class="s1">&#39;does nothing when undoing with no history&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;UNDO&#39;</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="p">};</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">nextState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">taskBoardReducer</span><span class="p">(</span><span class="nx">initialState</span><span class="p">,</span><span class="w"> </span><span class="nx">action</span><span class="p">);</span>

<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">nextState</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="nx">initialState</span><span class="p">);</span><span class="w"> </span><span class="c1">// Same reference</span>
<span class="w">  </span><span class="p">});</span>
<span class="p">});</span>
</code></pre></div>

<h3 id="the-reducer-pattern-lessons-learned">The Reducer Pattern: Lessons Learned</h3>
<p><strong>1. Actions are data, not functions</strong></p>
<p>Actions describe what happened, not how to handle it. The reducer decides how to handle it.</p>
<p><strong>2. Reducers are pure</strong></p>
<p>No side effects. No API calls. No randomness. Just: <code>(state, action) =&gt; nextState</code>.</p>
<p><strong>3. State is immutable</strong></p>
<p>Always return a new state object. Never mutate the existing state.</p>
<p><strong>4. One source of truth</strong></p>
<p>All related state lives in one object. No synchronization problems.</p>
<p><strong>5. Time-travel debugging</strong></p>
<p>Because every state change is explicit and reversible, you can implement undo/redo, replay actions, or debug by stepping through state changes.</p>
<h3 id="when-to-apply-this-solution">When to Apply This Solution</h3>
<p><strong>What it optimizes for</strong>:
- State consistency
- Complex update logic
- Predictable state transitions
- Testability
- Debugging</p>
<p><strong>What it sacrifices</strong>:
- Initial setup complexity
- More boilerplate code
- Learning curve for team members unfamiliar with reducers</p>
<p><strong>When to choose this approach</strong>:
- Multiple pieces of state that must stay synchronized
- Complex state update logic with many conditions
- Need for undo/redo or time-travel debugging
- State transitions that depend on previous state
- Team is comfortable with Redux-style patterns</p>
<p><strong>When to avoid this approach</strong>:
- Simple, independent state
- Straightforward updates (just setting values)
- Small components with minimal state
- Team prefers simpler patterns</p>
<p><strong>Code characteristics</strong>:
- Setup: More initial code (types, reducer, actions)
- Maintenance: Easier to modify (add new actions without touching component)
- Performance: Same as useState (React optimizes both equally)
- Testing: Much easier (pure functions)</p>
<p>The key insight: <code>useReducer</code> doesn't make your code faster or more performant. It makes it more <strong>maintainable</strong> and <strong>predictable</strong> when state logic becomes complex.</p>
<h2 id="context-api-use-sparingly">Context API: use sparingly</h2>
<h2 id="context-api-use-sparingly_1">Context API: use sparingly</h2>
<h3 id="phase-3-the-prop-drilling-problem">Phase 3: The Prop Drilling Problem</h3>
<p>Our TaskBoard works well, but it's still a single component. In a real application, we'd want to split it into multiple pages and share state across them. Let's add a realistic feature: <strong>a separate analytics dashboard</strong> that shows task statistics.</p>
<p><strong>New Project Structure</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="nx">src</span><span class="o">/</span>
<span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">components</span><span class="o">/</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">TaskBoard</span><span class="p">.</span><span class="nx">tsx</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">TaskList</span><span class="p">.</span><span class="nx">tsx</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">TaskItem</span><span class="p">.</span><span class="nx">tsx</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">TaskForm</span><span class="p">.</span><span class="nx">tsx</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">FilterBar</span><span class="p">.</span><span class="nx">tsx</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">AnalyticsDashboard</span><span class="p">.</span><span class="nx">tsx</span><span class="w">  </span><span class="err">‚Üê</span><span class="w"> </span><span class="nx">New</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">TaskStats</span><span class="p">.</span><span class="nx">tsx</span><span class="w">            </span><span class="err">‚Üê</span><span class="w"> </span><span class="nx">New</span>
<span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">pages</span><span class="o">/</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">TasksPage</span><span class="p">.</span><span class="nx">tsx</span><span class="w">            </span><span class="err">‚Üê</span><span class="w"> </span><span class="nx">New</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">AnalyticsPage</span><span class="p">.</span><span class="nx">tsx</span><span class="w">        </span><span class="err">‚Üê</span><span class="w"> </span><span class="nx">New</span>
<span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">App</span><span class="p">.</span><span class="nx">tsx</span>
<span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">types</span><span class="o">/</span>
<span class="w">    </span><span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">task</span><span class="p">.</span><span class="nx">ts</span>
</code></pre></div>

<h3 id="the-failure-prop-drilling-through-five-levels">The Failure: Prop Drilling Through Five Levels</h3>
<p>Let's try to share our task state across pages using props:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/App.tsx - Attempting to share state via props</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useReducer</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskBoardState</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./types/task&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">taskBoardReducer</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./reducers/taskBoardReducer&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TasksPage</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./pages/TasksPage&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">AnalyticsPage</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./pages/AnalyticsPage&#39;</span><span class="p">;</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">initialState</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskBoardState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="cm">/* ... initial state ... */</span>
<span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">App</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">state</span><span class="p">,</span><span class="w"> </span><span class="nx">dispatch</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useReducer</span><span class="p">(</span><span class="nx">taskBoardReducer</span><span class="p">,</span><span class="w"> </span><span class="nx">initialState</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">currentPage</span><span class="p">,</span><span class="w"> </span><span class="nx">setCurrentPage</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="o">&lt;</span><span class="s1">&#39;tasks&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;analytics&#39;</span><span class="o">&gt;</span><span class="p">(</span><span class="s1">&#39;tasks&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;app&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">nav</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setCurrentPage</span><span class="p">(</span><span class="s1">&#39;tasks&#39;</span><span class="p">)}&gt;</span><span class="nx">Tasks</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setCurrentPage</span><span class="p">(</span><span class="s1">&#39;analytics&#39;</span><span class="p">)}&gt;</span><span class="nx">Analytics</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">nav</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="nx">currentPage</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;tasks&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">TasksPage</span><span class="w"> </span><span class="na">state</span><span class="o">=</span><span class="p">{</span><span class="nx">state</span><span class="p">}</span><span class="w"> </span><span class="na">dispatch</span><span class="o">=</span><span class="p">{</span><span class="nx">dispatch</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">AnalyticsPage</span><span class="w"> </span><span class="na">state</span><span class="o">=</span><span class="p">{</span><span class="nx">state</span><span class="p">}</span><span class="w"> </span><span class="na">dispatch</span><span class="o">=</span><span class="p">{</span><span class="nx">dispatch</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">)}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/pages/TasksPage.tsx</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskBoardState</span><span class="p">,</span><span class="w"> </span><span class="nx">TaskBoardAction</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/task&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskBoard</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../components/TaskBoard&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">TasksPageProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">state</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskBoardState</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dispatch</span><span class="o">:</span><span class="w"> </span><span class="kt">React.Dispatch</span><span class="p">&lt;</span><span class="nt">TaskBoardAction</span><span class="p">&gt;;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TasksPage</span><span class="p">({</span><span class="w"> </span><span class="nx">state</span><span class="p">,</span><span class="w"> </span><span class="nx">dispatch</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">TasksPageProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;tasks-page&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">TaskBoard</span><span class="w"> </span><span class="na">state</span><span class="o">=</span><span class="p">{</span><span class="nx">state</span><span class="p">}</span><span class="w"> </span><span class="na">dispatch</span><span class="o">=</span><span class="p">{</span><span class="nx">dispatch</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/TaskBoard.tsx - Now needs props</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskBoardState</span><span class="p">,</span><span class="w"> </span><span class="nx">TaskBoardAction</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/task&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskList</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./TaskList&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">FilterBar</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./FilterBar&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">TaskBoardProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">state</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskBoardState</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dispatch</span><span class="o">:</span><span class="w"> </span><span class="kt">React.Dispatch</span><span class="p">&lt;</span><span class="nt">TaskBoardAction</span><span class="p">&gt;;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TaskBoard</span><span class="p">({</span><span class="w"> </span><span class="nx">state</span><span class="p">,</span><span class="w"> </span><span class="nx">dispatch</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">TaskBoardProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Now we have to pass state and dispatch to every child</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-board&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">FilterBar</span>
<span class="w">        </span><span class="na">filters</span><span class="o">=</span><span class="p">{</span><span class="nx">state</span><span class="p">.</span><span class="nx">filters</span><span class="p">}</span>
<span class="w">        </span><span class="na">onFilterChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">filters</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span>
<span class="w">          </span><span class="nx">dispatch</span><span class="p">({</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;UPDATE_FILTERS&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="kt">filters</span><span class="w"> </span><span class="p">})</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="err">//</span><span class="w"> </span><span class="na">...</span><span class="w"> </span><span class="na">more</span><span class="w"> </span><span class="na">props</span>
<span class="w">      </span><span class="p">/&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">TaskList</span>
<span class="w">        </span><span class="na">tasks</span><span class="o">=</span><span class="p">{</span><span class="nx">filteredTasks</span><span class="p">}</span>
<span class="w">        </span><span class="na">dispatch</span><span class="o">=</span><span class="p">{</span><span class="nx">dispatch</span><span class="p">}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="na">Pass</span><span class="w"> </span><span class="na">dispatch</span><span class="w"> </span><span class="na">down</span>
<span class="w">        </span><span class="err">//</span><span class="w"> </span><span class="na">...</span><span class="w"> </span><span class="na">more</span><span class="w"> </span><span class="na">props</span>
<span class="w">      </span><span class="p">/&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/TaskList.tsx - Needs dispatch now</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Task</span><span class="p">,</span><span class="w"> </span><span class="nx">TaskBoardAction</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/task&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskItem</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./TaskItem&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">TaskListProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">tasks</span><span class="o">:</span><span class="w"> </span><span class="kt">Task</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">dispatch</span><span class="o">:</span><span class="w"> </span><span class="kt">React.Dispatch</span><span class="p">&lt;</span><span class="nt">TaskBoardAction</span><span class="p">&gt;;</span><span class="w"> </span><span class="c1">// Added</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TaskList</span><span class="p">({</span><span class="w"> </span><span class="nx">tasks</span><span class="p">,</span><span class="w"> </span><span class="nx">dispatch</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">TaskListProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-list&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">task</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">TaskItem</span>
<span class="w">          </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">task</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span>
<span class="w">          </span><span class="na">task</span><span class="o">=</span><span class="p">{</span><span class="nx">task</span><span class="p">}</span>
<span class="w">          </span><span class="na">dispatch</span><span class="o">=</span><span class="p">{</span><span class="nx">dispatch</span><span class="p">}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="na">Pass</span><span class="w"> </span><span class="na">dispatch</span><span class="w"> </span><span class="na">down</span><span class="w"> </span><span class="na">again</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">))}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/TaskItem.tsx - Finally uses dispatch</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Task</span><span class="p">,</span><span class="w"> </span><span class="nx">TaskBoardAction</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/task&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">TaskItemProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">task</span><span class="o">:</span><span class="w"> </span><span class="kt">Task</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dispatch</span><span class="o">:</span><span class="w"> </span><span class="kt">React.Dispatch</span><span class="p">&lt;</span><span class="nt">TaskBoardAction</span><span class="p">&gt;;</span><span class="w"> </span><span class="c1">// Added</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TaskItem</span><span class="p">({</span><span class="w"> </span><span class="nx">task</span><span class="p">,</span><span class="w"> </span><span class="nx">dispatch</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">TaskItemProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-item&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="cm">/* ... task display ... */</span><span class="p">}</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">        </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span>
<span class="w">          </span><span class="nx">dispatch</span><span class="p">({</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;DELETE_TASK&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="kt">task.id</span><span class="w"> </span><span class="p">})</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">&gt;</span>
<span class="w">        </span><span class="nx">Delete</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>Now let's add the analytics page:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/pages/AnalyticsPage.tsx</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskBoardState</span><span class="p">,</span><span class="w"> </span><span class="nx">TaskBoardAction</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/task&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">AnalyticsDashboard</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../components/AnalyticsDashboard&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">AnalyticsPageProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">state</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskBoardState</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dispatch</span><span class="o">:</span><span class="w"> </span><span class="kt">React.Dispatch</span><span class="p">&lt;</span><span class="nt">TaskBoardAction</span><span class="p">&gt;;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">AnalyticsPage</span><span class="p">({</span><span class="w"> </span><span class="nx">state</span><span class="p">,</span><span class="w"> </span><span class="nx">dispatch</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">AnalyticsPageProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;analytics-page&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Task</span><span class="w"> </span><span class="nx">Analytics</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">AnalyticsDashboard</span><span class="w"> </span><span class="na">state</span><span class="o">=</span><span class="p">{</span><span class="nx">state</span><span class="p">}</span><span class="w"> </span><span class="na">dispatch</span><span class="o">=</span><span class="p">{</span><span class="nx">dispatch</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/AnalyticsDashboard.tsx</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskBoardState</span><span class="p">,</span><span class="w"> </span><span class="nx">TaskBoardAction</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/task&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskStats</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./TaskStats&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">AnalyticsDashboardProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">state</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskBoardState</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dispatch</span><span class="o">:</span><span class="w"> </span><span class="kt">React.Dispatch</span><span class="p">&lt;</span><span class="nt">TaskBoardAction</span><span class="p">&gt;;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">AnalyticsDashboard</span><span class="p">({</span><span class="w"> </span><span class="nx">state</span><span class="p">,</span><span class="w"> </span><span class="nx">dispatch</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">AnalyticsDashboardProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;analytics-dashboard&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">TaskStats</span><span class="w"> </span><span class="na">state</span><span class="o">=</span><span class="p">{</span><span class="nx">state</span><span class="p">}</span><span class="w"> </span><span class="na">dispatch</span><span class="o">=</span><span class="p">{</span><span class="nx">dispatch</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="cm">/* More analytics components */</span><span class="p">}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/TaskStats.tsx</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskBoardState</span><span class="p">,</span><span class="w"> </span><span class="nx">TaskBoardAction</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/task&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">TaskStatsProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">state</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskBoardState</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dispatch</span><span class="o">:</span><span class="w"> </span><span class="kt">React.Dispatch</span><span class="p">&lt;</span><span class="nt">TaskBoardAction</span><span class="p">&gt;;</span><span class="w"> </span><span class="c1">// Doesn&#39;t even use this!</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TaskStats</span><span class="p">({</span><span class="w"> </span><span class="nx">state</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">TaskStatsProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">totalTasks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">completedTasks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">t</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">t</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;done&#39;</span><span class="p">).</span><span class="nx">length</span><span class="p">;</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">inProgressTasks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">t</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">t</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;in-progress&#39;</span><span class="p">).</span><span class="nx">length</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-stats&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;stat&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">Total</span><span class="w"> </span><span class="nx">Tasks</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;{</span><span class="nx">totalTasks</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;stat&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">Completed</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;{</span><span class="nx">completedTasks</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;stat&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">In</span><span class="w"> </span><span class="nx">Progress</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;{</span><span class="nx">inProgressTasks</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="diagnostic-analysis-reading-the-prop-drilling-problem">Diagnostic Analysis: Reading the Prop Drilling Problem</h3>
<p><strong>Browser Behavior</strong>:
- App works correctly
- Data flows from App ‚Üí Pages ‚Üí Components
- But the code is becoming unmaintainable</p>
<p><strong>React DevTools Evidence</strong>:
- Component tree shows the prop chain:
  <code>App
    ‚îî‚îÄ TasksPage (props: state, dispatch)
        ‚îî‚îÄ TaskBoard (props: state, dispatch)
            ‚îî‚îÄ TaskList (props: tasks, dispatch)
                ‚îî‚îÄ TaskItem (props: task, dispatch)</code>
- Every intermediate component passes props it doesn't use
- <code>TaskList</code> doesn't use <code>dispatch</code>, but must pass it to <code>TaskItem</code>
- <code>AnalyticsDashboard</code> doesn't use <code>dispatch</code>, but must pass it to <code>TaskStats</code></p>
<p><strong>Code smell indicators</strong>:
1. <strong>Props that tunnel through</strong>: Components receive props only to pass them down
2. <strong>Brittle refactoring</strong>: Moving a component requires updating all intermediate components
3. <strong>Type duplication</strong>: Every component needs the same prop types
4. <strong>Cognitive overhead</strong>: Hard to understand what each component actually needs</p>
<p><strong>What the user experiences</strong>:
- Expected: App works fine
- Actual: App works fine, but developers suffer</p>
<p><strong>Root cause identified</strong>: </p>
<p>We're using props for <strong>global state</strong>. Props are designed for parent-to-child communication, not for application-wide state. When state needs to be accessed by components at different levels of the tree, props become a burden.</p>
<p><strong>Why the current approach can't solve this</strong>:</p>
<p>Props flow downward. To share state between distant components, you must lift state to a common ancestor and pass it down through every intermediate component. This creates coupling and maintenance problems.</p>
<p><strong>What we need</strong>: </p>
<p>A way to make state available to any component that needs it, without passing it through every intermediate component. We need Context.</p>
<h3 id="iteration-2-refactoring-to-context">Iteration 2: Refactoring to Context</h3>
<p>The Context API provides a way to share values between components without explicitly passing props through every level of the tree.</p>
<p><strong>The mental model</strong>:
- Create a Context to hold shared state
- Provide the Context value at the top of your component tree
- Consume the Context value in any descendant component</p>
<p>Let's refactor:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/contexts/TaskBoardContext.tsx</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">createContext</span><span class="p">,</span><span class="w"> </span><span class="nx">useContext</span><span class="p">,</span><span class="w"> </span><span class="nx">useReducer</span><span class="p">,</span><span class="w"> </span><span class="nx">ReactNode</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskBoardState</span><span class="p">,</span><span class="w"> </span><span class="nx">TaskBoardAction</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/task&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">taskBoardReducer</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../reducers/taskBoardReducer&#39;</span><span class="p">;</span>

<span class="c1">// Define the context value type</span>
<span class="kd">interface</span><span class="w"> </span><span class="nx">TaskBoardContextValue</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">state</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskBoardState</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dispatch</span><span class="o">:</span><span class="w"> </span><span class="kt">React.Dispatch</span><span class="p">&lt;</span><span class="nt">TaskBoardAction</span><span class="p">&gt;;</span>
<span class="p">}</span>

<span class="c1">// Create the context with undefined as default</span>
<span class="c1">// (we&#39;ll provide the real value in the Provider)</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">TaskBoardContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createContext</span><span class="p">&lt;</span><span class="nt">TaskBoardContextValue</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="na">undefined</span><span class="p">&gt;(</span>
<span class="w">  </span><span class="kc">undefined</span>
<span class="p">);</span>

<span class="c1">// Initial state</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">initialState</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskBoardState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">tasks</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Implement user authentication&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Add JWT-based auth flow&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;in-progress&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;high&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">assignee</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">createdAt</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="s1">&#39;2024-01-15&#39;</span><span class="p">),</span>
<span class="w">      </span><span class="nx">dueDate</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="s1">&#39;2024-02-01&#39;</span><span class="p">),</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Write API documentation&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Document all REST endpoints&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;todo&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;medium&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">assignee</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">createdAt</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="s1">&#39;2024-01-16&#39;</span><span class="p">),</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Fix mobile responsive issues&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Dashboard breaks on small screens&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;done&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;high&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">assignee</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">createdAt</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="s1">&#39;2024-01-10&#39;</span><span class="p">),</span>
<span class="w">      </span><span class="nx">dueDate</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="s1">&#39;2024-01-20&#39;</span><span class="p">),</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="nx">filters</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">assignee</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">searchQuery</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nx">isFormOpen</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
<span class="w">  </span><span class="nx">editingTask</span><span class="o">:</span><span class="w"> </span><span class="kt">null</span><span class="p">,</span>
<span class="w">  </span><span class="nx">history</span><span class="o">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">  </span><span class="nx">historyIndex</span><span class="o">:</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="p">,</span>
<span class="p">};</span>

<span class="c1">// Provider component</span>
<span class="kd">interface</span><span class="w"> </span><span class="nx">TaskBoardProviderProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">children</span><span class="o">:</span><span class="w"> </span><span class="kt">ReactNode</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TaskBoardProvider</span><span class="p">({</span><span class="w"> </span><span class="nx">children</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">TaskBoardProviderProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">state</span><span class="p">,</span><span class="w"> </span><span class="nx">dispatch</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useReducer</span><span class="p">(</span><span class="nx">taskBoardReducer</span><span class="p">,</span><span class="w"> </span><span class="nx">initialState</span><span class="p">);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskBoardContextValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">state</span><span class="p">,</span>
<span class="w">    </span><span class="nx">dispatch</span><span class="p">,</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">TaskBoardContext</span><span class="p">.</span><span class="na">Provider</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">value</span><span class="p">}&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">children</span><span class="p">}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">TaskBoardContext</span><span class="p">.</span><span class="na">Provider</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Custom hook to use the context</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">useTaskBoard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">context</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useContext</span><span class="p">(</span><span class="nx">TaskBoardContext</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">context</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="kc">undefined</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;useTaskBoard must be used within a TaskBoardProvider&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">context</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p>Now update the App to use the Provider:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/App.tsx - Using Context Provider</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskBoardProvider</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./contexts/TaskBoardContext&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TasksPage</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./pages/TasksPage&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">AnalyticsPage</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./pages/AnalyticsPage&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">App</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">currentPage</span><span class="p">,</span><span class="w"> </span><span class="nx">setCurrentPage</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="o">&lt;</span><span class="s1">&#39;tasks&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;analytics&#39;</span><span class="o">&gt;</span><span class="p">(</span><span class="s1">&#39;tasks&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">TaskBoardProvider</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;app&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">nav</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setCurrentPage</span><span class="p">(</span><span class="s1">&#39;tasks&#39;</span><span class="p">)}&gt;</span><span class="nx">Tasks</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setCurrentPage</span><span class="p">(</span><span class="s1">&#39;analytics&#39;</span><span class="p">)}&gt;</span><span class="nx">Analytics</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">nav</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">{</span><span class="nx">currentPage</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;tasks&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">TasksPage</span><span class="w"> </span><span class="p">/&gt;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">AnalyticsPage</span><span class="w"> </span><span class="p">/&gt;}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">TaskBoardProvider</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>Pages no longer need props:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/pages/TasksPage.tsx - No props needed</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskBoard</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../components/TaskBoard&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TasksPage</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;tasks-page&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">TaskBoard</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/pages/AnalyticsPage.tsx - No props needed</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">AnalyticsDashboard</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../components/AnalyticsDashboard&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">AnalyticsPage</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;analytics-page&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Task</span><span class="w"> </span><span class="nx">Analytics</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">AnalyticsDashboard</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>Components consume context directly:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/TaskBoard.tsx - Using Context</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useMemo</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useTaskBoard</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../contexts/TaskBoardContext&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskList</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./TaskList&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">FilterBar</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./FilterBar&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskForm</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./TaskForm&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TaskBoard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">state</span><span class="p">,</span><span class="w"> </span><span class="nx">dispatch</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useTaskBoard</span><span class="p">();</span><span class="w"> </span><span class="c1">// Get from context</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filteredTasks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">task</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">state</span><span class="p">.</span><span class="nx">filters</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">task</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">filters</span><span class="p">.</span><span class="nx">status</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">state</span><span class="p">.</span><span class="nx">filters</span><span class="p">.</span><span class="nx">priority</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">task</span><span class="p">.</span><span class="nx">priority</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">filters</span><span class="p">.</span><span class="nx">priority</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">state</span><span class="p">.</span><span class="nx">filters</span><span class="p">.</span><span class="nx">assignee</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">task</span><span class="p">.</span><span class="nx">assignee</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">filters</span><span class="p">.</span><span class="nx">assignee</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">state</span><span class="p">.</span><span class="nx">filters</span><span class="p">.</span><span class="nx">searchQuery</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">filters</span><span class="p">.</span><span class="nx">searchQuery</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="nx">task</span><span class="p">.</span><span class="nx">title</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">includes</span><span class="p">(</span><span class="nx">query</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
<span class="w">          </span><span class="nx">task</span><span class="p">.</span><span class="nx">description</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">includes</span><span class="p">(</span><span class="nx">query</span><span class="p">)</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">,</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">filters</span><span class="p">]);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-board&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">header</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;board-header&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Task</span><span class="w"> </span><span class="nx">Board</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;header-actions&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">dispatch</span><span class="p">({</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;OPEN_FORM&#39;</span><span class="w"> </span><span class="p">})}&gt;</span>
<span class="w">            </span><span class="nx">Add</span><span class="w"> </span><span class="nx">Task</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">            </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">dispatch</span><span class="p">({</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;UNDO&#39;</span><span class="w"> </span><span class="p">})}</span>
<span class="w">            </span><span class="na">disabled</span><span class="o">=</span><span class="p">{</span><span class="nx">state</span><span class="p">.</span><span class="nx">historyIndex</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">0</span><span class="p">}</span>
<span class="w">          </span><span class="p">&gt;</span>
<span class="w">            </span><span class="nx">Undo</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">            </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">dispatch</span><span class="p">({</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;REDO&#39;</span><span class="w"> </span><span class="p">})}</span>
<span class="w">            </span><span class="na">disabled</span><span class="o">=</span><span class="p">{</span><span class="nx">state</span><span class="p">.</span><span class="nx">historyIndex</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">}</span>
<span class="w">          </span><span class="p">&gt;</span>
<span class="w">            </span><span class="nx">Redo</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">header</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">FilterBar</span>
<span class="w">        </span><span class="na">filters</span><span class="o">=</span><span class="p">{</span><span class="nx">state</span><span class="p">.</span><span class="nx">filters</span><span class="p">}</span>
<span class="w">        </span><span class="na">onFilterChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">filters</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span>
<span class="w">          </span><span class="nx">dispatch</span><span class="p">({</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;UPDATE_FILTERS&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="kt">filters</span><span class="w"> </span><span class="p">})</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="na">onClearFilters</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">dispatch</span><span class="p">({</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;CLEAR_FILTERS&#39;</span><span class="w"> </span><span class="p">})}</span>
<span class="w">        </span><span class="na">taskCount</span><span class="o">=</span><span class="p">{</span><span class="nx">filteredTasks</span><span class="p">.</span><span class="nx">length</span><span class="p">}</span>
<span class="w">        </span><span class="na">totalCount</span><span class="o">=</span><span class="p">{</span><span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">length</span><span class="p">}</span>
<span class="w">      </span><span class="p">/&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">TaskList</span><span class="w"> </span><span class="na">tasks</span><span class="o">=</span><span class="p">{</span><span class="nx">filteredTasks</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="nx">state</span><span class="p">.</span><span class="nx">isFormOpen</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">TaskForm</span>
<span class="w">          </span><span class="na">task</span><span class="o">=</span><span class="p">{</span><span class="nx">state</span><span class="p">.</span><span class="nx">editingTask</span><span class="p">}</span>
<span class="w">          </span><span class="na">onSubmit</span><span class="o">=</span><span class="p">{(</span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span>
<span class="w">            </span><span class="nx">state</span><span class="p">.</span><span class="nx">editingTask</span>
<span class="w">              </span><span class="o">?</span><span class="w"> </span><span class="nx">dispatch</span><span class="p">({</span>
<span class="w">                  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;UPDATE_TASK&#39;</span><span class="p">,</span>
<span class="w">                  </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">state.editingTask.id</span><span class="p">,</span><span class="w"> </span><span class="nx">updates</span><span class="o">:</span><span class="w"> </span><span class="kt">data</span><span class="w"> </span><span class="p">},</span>
<span class="w">                </span><span class="p">})</span>
<span class="w">              </span><span class="o">:</span><span class="w"> </span><span class="nx">dispatch</span><span class="p">({</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;ADD_TASK&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="kt">data</span><span class="w"> </span><span class="p">})</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">          </span><span class="na">onCancel</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">dispatch</span><span class="p">({</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;CLOSE_FORM&#39;</span><span class="w"> </span><span class="p">})}</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">)}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/TaskList.tsx - No dispatch prop needed</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Task</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/task&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskItem</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./TaskItem&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">TaskListProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">tasks</span><span class="o">:</span><span class="w"> </span><span class="kt">Task</span><span class="p">[];</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TaskList</span><span class="p">({</span><span class="w"> </span><span class="nx">tasks</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">TaskListProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;empty-state&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">No</span><span class="w"> </span><span class="nx">tasks</span><span class="w"> </span><span class="nx">found</span><span class="p">.</span><span class="w"> </span><span class="nx">Create</span><span class="w"> </span><span class="nx">one</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">get</span><span class="w"> </span><span class="nx">started</span><span class="o">!</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-list&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">task</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">TaskItem</span><span class="w"> </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">task</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="w"> </span><span class="na">task</span><span class="o">=</span><span class="p">{</span><span class="nx">task</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">))}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/TaskItem.tsx - Gets dispatch from context</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Task</span><span class="p">,</span><span class="w"> </span><span class="nx">TaskStatus</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/task&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useTaskBoard</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../contexts/TaskBoardContext&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">TaskItemProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">task</span><span class="o">:</span><span class="w"> </span><span class="kt">Task</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TaskItem</span><span class="p">({</span><span class="w"> </span><span class="nx">task</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">TaskItemProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">dispatch</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useTaskBoard</span><span class="p">();</span><span class="w"> </span><span class="c1">// Get from context</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">priorityColors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">low</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;#4caf50&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">medium</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;#ff9800&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">high</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;#f44336&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-item&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-header&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;{</span><span class="nx">task</span><span class="p">.</span><span class="nx">title</span><span class="p">}&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">span</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;priority-badge&quot;</span>
<span class="w">          </span><span class="na">style</span><span class="o">=</span><span class="p">{{</span><span class="w"> </span><span class="nx">backgroundColor</span><span class="o">:</span><span class="w"> </span><span class="kt">priorityColors</span><span class="p">[</span><span class="nx">task</span><span class="p">.</span><span class="nx">priority</span><span class="p">]</span><span class="w"> </span><span class="p">}}</span>
<span class="w">        </span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">{</span><span class="nx">task</span><span class="p">.</span><span class="nx">priority</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-description&quot;</span><span class="p">&gt;{</span><span class="nx">task</span><span class="p">.</span><span class="nx">description</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-meta&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">span</span><span class="p">&gt;</span><span class="nx">Assignee</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">task</span><span class="p">.</span><span class="nx">assignee</span><span class="p">}&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">task</span><span class="p">.</span><span class="nx">dueDate</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">span</span><span class="p">&gt;</span><span class="nx">Due</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">task</span><span class="p">.</span><span class="nx">dueDate</span><span class="p">.</span><span class="nx">toLocaleDateString</span><span class="p">()}&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-actions&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">select</span>
<span class="w">          </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">task</span><span class="p">.</span><span class="nx">status</span><span class="p">}</span>
<span class="w">          </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span>
<span class="w">            </span><span class="nx">dispatch</span><span class="p">({</span>
<span class="w">              </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;UPDATE_TASK_STATUS&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">task.id</span><span class="p">,</span><span class="w"> </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">e.target.value</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">TaskStatus</span><span class="w"> </span><span class="p">},</span>
<span class="w">            </span><span class="p">})</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;todo&quot;</span><span class="p">&gt;</span><span class="nx">To</span><span class="w"> </span><span class="nx">Do</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;in-progress&quot;</span><span class="p">&gt;</span><span class="nx">In</span><span class="w"> </span><span class="nx">Progress</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;done&quot;</span><span class="p">&gt;</span><span class="nx">Done</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">          </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span>
<span class="w">            </span><span class="nx">dispatch</span><span class="p">({</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;OPEN_EDIT_FORM&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="kt">task</span><span class="w"> </span><span class="p">})</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Edit</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">          </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span>
<span class="w">            </span><span class="nx">dispatch</span><span class="p">({</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;DELETE_TASK&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="kt">task.id</span><span class="w"> </span><span class="p">})</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Delete</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/TaskStats.tsx - Gets state from context</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useTaskBoard</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../contexts/TaskBoardContext&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TaskStats</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">state</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useTaskBoard</span><span class="p">();</span><span class="w"> </span><span class="c1">// Get from context</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">totalTasks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">completedTasks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">t</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">t</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;done&#39;</span><span class="p">).</span><span class="nx">length</span><span class="p">;</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">inProgressTasks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span>
<span class="w">    </span><span class="p">(</span><span class="nx">t</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">t</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;in-progress&#39;</span>
<span class="w">  </span><span class="p">).</span><span class="nx">length</span><span class="p">;</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">todoTasks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">t</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">t</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;todo&#39;</span><span class="p">).</span><span class="nx">length</span><span class="p">;</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">completionRate</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="nx">totalTasks</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">((</span><span class="nx">completedTasks</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">totalTasks</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">100</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-stats&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;stat&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">Total</span><span class="w"> </span><span class="nx">Tasks</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;stat-value&quot;</span><span class="p">&gt;{</span><span class="nx">totalTasks</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;stat&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">Completed</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;stat-value&quot;</span><span class="p">&gt;{</span><span class="nx">completedTasks</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;stat&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">In</span><span class="w"> </span><span class="nx">Progress</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;stat-value&quot;</span><span class="p">&gt;{</span><span class="nx">inProgressTasks</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;stat&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">To</span><span class="w"> </span><span class="nx">Do</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;stat-value&quot;</span><span class="p">&gt;{</span><span class="nx">todoTasks</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;stat&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">Completion</span><span class="w"> </span><span class="nx">Rate</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;stat-value&quot;</span><span class="p">&gt;{</span><span class="nx">completionRate</span><span class="p">}</span><span class="o">%</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="verification-does-it-work_1">Verification: Does It Work?</h3>
<p><strong>Browser Console</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="o">[</span><span class="n">App</span><span class="o">]</span><span class="w"> </span><span class="n">Rendered</span>
<span class="o">[</span><span class="n">TaskBoardProvider</span><span class="o">]</span><span class="w"> </span><span class="n">Rendered</span>
<span class="o">[</span><span class="n">TasksPage</span><span class="o">]</span><span class="w"> </span><span class="n">Rendered</span>
<span class="o">[</span><span class="n">TaskBoard</span><span class="o">]</span><span class="w"> </span><span class="n">Rendered</span>
<span class="o">[</span><span class="n">TaskList</span><span class="o">]</span><span class="w"> </span><span class="n">Rendered</span>
<span class="o">[</span><span class="n">TaskItem</span><span class="o">]</span><span class="w"> </span><span class="n">Rendered</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="w"> </span><span class="n">times</span><span class="p">)</span>

<span class="o">//</span><span class="w"> </span><span class="k">User</span><span class="w"> </span><span class="n">switches</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">Analytics</span><span class="w"> </span><span class="nl">page</span><span class="p">:</span>
<span class="o">[</span><span class="n">AnalyticsPage</span><span class="o">]</span><span class="w"> </span><span class="n">Rendered</span>
<span class="o">[</span><span class="n">AnalyticsDashboard</span><span class="o">]</span><span class="w"> </span><span class="n">Rendered</span>
<span class="o">[</span><span class="n">TaskStats</span><span class="o">]</span><span class="w"> </span><span class="n">Rendered</span>
<span class="o">//</span><span class="w"> </span><span class="n">TaskStats</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="k">state</span><span class="err">!</span>

<span class="o">//</span><span class="w"> </span><span class="k">User</span><span class="w"> </span><span class="n">deletes</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">Tasks</span><span class="w"> </span><span class="nl">page</span><span class="p">:</span>
<span class="o">[</span><span class="n">TaskBoard</span><span class="o">]</span><span class="w"> </span><span class="k">Action</span><span class="w"> </span><span class="nl">dispatched</span><span class="p">:</span><span class="w"> </span><span class="n">DELETE_TASK</span>
<span class="o">[</span><span class="n">TaskBoardProvider</span><span class="o">]</span><span class="w"> </span><span class="k">State</span><span class="w"> </span><span class="n">updated</span>
<span class="o">[</span><span class="n">TaskBoard</span><span class="o">]</span><span class="w"> </span><span class="n">Re</span><span class="o">-</span><span class="n">rendered</span>
<span class="o">[</span><span class="n">TaskList</span><span class="o">]</span><span class="w"> </span><span class="n">Re</span><span class="o">-</span><span class="n">rendered</span>
<span class="o">[</span><span class="n">TaskItem</span><span class="o">]</span><span class="w"> </span><span class="n">Re</span><span class="o">-</span><span class="n">rendered</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">removed</span><span class="p">)</span>

<span class="o">//</span><span class="w"> </span><span class="k">User</span><span class="w"> </span><span class="n">switches</span><span class="w"> </span><span class="n">back</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">Analytics</span><span class="w"> </span><span class="nl">page</span><span class="p">:</span>
<span class="o">[</span><span class="n">AnalyticsPage</span><span class="o">]</span><span class="w"> </span><span class="n">Re</span><span class="o">-</span><span class="n">rendered</span>
<span class="o">[</span><span class="n">TaskStats</span><span class="o">]</span><span class="w"> </span><span class="n">Re</span><span class="o">-</span><span class="n">rendered</span>
<span class="o">//</span><span class="w"> </span><span class="n">Stats</span><span class="w"> </span><span class="n">automatically</span><span class="w"> </span><span class="n">updated</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="nf">count</span><span class="err">!</span>
</code></pre></div>

<p><strong>React DevTools Evidence</strong>:
- Component tree:
  <code>App
    ‚îî‚îÄ TaskBoardProvider (provides context)
        ‚îú‚îÄ TasksPage
        ‚îÇ   ‚îî‚îÄ TaskBoard (consumes context)
        ‚îÇ       ‚îî‚îÄ TaskList
        ‚îÇ           ‚îî‚îÄ TaskItem (consumes context)
        ‚îî‚îÄ AnalyticsPage
            ‚îî‚îÄ AnalyticsDashboard
                ‚îî‚îÄ TaskStats (consumes context)</code>
- Context value visible in DevTools
- No prop drilling through intermediate components
- State shared across both pages</p>
<p><strong>Expected vs. Actual</strong>:
- ‚úÖ No prop drilling
- ‚úÖ Components access state directly
- ‚úÖ State shared across pages
- ‚úÖ Changes in one page reflect in another
- ‚úÖ Cleaner component interfaces</p>
<h3 id="what-changed-and-why-it-works_1">What Changed and Why It Works</h3>
<p><strong>Before (Props)</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Every component in the chain needs props</span>
<span class="p">&lt;</span><span class="nt">App</span><span class="w"> </span><span class="na">state</span><span class="o">=</span><span class="p">{</span><span class="nx">state</span><span class="p">}</span><span class="w"> </span><span class="na">dispatch</span><span class="o">=</span><span class="p">{</span><span class="nx">dispatch</span><span class="p">}&gt;</span>
<span class="w">  </span><span class="p">&lt;</span><span class="nt">TasksPage</span><span class="w"> </span><span class="na">state</span><span class="o">=</span><span class="p">{</span><span class="nx">state</span><span class="p">}</span><span class="w"> </span><span class="na">dispatch</span><span class="o">=</span><span class="p">{</span><span class="nx">dispatch</span><span class="p">}&gt;</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">TaskBoard</span><span class="w"> </span><span class="na">state</span><span class="o">=</span><span class="p">{</span><span class="nx">state</span><span class="p">}</span><span class="w"> </span><span class="na">dispatch</span><span class="o">=</span><span class="p">{</span><span class="nx">dispatch</span><span class="p">}&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">TaskList</span><span class="w"> </span><span class="na">dispatch</span><span class="o">=</span><span class="p">{</span><span class="nx">dispatch</span><span class="p">}&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">TaskItem</span><span class="w"> </span><span class="na">dispatch</span><span class="o">=</span><span class="p">{</span><span class="nx">dispatch</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
</code></pre></div>

<p><strong>After (Context)</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Only Provider and consumers need to know about state</span>
<span class="p">&lt;</span><span class="nt">TaskBoardProvider</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">&lt;</span><span class="nt">TasksPage</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">TaskBoard</span><span class="p">&gt;</span><span class="w"> </span><span class="p">{</span><span class="cm">/* uses context */</span><span class="p">}</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">TaskList</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">TaskItem</span><span class="w"> </span><span class="p">/&gt;</span><span class="w"> </span><span class="p">{</span><span class="cm">/* uses context */</span><span class="p">}</span>
</code></pre></div>

<h3 id="the-context-mental-model">The Context Mental Model</h3>
<p>Think of Context as a <strong>wormhole</strong> through your component tree:</p>
<ol>
<li><strong>Provider</strong>: Creates the wormhole entrance at the top</li>
<li><strong>Consumer</strong>: Opens the wormhole exit anywhere below</li>
<li><strong>Value</strong>: Travels through the wormhole instantly</li>
</ol>
<p>No intermediate components need to know about the wormhole.</p>
<h3 id="the-performance-problem-why-use-sparingly">The Performance Problem: Why "Use Sparingly"</h3>
<p>Context solves prop drilling, but it introduces a new problem: <strong>unnecessary re-renders</strong>.</p>
<p>Let's see the failure:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/TaskStats.tsx - Add console.log</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useTaskBoard</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../contexts/TaskBoardContext&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TaskStats</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;[TaskStats] Rendering&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">state</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useTaskBoard</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// ... rest of component</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/FilterBar.tsx - Add console.log</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskFilters</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/task&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useTaskBoard</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../contexts/TaskBoardContext&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">FilterBar</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;[FilterBar] Rendering&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">state</span><span class="p">,</span><span class="w"> </span><span class="nx">dispatch</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useTaskBoard</span><span class="p">();</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;filter-bar&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">select</span>
<span class="w">        </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">state</span><span class="p">.</span><span class="nx">filters</span><span class="p">.</span><span class="nx">status</span><span class="p">}</span>
<span class="w">        </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span>
<span class="w">          </span><span class="nx">dispatch</span><span class="p">({</span>
<span class="w">            </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;UPDATE_FILTERS&#39;</span><span class="p">,</span>
<span class="w">            </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">e.target.value</span><span class="w"> </span><span class="p">},</span>
<span class="w">          </span><span class="p">})</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="cm">/* ... options ... */</span><span class="p">}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>Now let's change a filter:</p>
<p><strong>Browser Console</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="k">User</span><span class="w"> </span><span class="n">changes</span><span class="w"> </span><span class="k">filter</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="ss">&quot;All&quot;</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="ss">&quot;In Progress&quot;</span>
<span class="o">[</span><span class="n">FilterBar</span><span class="o">]</span><span class="w"> </span><span class="n">Rendering</span>
<span class="o">[</span><span class="n">TaskBoard</span><span class="o">]</span><span class="w"> </span><span class="n">Rendering</span>
<span class="o">[</span><span class="n">TaskList</span><span class="o">]</span><span class="w"> </span><span class="n">Rendering</span>
<span class="o">[</span><span class="n">TaskItem</span><span class="o">]</span><span class="w"> </span><span class="n">Rendering</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">filtered</span><span class="w"> </span><span class="n">task</span><span class="p">)</span>
<span class="o">[</span><span class="n">TaskStats</span><span class="o">]</span><span class="w"> </span><span class="n">Rendering</span><span class="w">  </span><span class="err">‚Üê</span><span class="w"> </span><span class="n">Why</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">rendering</span><span class="vm">?</span>
</code></pre></div>

<p><strong>React DevTools Evidence</strong>:
- Profiler shows <code>TaskStats</code> re-rendered
- Reason: Context value changed
- <code>TaskStats</code> is on a different page (not even visible!)
- But it still re-renders because it consumes the context</p>
<h3 id="diagnostic-analysis-the-context-re-render-problem">Diagnostic Analysis: The Context Re-render Problem</h3>
<p><strong>What the user experiences</strong>:
- Expected: Only visible components re-render
- Actual: All context consumers re-render, even hidden ones</p>
<p><strong>What DevTools shows</strong>:
- Every component that calls <code>useTaskBoard()</code> re-renders
- This happens even if they don't use the changed part of state
- <code>TaskStats</code> only uses <code>state.tasks</code>, but re-renders when <code>state.filters</code> changes</p>
<p><strong>Root cause identified</strong>:</p>
<p>When context value changes, <strong>every component that consumes that context re-renders</strong>. React doesn't know which parts of the context value each component uses, so it re-renders all of them.</p>
<p>This is fine for small apps, but becomes a performance problem as your app grows.</p>
<p><strong>Why the current approach can't solve this</strong>:</p>
<p>Context is all-or-nothing. You can't subscribe to just part of the context value. If any part changes, all consumers re-render.</p>
<h3 id="iteration-3-optimizing-context-with-selectors">Iteration 3: Optimizing Context with Selectors</h3>
<p>We can mitigate this with careful context design:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/contexts/TaskBoardContext.tsx - Optimized version</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">createContext</span><span class="p">,</span>
<span class="w">  </span><span class="nx">useContext</span><span class="p">,</span>
<span class="w">  </span><span class="nx">useReducer</span><span class="p">,</span>
<span class="w">  </span><span class="nx">useMemo</span><span class="p">,</span>
<span class="w">  </span><span class="nx">ReactNode</span><span class="p">,</span>
<span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskBoardState</span><span class="p">,</span><span class="w"> </span><span class="nx">TaskBoardAction</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/task&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">taskBoardReducer</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../reducers/taskBoardReducer&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">TaskBoardContextValue</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">state</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskBoardState</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dispatch</span><span class="o">:</span><span class="w"> </span><span class="kt">React.Dispatch</span><span class="p">&lt;</span><span class="nt">TaskBoardAction</span><span class="p">&gt;;</span>
<span class="p">}</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">TaskBoardContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createContext</span><span class="p">&lt;</span><span class="nt">TaskBoardContextValue</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="na">undefined</span><span class="p">&gt;(</span>
<span class="w">  </span><span class="kc">undefined</span>
<span class="p">);</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">initialState</span><span class="o">:</span><span class="w"> </span><span class="kt">TaskBoardState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="cm">/* ... */</span>
<span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TaskBoardProvider</span><span class="p">({</span><span class="w"> </span><span class="nx">children</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">children</span><span class="o">:</span><span class="w"> </span><span class="kt">ReactNode</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">state</span><span class="p">,</span><span class="w"> </span><span class="nx">dispatch</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useReducer</span><span class="p">(</span><span class="nx">taskBoardReducer</span><span class="p">,</span><span class="w"> </span><span class="nx">initialState</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Memoize the context value to prevent unnecessary re-renders</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span><span class="w"> </span><span class="nx">state</span><span class="p">,</span><span class="w"> </span><span class="nx">dispatch</span><span class="w"> </span><span class="p">}),</span>
<span class="w">    </span><span class="p">[</span><span class="nx">state</span><span class="p">]</span><span class="w"> </span><span class="c1">// Only recreate when state changes</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">TaskBoardContext</span><span class="p">.</span><span class="na">Provider</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">value</span><span class="p">}&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">children</span><span class="p">}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">TaskBoardContext</span><span class="p">.</span><span class="na">Provider</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Base hook</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">useTaskBoard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">context</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useContext</span><span class="p">(</span><span class="nx">TaskBoardContext</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">context</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="kc">undefined</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;useTaskBoard must be used within a TaskBoardProvider&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">context</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Selector hooks - only re-render when selected data changes</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">useTaskBoardTasks</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">state</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useTaskBoard</span><span class="p">();</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">useTaskBoardFilters</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">state</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useTaskBoard</span><span class="p">();</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">filters</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">useTaskBoardDispatch</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">dispatch</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useTaskBoard</span><span class="p">();</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">dispatch</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">useTaskBoardFormState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">state</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useTaskBoard</span><span class="p">();</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">isFormOpen</span><span class="o">:</span><span class="w"> </span><span class="kt">state.isFormOpen</span><span class="p">,</span>
<span class="w">    </span><span class="nx">editingTask</span><span class="o">:</span><span class="w"> </span><span class="kt">state.editingTask</span><span class="p">,</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">}</span>
</code></pre></div>

<p>Now components can use specific selectors:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/TaskStats.tsx - Using selector</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useTaskBoardTasks</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../contexts/TaskBoardContext&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TaskStats</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;[TaskStats] Rendering&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">tasks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useTaskBoardTasks</span><span class="p">();</span><span class="w"> </span><span class="c1">// Only subscribes to tasks</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">totalTasks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">tasks</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">completedTasks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">tasks</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">t</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">t</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;done&#39;</span><span class="p">).</span><span class="nx">length</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// ... rest of component</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Browser Console</strong> (after changing filter):</p>
<div class="codehilite"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="k">User</span><span class="w"> </span><span class="n">changes</span><span class="w"> </span><span class="k">filter</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="ss">&quot;All&quot;</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="ss">&quot;In Progress&quot;</span>
<span class="o">[</span><span class="n">FilterBar</span><span class="o">]</span><span class="w"> </span><span class="n">Rendering</span>
<span class="o">[</span><span class="n">TaskBoard</span><span class="o">]</span><span class="w"> </span><span class="n">Rendering</span>
<span class="o">[</span><span class="n">TaskList</span><span class="o">]</span><span class="w"> </span><span class="n">Rendering</span>
<span class="o">[</span><span class="n">TaskItem</span><span class="o">]</span><span class="w"> </span><span class="n">Rendering</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="nc">time</span><span class="p">)</span>
<span class="o">//</span><span class="w"> </span><span class="n">TaskStats</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="n">render</span><span class="err">!</span><span class="w"> </span><span class="err">‚úì</span>
</code></pre></div>

<p>But this is still not perfect. <code>TaskStats</code> will still re-render when tasks change, even though it's on a hidden page. The real solution is to <strong>not use Context for everything</strong>.</p>
<h3 id="when-to-use-context">When to Use Context</h3>
<p>Use Context when:</p>
<p>‚úÖ <strong>Truly global state</strong>: Theme, authentication, language
‚úÖ <strong>Infrequently changing</strong>: User preferences, feature flags
‚úÖ <strong>Widely consumed</strong>: Many components need the same data
‚úÖ <strong>Not performance-critical</strong>: Re-renders are acceptable</p>
<p>Don't use Context when:</p>
<p>‚ùå <strong>Frequently changing state</strong>: Form inputs, filters, search queries
‚ùå <strong>Performance-critical</strong>: Large lists, real-time updates
‚ùå <strong>Only a few components need it</strong>: Props are simpler
‚ùå <strong>State is local to a feature</strong>: Keep it in the feature component</p>
<h3 id="common-failure-modes-with-context">Common Failure Modes with Context</h3>
<h4 id="symptom-entire-app-re-renders-on-every-state-change">Symptom: Entire app re-renders on every state change</h4>
<p><strong>Browser Console</strong>:</p>
<div class="codehilite"><pre><span></span><code>[Every component in the app] Rendering
[Every component in the app] Rendering
[Every component in the app] Rendering
</code></pre></div>

<p><strong>React DevTools Evidence</strong>:
- Profiler shows all components highlighted
- Reason: Context value changes
- All consumers re-render</p>
<p><strong>Root cause</strong>: Context value is too broad, changes too frequently</p>
<p><strong>Solution</strong>: Split into multiple contexts or use a state management library</p>
<h4 id="symptom-usecontext-must-be-used-within-provider-error">Symptom: "useContext must be used within Provider" error</h4>
<p><strong>Browser Console</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">Error</span><span class="o">:</span><span class="w"> </span><span class="n">useTaskBoard</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">TaskBoardProvider</span>
<span class="w">  </span><span class="n">at</span><span class="w"> </span><span class="n">useTaskBoard</span><span class="w"> </span><span class="o">(</span><span class="n">TaskBoardContext</span><span class="o">.</span><span class="na">tsx</span><span class="o">:</span><span class="mi">45</span><span class="o">)</span>
<span class="w">  </span><span class="n">at</span><span class="w"> </span><span class="n">TaskItem</span><span class="w"> </span><span class="o">(</span><span class="n">TaskItem</span><span class="o">.</span><span class="na">tsx</span><span class="o">:</span><span class="mi">12</span><span class="o">)</span>
</code></pre></div>

<p><strong>Root cause</strong>: Component using context is rendered outside the Provider</p>
<p><strong>Solution</strong>: Ensure Provider wraps all components that need the context</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Wrong:</span>
<span class="p">&lt;</span><span class="nt">TaskItem</span><span class="w"> </span><span class="p">/&gt;</span><span class="w"> </span><span class="p">{</span><span class="cm">/* Outside provider */</span><span class="p">}</span>
<span class="p">&lt;</span><span class="nt">TaskBoardProvider</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">&lt;</span><span class="nt">TaskBoard</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="p">&lt;/</span><span class="nt">TaskBoardProvider</span><span class="p">&gt;</span>

<span class="c1">// Right:</span>
<span class="p">&lt;</span><span class="nt">TaskBoardProvider</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">&lt;</span><span class="nt">TaskItem</span><span class="w"> </span><span class="p">/&gt;</span><span class="w"> </span><span class="p">{</span><span class="cm">/* Inside provider */</span><span class="p">}</span>
<span class="w">  </span><span class="p">&lt;</span><span class="nt">TaskBoard</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="p">&lt;/</span><span class="nt">TaskBoardProvider</span><span class="p">&gt;</span>
</code></pre></div>

<h4 id="symptom-context-value-is-undefined-or-stale">Symptom: Context value is undefined or stale</h4>
<p><strong>React DevTools Evidence</strong>:
- Context value shows old data
- Component doesn't re-render when context changes</p>
<p><strong>Root cause</strong>: Context value not memoized, or component not consuming context correctly</p>
<p><strong>Solution</strong>: Memoize context value and ensure <code>useContext</code> is called at component top level</p>
<h3 id="the-context-decision-framework">The Context Decision Framework</h3>
<p><strong>Question 1</strong>: How many components need this state?
- 1-2 components: Use props
- 3-5 components: Consider lifting state up
- 6+ components: Consider Context</p>
<p><strong>Question 2</strong>: How often does this state change?
- Rarely (theme, auth): Context is fine
- Occasionally (user settings): Context is okay
- Frequently (form inputs, filters): Avoid Context</p>
<p><strong>Question 3</strong>: How performance-critical is this?
- Not critical (UI preferences): Context is fine
- Somewhat critical (data tables): Be careful with Context
- Very critical (real-time updates): Avoid Context</p>
<p><strong>Question 4</strong>: Is this truly global?
- Yes (current user, theme): Context is appropriate
- No (feature-specific state): Keep it local</p>
<h3 id="when-to-apply-this-solution_1">When to Apply This Solution</h3>
<p><strong>What Context optimizes for</strong>:
- Eliminating prop drilling
- Sharing state across distant components
- Simplifying component interfaces
- Reducing coupling between components</p>
<p><strong>What Context sacrifices</strong>:
- Performance (all consumers re-render)
- Explicit data flow (harder to trace where data comes from)
- Testing complexity (need to wrap components in Provider)</p>
<p><strong>When to choose Context</strong>:
- State is truly global (theme, auth, language)
- Many components need the same data
- Prop drilling is becoming painful
- Performance is not critical</p>
<p><strong>When to avoid Context</strong>:
- State changes frequently
- Only a few components need it
- Performance is critical
- State is feature-specific</p>
<p><strong>Code characteristics</strong>:
- Setup: Moderate (Provider, custom hooks)
- Maintenance: Easy (add consumers without changing intermediate components)
- Performance: Can be problematic (all consumers re-render)
- Testing: More complex (need Provider wrapper)</p>
<p>The key insight: Context is a tool for <strong>convenience</strong>, not <strong>performance</strong>. Use it to eliminate prop drilling, but be aware of the re-render cost. For high-performance state management, you'll need a different solution (which we'll explore in the next chapter).</p>
<h2 id="lifting-state-up-vs-pushing-it-down">Lifting state up vs. pushing it down</h2>
<h2 id="lifting-state-up-vs-pushing-it-down_1">Lifting state up vs. pushing it down</h2>
<h3 id="phase-4-the-state-placement-problem">Phase 4: The State Placement Problem</h3>
<p>We've learned three tools for managing state:
1. <code>useState</code> for simple, local state
2. <code>useReducer</code> for complex state logic
3. Context for sharing state across components</p>
<p>But we haven't addressed the most fundamental question: <strong>Where should state live?</strong></p>
<p>This is the state placement problem, and getting it wrong causes more bugs and performance issues than any other React mistake.</p>
<h3 id="the-two-competing-forces">The Two Competing Forces</h3>
<p><strong>Lifting state up</strong>: Moving state to a common ancestor so multiple components can access it</p>
<p><strong>Pushing state down</strong>: Keeping state as close as possible to where it's used</p>
<p>These forces are in constant tension. Lift too high, and you get unnecessary re-renders. Push too low, and you get prop drilling or duplicated state.</p>
<h3 id="the-failure-state-in-the-wrong-place">The Failure: State in the Wrong Place</h3>
<p>Let's add a new feature to our TaskBoard: <strong>inline task editing</strong>. Users should be able to click a task title and edit it directly, without opening the modal form.</p>
<p>Here's the naive approach‚Äîputting edit state in the parent:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/TaskBoard.tsx - Edit state in parent (WRONG)</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useMemo</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useTaskBoard</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../contexts/TaskBoardContext&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskList</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./TaskList&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TaskBoard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">state</span><span class="p">,</span><span class="w"> </span><span class="nx">dispatch</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useTaskBoard</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// Edit state for ALL tasks in the parent</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">editingTaskId</span><span class="p">,</span><span class="w"> </span><span class="nx">setEditingTaskId</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">string</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="na">null</span><span class="p">&gt;(</span><span class="kc">null</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">editingTitle</span><span class="p">,</span><span class="w"> </span><span class="nx">setEditingTitle</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filteredTasks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">task</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// ... filtering logic</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">,</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">filters</span><span class="p">]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">startEditing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">taskId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">currentTitle</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setEditingTaskId</span><span class="p">(</span><span class="nx">taskId</span><span class="p">);</span>
<span class="w">    </span><span class="nx">setEditingTitle</span><span class="p">(</span><span class="nx">currentTitle</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">saveEdit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">editingTaskId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">dispatch</span><span class="p">({</span>
<span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;UPDATE_TASK&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">editingTaskId</span><span class="p">,</span>
<span class="w">          </span><span class="nx">updates</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">editingTitle</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">      </span><span class="nx">setEditingTaskId</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
<span class="w">      </span><span class="nx">setEditingTitle</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">cancelEdit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setEditingTaskId</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
<span class="w">    </span><span class="nx">setEditingTitle</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-board&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="cm">/* ... header ... */</span><span class="p">}</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">TaskList</span>
<span class="w">        </span><span class="na">tasks</span><span class="o">=</span><span class="p">{</span><span class="nx">filteredTasks</span><span class="p">}</span>
<span class="w">        </span><span class="na">editingTaskId</span><span class="o">=</span><span class="p">{</span><span class="nx">editingTaskId</span><span class="p">}</span>
<span class="w">        </span><span class="na">editingTitle</span><span class="o">=</span><span class="p">{</span><span class="nx">editingTitle</span><span class="p">}</span>
<span class="w">        </span><span class="na">onStartEditing</span><span class="o">=</span><span class="p">{</span><span class="nx">startEditing</span><span class="p">}</span>
<span class="w">        </span><span class="na">onSaveEdit</span><span class="o">=</span><span class="p">{</span><span class="nx">saveEdit</span><span class="p">}</span>
<span class="w">        </span><span class="na">onCancelEdit</span><span class="o">=</span><span class="p">{</span><span class="nx">cancelEdit</span><span class="p">}</span>
<span class="w">        </span><span class="na">onTitleChange</span><span class="o">=</span><span class="p">{</span><span class="nx">setEditingTitle</span><span class="p">}</span>
<span class="w">      </span><span class="p">/&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/TaskList.tsx - Passing edit props down</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Task</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/task&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskItem</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./TaskItem&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">TaskListProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">tasks</span><span class="o">:</span><span class="w"> </span><span class="kt">Task</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">editingTaskId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">  </span><span class="nx">editingTitle</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onStartEditing</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">taskId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">currentTitle</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onSaveEdit</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onCancelEdit</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onTitleChange</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TaskList</span><span class="p">({</span>
<span class="w">  </span><span class="nx">tasks</span><span class="p">,</span>
<span class="w">  </span><span class="nx">editingTaskId</span><span class="p">,</span>
<span class="w">  </span><span class="nx">editingTitle</span><span class="p">,</span>
<span class="w">  </span><span class="nx">onStartEditing</span><span class="p">,</span>
<span class="w">  </span><span class="nx">onSaveEdit</span><span class="p">,</span>
<span class="w">  </span><span class="nx">onCancelEdit</span><span class="p">,</span>
<span class="w">  </span><span class="nx">onTitleChange</span><span class="p">,</span>
<span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">TaskListProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-list&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">task</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">TaskItem</span>
<span class="w">          </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">task</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span>
<span class="w">          </span><span class="na">task</span><span class="o">=</span><span class="p">{</span><span class="nx">task</span><span class="p">}</span>
<span class="w">          </span><span class="na">isEditing</span><span class="o">=</span><span class="p">{</span><span class="nx">editingTaskId</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">task</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span>
<span class="w">          </span><span class="na">editingTitle</span><span class="o">=</span><span class="p">{</span><span class="nx">editingTitle</span><span class="p">}</span>
<span class="w">          </span><span class="na">onStartEditing</span><span class="o">=</span><span class="p">{</span><span class="nx">onStartEditing</span><span class="p">}</span>
<span class="w">          </span><span class="na">onSaveEdit</span><span class="o">=</span><span class="p">{</span><span class="nx">onSaveEdit</span><span class="p">}</span>
<span class="w">          </span><span class="na">onCancelEdit</span><span class="o">=</span><span class="p">{</span><span class="nx">onCancelEdit</span><span class="p">}</span>
<span class="w">          </span><span class="na">onTitleChange</span><span class="o">=</span><span class="p">{</span><span class="nx">onTitleChange</span><span class="p">}</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">))}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/TaskItem.tsx - Using edit props</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Task</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/task&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useTaskBoard</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../contexts/TaskBoardContext&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">TaskItemProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">task</span><span class="o">:</span><span class="w"> </span><span class="kt">Task</span><span class="p">;</span>
<span class="w">  </span><span class="nx">isEditing</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">editingTitle</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onStartEditing</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">taskId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">currentTitle</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onSaveEdit</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onCancelEdit</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onTitleChange</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TaskItem</span><span class="p">({</span>
<span class="w">  </span><span class="nx">task</span><span class="p">,</span>
<span class="w">  </span><span class="nx">isEditing</span><span class="p">,</span>
<span class="w">  </span><span class="nx">editingTitle</span><span class="p">,</span>
<span class="w">  </span><span class="nx">onStartEditing</span><span class="p">,</span>
<span class="w">  </span><span class="nx">onSaveEdit</span><span class="p">,</span>
<span class="w">  </span><span class="nx">onCancelEdit</span><span class="p">,</span>
<span class="w">  </span><span class="nx">onTitleChange</span><span class="p">,</span>
<span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">TaskItemProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">dispatch</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useTaskBoard</span><span class="p">();</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-item&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-header&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">isEditing</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">            </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">            </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">editingTitle</span><span class="p">}</span>
<span class="w">            </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">onTitleChange</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">            </span><span class="na">onBlur</span><span class="o">=</span><span class="p">{</span><span class="nx">onSaveEdit</span><span class="p">}</span>
<span class="w">            </span><span class="na">onKeyDown</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">key</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;Enter&#39;</span><span class="p">)</span><span class="w"> </span><span class="nx">onSaveEdit</span><span class="p">();</span>
<span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">key</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;Escape&#39;</span><span class="p">)</span><span class="w"> </span><span class="nx">onCancelEdit</span><span class="p">();</span>
<span class="w">            </span><span class="p">}}</span>
<span class="w">            </span><span class="na">autoFocus</span>
<span class="w">          </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">h3</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">onStartEditing</span><span class="p">(</span><span class="nx">task</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span><span class="w"> </span><span class="nx">task</span><span class="p">.</span><span class="nx">title</span><span class="p">)}&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="nx">task</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="cm">/* ... rest of task item ... */</span><span class="p">}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>Let's test this:</p>
<p><strong>Browser Behavior</strong>:
1. User clicks on task title "Implement user authentication"
2. Input appears, user types "Implement OAuth authentication"
3. User clicks on a different task title "Write API documentation"
4. <strong>Both tasks show edit inputs!</strong> ‚ùå
5. The second task's input shows "Implement OAuth authentication" ‚ùå</p>
<p><strong>Browser Console</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="o">[</span><span class="n">TaskBoard</span><span class="o">]</span><span class="w"> </span><span class="n">Rendered</span>
<span class="o">[</span><span class="n">TaskList</span><span class="o">]</span><span class="w"> </span><span class="n">Rendered</span>
<span class="o">[</span><span class="n">TaskItem</span><span class="o">]</span><span class="w"> </span><span class="n">Rendered</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="w"> </span><span class="n">times</span><span class="p">)</span>

<span class="o">//</span><span class="w"> </span><span class="k">User</span><span class="w"> </span><span class="n">clicks</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="nl">task</span><span class="p">:</span>
<span class="o">[</span><span class="n">TaskBoard</span><span class="o">]</span><span class="w"> </span><span class="n">Re</span><span class="o">-</span><span class="n">rendered</span><span class="w"> </span><span class="p">(</span><span class="n">editingTaskId</span><span class="w"> </span><span class="n">changed</span><span class="p">)</span>
<span class="o">[</span><span class="n">TaskList</span><span class="o">]</span><span class="w"> </span><span class="n">Re</span><span class="o">-</span><span class="n">rendered</span><span class="w"> </span><span class="p">(</span><span class="n">props</span><span class="w"> </span><span class="n">changed</span><span class="p">)</span>
<span class="o">[</span><span class="n">TaskItem</span><span class="o">]</span><span class="w"> </span><span class="n">Re</span><span class="o">-</span><span class="n">rendered</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="ow">ALL</span><span class="w"> </span><span class="n">tasks</span><span class="w"> </span><span class="n">re</span><span class="o">-</span><span class="n">render</span><span class="err">!</span><span class="p">)</span>

<span class="o">//</span><span class="w"> </span><span class="k">User</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">input</span><span class="err">:</span>
<span class="o">[</span><span class="n">TaskBoard</span><span class="o">]</span><span class="w"> </span><span class="n">Re</span><span class="o">-</span><span class="n">rendered</span><span class="w"> </span><span class="p">(</span><span class="n">editingTitle</span><span class="w"> </span><span class="n">changed</span><span class="p">)</span>
<span class="o">[</span><span class="n">TaskList</span><span class="o">]</span><span class="w"> </span><span class="n">Re</span><span class="o">-</span><span class="n">rendered</span><span class="w"> </span><span class="p">(</span><span class="n">props</span><span class="w"> </span><span class="n">changed</span><span class="p">)</span>
<span class="o">[</span><span class="n">TaskItem</span><span class="o">]</span><span class="w"> </span><span class="n">Re</span><span class="o">-</span><span class="n">rendered</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="ow">ALL</span><span class="w"> </span><span class="n">tasks</span><span class="w"> </span><span class="n">re</span><span class="o">-</span><span class="n">render</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="k">every</span><span class="w"> </span><span class="n">keystroke</span><span class="err">!</span><span class="p">)</span>
</code></pre></div>

<p><strong>React DevTools Evidence</strong>:
- Profiler shows all 3 <code>TaskItem</code> components re-rendering on every keystroke
- State in <code>TaskBoard</code>:
  - <code>editingTaskId</code>: "1"
  - <code>editingTitle</code>: "Implement OAuth authentication"
- When user clicks second task:
  - <code>editingTaskId</code> changes to "2"
  - But <code>editingTitle</code> still has the old value
  - Second task shows wrong text</p>
<h3 id="diagnostic-analysis-state-too-high">Diagnostic Analysis: State Too High</h3>
<p><strong>What the user experiences</strong>:
- Expected: Only the edited task updates
- Actual: All tasks re-render, wrong task shows edit state</p>
<p><strong>What the console reveals</strong>:
- Key indicator: All tasks re-render on every keystroke
- This is a performance problem
- 3 tasks √ó 10 keystrokes = 30 unnecessary re-renders</p>
<p><strong>What DevTools shows</strong>:
- Component tree: <code>TaskBoard</code> ‚Üí <code>TaskList</code> ‚Üí <code>TaskItem</code> (all highlighted)
- Render reason: Props changed
- The problem: Edit state is in the parent, so changing it re-renders all children</p>
<p><strong>Root cause identified</strong>:</p>
<p>Edit state is <strong>lifted too high</strong>. Only one task is being edited at a time, but the state lives in <code>TaskBoard</code>, which means:
1. Changing edit state re-renders the entire board
2. All tasks re-render even though only one is editing
3. Edit state is shared across all tasks (causing the wrong-text bug)</p>
<p><strong>Why the current approach can't solve this</strong>:</p>
<p>When state lives in a parent component, changing that state re-renders all children. React can't know that only one child cares about the edit state.</p>
<p><strong>What we need</strong>:</p>
<p>Edit state should live in the <code>TaskItem</code> component itself. Each task should manage its own edit state independently.</p>
<h3 id="iteration-4-pushing-state-down">Iteration 4: Pushing State Down</h3>
<p>Let's move edit state to where it's actually used:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/TaskBoard.tsx - No edit state here</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useMemo</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useTaskBoard</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../contexts/TaskBoardContext&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskList</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./TaskList&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TaskBoard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">state</span><span class="p">,</span><span class="w"> </span><span class="nx">dispatch</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useTaskBoard</span><span class="p">();</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filteredTasks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">task</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// ... filtering logic</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">,</span><span class="w"> </span><span class="nx">state</span><span class="p">.</span><span class="nx">filters</span><span class="p">]);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-board&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="cm">/* ... header ... */</span><span class="p">}</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">TaskList</span><span class="w"> </span><span class="na">tasks</span><span class="o">=</span><span class="p">{</span><span class="nx">filteredTasks</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="cm">/* No edit props! */</span><span class="p">}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/TaskList.tsx - No edit props here either</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Task</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/task&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskItem</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./TaskItem&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">TaskListProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">tasks</span><span class="o">:</span><span class="w"> </span><span class="kt">Task</span><span class="p">[];</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TaskList</span><span class="p">({</span><span class="w"> </span><span class="nx">tasks</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">TaskListProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-list&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">task</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">TaskItem</span><span class="w"> </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">task</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="w"> </span><span class="na">task</span><span class="o">=</span><span class="p">{</span><span class="nx">task</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="cm">/* No edit props! */</span><span class="p">}</span>
<span class="w">      </span><span class="p">))}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/TaskItem.tsx - Edit state lives here</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Task</span><span class="p">,</span><span class="w"> </span><span class="nx">TaskStatus</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/task&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useTaskBoard</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../contexts/TaskBoardContext&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">TaskItemProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">task</span><span class="o">:</span><span class="w"> </span><span class="kt">Task</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TaskItem</span><span class="p">({</span><span class="w"> </span><span class="nx">task</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">TaskItemProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">dispatch</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useTaskBoard</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// Edit state is local to this component</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">isEditing</span><span class="p">,</span><span class="w"> </span><span class="nx">setIsEditing</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">editingTitle</span><span class="p">,</span><span class="w"> </span><span class="nx">setEditingTitle</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="nx">task</span><span class="p">.</span><span class="nx">title</span><span class="p">);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">startEditing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setIsEditing</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="w">    </span><span class="nx">setEditingTitle</span><span class="p">(</span><span class="nx">task</span><span class="p">.</span><span class="nx">title</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">saveEdit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">editingTitle</span><span class="p">.</span><span class="nx">trim</span><span class="p">()</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">task</span><span class="p">.</span><span class="nx">title</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">dispatch</span><span class="p">({</span>
<span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;UPDATE_TASK&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">task.id</span><span class="p">,</span>
<span class="w">          </span><span class="nx">updates</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">editingTitle.trim</span><span class="p">()</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">setIsEditing</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">cancelEdit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setEditingTitle</span><span class="p">(</span><span class="nx">task</span><span class="p">.</span><span class="nx">title</span><span class="p">);</span>
<span class="w">    </span><span class="nx">setIsEditing</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">priorityColors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">low</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;#4caf50&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">medium</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;#ff9800&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">high</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;#f44336&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-item&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-header&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">isEditing</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">            </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">            </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">editingTitle</span><span class="p">}</span>
<span class="w">            </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setEditingTitle</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">            </span><span class="na">onBlur</span><span class="o">=</span><span class="p">{</span><span class="nx">saveEdit</span><span class="p">}</span>
<span class="w">            </span><span class="na">onKeyDown</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">key</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;Enter&#39;</span><span class="p">)</span><span class="w"> </span><span class="nx">saveEdit</span><span class="p">();</span>
<span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">key</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;Escape&#39;</span><span class="p">)</span><span class="w"> </span><span class="nx">cancelEdit</span><span class="p">();</span>
<span class="w">            </span><span class="p">}}</span>
<span class="w">            </span><span class="na">autoFocus</span>
<span class="w">            </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-title-input&quot;</span>
<span class="w">          </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">h3</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">startEditing</span><span class="p">}</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-title&quot;</span><span class="p">&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="nx">task</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">span</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;priority-badge&quot;</span>
<span class="w">          </span><span class="na">style</span><span class="o">=</span><span class="p">{{</span><span class="w"> </span><span class="nx">backgroundColor</span><span class="o">:</span><span class="w"> </span><span class="kt">priorityColors</span><span class="p">[</span><span class="nx">task</span><span class="p">.</span><span class="nx">priority</span><span class="p">]</span><span class="w"> </span><span class="p">}}</span>
<span class="w">        </span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">{</span><span class="nx">task</span><span class="p">.</span><span class="nx">priority</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-description&quot;</span><span class="p">&gt;{</span><span class="nx">task</span><span class="p">.</span><span class="nx">description</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-meta&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">span</span><span class="p">&gt;</span><span class="nx">Assignee</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">task</span><span class="p">.</span><span class="nx">assignee</span><span class="p">}&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">task</span><span class="p">.</span><span class="nx">dueDate</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">span</span><span class="p">&gt;</span><span class="nx">Due</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">task</span><span class="p">.</span><span class="nx">dueDate</span><span class="p">.</span><span class="nx">toLocaleDateString</span><span class="p">()}&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-actions&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">select</span>
<span class="w">          </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">task</span><span class="p">.</span><span class="nx">status</span><span class="p">}</span>
<span class="w">          </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span>
<span class="w">            </span><span class="nx">dispatch</span><span class="p">({</span>
<span class="w">              </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;UPDATE_TASK_STATUS&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">task.id</span><span class="p">,</span><span class="w"> </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">e.target.value</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">TaskStatus</span><span class="w"> </span><span class="p">},</span>
<span class="w">            </span><span class="p">})</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;todo&quot;</span><span class="p">&gt;</span><span class="nx">To</span><span class="w"> </span><span class="nx">Do</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;in-progress&quot;</span><span class="p">&gt;</span><span class="nx">In</span><span class="w"> </span><span class="nx">Progress</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">option</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">&quot;done&quot;</span><span class="p">&gt;</span><span class="nx">Done</span><span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">          </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span>
<span class="w">            </span><span class="nx">dispatch</span><span class="p">({</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;OPEN_EDIT_FORM&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="kt">task</span><span class="w"> </span><span class="p">})</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Edit</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">          </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span>
<span class="w">            </span><span class="nx">dispatch</span><span class="p">({</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;DELETE_TASK&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="kt">task.id</span><span class="w"> </span><span class="p">})</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Delete</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="verification-does-it-work_2">Verification: Does It Work?</h3>
<p><strong>Browser Console</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="o">[</span><span class="n">TaskBoard</span><span class="o">]</span><span class="w"> </span><span class="n">Rendered</span>
<span class="o">[</span><span class="n">TaskList</span><span class="o">]</span><span class="w"> </span><span class="n">Rendered</span>
<span class="o">[</span><span class="n">TaskItem</span><span class="o">]</span><span class="w"> </span><span class="n">Rendered</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="w"> </span><span class="n">times</span><span class="p">)</span>

<span class="o">//</span><span class="w"> </span><span class="k">User</span><span class="w"> </span><span class="n">clicks</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="nl">task</span><span class="p">:</span>
<span class="o">[</span><span class="n">TaskItem</span><span class="o">]</span><span class="w"> </span><span class="n">Re</span><span class="o">-</span><span class="n">rendered</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">edited</span><span class="w"> </span><span class="n">task</span><span class="err">!</span><span class="p">)</span>

<span class="o">//</span><span class="w"> </span><span class="k">User</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">input</span><span class="err">:</span>
<span class="o">[</span><span class="n">TaskItem</span><span class="o">]</span><span class="w"> </span><span class="n">Re</span><span class="o">-</span><span class="n">rendered</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">edited</span><span class="w"> </span><span class="n">task</span><span class="err">!</span><span class="p">)</span>
<span class="o">[</span><span class="n">TaskItem</span><span class="o">]</span><span class="w"> </span><span class="n">Re</span><span class="o">-</span><span class="n">rendered</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">edited</span><span class="w"> </span><span class="n">task</span><span class="err">!</span><span class="p">)</span>
<span class="o">[</span><span class="n">TaskItem</span><span class="o">]</span><span class="w"> </span><span class="n">Re</span><span class="o">-</span><span class="n">rendered</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">edited</span><span class="w"> </span><span class="n">task</span><span class="err">!</span><span class="p">)</span>

<span class="o">//</span><span class="w"> </span><span class="k">User</span><span class="w"> </span><span class="n">clicks</span><span class="w"> </span><span class="k">second</span><span class="w"> </span><span class="nl">task</span><span class="p">:</span>
<span class="o">[</span><span class="n">TaskItem</span><span class="o">]</span><span class="w"> </span><span class="n">Re</span><span class="o">-</span><span class="n">rendered</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">saves</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">stops</span><span class="w"> </span><span class="n">editing</span><span class="p">)</span>
<span class="o">[</span><span class="n">TaskItem</span><span class="o">]</span><span class="w"> </span><span class="n">Re</span><span class="o">-</span><span class="n">rendered</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">second</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">starts</span><span class="w"> </span><span class="n">editing</span><span class="p">)</span>
</code></pre></div>

<p><strong>React DevTools Evidence</strong>:
- Profiler shows only the edited <code>TaskItem</code> re-rendering
- Other tasks remain unchanged
- Each task has its own independent edit state
- No interference between tasks</p>
<p><strong>Expected vs. Actual</strong>:
- ‚úÖ Only edited task re-renders
- ‚úÖ Other tasks unaffected
- ‚úÖ Each task has independent edit state
- ‚úÖ No wrong-text bug
- ‚úÖ Performance: 3 re-renders instead of 30</p>
<h3 id="the-state-placement-decision-tree">The State Placement Decision Tree</h3>
<p>Use this flowchart to decide where state should live:</p>
<p><strong>Question 1</strong>: Does only one component need this state?
- <strong>Yes</strong> ‚Üí Keep it in that component
- <strong>No</strong> ‚Üí Continue to Question 2</p>
<p><strong>Question 2</strong>: Do sibling components need to share this state?
- <strong>Yes</strong> ‚Üí Lift to common parent
- <strong>No</strong> ‚Üí Continue to Question 3</p>
<p><strong>Question 3</strong>: Do components far apart in the tree need this state?
- <strong>Yes</strong> ‚Üí Consider Context
- <strong>No</strong> ‚Üí Keep it local</p>
<p><strong>Question 4</strong>: Does this state change frequently?
- <strong>Yes</strong> ‚Üí Keep it as low as possible
- <strong>No</strong> ‚Üí Lifting is okay</p>
<p><strong>Question 5</strong>: Is this state truly global?
- <strong>Yes</strong> ‚Üí Use Context
- <strong>No</strong> ‚Üí Keep it local or lift minimally</p>
<h3 id="the-lifting-state-up-pattern">The Lifting State Up Pattern</h3>
<p>Sometimes you do need to lift state. Here's when and how:</p>
<p><strong>When to lift state up</strong>:
- Two sibling components need to share state
- Parent needs to coordinate children
- State represents a single source of truth</p>
<p><strong>Example: Coordinated filters</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/TaskBoard.tsx - Filters must be lifted</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskFilters</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/task&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">FilterBar</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./FilterBar&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskList</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./TaskList&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">TaskStats</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./TaskStats&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TaskBoard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Filters must be in parent because both FilterBar and TaskList need them</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">filters</span><span class="p">,</span><span class="w"> </span><span class="nx">setFilters</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">TaskFilters</span><span class="p">&gt;({</span>
<span class="w">    </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">assignee</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">searchQuery</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filteredTasks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">tasks</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">task</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Apply filters...</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-board&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="cm">/* FilterBar modifies filters */</span><span class="p">}</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">FilterBar</span><span class="w"> </span><span class="na">filters</span><span class="o">=</span><span class="p">{</span><span class="nx">filters</span><span class="p">}</span><span class="w"> </span><span class="na">onFilterChange</span><span class="o">=</span><span class="p">{</span><span class="nx">setFilters</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="cm">/* TaskList uses filtered results */</span><span class="p">}</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">TaskList</span><span class="w"> </span><span class="na">tasks</span><span class="o">=</span><span class="p">{</span><span class="nx">filteredTasks</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="cm">/* TaskStats uses filtered results */</span><span class="p">}</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">TaskStats</span><span class="w"> </span><span class="na">tasks</span><span class="o">=</span><span class="p">{</span><span class="nx">filteredTasks</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>This is correct lifting: filters are in the parent because multiple children need them.</p>
<h3 id="the-pushing-state-down-pattern">The Pushing State Down Pattern</h3>
<p><strong>When to push state down</strong>:
- State is only used by one component
- State changes frequently
- State is UI-specific (not business logic)</p>
<p><strong>Example: Dropdown open state</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/TaskItem.tsx - Dropdown state is local</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Task</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/task&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">TaskItem</span><span class="p">({</span><span class="w"> </span><span class="nx">task</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">task</span><span class="o">:</span><span class="w"> </span><span class="kt">Task</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Dropdown state is local - only this component cares</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">isDropdownOpen</span><span class="p">,</span><span class="w"> </span><span class="nx">setIsDropdownOpen</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;task-item&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;{</span><span class="nx">task</span><span class="p">.</span><span class="nx">title</span><span class="p">}&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setIsDropdownOpen</span><span class="p">(</span><span class="o">!</span><span class="nx">isDropdownOpen</span><span class="p">)}&gt;</span>
<span class="w">        </span><span class="nx">Actions</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="nx">isDropdownOpen</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;dropdown&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="cm">/* edit */</span><span class="p">}}&gt;</span><span class="nx">Edit</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="cm">/* delete */</span><span class="p">}}&gt;</span><span class="nx">Delete</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">)}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>This is correct pushing: dropdown state is local because only this component cares about it.</p>
<h3 id="common-failure-modes">Common Failure Modes</h3>
<h4 id="symptom-entire-component-tree-re-renders-on-every-keystroke">Symptom: Entire component tree re-renders on every keystroke</h4>
<p><strong>Browser Console</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="o">[</span><span class="n">Parent</span><span class="o">]</span><span class="w"> </span><span class="n">Rendering</span>
<span class="o">[</span><span class="n">Child1</span><span class="o">]</span><span class="w"> </span><span class="n">Rendering</span>
<span class="o">[</span><span class="n">Child2</span><span class="o">]</span><span class="w"> </span><span class="n">Rendering</span>
<span class="o">[</span><span class="n">Child3</span><span class="o">]</span><span class="w"> </span><span class="n">Rendering</span>
<span class="o">//</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="n">repeats</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="k">every</span><span class="w"> </span><span class="n">keystroke</span>
</code></pre></div>

<p><strong>Root cause</strong>: Input state is lifted too high</p>
<p><strong>Solution</strong>: Push input state down to the component that contains the input</p>
<h4 id="symptom-components-cant-share-state">Symptom: Components can't share state</h4>
<p><strong>Browser Console</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">Warning</span><span class="o">:</span><span class="w"> </span><span class="n">Cannot</span><span class="w"> </span><span class="n">update</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="n">rendering</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">component</span>
</code></pre></div>

<p><strong>Root cause</strong>: State is too low, siblings can't communicate</p>
<p><strong>Solution</strong>: Lift state to common parent</p>
<h4 id="symptom-props-drilling-through-many-levels">Symptom: Props drilling through many levels</h4>
<p><strong>React DevTools Evidence</strong>:
- Component tree shows props passed through 5+ levels
- Intermediate components don't use the props</p>
<p><strong>Root cause</strong>: State is lifted too high, or should use Context</p>
<p><strong>Solution</strong>: Either push state down or use Context</p>
<h3 id="the-performance-impact">The Performance Impact</h3>
<p>Let's measure the difference:</p>
<p><strong>State Too High</strong> (edit state in parent):</p>
<div class="codehilite"><pre><span></span><code><span class="nx">User</span><span class="w"> </span><span class="nx">types</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="nx">characters</span>
<span class="p">=</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="nx">state</span><span class="w"> </span><span class="nx">updates</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">parent</span>
<span class="p">=</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="nx">re</span><span class="o">-</span><span class="nx">renders</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">parent</span>
<span class="p">=</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="nx">re</span><span class="o">-</span><span class="nx">renders</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">TaskList</span>
<span class="p">=</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="err">√ó</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="nx">re</span><span class="o">-</span><span class="nx">renders</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">TaskItem</span>
<span class="p">=</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="nx">total</span><span class="w"> </span><span class="nx">TaskItem</span><span class="w"> </span><span class="nx">re</span><span class="o">-</span><span class="nx">renders</span>
</code></pre></div>

<p><strong>State Pushed Down</strong> (edit state in TaskItem):</p>
<div class="codehilite"><pre><span></span><code><span class="nx">User</span><span class="w"> </span><span class="nx">types</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="nx">characters</span>
<span class="p">=</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="nx">state</span><span class="w"> </span><span class="nx">updates</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">TaskItem</span>
<span class="p">=</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="nx">re</span><span class="o">-</span><span class="nx">renders</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">TaskItem</span>
<span class="p">=</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="nx">total</span><span class="w"> </span><span class="nx">TaskItem</span><span class="w"> </span><span class="nx">re</span><span class="o">-</span><span class="nx">renders</span>
</code></pre></div>

<p><strong>Result</strong>: 3√ó fewer re-renders by pushing state down.</p>
<h3 id="the-complete-journey-state-placement-evolution">The Complete Journey: State Placement Evolution</h3>
<table>
<thead>
<tr>
<th>Iteration</th>
<th>State Location</th>
<th>Problem</th>
<th>Solution</th>
<th>Performance</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Edit state in TaskBoard</td>
<td>All tasks re-render</td>
<td>-</td>
<td>30 re-renders</td>
</tr>
<tr>
<td>1</td>
<td>Edit state in TaskItem</td>
<td>Only edited task re-renders</td>
<td>Push state down</td>
<td>10 re-renders</td>
</tr>
<tr>
<td>2</td>
<td>Filters in TaskBoard</td>
<td>Multiple components need them</td>
<td>Lift state up</td>
<td>Correct</td>
</tr>
<tr>
<td>3</td>
<td>Dropdown in TaskItem</td>
<td>Only one component needs it</td>
<td>Keep state local</td>
<td>Optimal</td>
</tr>
</tbody>
</table>
<h3 id="decision-framework-where-should-state-live">Decision Framework: Where Should State Live?</h3>
<p><strong>Principle 1: Start Local</strong></p>
<p>Always start with state in the component that uses it. Only lift when you have a concrete reason.</p>
<p><strong>Principle 2: Lift Minimally</strong></p>
<p>When you do lift, lift only as high as necessary. Don't lift to App if lifting to a feature component is enough.</p>
<p><strong>Principle 3: Consider Performance</strong></p>
<p>Frequently changing state should be as low as possible. Infrequently changing state can be higher.</p>
<p><strong>Principle 4: Optimize for Maintainability</strong></p>
<p>Sometimes it's worth a small performance cost for clearer code. Don't prematurely optimize.</p>
<h3 id="when-to-apply-these-patterns">When to Apply These Patterns</h3>
<p><strong>Push State Down</strong>:
- What it optimizes for: Performance, isolation, simplicity
- What it sacrifices: Sharing state between components
- When to use: State is local, changes frequently, UI-specific
- When to avoid: Multiple components need the state</p>
<p><strong>Lift State Up</strong>:
- What it optimizes for: Sharing state, coordination, single source of truth
- What it sacrifices: Performance (more re-renders), complexity
- When to use: Siblings need to share state, parent needs to coordinate
- When to avoid: Only one component needs the state</p>
<p><strong>Use Context</strong>:
- What it optimizes for: Eliminating prop drilling, global state
- What it sacrifices: Performance (all consumers re-render), explicit data flow
- When to use: Truly global state, many distant components need it
- When to avoid: State changes frequently, only a few components need it</p>
<h3 id="lessons-learned">Lessons Learned</h3>
<p><strong>1. State placement is a design decision</strong></p>
<p>There's no one right answer. Consider:
- How many components need the state?
- How often does it change?
- How performance-critical is it?
- How maintainable is the code?</p>
<p><strong>2. Start simple, refactor when needed</strong></p>
<p>Don't prematurely optimize. Start with the simplest solution (local state), and refactor when you encounter problems.</p>
<p><strong>3. Performance is about re-renders</strong></p>
<p>The higher state lives, the more components re-render when it changes. This is the fundamental trade-off.</p>
<p><strong>4. Composition over configuration</strong></p>
<p>Sometimes the best solution is to restructure your components, not to move state around.</p>
<p><strong>5. Measure, don't guess</strong></p>
<p>Use React DevTools Profiler to see actual re-render counts. Don't optimize based on assumptions.</p>
<p>The key insight: State placement is the most important decision you make in React. Get it right, and your app is fast and maintainable. Get it wrong, and you'll fight performance problems and prop drilling forever.</p>
        </div>
        <div class="footer">
            Generated on 2025-12-03 12:33:24 | Made with ‚ù§Ô∏è by GitHub Pages Generator
        </div>
    </div>
    <script>
        // Syntax highlighting for code blocks
        document.addEventListener('DOMContentLoaded', (event) => {
            // Highlight code blocks
            document.querySelectorAll('pre code').forEach((block) => {
                hljs.highlightElement(block);
            });
            
            // Add copy buttons to code blocks
            document.querySelectorAll('pre').forEach((pre) => {
                const button = document.createElement('button');
                button.className = 'copy-btn';
                button.textContent = 'Copy';
                
                button.addEventListener('click', () => {
                    const code = pre.querySelector('code').textContent;
                    navigator.clipboard.writeText(code).then(() => {
                        button.textContent = 'Copied!';
                        button.classList.add('copied');
                        setTimeout(() => {
                            button.textContent = 'Copy';
                            button.classList.remove('copied');
                        }, 2000);
                    }).catch(err => {
                        console.error('Failed to copy:', err);
                        button.textContent = 'Error';
                        setTimeout(() => {
                            button.textContent = 'Copy';
                        }, 2000);
                    });
                });
                
                pre.appendChild(button);
            });
        });
    </script>
</body>
</html>