<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>05 Lists, Keys, and Conditional Rendering</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #8b5cf6;
            --bg-main: #0f172a;
            --bg-card: #1e293b;
            --bg-code: #0f172a;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #334155;
            --accent: #06b6d4;
            --success: #10b981;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            line-height: 1.7; 
            color: var(--text-primary); 
            background: var(--bg-main);
        }
        
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 20px; 
        }
        
        .home-btn { 
            position: fixed; 
            top: 20px; 
            right: 20px; 
            background: var(--accent);
            color: white; 
            width: 50px;
            height: 50px;
            border-radius: 50%;
            text-decoration: none; 
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(6, 182, 212, 0.4);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .home-btn:hover { 
            background: #0891b2;
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(6, 182, 212, 0.5);
        }
        
        .breadcrumb { 
            background: var(--bg-card);
            padding: 12px 0; 
            margin-bottom: 24px; 
            font-size: 14px;
            border-radius: 8px;
            border: 1px solid var(--border);
        }
        
        .breadcrumb a { 
            color: var(--accent);
            text-decoration: none;
            transition: color 0.2s;
        }
        
        .breadcrumb a:hover { 
            color: var(--primary);
            text-decoration: underline;
        }
        
        .content { 
            background: var(--bg-card);
            padding: 3rem; 
            border-radius: 16px; 
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border);
        }
        
        .file-list { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); 
            gap: 1.5rem; 
            margin: 2rem 0; 
        }
        
        .file-item { 
            padding: 1.5rem; 
            border: 1px solid var(--border);
            border-radius: 12px; 
            background: var(--bg-main);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .file-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .file-item:hover { 
            transform: translateY(-4px); 
            box-shadow: 0 8px 30px rgba(99, 102, 241, 0.3);
            border-color: var(--primary);
        }
        
        .file-item:hover::before {
            opacity: 1;
        }
        
        .file-item a { 
            color: var(--text-primary);
            text-decoration: none; 
            font-weight: 600; 
            display: block;
            font-size: 1.1rem;
        }
        
        .file-item a:hover { 
            color: var(--primary);
        }
        
        .file-type { 
            font-size: 13px; 
            color: var(--text-secondary);
            margin-top: 8px; 
            font-weight: 500;
        }
        
        /* Code Blocks */
        pre { 
            background: var(--bg-code);
            padding: 1.5rem; 
            border-radius: 12px; 
            overflow-x: auto;
            border: 1px solid var(--border);
            margin: 1.5rem 0;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            position: relative;
        }
        
        pre code { 
            background: none;
            padding: 0;
            font-family: 'Fira Code', 'Consolas', monospace;
            font-size: 0.9em;
            line-height: 1.6;
        }
        
        /* Copy Button */
        .copy-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: var(--primary);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.2s;
            opacity: 0.7;
            z-index: 10;
        }
        
        .copy-btn:hover {
            opacity: 1;
            background: var(--primary-dark);
            transform: translateY(-1px);
        }
        
        .copy-btn.copied {
            background: var(--success);
        }
        
        pre:hover .copy-btn {
            opacity: 1;
        }
        
        /* Inline Code */
        code { 
            background: var(--bg-code);
            color: #8b5cf6;
            padding: 3px 8px; 
            border-radius: 6px; 
            font-size: 1.1em;
            font-family: 'Fira Code', 'Consolas', monospace;
            border: 1px solid var(--border);
        }
        
        /* Headings */
        h1, h2, h3, h4, h5, h6 { 
            color: var(--text-primary);
            margin: 2rem 0 1rem 0;
            font-weight: 700;
            letter-spacing: -0.5px;
        }
        
        h1 { 
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            border-bottom: 3px solid var(--primary);
            padding-bottom: 12px;
            margin-bottom: 1.5rem;
        }
        
        h2 { 
            font-size: 2rem;
            color: var(--primary);
            border-bottom: 2px solid var(--border);
            padding-bottom: 8px;
        }
        
        h3 { 
            font-size: 1.5rem;
            color: var(--accent);
        }
        
        /* Links */
        a { 
            color: var(--accent);
            transition: color 0.2s;
        }
        
        a:hover { 
            color: var(--primary);
        }
        
        /* Paragraphs */
        p {
            margin: 1rem 0;
            color: var(--text-secondary);
        }
        
        /* Lists */
        ul, ol {
            margin: 1rem 0;
            padding-left: 2rem;
            color: var(--text-secondary);
        }
        
        li {
            margin: 0.5rem 0;
        }
        
        /* Tables */
        table { 
            border-collapse: collapse;
            width: 100%;
            margin: 1.5rem 0;
            background: var(--bg-main);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }
        
        th, td { 
            border: 1px solid var(--border);
            padding: 12px 16px;
            text-align: left;
        }
        
        th { 
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            font-weight: 600;
        }
        
        tr:hover {
            background: var(--bg-card);
        }
        
        /* Blockquotes */
        blockquote {
            border-left: 4px solid var(--primary);
            padding: 1rem 1.5rem;
            margin: 1.5rem 0;
            background: var(--bg-main);
            border-radius: 0 8px 8px 0;
            color: var(--text-secondary);
            font-style: italic;
        }
        
        /* Horizontal Rule */
        hr {
            border: none;
            border-top: 2px solid var(--border);
            margin: 2rem 0;
        }
        
        .footer { 
            text-align: center; 
            padding: 2rem; 
            color: var(--text-secondary);
            border-top: 1px solid var(--border);
            margin-top: 3rem; 
            font-size: 14px;
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--bg-main);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 6px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }
        
        @media (max-width: 768px) {
            .container { padding: 10px; }
            .file-list { grid-template-columns: 1fr; }
            .content { padding: 1.5rem; }
            h1 { font-size: 2rem; }
            h2 { font-size: 1.5rem; }
        }
    </style>
</head>
<body>
    <a href="../index.html" class="home-btn">üè†</a>
    <div class="container">
        <div class="breadcrumb">
            <div style="padding: 0 20px;">
                <a href="../index.html">üè† Home</a> <span style="color: #64748b;">/</span> <a href="index.html">01 React Fundamentals</a>
            </div>
        </div>
        <div class="content">
            <h1 id="chapter-5-lists-keys-and-conditional-rendering">Chapter 5: Lists, Keys, and Conditional Rendering</h1>
<h2 id="rendering-arrays-efficiently">Rendering arrays efficiently</h2>
<h2 id="the-challenge-from-data-to-ui">The Challenge: From Data to UI</h2>
<p>So far, we've dealt with single pieces of state. But most applications handle collections of data: a list of users, a feed of posts, a gallery of images. The core task is transforming an array of data into a list of UI elements.</p>
<p>React makes this straightforward with standard JavaScript methods like <code>Array.prototype.map()</code>, but doing it correctly and efficiently requires understanding a crucial concept: <strong>identity</strong>. React needs to know which UI element corresponds to which piece of data, especially when that data changes.</p>
<p>This chapter will build a single, realistic component from the ground up, demonstrating how to render lists, why React's <code>key</code> prop is non-negotiable, and how to conditionally show, hide, or change UI based on application state.</p>
<h3 id="phase-1-establish-the-reference-implementation">Phase 1: Establish the Reference Implementation</h3>
<p>Our anchor example for this chapter will be a <code>NotificationPanel</code>. It's a perfect candidate because notifications are inherently a list, and they are dynamic: they can be added, removed, and their state (e.g., "read" or "unread") can change.</p>
<p>Let's start with a basic version that simply displays a hardcoded list of notifications.</p>
<p><strong>Project Structure</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="nx">src</span><span class="o">/</span>
<span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">components</span><span class="o">/</span>
<span class="w">    </span><span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">NotificationPanel</span><span class="p">.</span><span class="nx">tsx</span><span class="w">  </span><span class="err">‚Üê</span><span class="w"> </span><span class="nx">Our</span><span class="w"> </span><span class="nx">reference</span><span class="w"> </span><span class="nx">implementation</span>
</code></pre></div>

<p>Here is our initial data and the first, naive implementation.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/NotificationPanel.tsx</span>

<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">Notification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;info&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;warning&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">};</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">initialNotifications</span><span class="o">:</span><span class="w"> </span><span class="kt">Notification</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;notif-1&#39;</span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;info&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Your profile has been updated.&#39;</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;notif-2&#39;</span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;warning&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Your subscription is expiring soon.&#39;</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;notif-3&#39;</span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Failed to upload document.&#39;</span><span class="w"> </span><span class="p">},</span>
<span class="p">];</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">NotificationPanel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">notifications</span><span class="p">,</span><span class="w"> </span><span class="nx">setNotifications</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="nx">initialNotifications</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;notification-panel&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">Notifications</span><span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;notification-list&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">notification</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`notification notification--</span><span class="si">${</span><span class="nx">notification</span><span class="p">.</span><span class="kr">type</span><span class="si">}</span><span class="sb">`</span><span class="p">}&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="nx">notification</span><span class="p">.</span><span class="nx">message</span><span class="p">}</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">))}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>When you run this, it appears to work. You'll see the three notifications rendered on the screen. However, if you open your browser's developer console, you'll see a critical warning. This is our first failure.</p>
<h3 id="diagnostic-analysis-reading-the-failure">Diagnostic Analysis: Reading the Failure</h3>
<p><strong>Browser Behavior</strong>:
The UI displays the three notifications as expected. Visually, nothing appears broken.</p>
<p><strong>Browser Console Output</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">Warning</span><span class="o">:</span><span class="w"> </span><span class="k">Each</span><span class="w"> </span><span class="n">child</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">list</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">unique</span><span class="w"> </span><span class="s2">&quot;key&quot;</span><span class="w"> </span><span class="n">prop</span><span class="p">.</span>

<span class="k">Check</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">render</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n n-Quoted">`NotificationPanel`</span><span class="p">.</span>
<span class="w">    </span><span class="k">at</span><span class="w"> </span><span class="k">div</span>
<span class="w">    </span><span class="k">at</span><span class="w"> </span><span class="n">NotificationPanel</span><span class="w"> </span><span class="p">(</span><span class="n">http</span><span class="o">://</span><span class="n">localhost</span><span class="o">:</span><span class="mi">3000</span><span class="o">/</span><span class="n">static</span><span class="o">/</span><span class="n">js</span><span class="o">/</span><span class="n">bundle</span><span class="p">.</span><span class="n">js</span><span class="o">:</span><span class="p">...)</span>
<span class="w">    </span><span class="p">...</span>
</code></pre></div>

<p><strong>React DevTools Evidence</strong>:
The component tree shows the <code>NotificationPanel</code> with three <code>div</code> children inside <code>notification-list</code>. React has rendered them, but it's unhappy about it.</p>
<p><strong>Let's parse this evidence</strong>:</p>
<ol>
<li><strong>What the user experiences</strong>: Everything looks fine. This is a deceptive kind of failure‚Äîit's a performance and correctness time bomb, not an immediate crash.</li>
<li><strong>What the console reveals</strong>: React is explicitly telling us the problem. When it sees an array of elements returned from a <code>.map()</code>, it needs a <code>key</code> prop on each element to distinguish them.</li>
<li><strong>Root cause identified</strong>: We are rendering a list of elements without providing the <code>key</code> prop that React requires for list reconciliation.</li>
<li><strong>Why the current approach can't solve this</strong>: Without keys, React doesn't know if the first <code>div</code> in the list is the <em>same</em> <code>div</code> on the next render. If we add, remove, or re-sort items, React has no stable identity to track which item is which. It might resort to re-creating all the DOM elements from scratch, which is inefficient and can lead to bugs.</li>
<li><strong>What we need</strong>: A way to provide a stable, unique identifier for each rendered element in the list so React can track it across renders.</li>
</ol>
<h2 id="why-keys-matter-and-what-happens-when-you-get-them-wrong">Why keys matter (and what happens when you get them wrong)</h2>
<h2 id="iteration-1-the-index-as-key-anti-pattern">Iteration 1: The Index-as-Key Anti-Pattern</h2>
<p>The console warning is clear: we need a <code>key</code>. A common, but often incorrect, first attempt is to use the array index from the <code>.map()</code> function. Let's try it.</p>
<p><strong>Before</strong> (Iteration 0):</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/NotificationPanel.tsx - Version 0</span>
<span class="c1">// ...</span>
<span class="p">{</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">notification</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`notification notification--</span><span class="si">${</span><span class="nx">notification</span><span class="p">.</span><span class="kr">type</span><span class="si">}</span><span class="sb">`</span><span class="p">}&gt;</span>
<span class="w">    </span><span class="p">{</span><span class="nx">notification</span><span class="p">.</span><span class="nx">message</span><span class="p">}</span>
<span class="w">  </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">))}</span>
<span class="c1">// ...</span>
</code></pre></div>

<p><strong>After</strong> (Iteration 1):</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/NotificationPanel.tsx - Version 1</span>
<span class="c1">// ...</span>
<span class="p">{</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">notification</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span>
<span class="w">    </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">index</span><span class="p">}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">‚Üê</span><span class="w"> </span><span class="na">Added</span><span class="w"> </span><span class="na">index</span><span class="w"> </span><span class="na">as</span><span class="w"> </span><span class="na">key</span>
<span class="w">    </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`notification notification--</span><span class="si">${</span><span class="nx">notification</span><span class="p">.</span><span class="kr">type</span><span class="si">}</span><span class="sb">`</span><span class="p">}</span>
<span class="w">  </span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">{</span><span class="nx">notification</span><span class="p">.</span><span class="nx">message</span><span class="p">}</span>
<span class="w">  </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">))}</span>
<span class="c1">// ...</span>
</code></pre></div>

<p>The console warning is gone! Problem solved, right?</p>
<p><strong>Not so fast.</strong> Using the index as a key is one of the most common and subtle bugs in React. It silences the warning but creates deeper issues.</p>
<h3 id="the-limitation-of-index-as-key">The Limitation of Index-as-Key</h3>
<p>The <code>key</code> prop is not for you; it's for React. It's a hint that helps React identify which items have changed, are added, or are removed. A key should be <strong>stable</strong> (it doesn't change for a given item), <strong>predictable</strong>, and <strong>unique</strong>.</p>
<p>An item's index in an array is <em>not</em> stable. If you delete the first item, the second item's index becomes <code>0</code>. If you sort the array, every item's index can change. By using <code>key={index}</code>, you are telling React that the item's identity is tied to its <em>position</em>, not the data it represents.</p>
<h3 id="new-scenario-dismissing-a-notification">New Scenario: Dismissing a Notification</h3>
<p>Let's prove this is a problem. We'll add a button to each notification to dismiss it. To make the bug obvious, we'll also add an uncontrolled <code>&lt;input&gt;</code> field inside each notification item. This input will hold its own state, separate from React's state, which will visually expose the underlying issue.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/NotificationPanel.tsx - Version 1.1 (demonstrating failure)</span>

<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="c1">// ... (Notification type and initialNotifications are the same)</span>

<span class="c1">// Let&#39;s create a sub-component for clarity</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">NotificationItem</span><span class="p">({</span><span class="w"> </span><span class="nx">notification</span><span class="p">,</span><span class="w"> </span><span class="nx">onDismiss</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span>
<span class="w">      </span><span class="err">//</span><span class="w"> </span><span class="na">The</span><span class="w"> </span><span class="na">anti</span><span class="err">-</span><span class="na">pattern</span><span class="w"> </span><span class="na">we</span><span class="w"> </span><span class="na">are</span><span class="w"> </span><span class="na">testing</span>
<span class="w">      </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`notification notification--</span><span class="si">${</span><span class="nx">notification</span><span class="p">.</span><span class="kr">type</span><span class="si">}</span><span class="sb">`</span><span class="p">}</span>
<span class="w">    </span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">notification</span><span class="p">.</span><span class="nx">message</span><span class="p">}</span>
<span class="w">      </span><span class="p">{</span><span class="cm">/* This input will help us visualize the bug */</span><span class="p">}</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">input</span><span class="w"> </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="w"> </span><span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Add a note...&quot;</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">onDismiss</span><span class="p">}&gt;</span><span class="nx">Dismiss</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">NotificationPanel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">notifications</span><span class="p">,</span><span class="w"> </span><span class="nx">setNotifications</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="nx">initialNotifications</span><span class="p">);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleDismiss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">idToDismiss</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setNotifications</span><span class="p">(</span><span class="nx">current</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">current</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">n</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">idToDismiss</span><span class="p">));</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;notification-panel&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">Notifications</span><span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;notification-list&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">notification</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">NotificationItem</span>
<span class="w">            </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">index</span><span class="p">}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">‚Üê</span><span class="w"> </span><span class="na">The</span><span class="w"> </span><span class="na">problematic</span><span class="w"> </span><span class="na">key</span>
<span class="w">            </span><span class="na">notification</span><span class="o">=</span><span class="p">{</span><span class="nx">notification</span><span class="p">}</span>
<span class="w">            </span><span class="na">onDismiss</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">handleDismiss</span><span class="p">(</span><span class="nx">notification</span><span class="p">.</span><span class="nx">id</span><span class="p">)}</span>
<span class="w">          </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">))}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>Now, let's run the failure scenario:</p>
<ol>
<li>Run the app.</li>
<li>In the first notification's input field ("Your profile has been updated."), type "Checked this".</li>
<li>In the second notification's input field ("Your subscription is expiring soon."), type "Need to renew".</li>
<li>Now, click the "Dismiss" button on the <strong>first</strong> notification.</li>
</ol>
<h3 id="diagnostic-analysis-the-index-key-failure">Diagnostic Analysis: The Index-Key Failure</h3>
<p><strong>Browser Behavior</strong>:
When you dismiss the first notification, the list shrinks from three items to two. However, you'll see something strange:</p>
<ul>
<li>The text "Your profile has been updated." disappears.</li>
<li>The text "Your subscription is expiring soon." moves up to the first position.</li>
<li>The text "Failed to upload document." moves up to the second position.</li>
<li><strong>Crucially</strong>, the input field in the first position still says "Checked this", and the second input field still says "Need to renew". The input state did not move with the notification message it was next to. The last notification item, along with its empty input field, is what actually got removed from the DOM.</li>
</ul>
<p><strong>React DevTools Evidence</strong>:
- <strong>Before Dismiss</strong>: The component tree shows three <code>NotificationItem</code> components with keys <code>0</code>, <code>1</code>, and <code>2</code>.
- <strong>After Dismiss</strong>: The component tree shows two <code>NotificationItem</code> components with keys <code>0</code> and <code>1</code>.
- React sees that it used to have components for keys <code>0, 1, 2</code> and now it only needs components for keys <code>0, 1</code>. Its most efficient move is to simply discard the component and DOM node for <code>key=2</code>. It then updates the props for the components at <code>key=0</code> and <code>key=1</code> with the new data at <code>index=0</code> and <code>index=1</code>. The components themselves (and their internal state, like our input) are preserved.</p>
<p><strong>Let's parse this evidence</strong>:</p>
<ol>
<li><strong>What the user experiences</strong>: The UI is now in a corrupted state. The data (notification message) and the component's internal state (the input value) are mismatched.</li>
<li><strong>What DevTools reveals</strong>: React didn't remove the first component. It removed the <em>last</em> component and just passed new props to the first two.</li>
<li><strong>Root cause identified</strong>: Using the index as a key tells React that <code>NotificationItem key={0}</code> is the same conceptual component before and after the state update. React re-renders it with new props (<code>notification</code> object for <code>id: 'notif-2'</code>), but since it's an uncontrolled input, its internal state is preserved.</li>
<li><strong>Why the current approach can't solve this</strong>: The index key breaks the link between the data's identity and the component's identity. It forces React to make incorrect assumptions about which component corresponds to which piece of data.</li>
<li><strong>What we need</strong>: A key that is tied to the data itself. A key that is stable and unique for each notification, no matter its position in the array.</li>
</ol>
<h3 id="iteration-2-the-correct-solution-stable-unique-keys">Iteration 2: The Correct Solution (Stable, Unique Keys)</h3>
<p>The solution is to use a piece of data that uniquely identifies each notification. In our <code>Notification</code> type, the <code>id</code> property is perfect for this.</p>
<p><strong>Before</strong> (Iteration 1.1):</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/NotificationPanel.tsx - Version 1.1</span>
<span class="c1">// ...</span>
<span class="p">{</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">notification</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="p">&lt;</span><span class="nt">NotificationItem</span>
<span class="w">    </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">index</span><span class="p">}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">‚Üê</span><span class="w"> </span><span class="na">The</span><span class="w"> </span><span class="na">problem</span>
<span class="w">    </span><span class="na">notification</span><span class="o">=</span><span class="p">{</span><span class="nx">notification</span><span class="p">}</span>
<span class="w">    </span><span class="na">onDismiss</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">handleDismiss</span><span class="p">(</span><span class="nx">notification</span><span class="p">.</span><span class="nx">id</span><span class="p">)}</span>
<span class="w">  </span><span class="p">/&gt;</span>
<span class="p">))}</span>
<span class="c1">// ...</span>
</code></pre></div>

<p><strong>After</strong> (Iteration 2):</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/NotificationPanel.tsx - Version 2</span>
<span class="c1">// ...</span>
<span class="p">{</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">notification</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="p">&lt;</span><span class="nt">NotificationItem</span>
<span class="w">    </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">notification</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">‚Üê</span><span class="w"> </span><span class="na">The</span><span class="w"> </span><span class="na">solution</span><span class="err">:</span><span class="w"> </span><span class="na">use</span><span class="w"> </span><span class="na">a</span><span class="w"> </span><span class="na">stable</span><span class="err">,</span><span class="w"> </span><span class="na">unique</span><span class="w"> </span><span class="na">ID</span>
<span class="w">    </span><span class="na">notification</span><span class="o">=</span><span class="p">{</span><span class="nx">notification</span><span class="p">}</span>
<span class="w">    </span><span class="na">onDismiss</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">handleDismiss</span><span class="p">(</span><span class="nx">notification</span><span class="p">.</span><span class="nx">id</span><span class="p">)}</span>
<span class="w">  </span><span class="p">/&gt;</span>
<span class="p">))}</span>
<span class="c1">// ...</span>
</code></pre></div>

<h3 id="verification">Verification</h3>
<p>Let's re-run the exact same test scenario:</p>
<ol>
<li>Run the app.</li>
<li>Type "Checked this" into the first notification's input.</li>
<li>Type "Need to renew" into the second notification's input.</li>
<li>Click "Dismiss" on the <strong>first</strong> notification.</li>
</ol>
<p><strong>Expected vs. Actual Improvement</strong>:
- <strong>Expected</strong>: The first notification, along with its input field containing "Checked this", should disappear entirely. The second notification, with its input field containing "Need to renew", should remain as the first item in the list.
- <strong>Actual</strong>: This is exactly what happens! The UI behaves correctly. React, using the stable <code>id</code> as the key, correctly identified that the component with <code>key="notif-1"</code> was removed and updated the DOM accordingly, preserving the correct state for the remaining components.</p>
<h3 id="when-to-apply-this-solution">When to Apply This Solution</h3>
<ul>
<li><strong>When to use stable IDs for keys</strong>: <strong>Almost always.</strong> Whenever you are rendering a list from an array of objects, and those objects have a unique identifier, use it as the key. This is the correct, default approach.</li>
<li><strong>When is <code>key={index}</code> acceptable?</strong>: Only in the rare case that all of the following are true:<ol>
<li>The list and its items are purely static; they will never be re-ordered, filtered, or have items added/removed from the middle.</li>
<li>The items in the list have no IDs.</li>
<li>The component is simple and has no internal state of its own.</li>
</ol>
</li>
</ul>
<p>Even then, it's often better to generate temporary IDs if possible. As a rule of thumb: <strong>avoid index as key</strong>.</p>
<h2 id="conditional-rendering-patterns">Conditional rendering patterns</h2>
<h2 id="handling-dynamic-ui-states">Handling Dynamic UI States</h2>
<p>Our <code>NotificationPanel</code> is better, but it's still naive. What happens if the list of notifications is empty? Or while we're fetching them from a server? A robust component must handle all possible states, not just the "happy path" where data exists. This is where conditional rendering comes in.</p>
<p>Let's enhance our <code>NotificationPanel</code> to handle an empty state.</p>
<h3 id="pattern-1-ternary-operator-condition-a-b">Pattern 1: Ternary Operator (<code>condition ? &lt;A /&gt; : &lt;B /&gt;</code>)</h3>
<p>The ternary operator is perfect for simple if-else logic directly inside your JSX. If the notifications array is empty, we want to show a message; otherwise, we show the list.</p>
<p><strong>Before</strong> (Iteration 2):</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/NotificationPanel.tsx - Version 2</span>
<span class="c1">// ...</span>
<span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;notification-panel&quot;</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">Notifications</span><span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;notification-list&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">notification</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">NotificationItem</span><span class="w"> </span><span class="err">/*</span><span class="w"> </span><span class="na">...</span><span class="w"> </span><span class="err">*/</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">))}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">);</span>
<span class="c1">// ...</span>
</code></pre></div>

<p><strong>After</strong> (Iteration 3.1):</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/NotificationPanel.tsx - Version 3.1</span>
<span class="c1">// ...</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">NotificationPanel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">notifications</span><span class="p">,</span><span class="w"> </span><span class="nx">setNotifications</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="nx">initialNotifications</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// ... handleDismiss function</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;notification-panel&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">Notifications</span><span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;notification-list&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="nx">notifications</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">notification</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="p">&lt;</span><span class="nt">NotificationItem</span>
<span class="w">              </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">notification</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span>
<span class="w">              </span><span class="na">notification</span><span class="o">=</span><span class="p">{</span><span class="nx">notification</span><span class="p">}</span>
<span class="w">              </span><span class="na">onDismiss</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">handleDismiss</span><span class="p">(</span><span class="nx">notification</span><span class="p">.</span><span class="nx">id</span><span class="p">)}</span>
<span class="w">            </span><span class="p">/&gt;</span>
<span class="w">          </span><span class="p">))</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;empty-state&quot;</span><span class="p">&gt;</span><span class="nx">No</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">notifications</span><span class="p">.&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>Now, if you change <code>initialNotifications</code> to an empty array <code>[]</code>, the panel will correctly display "No new notifications."</p>
<h3 id="pattern-2-logical-and-condition-expression">Pattern 2: Logical AND (<code>condition &amp;&amp; &lt;Expression /&gt;</code>)</h3>
<p>This pattern is ideal for situations where you want to render something <em>only if</em> a condition is true, and render nothing otherwise. Let's add an "unread" indicator to our notifications. We'll add a <code>read</code> property to our data.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/NotificationPanel.tsx - Updated types and data</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">Notification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;info&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;warning&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">read</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span><span class="w"> </span><span class="c1">// ‚Üê Added property</span>
<span class="p">};</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">initialNotifications</span><span class="o">:</span><span class="w"> </span><span class="kt">Notification</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;notif-1&#39;</span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;info&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Your profile has been updated.&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">read</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;notif-2&#39;</span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;warning&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Your subscription is expiring soon.&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">read</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;notif-3&#39;</span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Failed to upload document.&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">read</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="w"> </span><span class="p">},</span>
<span class="p">];</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/NotificationPanel.tsx - Version 3.2 (in NotificationItem)</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">UnreadIndicator</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;unread-dot&quot;</span><span class="w"> </span><span class="na">aria-label</span><span class="o">=</span><span class="s">&quot;unread&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;;</span>
<span class="p">}</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">NotificationItem</span><span class="p">({</span><span class="w"> </span><span class="nx">notification</span><span class="p">,</span><span class="w"> </span><span class="nx">onDismiss</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`notification notification--</span><span class="si">${</span><span class="nx">notification</span><span class="p">.</span><span class="kr">type</span><span class="si">}</span><span class="sb"> </span><span class="si">${</span><span class="nx">notification</span><span class="p">.</span><span class="nx">read</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;is-read&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="sb">`</span><span class="p">}&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="o">!</span><span class="nx">notification</span><span class="p">.</span><span class="nx">read</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">UnreadIndicator</span><span class="w"> </span><span class="p">/&gt;}</span><span class="w"> </span><span class="p">{</span><span class="cm">/* ‚Üê Logical AND */</span><span class="p">}</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;message&quot;</span><span class="p">&gt;{</span><span class="nx">notification</span><span class="p">.</span><span class="nx">message</span><span class="p">}&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">input</span><span class="w"> </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="w"> </span><span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Add a note...&quot;</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">onDismiss</span><span class="p">}&gt;</span><span class="nx">Dismiss</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>This works perfectly. The <code>UnreadIndicator</code> component will only be rendered if <code>!notification.read</code> is true.</p>
<h4 id="common-failure-mode-the-0-gotcha">Common Failure Mode: The <code>0</code> Gotcha</h4>
<p>A classic trap with the <code>&amp;&amp;</code> pattern occurs when the condition is a number. In JavaScript, <code>0</code> is "falsy", but it's not <code>null</code> or <code>undefined</code>. React renders the number <code>0</code> as text in the DOM.</p>
<p><strong>Symptom</strong>: You see a <code>0</code> unexpectedly rendered on your page.</p>
<p><strong>Example Failure</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">messageCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>

<span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">{</span><span class="nx">messageCount</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">You</span><span class="w"> </span><span class="nx">have</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">messages</span><span class="o">!</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;}</span>
<span class="w">  </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">);</span>
</code></pre></div>

<p><strong>Browser Behavior</strong>: The page will render <code>&lt;div&gt;0&lt;/div&gt;</code>.</p>
<p><strong>Root Cause</strong>: The expression <code>0 &amp;&amp; &lt;p&gt;...&lt;/p&gt;</code> evaluates to <code>0</code> in JavaScript, which React then renders.</p>
<p><strong>Solution</strong>: Ensure your condition is a true boolean.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Fix 1: Explicit comparison</span>
<span class="p">{</span><span class="nx">messageCount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">You</span><span class="w"> </span><span class="nx">have</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">messages</span><span class="o">!</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;}</span>

<span class="c1">// Fix 2: Coerce to boolean</span>
<span class="p">{</span><span class="nb">Boolean</span><span class="p">(</span><span class="nx">messageCount</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">You</span><span class="w"> </span><span class="nx">have</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">messages</span><span class="o">!</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;}</span>
</code></pre></div>

<h3 id="pattern-3-if-statements-and-early-returns">Pattern 3: <code>if</code> Statements and Early Returns</h3>
<p>When a component has multiple, mutually exclusive states (like loading, error, and success), nesting ternaries can become messy. A cleaner pattern is to use "guard clauses" or "early returns" at the top of your component.</p>
<p>Let's simulate loading and error states in our <code>NotificationPanel</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/NotificationPanel.tsx - Version 3.3</span>

<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useEffect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="c1">// ... Notification type, NotificationItem, etc.</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">NotificationPanel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">notifications</span><span class="p">,</span><span class="w"> </span><span class="nx">setNotifications</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">Notification</span><span class="err">[]</span><span class="p">&gt;([]);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">isLoading</span><span class="p">,</span><span class="w"> </span><span class="nx">setIsLoading</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">error</span><span class="p">,</span><span class="w"> </span><span class="nx">setError</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">string</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="na">null</span><span class="p">&gt;(</span><span class="kc">null</span><span class="p">);</span>

<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Simulate a network request</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">fetchNotifications</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">await</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Promise</span><span class="p">(</span><span class="nx">resolve</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setTimeout</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span><span class="w"> </span><span class="mf">1500</span><span class="p">));</span><span class="w"> </span><span class="c1">// Fake delay</span>
<span class="w">        </span><span class="c1">// To test the error state, uncomment the next line:</span>
<span class="w">        </span><span class="c1">// throw new Error(&quot;Could not fetch notifications.&quot;);</span>
<span class="w">        </span><span class="nx">setNotifications</span><span class="p">(</span><span class="nx">initialNotifications</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">setError</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">setIsLoading</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="nx">fetchNotifications</span><span class="p">();</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleDismiss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">idToDismiss</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setNotifications</span><span class="p">(</span><span class="nx">current</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">current</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">n</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">idToDismiss</span><span class="p">));</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="c1">// --- Early Return Guard Clauses ---</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isLoading</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;panel-loading&quot;</span><span class="p">&gt;</span><span class="nx">Loading</span><span class="w"> </span><span class="nx">notifications</span><span class="p">...&lt;/</span><span class="nt">div</span><span class="p">&gt;;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;panel-error&quot;</span><span class="p">&gt;</span><span class="ne">Error</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">error</span><span class="p">}&lt;/</span><span class="nt">div</span><span class="p">&gt;;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="c1">// ------------------------------------</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;notification-panel&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">Notifications</span><span class="w"> </span><span class="p">({</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">length</span><span class="p">})&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;notification-list&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="nx">notifications</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">notification</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="p">&lt;</span><span class="nt">NotificationItem</span>
<span class="w">              </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">notification</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span>
<span class="w">              </span><span class="na">notification</span><span class="o">=</span><span class="p">{</span><span class="nx">notification</span><span class="p">}</span>
<span class="w">              </span><span class="na">onDismiss</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">handleDismiss</span><span class="p">(</span><span class="nx">notification</span><span class="p">.</span><span class="nx">id</span><span class="p">)}</span>
<span class="w">            </span><span class="p">/&gt;</span>
<span class="w">          </span><span class="p">))</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;empty-state&quot;</span><span class="p">&gt;</span><span class="nx">No</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">notifications</span><span class="p">.&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>This code is much easier to read. The main <code>return</code> statement at the end can assume that loading is finished and there are no errors. It only has to worry about the "success" and "empty" states.</p>
<h3 id="decision-framework-choosing-a-pattern">Decision Framework: Choosing a Pattern</h3>
<table>
<thead>
<tr>
<th>Scenario</th>
<th>Best Pattern</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>Simple "if-this-then-that-else-other"</td>
<td>Ternary Operator (<code>? :</code>)</td>
<td><code>isLoggedIn ? &lt;UserProfile /&gt; : &lt;LoginForm /&gt;</code></td>
</tr>
<tr>
<td>"Show this or show nothing"</td>
<td>Logical AND (<code>&amp;&amp;</code>)</td>
<td><code>isAdmin &amp;&amp; &lt;AdminDashboardLink /&gt;</code></td>
</tr>
<tr>
<td>Multiple exclusive top-level states</td>
<td><code>if</code> statements / Early Returns</td>
<td><code>if (loading) ...</code>, <code>if (error) ...</code>, <code>return &lt;DataView /&gt;</code></td>
</tr>
<tr>
<td>Filtering items within a list</td>
<td>Pre-filter array before <code>.map()</code></td>
<td><code>items.filter(item =&gt; item.isActive).map(...)</code></td>
</tr>
</tbody>
</table>
<h2 id="avoiding-unnecessary-re-renders">Avoiding unnecessary re-renders</h2>
<h2 id="the-performance-cost-of-change">The Performance Cost of Change</h2>
<p>Our component is now robust, but is it performant? Every time a component's state or props change, it re-renders. This is usually fine, but in a list, if the parent component re-renders, it can cause <em>every single item in the list</em> to re-render, even if those items haven't changed.</p>
<p>Let's introduce a new feature to demonstrate this problem: a filter input that lets the user search their notifications.</p>
<h3 id="iteration-4-introducing-a-parent-state-change">Iteration 4: Introducing a Parent State Change</h3>
<p>We'll add a simple text input to the <code>NotificationPanel</code>. As the user types, we'll update a <code>filterText</code> state variable.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/NotificationPanel.tsx - Version 4 (demonstrating failure)</span>

<span class="c1">// In NotificationItem, add a console.log to see when it renders</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">NotificationItem</span><span class="p">({</span><span class="w"> </span><span class="nx">notification</span><span class="p">,</span><span class="w"> </span><span class="nx">onDismiss</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Rendering NotificationItem: </span><span class="si">${</span><span class="nx">notification</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// ... rest of the component is the same</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">);</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">NotificationPanel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// ... all the existing state and logic ...</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">filterText</span><span class="p">,</span><span class="w"> </span><span class="nx">setFilterText</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// ... useEffect for fetching ...</span>
<span class="w">  </span><span class="c1">// ... handleDismiss ...</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isLoading</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">}</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filteredNotifications</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">notifications</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span>
<span class="w">    </span><span class="nx">n</span><span class="p">.</span><span class="nx">message</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">includes</span><span class="p">(</span><span class="nx">filterText</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">())</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;notification-panel&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">Notifications</span><span class="w"> </span><span class="p">({</span><span class="nx">filteredNotifications</span><span class="p">.</span><span class="nx">length</span><span class="p">})&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">input</span><span class="w"> </span>
<span class="w">        </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">        </span><span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Filter notifications...&quot;</span>
<span class="w">        </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">filterText</span><span class="p">}</span>
<span class="w">        </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setFilterText</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">        </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;filter-input&quot;</span>
<span class="w">      </span><span class="p">/&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;notification-list&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">filteredNotifications</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="nx">filteredNotifications</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">notification</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="p">&lt;</span><span class="nt">NotificationItem</span>
<span class="w">              </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">notification</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span>
<span class="w">              </span><span class="na">notification</span><span class="o">=</span><span class="p">{</span><span class="nx">notification</span><span class="p">}</span>
<span class="w">              </span><span class="na">onDismiss</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">handleDismiss</span><span class="p">(</span><span class="nx">notification</span><span class="p">.</span><span class="nx">id</span><span class="p">)}</span>
<span class="w">            </span><span class="p">/&gt;</span>
<span class="w">          </span><span class="p">))</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;empty-state&quot;</span><span class="p">&gt;</span><span class="nx">No</span><span class="w"> </span><span class="nx">matching</span><span class="w"> </span><span class="nx">notifications</span><span class="p">.&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>Now, run the app and open the console. Start typing in the "Filter notifications..." input box.</p>
<h3 id="diagnostic-analysis-the-re-render-cascade">Diagnostic Analysis: The Re-render Cascade</h3>
<p><strong>Browser Behavior</strong>:
The filtering works correctly. As you type, the list of notifications updates to show only matching items.</p>
<p><strong>Browser Console Output</strong>:
With every single keystroke, you will see a flood of logs:</p>
<div class="codehilite"><pre><span></span><code><span class="nv">Rendering</span><span class="w"> </span><span class="nv">NotificationItem</span>:<span class="w"> </span><span class="nv">notif</span><span class="o">-</span><span class="mi">1</span>
<span class="nv">Rendering</span><span class="w"> </span><span class="nv">NotificationItem</span>:<span class="w"> </span><span class="nv">notif</span><span class="o">-</span><span class="mi">2</span>
<span class="nv">Rendering</span><span class="w"> </span><span class="nv">NotificationItem</span>:<span class="w"> </span><span class="nv">notif</span><span class="o">-</span><span class="mi">3</span>
<span class="nv">Rendering</span><span class="w"> </span><span class="nv">NotificationItem</span>:<span class="w"> </span><span class="nv">notif</span><span class="o">-</span><span class="mi">1</span>
<span class="nv">Rendering</span><span class="w"> </span><span class="nv">NotificationItem</span>:<span class="w"> </span><span class="nv">notif</span><span class="o">-</span><span class="mi">2</span>
<span class="nv">Rendering</span><span class="w"> </span><span class="nv">NotificationItem</span>:<span class="w"> </span><span class="nv">notif</span><span class="o">-</span><span class="mi">3</span>
...<span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">so</span><span class="w"> </span><span class="nv">on</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">every</span><span class="w"> </span><span class="nv">key</span><span class="w"> </span><span class="nv">press</span>
</code></pre></div>

<p><strong>React DevTools Profiler Evidence</strong>:
If you record a profiling session while typing, you'll see that with each keystroke, the <code>NotificationPanel</code> re-renders (which is correct, its state changed), and consequently, <em>all</em> of the visible <code>NotificationItem</code> components also re-render, even though their own <code>notification</code> prop has not changed.</p>
<p><strong>Let's parse this evidence</strong>:</p>
<ol>
<li><strong>What the user experiences</strong>: The UI works, but for very long lists or complex list items, it might feel sluggish.</li>
<li><strong>What the console reveals</strong>: Every <code>NotificationItem</code> is re-rendering on every keystroke.</li>
<li><strong>Root cause identified</strong>: When <code>NotificationPanel</code>'s state (<code>filterText</code>) changes, it re-renders. During its render, it calls <code>.map()</code> on the <code>filteredNotifications</code> array, creating a new set of <code>NotificationItem</code> elements. React compares the new elements to the old ones. Even though the props might be identical, React re-renders the child components by default.</li>
<li><strong>Why the current approach can't solve this</strong>: By default, React's philosophy is to re-render children when a parent re-renders. We need a way to opt out of this behavior.</li>
<li><strong>What we need</strong>: A way to tell React, "Hey, this <code>NotificationItem</code> component is pure. If its props don't change, don't bother re-rendering it."</li>
</ol>
<h3 id="the-solution-reactmemo">The Solution: <code>React.memo</code></h3>
<p>React provides a Higher-Order Component called <code>React.memo</code> for exactly this purpose. It "memoizes" the component, meaning it saves the result of the last render and reuses it if the props are the same on the next render.</p>
<p><strong>Before</strong> (Iteration 4):</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/NotificationPanel.tsx - Version 4</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">NotificationItem</span><span class="p">({</span><span class="w"> </span><span class="nx">notification</span><span class="p">,</span><span class="w"> </span><span class="nx">onDismiss</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Rendering NotificationItem: </span><span class="si">${</span><span class="nx">notification</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>After</strong> (Iteration 5):</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/NotificationPanel.tsx - Version 5</span>
<span class="k">import</span><span class="w"> </span><span class="nx">React</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useEffect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Import React</span>

<span class="c1">// ...</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">NotificationItem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">React</span><span class="p">.</span><span class="nx">memo</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="nx">NotificationItem</span><span class="p">({</span><span class="w"> </span><span class="nx">notification</span><span class="p">,</span><span class="w"> </span><span class="nx">onDismiss</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Rendering NotificationItem: </span><span class="si">${</span><span class="nx">notification</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// ... same component implementation</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`notification notification--</span><span class="si">${</span><span class="nx">notification</span><span class="p">.</span><span class="kr">type</span><span class="si">}</span><span class="sb"> </span><span class="si">${</span><span class="nx">notification</span><span class="p">.</span><span class="nx">read</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;is-read&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="sb">`</span><span class="p">}&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="o">!</span><span class="nx">notification</span><span class="p">.</span><span class="nx">read</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">UnreadIndicator</span><span class="w"> </span><span class="p">/&gt;}</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;message&quot;</span><span class="p">&gt;{</span><span class="nx">notification</span><span class="p">.</span><span class="nx">message</span><span class="p">}&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">input</span><span class="w"> </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="w"> </span><span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Add a note...&quot;</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">onDismiss</span><span class="p">}&gt;</span><span class="nx">Dismiss</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// ... NotificationPanel remains the same</span>
</code></pre></div>

<h3 id="verification_1">Verification</h3>
<p>Clear your console and type in the filter input again.</p>
<p><strong>Expected vs. Actual Improvement</strong>:
- <strong>Expected</strong>: The <code>console.log</code> for <code>NotificationItem</code> should not fire when typing in the filter, because the props for each item (<code>notification</code> and <code>onDismiss</code>) are not changing.
- <strong>Actual</strong>: The console is silent! The items no longer re-render on every keystroke. The Profiler confirms this, showing the <code>NotificationItem</code> components as grayed out ("did not render").</p>
<p><strong>Limitation Preview</strong>: <code>React.memo</code> performs a shallow comparison of props. If you pass complex objects or functions that are re-created on every render (like an inline arrow function <code>onClick={() =&gt; {}}</code>), memoization will fail. This is a deeper topic we will explore fully in Chapter 10: Performance Optimization. For now, know that <code>memo</code> is your first tool for preventing unnecessary list item re-renders.</p>
<h2 id="synthesis-the-complete-journey">Synthesis - The Complete Journey</h2>
<h2 id="the-journey-from-problem-to-solution">The Journey: From Problem to Solution</h2>
<p>We've taken a simple component and progressively made it more robust, correct, and performant by encountering and solving a series of common problems.</p>
<table>
<thead>
<tr>
<th>Iteration</th>
<th>Failure Mode</th>
<th>Technique Applied</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Missing <code>key</code> prop</td>
<td>None</td>
<td>Console warning, inefficient updates</td>
</tr>
<tr>
<td>1</td>
<td>Using <code>index</code> as key</td>
<td><code>key={index}</code></td>
<td>State corruption on item deletion/reorder</td>
</tr>
<tr>
<td>2</td>
<td>Incorrect UI state on data changes</td>
<td><code>key={notification.id}</code></td>
<td>Correct, stable rendering and state handling</td>
</tr>
<tr>
<td>3</td>
<td>No handling for empty/loading/error states</td>
<td>Conditional Rendering</td>
<td>Robust UI that handles all data states</td>
</tr>
<tr>
<td>4</td>
<td>Unnecessary re-renders of list items</td>
<td><code>React.memo</code></td>
<td>Optimized performance on parent state change</td>
</tr>
</tbody>
</table>
<h3 id="final-implementation">Final Implementation</h3>
<p>Here is the complete, production-ready version of our <code>NotificationPanel</code> that incorporates all the lessons learned.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/NotificationPanel.tsx - Final Version</span>

<span class="k">import</span><span class="w"> </span><span class="nx">React</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useEffect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="c1">// --- Types and Initial Data ---</span>
<span class="kr">type</span><span class="w"> </span><span class="nx">Notification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;info&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;warning&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">read</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="p">};</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">initialNotifications</span><span class="o">:</span><span class="w"> </span><span class="kt">Notification</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;notif-1&#39;</span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;info&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Your profile has been updated.&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">read</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;notif-2&#39;</span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;warning&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Your subscription is expiring soon.&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">read</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;notif-3&#39;</span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Failed to upload document.&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">read</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="w"> </span><span class="p">},</span>
<span class="p">];</span>

<span class="c1">// --- Child Components ---</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">UnreadIndicator</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;unread-dot&quot;</span><span class="w"> </span><span class="na">aria-label</span><span class="o">=</span><span class="s">&quot;unread&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;;</span>
<span class="p">}</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">NotificationItem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">React</span><span class="p">.</span><span class="nx">memo</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="nx">NotificationItem</span><span class="p">({</span>
<span class="w">  </span><span class="nx">notification</span><span class="p">,</span>
<span class="w">  </span><span class="nx">onDismiss</span><span class="p">,</span>
<span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">notification</span><span class="o">:</span><span class="w"> </span><span class="kt">Notification</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onDismiss</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// console.log(`Rendering NotificationItem: ${notification.id}`); // For debugging</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`notification notification--</span><span class="si">${</span><span class="nx">notification</span><span class="p">.</span><span class="kr">type</span><span class="si">}</span><span class="sb"> </span><span class="si">${</span><span class="nx">notification</span><span class="p">.</span><span class="nx">read</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;is-read&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="sb">`</span><span class="p">}&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="o">!</span><span class="nx">notification</span><span class="p">.</span><span class="nx">read</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">UnreadIndicator</span><span class="w"> </span><span class="p">/&gt;}</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;message&quot;</span><span class="p">&gt;{</span><span class="nx">notification</span><span class="p">.</span><span class="nx">message</span><span class="p">}&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">input</span><span class="w"> </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="w"> </span><span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Add a note...&quot;</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">onDismiss</span><span class="p">(</span><span class="nx">notification</span><span class="p">.</span><span class="nx">id</span><span class="p">)}&gt;</span><span class="nx">Dismiss</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// --- Main Panel Component ---</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">NotificationPanel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">notifications</span><span class="p">,</span><span class="w"> </span><span class="nx">setNotifications</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">Notification</span><span class="err">[]</span><span class="p">&gt;([]);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">isLoading</span><span class="p">,</span><span class="w"> </span><span class="nx">setIsLoading</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">error</span><span class="p">,</span><span class="w"> </span><span class="nx">setError</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">string</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="na">null</span><span class="p">&gt;(</span><span class="kc">null</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">filterText</span><span class="p">,</span><span class="w"> </span><span class="nx">setFilterText</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">fetchNotifications</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">await</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Promise</span><span class="p">(</span><span class="nx">resolve</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setTimeout</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span><span class="w"> </span><span class="mf">1500</span><span class="p">));</span>
<span class="w">        </span><span class="nx">setNotifications</span><span class="p">(</span><span class="nx">initialNotifications</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">setError</span><span class="p">(</span><span class="s1">&#39;Could not fetch notifications.&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">setIsLoading</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="nx">fetchNotifications</span><span class="p">();</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleDismiss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">idToDismiss</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setNotifications</span><span class="p">(</span><span class="nx">current</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">current</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">n</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">idToDismiss</span><span class="p">));</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isLoading</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;panel-loading&quot;</span><span class="p">&gt;</span><span class="nx">Loading</span><span class="w"> </span><span class="nx">notifications</span><span class="p">...&lt;/</span><span class="nt">div</span><span class="p">&gt;;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;panel-error&quot;</span><span class="p">&gt;</span><span class="ne">Error</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">error</span><span class="p">}&lt;/</span><span class="nt">div</span><span class="p">&gt;;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filteredNotifications</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">notifications</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="p">=&gt;</span>
<span class="w">    </span><span class="nx">n</span><span class="p">.</span><span class="nx">message</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">includes</span><span class="p">(</span><span class="nx">filterText</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">())</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;notification-panel&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">Notifications</span><span class="w"> </span><span class="p">({</span><span class="nx">filteredNotifications</span><span class="p">.</span><span class="nx">length</span><span class="p">})&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">        </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">        </span><span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Filter notifications...&quot;</span>
<span class="w">        </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">filterText</span><span class="p">}</span>
<span class="w">        </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setFilterText</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">        </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;filter-input&quot;</span>
<span class="w">      </span><span class="p">/&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;notification-list&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">filteredNotifications</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="nx">filteredNotifications</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">notification</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="p">&lt;</span><span class="nt">NotificationItem</span>
<span class="w">              </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">notification</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span>
<span class="w">              </span><span class="na">notification</span><span class="o">=</span><span class="p">{</span><span class="nx">notification</span><span class="p">}</span>
<span class="w">              </span><span class="na">onDismiss</span><span class="o">=</span><span class="p">{</span><span class="nx">handleDismiss</span><span class="p">}</span>
<span class="w">            </span><span class="p">/&gt;</span>
<span class="w">          </span><span class="p">))</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;empty-state&quot;</span><span class="p">&gt;</span><span class="nx">No</span><span class="w"> </span><span class="nx">matching</span><span class="w"> </span><span class="nx">notifications</span><span class="p">.&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="lessons-learned">Lessons Learned</h3>
<ol>
<li><strong>Keys are for Identity, Not Position</strong>: The <code>key</code> prop is React's way of tracking an element's identity across renders. Always use a stable, unique ID from your data (<code>item.id</code>), and never use the array index (<code>index</code>) for dynamic lists.</li>
<li><strong>Render Every State</strong>: A component isn't complete until it can correctly render all its possible states: loading, error, empty, and data-filled. Use conditional rendering patterns to handle each case explicitly.</li>
<li><strong>Default Re-renders Can Be Costly</strong>: Be aware that parent state changes will cause child components in a list to re-render by default. Use <code>React.memo</code> as a first-line defense to prevent this for components that receive stable props.</li>
</ol>
        </div>
        <div class="footer">
            Generated on 2025-11-25 13:40:58 | Made with ‚ù§Ô∏è by GitHub Pages Generator
        </div>
    </div>
    <script>
        // Syntax highlighting for code blocks
        document.addEventListener('DOMContentLoaded', (event) => {
            // Highlight code blocks
            document.querySelectorAll('pre code').forEach((block) => {
                hljs.highlightElement(block);
            });
            
            // Add copy buttons to code blocks
            document.querySelectorAll('pre').forEach((pre) => {
                const button = document.createElement('button');
                button.className = 'copy-btn';
                button.textContent = 'Copy';
                
                button.addEventListener('click', () => {
                    const code = pre.querySelector('code').textContent;
                    navigator.clipboard.writeText(code).then(() => {
                        button.textContent = 'Copied!';
                        button.classList.add('copied');
                        setTimeout(() => {
                            button.textContent = 'Copy';
                            button.classList.remove('copied');
                        }, 2000);
                    }).catch(err => {
                        console.error('Failed to copy:', err);
                        button.textContent = 'Error';
                        setTimeout(() => {
                            button.textContent = 'Copy';
                        }, 2000);
                    });
                });
                
                pre.appendChild(button);
            });
        });
    </script>
</body>
</html>