<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>06 Forms and Validation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #8b5cf6;
            --bg-main: #0f172a;
            --bg-card: #1e293b;
            --bg-code: #0f172a;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #334155;
            --accent: #06b6d4;
            --success: #10b981;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            line-height: 1.7; 
            color: var(--text-primary); 
            background: var(--bg-main);
        }
        
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 20px; 
        }
        
        .home-btn { 
            position: fixed; 
            top: 20px; 
            right: 20px; 
            background: var(--accent);
            color: white; 
            width: 50px;
            height: 50px;
            border-radius: 50%;
            text-decoration: none; 
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(6, 182, 212, 0.4);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .home-btn:hover { 
            background: #0891b2;
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(6, 182, 212, 0.5);
        }
        
        .breadcrumb { 
            background: var(--bg-card);
            padding: 12px 0; 
            margin-bottom: 24px; 
            font-size: 14px;
            border-radius: 8px;
            border: 1px solid var(--border);
        }
        
        .breadcrumb a { 
            color: var(--accent);
            text-decoration: none;
            transition: color 0.2s;
        }
        
        .breadcrumb a:hover { 
            color: var(--primary);
            text-decoration: underline;
        }
        
        .content { 
            background: var(--bg-card);
            padding: 3rem; 
            border-radius: 16px; 
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border);
        }
        
        .file-list { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); 
            gap: 1.5rem; 
            margin: 2rem 0; 
        }
        
        .file-item { 
            padding: 1.5rem; 
            border: 1px solid var(--border);
            border-radius: 12px; 
            background: var(--bg-main);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .file-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .file-item:hover { 
            transform: translateY(-4px); 
            box-shadow: 0 8px 30px rgba(99, 102, 241, 0.3);
            border-color: var(--primary);
        }
        
        .file-item:hover::before {
            opacity: 1;
        }
        
        .file-item a { 
            color: var(--text-primary);
            text-decoration: none; 
            font-weight: 600; 
            display: block;
            font-size: 1.1rem;
        }
        
        .file-item a:hover { 
            color: var(--primary);
        }
        
        .file-type { 
            font-size: 13px; 
            color: var(--text-secondary);
            margin-top: 8px; 
            font-weight: 500;
        }
        
        /* Code Blocks */
        pre { 
            background: var(--bg-code);
            padding: 1.5rem; 
            border-radius: 12px; 
            overflow-x: auto;
            border: 1px solid var(--border);
            margin: 1.5rem 0;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            position: relative;
        }
        
        pre code { 
            background: none;
            padding: 0;
            font-family: 'Fira Code', 'Consolas', monospace;
            font-size: 0.9em;
            line-height: 1.6;
        }
        
        /* Copy Button */
        .copy-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: var(--primary);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.2s;
            opacity: 0.7;
            z-index: 10;
        }
        
        .copy-btn:hover {
            opacity: 1;
            background: var(--primary-dark);
            transform: translateY(-1px);
        }
        
        .copy-btn.copied {
            background: var(--success);
        }
        
        pre:hover .copy-btn {
            opacity: 1;
        }
        
        /* Inline Code */
        code { 
            background: var(--bg-code);
            color: #8b5cf6;
            padding: 3px 8px; 
            border-radius: 6px; 
            font-size: 1.1em;
            font-family: 'Fira Code', 'Consolas', monospace;
            border: 1px solid var(--border);
        }
        
        /* Headings */
        h1, h2, h3, h4, h5, h6 { 
            color: var(--text-primary);
            margin: 2rem 0 1rem 0;
            font-weight: 700;
            letter-spacing: -0.5px;
        }
        
        h1 { 
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            border-bottom: 3px solid var(--primary);
            padding-bottom: 12px;
            margin-bottom: 1.5rem;
        }
        
        h2 { 
            font-size: 2rem;
            color: var(--primary);
            border-bottom: 2px solid var(--border);
            padding-bottom: 8px;
        }
        
        h3 { 
            font-size: 1.5rem;
            color: var(--accent);
        }
        
        /* Links */
        a { 
            color: var(--accent);
            transition: color 0.2s;
        }
        
        a:hover { 
            color: var(--primary);
        }
        
        /* Paragraphs */
        p {
            margin: 1rem 0;
            color: var(--text-secondary);
        }
        
        /* Lists */
        ul, ol {
            margin: 1rem 0;
            padding-left: 2rem;
            color: var(--text-secondary);
        }
        
        li {
            margin: 0.5rem 0;
        }
        
        /* Tables */
        table { 
            border-collapse: collapse;
            width: 100%;
            margin: 1.5rem 0;
            background: var(--bg-main);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }
        
        th, td { 
            border: 1px solid var(--border);
            padding: 12px 16px;
            text-align: left;
        }
        
        th { 
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            font-weight: 600;
        }
        
        tr:hover {
            background: var(--bg-card);
        }
        
        /* Blockquotes */
        blockquote {
            border-left: 4px solid var(--primary);
            padding: 1rem 1.5rem;
            margin: 1.5rem 0;
            background: var(--bg-main);
            border-radius: 0 8px 8px 0;
            color: var(--text-secondary);
            font-style: italic;
        }
        
        /* Horizontal Rule */
        hr {
            border: none;
            border-top: 2px solid var(--border);
            margin: 2rem 0;
        }
        
        .footer { 
            text-align: center; 
            padding: 2rem; 
            color: var(--text-secondary);
            border-top: 1px solid var(--border);
            margin-top: 3rem; 
            font-size: 14px;
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--bg-main);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 6px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }
        
        @media (max-width: 768px) {
            .container { padding: 10px; }
            .file-list { grid-template-columns: 1fr; }
            .content { padding: 1.5rem; }
            h1 { font-size: 2rem; }
            h2 { font-size: 1.5rem; }
        }
    </style>
</head>
<body>
    <a href="../index.html" class="home-btn">üè†</a>
    <div class="container">
        <div class="breadcrumb">
            <div style="padding: 0 20px;">
                <a href="../index.html">üè† Home</a> <span style="color: #64748b;">/</span> <a href="index.html">01 React Fundamentals</a>
            </div>
        </div>
        <div class="content">
            <h1 id="chapter-6-forms-and-validation">Chapter 6: Forms and Validation</h1>
<h2 id="handling-form-state">Handling form state</h2>
<h2 id="the-problem-forms-are-deceptively-complex">The Problem: Forms Are Deceptively Complex</h2>
<p>Forms seem simple. A few inputs, a submit button, maybe some validation. How hard could it be?</p>
<p>Let's find out by building a user settings form for our dashboard. Users should be able to update their profile information: name, email, bio, and notification preferences.</p>
<h3 id="phase-1-the-naive-approach">Phase 1: The Naive Approach</h3>
<p>Here's what most developers try first‚Äîmanaging form state manually with <code>useState</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/UserSettingsForm.tsx</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">FormEvent</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">UserSettings</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">bio</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">emailNotifications</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">pushNotifications</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">UserSettingsForm</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">setName</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">email</span><span class="p">,</span><span class="w"> </span><span class="nx">setEmail</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">bio</span><span class="p">,</span><span class="w"> </span><span class="nx">setBio</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">emailNotifications</span><span class="p">,</span><span class="w"> </span><span class="nx">setEmailNotifications</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">pushNotifications</span><span class="p">,</span><span class="w"> </span><span class="nx">setPushNotifications</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">isSubmitting</span><span class="p">,</span><span class="w"> </span><span class="nx">setIsSubmitting</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleSubmit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="o">:</span><span class="w"> </span><span class="kt">FormEvent</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
<span class="w">    </span><span class="nx">setIsSubmitting</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>

<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/api/user/settings&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;PUT&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">({</span>
<span class="w">          </span><span class="nx">name</span><span class="p">,</span>
<span class="w">          </span><span class="nx">email</span><span class="p">,</span>
<span class="w">          </span><span class="nx">bio</span><span class="p">,</span>
<span class="w">          </span><span class="nx">emailNotifications</span><span class="p">,</span>
<span class="w">          </span><span class="nx">pushNotifications</span><span class="p">,</span>
<span class="w">        </span><span class="p">}),</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;Failed to update settings&#39;</span><span class="p">);</span>

<span class="w">      </span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Settings updated successfully!&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Failed to update settings&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">setIsSubmitting</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">form</span><span class="w"> </span><span class="na">onSubmit</span><span class="o">=</span><span class="p">{</span><span class="nx">handleSubmit</span><span class="p">}</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;space-y-4&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">htmlFor</span><span class="o">=</span><span class="s">&quot;name&quot;</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;block text-sm font-medium&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Name</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;name&quot;</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">          </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">name</span><span class="p">}</span>
<span class="w">          </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setName</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 block w-full rounded border p-2&quot;</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">htmlFor</span><span class="o">=</span><span class="s">&quot;email&quot;</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;block text-sm font-medium&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Email</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;email&quot;</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;email&quot;</span>
<span class="w">          </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">email</span><span class="p">}</span>
<span class="w">          </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setEmail</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 block w-full rounded border p-2&quot;</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">htmlFor</span><span class="o">=</span><span class="s">&quot;bio&quot;</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;block text-sm font-medium&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Bio</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">textarea</span>
<span class="w">          </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;bio&quot;</span>
<span class="w">          </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">bio</span><span class="p">}</span>
<span class="w">          </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setBio</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">          </span><span class="na">rows</span><span class="o">=</span><span class="p">{</span><span class="mf">4</span><span class="p">}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 block w-full rounded border p-2&quot;</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;space-y-2&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex items-center&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">            </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;checkbox&quot;</span>
<span class="w">            </span><span class="na">checked</span><span class="o">=</span><span class="p">{</span><span class="nx">emailNotifications</span><span class="p">}</span>
<span class="w">            </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setEmailNotifications</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">checked</span><span class="p">)}</span>
<span class="w">            </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mr-2&quot;</span>
<span class="w">          </span><span class="p">/&gt;</span>
<span class="w">          </span><span class="nx">Email</span><span class="w"> </span><span class="nx">notifications</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex items-center&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">            </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;checkbox&quot;</span>
<span class="w">            </span><span class="na">checked</span><span class="o">=</span><span class="p">{</span><span class="nx">pushNotifications</span><span class="p">}</span>
<span class="w">            </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setPushNotifications</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">checked</span><span class="p">)}</span>
<span class="w">            </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mr-2&quot;</span>
<span class="w">          </span><span class="p">/&gt;</span>
<span class="w">          </span><span class="nx">Push</span><span class="w"> </span><span class="nx">notifications</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">        </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span>
<span class="w">        </span><span class="na">disabled</span><span class="o">=</span><span class="p">{</span><span class="nx">isSubmitting</span><span class="p">}</span>
<span class="w">        </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;rounded bg-blue-600 px-4 py-2 text-white disabled:opacity-50&quot;</span>
<span class="w">      </span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">isSubmitting</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;Saving...&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Save Settings&#39;</span><span class="p">}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>This works. You can type in the fields, check the boxes, submit the form. But let's add some real-world requirements and watch it fall apart.</p>
<h3 id="the-first-failure-no-validation">The First Failure: No Validation</h3>
<p><strong>Scenario</strong>: User submits the form with an empty name or invalid email.</p>
<p>Let's test it:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// In your app, render the form and try submitting with:</span>
<span class="c1">// - Empty name field</span>
<span class="c1">// - Email: &quot;notanemail&quot;</span>
<span class="c1">// - Bio: (leave empty)</span>

<span class="p">&lt;</span><span class="nt">UserSettingsForm</span><span class="w"> </span><span class="p">/&gt;</span>
</code></pre></div>

<h3 id="diagnostic-analysis-reading-the-failure">Diagnostic Analysis: Reading the Failure</h3>
<p><strong>Browser Behavior</strong>:
- Form submits successfully
- Alert shows "Settings updated successfully!"
- No indication that the data is invalid</p>
<p><strong>Browser Console Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>POST /api/user/settings 400 Bad Request
{
  &quot;error&quot;: &quot;Validation failed&quot;,
  &quot;details&quot;: {
    &quot;name&quot;: &quot;Name is required&quot;,
    &quot;email&quot;: &quot;Invalid email format&quot;
  }
}
</code></pre></div>

<p><strong>Network Tab Analysis</strong>:
- Request sent with invalid data: <code>{ name: "", email: "notanemail", ... }</code>
- Server responds with 400 error
- Client shows success message anyway (we're not checking <code>response.ok</code> properly)</p>
<p><strong>Let's parse this evidence</strong>:</p>
<ol>
<li><strong>What the user experiences</strong>: </li>
<li>Expected: Form should prevent submission with invalid data</li>
<li>
<p>Actual: Form submits, shows success, but server rejects it</p>
</li>
<li>
<p><strong>What the console reveals</strong>: </p>
</li>
<li>Server validation is working (400 error with details)</li>
<li>Client validation is completely missing</li>
<li>
<p>Error handling in our code is broken (we throw an error but still show success)</p>
</li>
<li>
<p><strong>Root cause identified</strong>: We have no client-side validation, and our error handling doesn't actually work because we're checking <code>response.ok</code> but then showing success regardless.</p>
</li>
<li>
<p><strong>Why the current approach can't solve this</strong>: Adding validation manually means:</p>
</li>
<li>Writing validation logic for each field</li>
<li>Managing error state for each field</li>
<li>Coordinating when to show errors (on blur? on submit? on change?)</li>
<li>
<p>Keeping validation logic in sync with server-side rules</p>
</li>
<li>
<p><strong>What we need</strong>: A systematic way to validate form data before submission.</p>
</li>
</ol>
<h3 id="iteration-1-adding-manual-validation">Iteration 1: Adding Manual Validation</h3>
<p>Let's add validation the hard way first, so you understand why libraries exist:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/UserSettingsForm.tsx</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">FormEvent</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">UserSettings</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">bio</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">emailNotifications</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">pushNotifications</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">FormErrors</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">name?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">email?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">bio?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">UserSettingsForm</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">setName</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">email</span><span class="p">,</span><span class="w"> </span><span class="nx">setEmail</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">bio</span><span class="p">,</span><span class="w"> </span><span class="nx">setBio</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">emailNotifications</span><span class="p">,</span><span class="w"> </span><span class="nx">setEmailNotifications</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">pushNotifications</span><span class="p">,</span><span class="w"> </span><span class="nx">setPushNotifications</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">isSubmitting</span><span class="p">,</span><span class="w"> </span><span class="nx">setIsSubmitting</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">errors</span><span class="p">,</span><span class="w"> </span><span class="nx">setErrors</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">FormErrors</span><span class="p">&gt;({});</span><span class="w"> </span><span class="c1">// ‚Üê Added</span>

<span class="w">  </span><span class="c1">// ‚Üê Added validation function</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">validateForm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">newErrors</span><span class="o">:</span><span class="w"> </span><span class="kt">FormErrors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">name</span><span class="p">.</span><span class="nx">trim</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">newErrors</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Name is required&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">newErrors</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Name must be at least 2 characters&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">email</span><span class="p">.</span><span class="nx">trim</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">newErrors</span><span class="p">.</span><span class="nx">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Email is required&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="sr">/^[^\s@]+@[^\s@]+\.[^\s@]+$/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">email</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">newErrors</span><span class="p">.</span><span class="nx">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Invalid email format&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">bio</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">500</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">newErrors</span><span class="p">.</span><span class="nx">bio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Bio must be less than 500 characters&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">setErrors</span><span class="p">(</span><span class="nx">newErrors</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">newErrors</span><span class="p">).</span><span class="nx">length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleSubmit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="o">:</span><span class="w"> </span><span class="kt">FormEvent</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// ‚Üê Added validation check</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">validateForm</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">setIsSubmitting</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>

<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/api/user/settings&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;PUT&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">({</span>
<span class="w">          </span><span class="nx">name</span><span class="p">,</span>
<span class="w">          </span><span class="nx">email</span><span class="p">,</span>
<span class="w">          </span><span class="nx">bio</span><span class="p">,</span>
<span class="w">          </span><span class="nx">emailNotifications</span><span class="p">,</span>
<span class="w">          </span><span class="nx">pushNotifications</span><span class="p">,</span>
<span class="w">        </span><span class="p">}),</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">errorData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="nx">errorData</span><span class="p">.</span><span class="nx">error</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;Failed to update settings&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Settings updated successfully!&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="nx">setErrors</span><span class="p">({});</span><span class="w"> </span><span class="c1">// ‚Üê Clear errors on success</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">alert</span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Failed to update settings&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">setIsSubmitting</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">form</span><span class="w"> </span><span class="na">onSubmit</span><span class="o">=</span><span class="p">{</span><span class="nx">handleSubmit</span><span class="p">}</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;space-y-4&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">htmlFor</span><span class="o">=</span><span class="s">&quot;name&quot;</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;block text-sm font-medium&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Name</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;name&quot;</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">          </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">name</span><span class="p">}</span>
<span class="w">          </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setName</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 block w-full rounded border p-2&quot;</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="cm">/* ‚Üê Added error display */</span><span class="p">}</span>
<span class="w">        </span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 text-sm text-red-600&quot;</span><span class="p">&gt;{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">name</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">htmlFor</span><span class="o">=</span><span class="s">&quot;email&quot;</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;block text-sm font-medium&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Email</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;email&quot;</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;email&quot;</span>
<span class="w">          </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">email</span><span class="p">}</span>
<span class="w">          </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setEmail</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 block w-full rounded border p-2&quot;</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="cm">/* ‚Üê Added error display */</span><span class="p">}</span>
<span class="w">        </span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">email</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 text-sm text-red-600&quot;</span><span class="p">&gt;{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">email</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">htmlFor</span><span class="o">=</span><span class="s">&quot;bio&quot;</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;block text-sm font-medium&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Bio</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">textarea</span>
<span class="w">          </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;bio&quot;</span>
<span class="w">          </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">bio</span><span class="p">}</span>
<span class="w">          </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setBio</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">          </span><span class="na">rows</span><span class="o">=</span><span class="p">{</span><span class="mf">4</span><span class="p">}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 block w-full rounded border p-2&quot;</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="cm">/* ‚Üê Added error display */</span><span class="p">}</span>
<span class="w">        </span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">bio</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 text-sm text-red-600&quot;</span><span class="p">&gt;{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">bio</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;space-y-2&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex items-center&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">            </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;checkbox&quot;</span>
<span class="w">            </span><span class="na">checked</span><span class="o">=</span><span class="p">{</span><span class="nx">emailNotifications</span><span class="p">}</span>
<span class="w">            </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setEmailNotifications</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">checked</span><span class="p">)}</span>
<span class="w">            </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mr-2&quot;</span>
<span class="w">          </span><span class="p">/&gt;</span>
<span class="w">          </span><span class="nx">Email</span><span class="w"> </span><span class="nx">notifications</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex items-center&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">            </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;checkbox&quot;</span>
<span class="w">            </span><span class="na">checked</span><span class="o">=</span><span class="p">{</span><span class="nx">pushNotifications</span><span class="p">}</span>
<span class="w">            </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setPushNotifications</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">checked</span><span class="p">)}</span>
<span class="w">            </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mr-2&quot;</span>
<span class="w">          </span><span class="p">/&gt;</span>
<span class="w">          </span><span class="nx">Push</span><span class="w"> </span><span class="nx">notifications</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">        </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span>
<span class="w">        </span><span class="na">disabled</span><span class="o">=</span><span class="p">{</span><span class="nx">isSubmitting</span><span class="p">}</span>
<span class="w">        </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;rounded bg-blue-600 px-4 py-2 text-white disabled:opacity-50&quot;</span>
<span class="w">      </span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">isSubmitting</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;Saving...&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Save Settings&#39;</span><span class="p">}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Improvement</strong>: Form now validates on submit and shows error messages.</p>
<p><strong>Verification</strong>: Try submitting with invalid data:
- Empty name ‚Üí Shows "Name is required"
- Invalid email ‚Üí Shows "Invalid email format"
- Form doesn't submit until all fields are valid</p>
<h3 id="the-second-failure-validation-timing-is-wrong">The Second Failure: Validation Timing Is Wrong</h3>
<p><strong>Scenario</strong>: User types an invalid email, then clicks submit. Error appears. User fixes the email but the error message stays until they submit again.</p>
<h3 id="diagnostic-analysis-reading-the-failure_1">Diagnostic Analysis: Reading the Failure</h3>
<p><strong>Browser Behavior</strong>:
- Type "notanemail" in email field
- Click submit
- Error appears: "Invalid email format"
- Fix email to "user@example.com"
- Error message still shows "Invalid email format"
- Must click submit again to clear the error</p>
<p><strong>React DevTools Evidence</strong>:
- <code>UserSettingsForm</code> component selected
- State: <code>errors: { email: "Invalid email format" }</code>
- User types in email field
- State: <code>email</code> updates to "user@example.com"
- State: <code>errors</code> still contains <code>{ email: "Invalid email format" }</code>
- Errors only clear on next submit</p>
<p><strong>Let's parse this evidence</strong>:</p>
<ol>
<li><strong>What the user experiences</strong>:</li>
<li>Expected: Error should disappear when field becomes valid</li>
<li>
<p>Actual: Error persists until form is submitted again</p>
</li>
<li>
<p><strong>What DevTools shows</strong>:</p>
</li>
<li>Email state updates on every keystroke</li>
<li>Error state only updates on submit</li>
<li>
<p>No connection between field changes and error clearing</p>
</li>
<li>
<p><strong>Root cause identified</strong>: We only validate on submit. Field changes don't trigger validation.</p>
</li>
<li>
<p><strong>Why the current approach can't solve this</strong>: We need to validate on field change, but that means:</p>
</li>
<li>Calling <code>validateForm()</code> on every keystroke</li>
<li>Validating ALL fields on EVERY change (expensive)</li>
<li>Or writing per-field validation logic (more code)</li>
<li>
<p>Managing when to show errors (immediately? after blur? after first submit?)</p>
</li>
<li>
<p><strong>What we need</strong>: Smart validation that knows when to validate each field.</p>
</li>
</ol>
<h3 id="iteration-2-validate-on-change-the-naive-way">Iteration 2: Validate on Change (The Naive Way)</h3>
<p>Let's try validating on every change:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/UserSettingsForm.tsx - Validation on change</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">UserSettingsForm</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">setName</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">email</span><span class="p">,</span><span class="w"> </span><span class="nx">setEmail</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">bio</span><span class="p">,</span><span class="w"> </span><span class="nx">setBio</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">emailNotifications</span><span class="p">,</span><span class="w"> </span><span class="nx">setEmailNotifications</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">pushNotifications</span><span class="p">,</span><span class="w"> </span><span class="nx">setPushNotifications</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">isSubmitting</span><span class="p">,</span><span class="w"> </span><span class="nx">setIsSubmitting</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">errors</span><span class="p">,</span><span class="w"> </span><span class="nx">setErrors</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">FormErrors</span><span class="p">&gt;({});</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">touched</span><span class="p">,</span><span class="w"> </span><span class="nx">setTouched</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">Record</span><span class="err">&lt;</span><span class="na">string</span><span class="err">,</span><span class="w"> </span><span class="na">boolean</span><span class="p">&gt;</span><span class="o">&gt;</span><span class="p">({});</span><span class="w"> </span><span class="c1">// ‚Üê Added</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">validateForm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">newErrors</span><span class="o">:</span><span class="w"> </span><span class="kt">FormErrors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">name</span><span class="p">.</span><span class="nx">trim</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">newErrors</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Name is required&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">newErrors</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Name must be at least 2 characters&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">email</span><span class="p">.</span><span class="nx">trim</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">newErrors</span><span class="p">.</span><span class="nx">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Email is required&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="sr">/^[^\s@]+@[^\s@]+\.[^\s@]+$/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">email</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">newErrors</span><span class="p">.</span><span class="nx">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Invalid email format&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">bio</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">500</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">newErrors</span><span class="p">.</span><span class="nx">bio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Bio must be less than 500 characters&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">setErrors</span><span class="p">(</span><span class="nx">newErrors</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">newErrors</span><span class="p">).</span><span class="nx">length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="c1">// ‚Üê Added: Validate whenever fields change</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleNameChange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setName</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">touched</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">validateForm</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleEmailChange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setEmail</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">touched</span><span class="p">.</span><span class="nx">email</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">validateForm</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleBioChange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setBio</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">touched</span><span class="p">.</span><span class="nx">bio</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">validateForm</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleBlur</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">field</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setTouched</span><span class="p">({</span><span class="w"> </span><span class="p">...</span><span class="nx">touched</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="nx">field</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">});</span>
<span class="w">    </span><span class="nx">validateForm</span><span class="p">();</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleSubmit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="o">:</span><span class="w"> </span><span class="kt">FormEvent</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// Mark all fields as touched</span>
<span class="w">    </span><span class="nx">setTouched</span><span class="p">({</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span><span class="w"> </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span><span class="w"> </span><span class="nx">bio</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="w"> </span><span class="p">});</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">validateForm</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">setIsSubmitting</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>

<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/api/user/settings&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;PUT&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">({</span>
<span class="w">          </span><span class="nx">name</span><span class="p">,</span>
<span class="w">          </span><span class="nx">email</span><span class="p">,</span>
<span class="w">          </span><span class="nx">bio</span><span class="p">,</span>
<span class="w">          </span><span class="nx">emailNotifications</span><span class="p">,</span>
<span class="w">          </span><span class="nx">pushNotifications</span><span class="p">,</span>
<span class="w">        </span><span class="p">}),</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">errorData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="nx">errorData</span><span class="p">.</span><span class="nx">error</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;Failed to update settings&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Settings updated successfully!&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="nx">setErrors</span><span class="p">({});</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">alert</span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Failed to update settings&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">setIsSubmitting</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">form</span><span class="w"> </span><span class="na">onSubmit</span><span class="o">=</span><span class="p">{</span><span class="nx">handleSubmit</span><span class="p">}</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;space-y-4&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">htmlFor</span><span class="o">=</span><span class="s">&quot;name&quot;</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;block text-sm font-medium&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Name</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;name&quot;</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">          </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">name</span><span class="p">}</span>
<span class="w">          </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">handleNameChange</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">          </span><span class="na">onBlur</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">handleBlur</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">‚Üê</span><span class="w"> </span><span class="na">Added</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 block w-full rounded border p-2&quot;</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">touched</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="c1">// ‚Üê Only show if touched</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 text-sm text-red-600&quot;</span><span class="p">&gt;{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">name</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">htmlFor</span><span class="o">=</span><span class="s">&quot;email&quot;</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;block text-sm font-medium&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Email</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;email&quot;</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;email&quot;</span>
<span class="w">          </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">email</span><span class="p">}</span>
<span class="w">          </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">handleEmailChange</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">          </span><span class="na">onBlur</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">handleBlur</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">)}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">‚Üê</span><span class="w"> </span><span class="na">Added</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 block w-full rounded border p-2&quot;</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">touched</span><span class="p">.</span><span class="nx">email</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">email</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="c1">// ‚Üê Only show if touched</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 text-sm text-red-600&quot;</span><span class="p">&gt;{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">email</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">htmlFor</span><span class="o">=</span><span class="s">&quot;bio&quot;</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;block text-sm font-medium&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Bio</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">textarea</span>
<span class="w">          </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;bio&quot;</span>
<span class="w">          </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">bio</span><span class="p">}</span>
<span class="w">          </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">handleBioChange</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">          </span><span class="na">onBlur</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">handleBlur</span><span class="p">(</span><span class="s1">&#39;bio&#39;</span><span class="p">)}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">‚Üê</span><span class="w"> </span><span class="na">Added</span>
<span class="w">          </span><span class="na">rows</span><span class="o">=</span><span class="p">{</span><span class="mf">4</span><span class="p">}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 block w-full rounded border p-2&quot;</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">touched</span><span class="p">.</span><span class="nx">bio</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">bio</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="c1">// ‚Üê Only show if touched</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 text-sm text-red-600&quot;</span><span class="p">&gt;{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">bio</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;space-y-2&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex items-center&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">            </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;checkbox&quot;</span>
<span class="w">            </span><span class="na">checked</span><span class="o">=</span><span class="p">{</span><span class="nx">emailNotifications</span><span class="p">}</span>
<span class="w">            </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setEmailNotifications</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">checked</span><span class="p">)}</span>
<span class="w">            </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mr-2&quot;</span>
<span class="w">          </span><span class="p">/&gt;</span>
<span class="w">          </span><span class="nx">Email</span><span class="w"> </span><span class="nx">notifications</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex items-center&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">            </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;checkbox&quot;</span>
<span class="w">            </span><span class="na">checked</span><span class="o">=</span><span class="p">{</span><span class="nx">pushNotifications</span><span class="p">}</span>
<span class="w">            </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setPushNotifications</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">checked</span><span class="p">)}</span>
<span class="w">            </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mr-2&quot;</span>
<span class="w">          </span><span class="p">/&gt;</span>
<span class="w">          </span><span class="nx">Push</span><span class="w"> </span><span class="nx">notifications</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">        </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span>
<span class="w">        </span><span class="na">disabled</span><span class="o">=</span><span class="p">{</span><span class="nx">isSubmitting</span><span class="p">}</span>
<span class="w">        </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;rounded bg-blue-600 px-4 py-2 text-white disabled:opacity-50&quot;</span>
<span class="w">      </span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">isSubmitting</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;Saving...&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Save Settings&#39;</span><span class="p">}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Improvement</strong>: Errors now clear as you fix them (after the field has been touched).</p>
<p><strong>Verification</strong>: 
- Submit form with invalid email
- Error appears
- Fix email ‚Üí Error disappears immediately
- Fresh fields don't show errors until you blur them</p>
<h3 id="the-third-failure-this-code-is-a-maintenance-nightmare">The Third Failure: This Code Is a Maintenance Nightmare</h3>
<p>Look at what we've created:
- 6 state variables for 5 form fields
- Separate change handlers for each field
- Manual touched state tracking
- Validation logic duplicated between submit and change handlers
- 150+ lines of code for a simple form</p>
<p><strong>What happens when we need to add</strong>:
- Password field with confirmation
- Phone number with formatting
- Address with multiple fields
- Async validation (check if email is already taken)
- File upload for profile picture</p>
<p><strong>The math</strong>: Each new field requires:
- 1 <code>useState</code> for value
- 1 entry in <code>touched</code> state
- 1 change handler function
- 1 blur handler call
- 1 validation rule
- 1 error display block
- TypeScript types for all of the above</p>
<p>For a 10-field form, that's 70+ additions. For a 20-field form, you're looking at 140+ additions.</p>
<h3 id="current-limitation">Current Limitation</h3>
<p>Manual form state management doesn't scale. We need:
1. Automatic state management for all fields
2. Smart validation timing (touched fields only)
3. Type-safe field registration
4. Built-in error handling
5. Less boilerplate</p>
<p>This is exactly what React Hook Form solves.</p>
<h2 id="react-hook-form-stop-reinventing-the-wheel">React Hook Form: stop reinventing the wheel</h2>
<h2 id="the-solution-react-hook-form">The Solution: React Hook Form</h2>
<p>React Hook Form is a library that handles all the tedious parts of form management:
- Field registration and state management
- Validation timing (touched, dirty, submit)
- Error handling and display
- TypeScript integration
- Performance optimization (minimal re-renders)</p>
<p>Let's rebuild our form using React Hook Form and see the difference.</p>
<h3 id="installation">Installation</h3>
<p>First, install the library:</p>
<div class="codehilite"><pre><span></span><code>npm<span class="w"> </span>install<span class="w"> </span>react-hook-form
</code></pre></div>

<h3 id="iteration-3-react-hook-form-basic-implementation">Iteration 3: React Hook Form Basic Implementation</h3>
<p>Here's the same form, rewritten with React Hook Form:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/UserSettingsForm.tsx</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useForm</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react-hook-form&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">UserSettings</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">bio</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">emailNotifications</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">pushNotifications</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">UserSettingsForm</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">register</span><span class="p">,</span>
<span class="w">    </span><span class="nx">handleSubmit</span><span class="p">,</span>
<span class="w">    </span><span class="nx">formState</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">errors</span><span class="p">,</span><span class="w"> </span><span class="nx">isSubmitting</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useForm</span><span class="p">&lt;</span><span class="nt">UserSettings</span><span class="p">&gt;({</span>
<span class="w">    </span><span class="nx">defaultValues</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">bio</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">emailNotifications</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
<span class="w">      </span><span class="nx">pushNotifications</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">onSubmit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">UserSettings</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/api/user/settings&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;PUT&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">(</span><span class="nx">data</span><span class="p">),</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">errorData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="nx">errorData</span><span class="p">.</span><span class="nx">error</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;Failed to update settings&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Settings updated successfully!&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">alert</span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Failed to update settings&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">form</span><span class="w"> </span><span class="na">onSubmit</span><span class="o">=</span><span class="p">{</span><span class="nx">handleSubmit</span><span class="p">(</span><span class="nx">onSubmit</span><span class="p">)}</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;space-y-4&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">htmlFor</span><span class="o">=</span><span class="s">&quot;name&quot;</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;block text-sm font-medium&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Name</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;name&quot;</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">          </span><span class="p">{</span><span class="na">...register</span><span class="err">(&#39;</span><span class="na">name</span><span class="err">&#39;,</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="na">required</span><span class="err">:</span><span class="w"> </span><span class="err">&#39;</span><span class="na">Name</span><span class="w"> </span><span class="na">is</span><span class="w"> </span><span class="na">required</span><span class="err">&#39;,</span>
<span class="w">            </span><span class="na">minLength</span><span class="err">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="na">value</span><span class="err">:</span><span class="w"> </span><span class="na">2</span><span class="err">,</span>
<span class="w">              </span><span class="na">message</span><span class="err">:</span><span class="w"> </span><span class="err">&#39;</span><span class="na">Name</span><span class="w"> </span><span class="na">must</span><span class="w"> </span><span class="na">be</span><span class="w"> </span><span class="na">at</span><span class="w"> </span><span class="na">least</span><span class="w"> </span><span class="na">2</span><span class="w"> </span><span class="na">characters</span><span class="err">&#39;,</span>
<span class="w">            </span><span class="p">}</span><span class="err">,</span>
<span class="w">          </span><span class="p">}</span><span class="err">)</span><span class="p">}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 block w-full rounded border p-2&quot;</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 text-sm text-red-600&quot;</span><span class="p">&gt;{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">message</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">htmlFor</span><span class="o">=</span><span class="s">&quot;email&quot;</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;block text-sm font-medium&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Email</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;email&quot;</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;email&quot;</span>
<span class="w">          </span><span class="p">{</span><span class="na">...register</span><span class="err">(&#39;</span><span class="na">email</span><span class="err">&#39;,</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="na">required</span><span class="err">:</span><span class="w"> </span><span class="err">&#39;</span><span class="na">Email</span><span class="w"> </span><span class="na">is</span><span class="w"> </span><span class="na">required</span><span class="err">&#39;,</span>
<span class="w">            </span><span class="na">pattern</span><span class="err">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="na">value</span><span class="err">:</span><span class="w"> </span><span class="err">/^[^\</span><span class="na">s</span><span class="err">@]+@[^\</span><span class="na">s</span><span class="err">@]+\</span><span class="na">.</span><span class="err">[^\</span><span class="na">s</span><span class="err">@]+$/,</span>
<span class="w">              </span><span class="na">message</span><span class="err">:</span><span class="w"> </span><span class="err">&#39;</span><span class="na">Invalid</span><span class="w"> </span><span class="na">email</span><span class="w"> </span><span class="na">format</span><span class="err">&#39;,</span>
<span class="w">            </span><span class="p">}</span><span class="err">,</span>
<span class="w">          </span><span class="p">}</span><span class="err">)</span><span class="p">}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 block w-full rounded border p-2&quot;</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">email</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 text-sm text-red-600&quot;</span><span class="p">&gt;{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">email</span><span class="p">.</span><span class="nx">message</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">htmlFor</span><span class="o">=</span><span class="s">&quot;bio&quot;</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;block text-sm font-medium&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Bio</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">textarea</span>
<span class="w">          </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;bio&quot;</span>
<span class="w">          </span><span class="p">{</span><span class="na">...register</span><span class="err">(&#39;</span><span class="na">bio</span><span class="err">&#39;,</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="na">maxLength</span><span class="err">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="na">value</span><span class="err">:</span><span class="w"> </span><span class="na">500</span><span class="err">,</span>
<span class="w">              </span><span class="na">message</span><span class="err">:</span><span class="w"> </span><span class="err">&#39;</span><span class="na">Bio</span><span class="w"> </span><span class="na">must</span><span class="w"> </span><span class="na">be</span><span class="w"> </span><span class="na">less</span><span class="w"> </span><span class="na">than</span><span class="w"> </span><span class="na">500</span><span class="w"> </span><span class="na">characters</span><span class="err">&#39;,</span>
<span class="w">            </span><span class="p">}</span><span class="err">,</span>
<span class="w">          </span><span class="p">}</span><span class="err">)</span><span class="p">}</span>
<span class="w">          </span><span class="na">rows</span><span class="o">=</span><span class="p">{</span><span class="mf">4</span><span class="p">}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 block w-full rounded border p-2&quot;</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">bio</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 text-sm text-red-600&quot;</span><span class="p">&gt;{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">bio</span><span class="p">.</span><span class="nx">message</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;space-y-2&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex items-center&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">            </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;checkbox&quot;</span>
<span class="w">            </span><span class="p">{</span><span class="na">...register</span><span class="err">(&#39;</span><span class="na">emailNotifications</span><span class="err">&#39;)</span><span class="p">}</span>
<span class="w">            </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mr-2&quot;</span>
<span class="w">          </span><span class="p">/&gt;</span>
<span class="w">          </span><span class="nx">Email</span><span class="w"> </span><span class="nx">notifications</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex items-center&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">            </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;checkbox&quot;</span>
<span class="w">            </span><span class="p">{</span><span class="na">...register</span><span class="err">(&#39;</span><span class="na">pushNotifications</span><span class="err">&#39;)</span><span class="p">}</span>
<span class="w">            </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mr-2&quot;</span>
<span class="w">          </span><span class="p">/&gt;</span>
<span class="w">          </span><span class="nx">Push</span><span class="w"> </span><span class="nx">notifications</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">        </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span>
<span class="w">        </span><span class="na">disabled</span><span class="o">=</span><span class="p">{</span><span class="nx">isSubmitting</span><span class="p">}</span>
<span class="w">        </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;rounded bg-blue-600 px-4 py-2 text-white disabled:opacity-50&quot;</span>
<span class="w">      </span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">isSubmitting</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;Saving...&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Save Settings&#39;</span><span class="p">}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>What just happened?</strong></p>
<p>Compare the line counts:
- <strong>Manual approach</strong>: 150+ lines
- <strong>React Hook Form</strong>: 80 lines</p>
<p>We eliminated:
- ‚ùå 6 <code>useState</code> declarations
- ‚ùå 3 custom change handlers
- ‚ùå 1 <code>touched</code> state object
- ‚ùå 1 <code>validateForm</code> function
- ‚ùå Manual error state management</p>
<p>We gained:
- ‚úÖ Automatic field registration with <code>register()</code>
- ‚úÖ Built-in validation rules
- ‚úÖ Type-safe form data
- ‚úÖ Smart validation timing (validates on blur, re-validates on change)
- ‚úÖ Automatic <code>isSubmitting</code> state</p>
<h3 id="how-react-hook-form-works">How React Hook Form Works</h3>
<p>Let's break down the key pieces:</p>
<h4 id="1-the-useform-hook">1. The <code>useForm</code> Hook</h4>
<div class="codehilite"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">register</span><span class="p">,</span>
<span class="w">  </span><span class="nx">handleSubmit</span><span class="p">,</span>
<span class="w">  </span><span class="nx">formState</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">errors</span><span class="p">,</span><span class="w"> </span><span class="nx">isSubmitting</span><span class="w"> </span><span class="p">},</span>
<span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useForm</span><span class="p">&lt;</span><span class="nt">UserSettings</span><span class="p">&gt;({</span>
<span class="w">  </span><span class="nx">defaultValues</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="w">  </span><span class="p">},</span>
<span class="p">});</span>
</code></pre></div>

<p>This hook returns everything you need:
- <code>register</code>: Function to register input fields
- <code>handleSubmit</code>: Wrapper for your submit handler
- <code>formState</code>: Contains errors, validation state, etc.</p>
<h4 id="2-field-registration">2. Field Registration</h4>
<div class="codehilite"><pre><span></span><code><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">  </span><span class="p">{</span><span class="na">...register</span><span class="err">(&#39;</span><span class="na">name</span><span class="err">&#39;,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="na">required</span><span class="err">:</span><span class="w"> </span><span class="err">&#39;</span><span class="na">Name</span><span class="w"> </span><span class="na">is</span><span class="w"> </span><span class="na">required</span><span class="err">&#39;,</span>
<span class="w">    </span><span class="na">minLength</span><span class="err">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="na">value</span><span class="err">:</span><span class="w"> </span><span class="na">2</span><span class="err">,</span><span class="w"> </span><span class="na">message</span><span class="err">:</span><span class="w"> </span><span class="err">&#39;</span><span class="na">Name</span><span class="w"> </span><span class="na">must</span><span class="w"> </span><span class="na">be</span><span class="w"> </span><span class="na">at</span><span class="w"> </span><span class="na">least</span><span class="w"> </span><span class="na">2</span><span class="w"> </span><span class="na">characters</span><span class="err">&#39;</span><span class="w"> </span><span class="p">}</span><span class="err">,</span>
<span class="w">  </span><span class="p">}</span><span class="err">)</span><span class="p">}</span>
<span class="p">/&gt;</span>
</code></pre></div>

<p>The <code>register</code> function returns props that connect the input to React Hook Form:
- <code>name</code>: Field identifier
- <code>onChange</code>: Tracks value changes
- <code>onBlur</code>: Triggers validation
- <code>ref</code>: Accesses the DOM element</p>
<p>The spread operator <code>{...register('name')}</code> applies all these props at once.</p>
<h4 id="3-validation-rules">3. Validation Rules</h4>
<p>React Hook Form supports built-in validation rules:
- <code>required</code>: Field must have a value
- <code>minLength</code> / <code>maxLength</code>: String length constraints
- <code>min</code> / <code>max</code>: Number constraints
- <code>pattern</code>: Regex validation
- <code>validate</code>: Custom validation function</p>
<h4 id="4-submit-handling">4. Submit Handling</h4>
<div class="codehilite"><pre><span></span><code><span class="p">&lt;</span><span class="nt">form</span><span class="w"> </span><span class="na">onSubmit</span><span class="o">=</span><span class="p">{</span><span class="nx">handleSubmit</span><span class="p">(</span><span class="nx">onSubmit</span><span class="p">)}&gt;</span>
</code></pre></div>

<p><code>handleSubmit</code> wraps your submit function and:
- Prevents default form submission
- Validates all fields
- Only calls <code>onSubmit</code> if validation passes
- Passes validated data to your function</p>
<h3 id="verification-testing-the-form">Verification: Testing the Form</h3>
<p>Let's verify the behavior:</p>
<p><strong>Test 1: Submit with empty fields</strong>
- Click submit without filling anything
- Result: "Name is required" and "Email is required" errors appear
- Form does not submit</p>
<p><strong>Test 2: Fix one field</strong>
- Type "John" in name field
- Blur the field (click elsewhere)
- Result: Name error disappears
- Email error still shows</p>
<p><strong>Test 3: Invalid email</strong>
- Type "notanemail" in email field
- Blur the field
- Result: "Invalid email format" error appears</p>
<p><strong>Test 4: Fix email</strong>
- Change email to "john@example.com"
- Result: Error disappears immediately (validates on change after first blur)</p>
<p><strong>Test 5: Valid submission</strong>
- Fill all required fields correctly
- Click submit
- Result: Form submits, API call is made, success message appears</p>
<h3 id="performance-why-react-hook-form-is-fast">Performance: Why React Hook Form Is Fast</h3>
<p>React Hook Form uses <strong>uncontrolled components</strong> by default. This means:</p>
<p><strong>Traditional controlled components</strong> (our manual approach):</p>
<div class="codehilite"><pre><span></span><code><span class="p">&lt;</span><span class="nt">input</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">name</span><span class="p">}</span><span class="w"> </span><span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setName</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span><span class="w"> </span><span class="p">/&gt;</span>
</code></pre></div>

<ul>
<li>Every keystroke triggers a state update</li>
<li>State update causes component re-render</li>
<li>Entire form re-renders on every keystroke</li>
</ul>
<p><strong>React Hook Form's uncontrolled approach</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="p">&lt;</span><span class="nt">input</span><span class="w"> </span><span class="p">{</span><span class="na">...register</span><span class="err">(&#39;</span><span class="na">name</span><span class="err">&#39;)</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
</code></pre></div>

<ul>
<li>Field value stored in DOM, not React state</li>
<li>No re-render on keystroke</li>
<li>Only re-renders when validation state changes</li>
</ul>
<p><strong>React DevTools Evidence</strong>:</p>
<p>Open React DevTools Profiler and type in both forms:</p>
<p><strong>Manual form</strong>:
- Each keystroke: Component renders
- 10 keystrokes = 10 renders</p>
<p><strong>React Hook Form</strong>:
- Typing: No renders
- Blur (validation): 1 render
- 10 keystrokes = 1 render (on blur)</p>
<p>This matters for large forms with many fields.</p>
<h3 id="limitation-preview">Limitation Preview</h3>
<p>This form validates on blur and re-validates on change. But what if we need:
- Async validation (check if email is already taken)
- Cross-field validation (password confirmation)
- Complex validation logic (business rules)
- Runtime type validation (ensure data matches expected shape)</p>
<p>React Hook Form's built-in validators are limited to simple rules. For complex validation, we need a validation schema library.</p>
<p>That's where Zod comes in.</p>
<h2 id="zod-runtime-validation-that-doesnt-suck">Zod: runtime validation that doesn't suck</h2>
<h2 id="the-problem-validation-logic-gets-complex">The Problem: Validation Logic Gets Complex</h2>
<p>Our current validation is simple: required fields, string lengths, regex patterns. But real-world forms need more:</p>
<p><strong>Scenario 1: Password Confirmation</strong>
- Password must match confirmation
- Can't express this with <code>pattern</code> or <code>minLength</code></p>
<p><strong>Scenario 2: Conditional Validation</strong>
- If "Other" is selected, text field becomes required
- Validation rules depend on other field values</p>
<p><strong>Scenario 3: Type Safety</strong>
- Form data should match TypeScript types
- Runtime data might not match (API responses, user input)
- Need to validate at runtime AND compile time</p>
<p><strong>Scenario 4: Reusable Validation</strong>
- Same validation rules used in multiple forms
- Same rules used on server and client
- Don't want to duplicate logic</p>
<p>Let's see these problems in action.</p>
<h3 id="the-fourth-failure-password-confirmation">The Fourth Failure: Password Confirmation</h3>
<p>Let's add password change to our form:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/UserSettingsForm.tsx - Adding password fields</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useForm</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react-hook-form&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">UserSettings</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">bio</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">emailNotifications</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">pushNotifications</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">password?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">confirmPassword?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">UserSettingsForm</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">register</span><span class="p">,</span>
<span class="w">    </span><span class="nx">handleSubmit</span><span class="p">,</span>
<span class="w">    </span><span class="nx">formState</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">errors</span><span class="p">,</span><span class="w"> </span><span class="nx">isSubmitting</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useForm</span><span class="p">&lt;</span><span class="nt">UserSettings</span><span class="p">&gt;({</span>
<span class="w">    </span><span class="nx">defaultValues</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">bio</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">emailNotifications</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
<span class="w">      </span><span class="nx">pushNotifications</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
<span class="w">      </span><span class="nx">password</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">confirmPassword</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">onSubmit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">UserSettings</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// How do we validate password confirmation here?</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">password</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">confirmPassword</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Passwords do not match&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/api/user/settings&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;PUT&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">(</span><span class="nx">data</span><span class="p">),</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">errorData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="nx">errorData</span><span class="p">.</span><span class="nx">error</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;Failed to update settings&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Settings updated successfully!&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">alert</span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Failed to update settings&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">form</span><span class="w"> </span><span class="na">onSubmit</span><span class="o">=</span><span class="p">{</span><span class="nx">handleSubmit</span><span class="p">(</span><span class="nx">onSubmit</span><span class="p">)}</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;space-y-4&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="cm">/* Previous fields... */</span><span class="p">}</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">htmlFor</span><span class="o">=</span><span class="s">&quot;password&quot;</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;block text-sm font-medium&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">New</span><span class="w"> </span><span class="nx">Password</span><span class="w"> </span><span class="p">(</span><span class="nx">optional</span><span class="p">)</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;password&quot;</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;password&quot;</span>
<span class="w">          </span><span class="p">{</span><span class="na">...register</span><span class="err">(&#39;</span><span class="na">password</span><span class="err">&#39;,</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="na">minLength</span><span class="err">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="na">value</span><span class="err">:</span><span class="w"> </span><span class="na">8</span><span class="err">,</span>
<span class="w">              </span><span class="na">message</span><span class="err">:</span><span class="w"> </span><span class="err">&#39;</span><span class="na">Password</span><span class="w"> </span><span class="na">must</span><span class="w"> </span><span class="na">be</span><span class="w"> </span><span class="na">at</span><span class="w"> </span><span class="na">least</span><span class="w"> </span><span class="na">8</span><span class="w"> </span><span class="na">characters</span><span class="err">&#39;,</span>
<span class="w">            </span><span class="p">}</span><span class="err">,</span>
<span class="w">          </span><span class="p">}</span><span class="err">)</span><span class="p">}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 block w-full rounded border p-2&quot;</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">password</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 text-sm text-red-600&quot;</span><span class="p">&gt;{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">password</span><span class="p">.</span><span class="nx">message</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">htmlFor</span><span class="o">=</span><span class="s">&quot;confirmPassword&quot;</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;block text-sm font-medium&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Confirm</span><span class="w"> </span><span class="nx">Password</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;confirmPassword&quot;</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;password&quot;</span>
<span class="w">          </span><span class="p">{</span><span class="na">...register</span><span class="err">(&#39;</span><span class="na">confirmPassword</span><span class="err">&#39;)</span><span class="p">}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 block w-full rounded border p-2&quot;</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="cm">/* How do we show &quot;passwords don&#39;t match&quot; error here? */</span><span class="p">}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">        </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span>
<span class="w">        </span><span class="na">disabled</span><span class="o">=</span><span class="p">{</span><span class="nx">isSubmitting</span><span class="p">}</span>
<span class="w">        </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;rounded bg-blue-600 px-4 py-2 text-white disabled:opacity-50&quot;</span>
<span class="w">      </span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">isSubmitting</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;Saving...&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Save Settings&#39;</span><span class="p">}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="diagnostic-analysis-reading-the-failure_2">Diagnostic Analysis: Reading the Failure</h3>
<p><strong>Browser Behavior</strong>:
- Enter password: "password123"
- Enter confirmation: "password456"
- Click submit
- Alert shows: "Passwords do not match"
- But no error appears under the confirmation field
- User doesn't know which field is wrong</p>
<p><strong>React DevTools Evidence</strong>:
- <code>formState.errors</code> is empty
- Validation happens in <code>onSubmit</code>, not in React Hook Form
- No way to show field-specific error for cross-field validation</p>
<p><strong>Let's parse this evidence</strong>:</p>
<ol>
<li><strong>What the user experiences</strong>:</li>
<li>Expected: Error message under confirmation field</li>
<li>
<p>Actual: Generic alert, no field highlighting</p>
</li>
<li>
<p><strong>What DevTools shows</strong>:</p>
</li>
<li>React Hook Form doesn't know about the validation failure</li>
<li>Error is handled manually in submit function</li>
<li>
<p>Can't use React Hook Form's error display</p>
</li>
<li>
<p><strong>Root cause identified</strong>: React Hook Form's built-in validators can't compare two fields.</p>
</li>
<li>
<p><strong>Why the current approach can't solve this</strong>: We could use <code>validate</code> function:</p>
</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="p">{...</span><span class="nx">register</span><span class="p">(</span><span class="s1">&#39;confirmPassword&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">validate</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">value</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// But how do we access the password field value here?</span>
<span class="w">    </span><span class="c1">// We&#39;d need to use watch() or getValues()</span>
<span class="w">    </span><span class="c1">// This gets messy fast</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">})}</span>
</code></pre></div>

<ol>
<li><strong>What we need</strong>: A validation schema that can:</li>
<li>Define complex validation rules</li>
<li>Access multiple field values</li>
<li>Provide clear error messages</li>
<li>Work with TypeScript types</li>
</ol>
<h3 id="the-solution-zod">The Solution: Zod</h3>
<p>Zod is a TypeScript-first schema validation library. It lets you:
- Define validation rules as a schema
- Validate data at runtime
- Infer TypeScript types from schemas
- Compose and reuse validation logic</p>
<h3 id="installation_1">Installation</h3>
<div class="codehilite"><pre><span></span><code>npm<span class="w"> </span>install<span class="w"> </span>zod<span class="w"> </span>@hookform/resolvers
</code></pre></div>

<p><code>@hookform/resolvers</code> provides integration between React Hook Form and validation libraries like Zod.</p>
<h3 id="iteration-4-zod-schema-validation">Iteration 4: Zod Schema Validation</h3>
<p>Let's rebuild our form with Zod:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/UserSettingsForm.tsx</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useForm</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react-hook-form&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">zodResolver</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@hookform/resolvers/zod&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">z</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;zod&#39;</span><span class="p">;</span>

<span class="c1">// Define validation schema</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">userSettingsSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">z</span>
<span class="w">    </span><span class="p">.</span><span class="kt">string</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Name is required&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Name must be at least 2 characters&#39;</span><span class="p">),</span>
<span class="w">  </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="kt">z</span>
<span class="w">    </span><span class="p">.</span><span class="kt">string</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Email is required&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="nx">email</span><span class="p">(</span><span class="s1">&#39;Invalid email format&#39;</span><span class="p">),</span>
<span class="w">  </span><span class="nx">bio</span><span class="o">:</span><span class="w"> </span><span class="kt">z</span>
<span class="w">    </span><span class="p">.</span><span class="kt">string</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mf">500</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Bio must be less than 500 characters&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="nx">optional</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">emailNotifications</span><span class="o">:</span><span class="w"> </span><span class="kt">z.boolean</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">pushNotifications</span><span class="o">:</span><span class="w"> </span><span class="kt">z.boolean</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">password</span><span class="o">:</span><span class="w"> </span><span class="kt">z</span>
<span class="w">    </span><span class="p">.</span><span class="kt">string</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="mf">8</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Password must be at least 8 characters&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="nx">optional</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="nx">or</span><span class="p">(</span><span class="nx">z</span><span class="p">.</span><span class="nx">literal</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)),</span>
<span class="w">  </span><span class="nx">confirmPassword</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">().</span><span class="nx">optional</span><span class="p">().</span><span class="nx">or</span><span class="p">(</span><span class="nx">z</span><span class="p">.</span><span class="nx">literal</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)),</span>
<span class="p">}).</span><span class="nx">refine</span><span class="p">(</span>
<span class="w">  </span><span class="p">(</span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Cross-field validation: passwords must match</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">password</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">password</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">confirmPassword</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Passwords do not match&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">path</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;confirmPassword&#39;</span><span class="p">],</span><span class="w"> </span><span class="c1">// Show error on confirmPassword field</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">);</span>

<span class="c1">// Infer TypeScript type from schema</span>
<span class="kr">type</span><span class="w"> </span><span class="nx">UserSettings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">infer</span><span class="p">&lt;</span><span class="nt">typeof</span><span class="w"> </span><span class="na">userSettingsSchema</span><span class="p">&gt;;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">UserSettingsForm</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">register</span><span class="p">,</span>
<span class="w">    </span><span class="nx">handleSubmit</span><span class="p">,</span>
<span class="w">    </span><span class="nx">formState</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">errors</span><span class="p">,</span><span class="w"> </span><span class="nx">isSubmitting</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useForm</span><span class="p">&lt;</span><span class="nt">UserSettings</span><span class="p">&gt;({</span>
<span class="w">    </span><span class="nx">resolver</span><span class="o">:</span><span class="w"> </span><span class="kt">zodResolver</span><span class="p">(</span><span class="nx">userSettingsSchema</span><span class="p">),</span>
<span class="w">    </span><span class="nx">defaultValues</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">bio</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">emailNotifications</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
<span class="w">      </span><span class="nx">pushNotifications</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
<span class="w">      </span><span class="nx">password</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">confirmPassword</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">onSubmit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">UserSettings</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Data is already validated by Zod</span>
<span class="w">    </span><span class="c1">// TypeScript knows the exact shape</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/api/user/settings&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;PUT&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">(</span><span class="nx">data</span><span class="p">),</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">errorData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="nx">errorData</span><span class="p">.</span><span class="nx">error</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;Failed to update settings&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Settings updated successfully!&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">alert</span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Failed to update settings&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">form</span><span class="w"> </span><span class="na">onSubmit</span><span class="o">=</span><span class="p">{</span><span class="nx">handleSubmit</span><span class="p">(</span><span class="nx">onSubmit</span><span class="p">)}</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;space-y-4&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">htmlFor</span><span class="o">=</span><span class="s">&quot;name&quot;</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;block text-sm font-medium&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Name</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;name&quot;</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">          </span><span class="p">{</span><span class="na">...register</span><span class="err">(&#39;</span><span class="na">name</span><span class="err">&#39;)</span><span class="p">}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 block w-full rounded border p-2&quot;</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 text-sm text-red-600&quot;</span><span class="p">&gt;{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">message</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">htmlFor</span><span class="o">=</span><span class="s">&quot;email&quot;</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;block text-sm font-medium&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Email</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;email&quot;</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;email&quot;</span>
<span class="w">          </span><span class="p">{</span><span class="na">...register</span><span class="err">(&#39;</span><span class="na">email</span><span class="err">&#39;)</span><span class="p">}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 block w-full rounded border p-2&quot;</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">email</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 text-sm text-red-600&quot;</span><span class="p">&gt;{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">email</span><span class="p">.</span><span class="nx">message</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">htmlFor</span><span class="o">=</span><span class="s">&quot;bio&quot;</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;block text-sm font-medium&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Bio</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">textarea</span>
<span class="w">          </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;bio&quot;</span>
<span class="w">          </span><span class="p">{</span><span class="na">...register</span><span class="err">(&#39;</span><span class="na">bio</span><span class="err">&#39;)</span><span class="p">}</span>
<span class="w">          </span><span class="na">rows</span><span class="o">=</span><span class="p">{</span><span class="mf">4</span><span class="p">}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 block w-full rounded border p-2&quot;</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">bio</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 text-sm text-red-600&quot;</span><span class="p">&gt;{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">bio</span><span class="p">.</span><span class="nx">message</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">htmlFor</span><span class="o">=</span><span class="s">&quot;password&quot;</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;block text-sm font-medium&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">New</span><span class="w"> </span><span class="nx">Password</span><span class="w"> </span><span class="p">(</span><span class="nx">optional</span><span class="p">)</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;password&quot;</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;password&quot;</span>
<span class="w">          </span><span class="p">{</span><span class="na">...register</span><span class="err">(&#39;</span><span class="na">password</span><span class="err">&#39;)</span><span class="p">}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 block w-full rounded border p-2&quot;</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">password</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 text-sm text-red-600&quot;</span><span class="p">&gt;{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">password</span><span class="p">.</span><span class="nx">message</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">htmlFor</span><span class="o">=</span><span class="s">&quot;confirmPassword&quot;</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;block text-sm font-medium&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Confirm</span><span class="w"> </span><span class="nx">Password</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;confirmPassword&quot;</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;password&quot;</span>
<span class="w">          </span><span class="p">{</span><span class="na">...register</span><span class="err">(&#39;</span><span class="na">confirmPassword</span><span class="err">&#39;)</span><span class="p">}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 block w-full rounded border p-2&quot;</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">confirmPassword</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 text-sm text-red-600&quot;</span><span class="p">&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">confirmPassword</span><span class="p">.</span><span class="nx">message</span><span class="p">}</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;space-y-2&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex items-center&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">            </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;checkbox&quot;</span>
<span class="w">            </span><span class="p">{</span><span class="na">...register</span><span class="err">(&#39;</span><span class="na">emailNotifications</span><span class="err">&#39;)</span><span class="p">}</span>
<span class="w">            </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mr-2&quot;</span>
<span class="w">          </span><span class="p">/&gt;</span>
<span class="w">          </span><span class="nx">Email</span><span class="w"> </span><span class="nx">notifications</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex items-center&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">            </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;checkbox&quot;</span>
<span class="w">            </span><span class="p">{</span><span class="na">...register</span><span class="err">(&#39;</span><span class="na">pushNotifications</span><span class="err">&#39;)</span><span class="p">}</span>
<span class="w">            </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mr-2&quot;</span>
<span class="w">          </span><span class="p">/&gt;</span>
<span class="w">          </span><span class="nx">Push</span><span class="w"> </span><span class="nx">notifications</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">        </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span>
<span class="w">        </span><span class="na">disabled</span><span class="o">=</span><span class="p">{</span><span class="nx">isSubmitting</span><span class="p">}</span>
<span class="w">        </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;rounded bg-blue-600 px-4 py-2 text-white disabled:opacity-50&quot;</span>
<span class="w">      </span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">isSubmitting</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;Saving...&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Save Settings&#39;</span><span class="p">}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>What changed?</strong></p>
<ol>
<li><strong>Validation moved to schema</strong>:</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">userSettingsSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Name is required&#39;</span><span class="p">).</span><span class="nx">min</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Name must be at least 2 characters&#39;</span><span class="p">),</span>
<span class="w">  </span><span class="c1">// ...</span>
<span class="p">});</span>
</code></pre></div>

<ol>
<li><strong>Cross-field validation with <code>.refine()</code></strong>:</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="p">.</span><span class="nx">refine</span><span class="p">(</span>
<span class="w">  </span><span class="p">(</span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">password</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">password</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">confirmPassword</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Passwords do not match&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">path</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;confirmPassword&#39;</span><span class="p">],</span><span class="w"> </span><span class="c1">// Error shows on this field</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">)</span>
</code></pre></div>

<ol>
<li><strong>Type inference</strong>:</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="kr">type</span><span class="w"> </span><span class="nx">UserSettings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">infer</span><span class="p">&lt;</span><span class="nt">typeof</span><span class="w"> </span><span class="na">userSettingsSchema</span><span class="p">&gt;;</span>
</code></pre></div>

<p>TypeScript type is derived from the schema. Change the schema, type updates automatically.</p>
<ol>
<li><strong>Resolver integration</strong>:</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">register</span><span class="p">,</span><span class="w"> </span><span class="nx">handleSubmit</span><span class="p">,</span><span class="w"> </span><span class="nx">formState</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useForm</span><span class="p">&lt;</span><span class="nt">UserSettings</span><span class="p">&gt;({</span>
<span class="w">  </span><span class="nx">resolver</span><span class="o">:</span><span class="w"> </span><span class="kt">zodResolver</span><span class="p">(</span><span class="nx">userSettingsSchema</span><span class="p">),</span>
<span class="w">  </span><span class="c1">// ...</span>
<span class="p">});</span>
</code></pre></div>

<ol>
<li><strong>Simplified field registration</strong>:</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="p">&lt;</span><span class="nt">input</span><span class="w"> </span><span class="p">{</span><span class="na">...register</span><span class="err">(&#39;</span><span class="na">name</span><span class="err">&#39;)</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
</code></pre></div>

<p>No validation rules in <code>register()</code>. All validation is in the schema.</p>
<h3 id="verification-testing-password-confirmation">Verification: Testing Password Confirmation</h3>
<p><strong>Test 1: Mismatched passwords</strong>
- Password: "password123"
- Confirm: "password456"
- Blur confirm field
- Result: "Passwords do not match" appears under confirm field</p>
<p><strong>Test 2: Fix confirmation</strong>
- Change confirm to "password123"
- Result: Error disappears immediately</p>
<p><strong>Test 3: Empty password</strong>
- Leave both password fields empty
- Submit form
- Result: No password errors (both are optional)</p>
<p><strong>Test 4: Short password</strong>
- Password: "pass"
- Blur field
- Result: "Password must be at least 8 characters"</p>
<h3 id="zod-schema-patterns">Zod Schema Patterns</h3>
<p>Let's explore common Zod patterns you'll use:</p>
<h4 id="basic-types">Basic Types</h4>
<div class="codehilite"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">z</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;zod&#39;</span><span class="p">;</span>

<span class="c1">// String validation</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">nameSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">()</span>
<span class="w">  </span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Required&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Too long&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="nx">trim</span><span class="p">();</span><span class="w"> </span><span class="c1">// Remove whitespace</span>

<span class="c1">// Number validation</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">ageSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">number</span><span class="p">()</span>
<span class="w">  </span><span class="p">.</span><span class="kr">int</span><span class="p">(</span><span class="s1">&#39;Must be an integer&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="mf">18</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Must be 18 or older&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mf">120</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Invalid age&#39;</span><span class="p">);</span>

<span class="c1">// Email validation</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">emailSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">().</span><span class="nx">email</span><span class="p">(</span><span class="s1">&#39;Invalid email&#39;</span><span class="p">);</span>

<span class="c1">// URL validation</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">websiteSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">().</span><span class="nx">url</span><span class="p">(</span><span class="s1">&#39;Invalid URL&#39;</span><span class="p">);</span>

<span class="c1">// Boolean</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">agreeSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">boolean</span><span class="p">();</span>

<span class="c1">// Optional fields</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">bioSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">().</span><span class="nx">optional</span><span class="p">();</span>

<span class="c1">// Nullable fields</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">middleNameSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">().</span><span class="nx">nullable</span><span class="p">();</span>

<span class="c1">// Optional OR empty string (common for form inputs)</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">optionalStringSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">().</span><span class="nx">optional</span><span class="p">().</span><span class="nx">or</span><span class="p">(</span><span class="nx">z</span><span class="p">.</span><span class="nx">literal</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">));</span>
</code></pre></div>

<h4 id="arrays-and-objects">Arrays and Objects</h4>
<div class="codehilite"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">z</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;zod&#39;</span><span class="p">;</span>

<span class="c1">// Array of strings</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">tagsSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">array</span><span class="p">(</span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">()).</span><span class="nx">min</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;At least one tag required&#39;</span><span class="p">);</span>

<span class="c1">// Array of objects</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">addressesSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">array</span><span class="p">(</span>
<span class="w">  </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<span class="w">    </span><span class="nx">street</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">(),</span>
<span class="w">    </span><span class="nx">city</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">(),</span>
<span class="w">    </span><span class="nx">zipCode</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">().</span><span class="nx">regex</span><span class="p">(</span><span class="sr">/^\d{5}$/</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Invalid ZIP code&#39;</span><span class="p">),</span>
<span class="w">  </span><span class="p">})</span>
<span class="p">);</span>

<span class="c1">// Nested objects</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">userSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">profile</span><span class="o">:</span><span class="w"> </span><span class="kt">z.object</span><span class="p">({</span>
<span class="w">    </span><span class="nx">bio</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">(),</span>
<span class="w">    </span><span class="nx">avatar</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">().</span><span class="nx">url</span><span class="p">(),</span>
<span class="w">  </span><span class="p">}),</span>
<span class="p">});</span>
</code></pre></div>

<h4 id="enums-and-literals">Enums and Literals</h4>
<div class="codehilite"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">z</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;zod&#39;</span><span class="p">;</span>

<span class="c1">// Enum (one of several values)</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">roleSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kd">enum</span><span class="p">([</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;user&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;guest&#39;</span><span class="p">]);</span>

<span class="c1">// Literal (exact value)</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">acceptTermsSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">literal</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>

<span class="c1">// Union (one of several types)</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">idSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">union</span><span class="p">([</span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">(),</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">number</span><span class="p">()]);</span>

<span class="c1">// Discriminated union (tagged union)</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">notificationSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">discriminatedUnion</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<span class="w">    </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">literal</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">),</span>
<span class="w">    </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">().</span><span class="nx">email</span><span class="p">(),</span>
<span class="w">  </span><span class="p">}),</span>
<span class="w">  </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<span class="w">    </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">literal</span><span class="p">(</span><span class="s1">&#39;sms&#39;</span><span class="p">),</span>
<span class="w">    </span><span class="nx">phone</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">(),</span>
<span class="w">  </span><span class="p">}),</span>
<span class="p">]);</span>
</code></pre></div>

<h4 id="custom-validation">Custom Validation</h4>
<div class="codehilite"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">z</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;zod&#39;</span><span class="p">;</span>

<span class="c1">// Custom validation with .refine()</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">passwordSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">()</span>
<span class="w">  </span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="mf">8</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Password must be at least 8 characters&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="nx">refine</span><span class="p">(</span>
<span class="w">    </span><span class="p">(</span><span class="nx">password</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="o">/</span><span class="p">[</span><span class="nx">A</span><span class="o">-</span><span class="nx">Z</span><span class="p">]</span><span class="o">/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">password</span><span class="p">),</span>
<span class="w">    </span><span class="s1">&#39;Password must contain at least one uppercase letter&#39;</span>
<span class="w">  </span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="nx">refine</span><span class="p">(</span>
<span class="w">    </span><span class="p">(</span><span class="nx">password</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="o">/</span><span class="p">[</span><span class="nx">a</span><span class="o">-</span><span class="nx">z</span><span class="p">]</span><span class="o">/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">password</span><span class="p">),</span>
<span class="w">    </span><span class="s1">&#39;Password must contain at least one lowercase letter&#39;</span>
<span class="w">  </span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="nx">refine</span><span class="p">(</span>
<span class="w">    </span><span class="p">(</span><span class="nx">password</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="o">/</span><span class="p">[</span><span class="mf">0</span><span class="o">-</span><span class="mf">9</span><span class="p">]</span><span class="o">/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">password</span><span class="p">),</span>
<span class="w">    </span><span class="s1">&#39;Password must contain at least one number&#39;</span>
<span class="w">  </span><span class="p">);</span>

<span class="c1">// Transform data</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">trimmedStringSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">().</span><span class="nx">transform</span><span class="p">((</span><span class="nx">val</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">val</span><span class="p">.</span><span class="nx">trim</span><span class="p">());</span>

<span class="c1">// Preprocess data</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">dateSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">preprocess</span><span class="p">(</span>
<span class="w">  </span><span class="p">(</span><span class="nx">val</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">val</span><span class="p">),</span>
<span class="w">  </span><span class="nx">z</span><span class="p">.</span><span class="nx">date</span><span class="p">()</span>
<span class="p">);</span>
</code></pre></div>

<h4 id="reusable-schemas">Reusable Schemas</h4>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/lib/validation.ts</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">z</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;zod&#39;</span><span class="p">;</span>

<span class="c1">// Base schemas</span>
<span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">emailSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">().</span><span class="nx">email</span><span class="p">(</span><span class="s1">&#39;Invalid email format&#39;</span><span class="p">);</span>
<span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">passwordSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mf">8</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Password must be at least 8 characters&#39;</span><span class="p">);</span>

<span class="c1">// Composed schemas</span>
<span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">loginSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<span class="w">  </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="kt">emailSchema</span><span class="p">,</span>
<span class="w">  </span><span class="nx">password</span><span class="o">:</span><span class="w"> </span><span class="kt">passwordSchema</span><span class="p">,</span>
<span class="p">});</span>

<span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">registerSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<span class="w">  </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="kt">emailSchema</span><span class="p">,</span>
<span class="w">  </span><span class="nx">password</span><span class="o">:</span><span class="w"> </span><span class="kt">passwordSchema</span><span class="p">,</span>
<span class="w">  </span><span class="nx">confirmPassword</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">(),</span>
<span class="p">}).</span><span class="nx">refine</span><span class="p">(</span>
<span class="w">  </span><span class="p">(</span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">password</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">confirmPassword</span><span class="p">,</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Passwords do not match&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">path</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;confirmPassword&#39;</span><span class="p">],</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">);</span>

<span class="c1">// Extend schemas</span>
<span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">userProfileSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">loginSchema</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Name must be at least 2 characters&#39;</span><span class="p">),</span>
<span class="w">  </span><span class="nx">bio</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">().</span><span class="nx">max</span><span class="p">(</span><span class="mf">500</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Bio must be less than 500 characters&#39;</span><span class="p">).</span><span class="nx">optional</span><span class="p">(),</span>
<span class="p">});</span>
</code></pre></div>

<h3 id="when-to-apply-zod-vs-built-in-validation">When to Apply: Zod vs. Built-in Validation</h3>
<p><strong>Use Zod when</strong>:
- Cross-field validation (password confirmation, date ranges)
- Complex business rules (age restrictions, conditional requirements)
- Reusable validation across multiple forms
- Server-side validation needs to match client-side
- Runtime type validation (API responses, user uploads)</p>
<p><strong>Use built-in React Hook Form validation when</strong>:
- Simple field-level rules (required, min/max length)
- Prototyping or small forms
- No need for type inference
- Performance is critical (Zod adds ~10KB to bundle)</p>
<p><strong>Decision Framework</strong>:</p>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Built-in</th>
<th>Zod</th>
</tr>
</thead>
<tbody>
<tr>
<td>Required field</td>
<td>‚úÖ</td>
<td>‚úÖ</td>
</tr>
<tr>
<td>Min/max length</td>
<td>‚úÖ</td>
<td>‚úÖ</td>
</tr>
<tr>
<td>Regex pattern</td>
<td>‚úÖ</td>
<td>‚úÖ</td>
</tr>
<tr>
<td>Cross-field validation</td>
<td>‚ùå</td>
<td>‚úÖ</td>
</tr>
<tr>
<td>Conditional validation</td>
<td>‚ö†Ô∏è Complex</td>
<td>‚úÖ</td>
</tr>
<tr>
<td>Type inference</td>
<td>‚ùå</td>
<td>‚úÖ</td>
</tr>
<tr>
<td>Reusable schemas</td>
<td>‚ùå</td>
<td>‚úÖ</td>
</tr>
<tr>
<td>Server/client sharing</td>
<td>‚ùå</td>
<td>‚úÖ</td>
</tr>
<tr>
<td>Bundle size</td>
<td>0KB</td>
<td>~10KB</td>
</tr>
</tbody>
</table>
<h3 id="limitation-preview_1">Limitation Preview</h3>
<p>We now have a robust form with validation. But we're still missing:
- Loading initial data (edit existing settings)
- Optimistic updates (show changes immediately)
- Error recovery (what if the API call fails?)
- Accessibility (keyboard navigation, screen readers)
- User experience polish (disable submit while invalid, show character counts)</p>
<p>Let's build a production-ready form that handles all of these.</p>
<h2 id="building-a-production-ready-form-in-20-minutes">Building a production-ready form in 20 minutes</h2>
<h2 id="the-complete-picture-production-ready-form">The Complete Picture: Production-Ready Form</h2>
<p>Let's take everything we've learned and build a form that's ready for real users. We'll add:</p>
<ol>
<li><strong>Loading initial data</strong> - Edit existing settings</li>
<li><strong>Optimistic updates</strong> - Show changes immediately</li>
<li><strong>Error handling</strong> - Graceful failure recovery</li>
<li><strong>Accessibility</strong> - Keyboard navigation, ARIA labels</li>
<li><strong>UX polish</strong> - Character counts, disabled states, success feedback</li>
</ol>
<h3 id="project-structure">Project Structure</h3>
<div class="codehilite"><pre><span></span><code>src/
‚îú‚îÄ‚îÄ<span class="w"> </span>components/
‚îÇ<span class="w">   </span>‚îî‚îÄ‚îÄ<span class="w"> </span>UserSettingsForm.tsx<span class="w">      </span>‚Üê<span class="w"> </span>Our<span class="w"> </span>production<span class="w"> </span>form
‚îú‚îÄ‚îÄ<span class="w"> </span>lib/
‚îÇ<span class="w">   </span>‚îú‚îÄ‚îÄ<span class="w"> </span>validation.ts<span class="w">              </span>‚Üê<span class="w"> </span>Reusable<span class="w"> </span>Zod<span class="w"> </span>schemas
‚îÇ<span class="w">   </span>‚îî‚îÄ‚îÄ<span class="w"> </span>api.ts<span class="w">                     </span>‚Üê<span class="w"> </span>API<span class="w"> </span>client<span class="w"> </span>functions
‚îî‚îÄ‚îÄ<span class="w"> </span>hooks/
<span class="w">    </span>‚îî‚îÄ‚îÄ<span class="w"> </span>useUserSettings.ts<span class="w">         </span>‚Üê<span class="w"> </span>Data<span class="w"> </span>fetching<span class="w"> </span>hook
</code></pre></div>

<h3 id="step-1-reusable-validation-schema">Step 1: Reusable Validation Schema</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/lib/validation.ts</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">z</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;zod&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">userSettingsSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">z</span>
<span class="w">    </span><span class="p">.</span><span class="kt">string</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Name is required&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Name must be at least 2 characters&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Name must be less than 100 characters&#39;</span><span class="p">),</span>
<span class="w">  </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="kt">z</span>
<span class="w">    </span><span class="p">.</span><span class="kt">string</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Email is required&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="nx">email</span><span class="p">(</span><span class="s1">&#39;Invalid email format&#39;</span><span class="p">),</span>
<span class="w">  </span><span class="nx">bio</span><span class="o">:</span><span class="w"> </span><span class="kt">z</span>
<span class="w">    </span><span class="p">.</span><span class="kt">string</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mf">500</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Bio must be less than 500 characters&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="nx">optional</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="nx">or</span><span class="p">(</span><span class="nx">z</span><span class="p">.</span><span class="nx">literal</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)),</span>
<span class="w">  </span><span class="nx">emailNotifications</span><span class="o">:</span><span class="w"> </span><span class="kt">z.boolean</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">pushNotifications</span><span class="o">:</span><span class="w"> </span><span class="kt">z.boolean</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">password</span><span class="o">:</span><span class="w"> </span><span class="kt">z</span>
<span class="w">    </span><span class="p">.</span><span class="kt">string</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="mf">8</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Password must be at least 8 characters&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="nx">regex</span><span class="p">(</span><span class="sr">/[A-Z]/</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Password must contain at least one uppercase letter&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="nx">regex</span><span class="p">(</span><span class="sr">/[a-z]/</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Password must contain at least one lowercase letter&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="nx">regex</span><span class="p">(</span><span class="sr">/[0-9]/</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Password must contain at least one number&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="nx">optional</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="nx">or</span><span class="p">(</span><span class="nx">z</span><span class="p">.</span><span class="nx">literal</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)),</span>
<span class="w">  </span><span class="nx">confirmPassword</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">().</span><span class="nx">optional</span><span class="p">().</span><span class="nx">or</span><span class="p">(</span><span class="nx">z</span><span class="p">.</span><span class="nx">literal</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)),</span>
<span class="p">}).</span><span class="nx">refine</span><span class="p">(</span>
<span class="w">  </span><span class="p">(</span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">password</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">password</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">confirmPassword</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Passwords do not match&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">path</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;confirmPassword&#39;</span><span class="p">],</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">);</span>

<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">UserSettings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">infer</span><span class="o">&lt;</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">userSettingsSchema</span><span class="o">&gt;</span><span class="p">;</span>
</code></pre></div>

<h3 id="step-2-api-client-functions">Step 2: API Client Functions</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/lib/api.ts</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">UserSettings</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./validation&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">fetchUserSettings</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">UserSettings</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/api/user/settings&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;Failed to fetch user settings&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">updateUserSettings</span><span class="p">(</span>
<span class="w">  </span><span class="nx">settings</span><span class="o">:</span><span class="w"> </span><span class="kt">UserSettings</span>
<span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/api/user/settings&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;PUT&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">(</span><span class="nx">settings</span><span class="p">),</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">errorData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="nx">errorData</span><span class="p">.</span><span class="nx">error</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;Failed to update settings&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="step-3-data-fetching-hook">Step 3: Data Fetching Hook</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/hooks/useUserSettings.ts</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useEffect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">UserSettings</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/lib/validation&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">fetchUserSettings</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/lib/api&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">useUserSettings</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">settings</span><span class="p">,</span><span class="w"> </span><span class="nx">setSettings</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="o">&lt;</span><span class="nx">UserSettings</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="o">&gt;</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">isLoading</span><span class="p">,</span><span class="w"> </span><span class="nx">setIsLoading</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">error</span><span class="p">,</span><span class="w"> </span><span class="nx">setError</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="o">&lt;</span><span class="kt">string</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="o">&gt;</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>

<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">fetchUserSettings</span><span class="p">()</span>
<span class="w">      </span><span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">setSettings</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="w">        </span><span class="nx">setError</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
<span class="w">      </span><span class="p">})</span>
<span class="w">      </span><span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">err</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">setError</span><span class="p">(</span><span class="nx">err</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">err</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Failed to load settings&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="p">})</span>
<span class="w">      </span><span class="p">.</span><span class="k">finally</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">setIsLoading</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">settings</span><span class="p">,</span><span class="w"> </span><span class="nx">isLoading</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="w"> </span><span class="p">};</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="step-4-production-ready-form-component">Step 4: Production-Ready Form Component</h3>
<p>Now let's build the complete form with all the features:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/UserSettingsForm.tsx</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useEffect</span><span class="p">,</span><span class="w"> </span><span class="nx">useState</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useForm</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react-hook-form&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">zodResolver</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@hookform/resolvers/zod&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">userSettingsSchema</span><span class="p">,</span><span class="w"> </span><span class="nx">UserSettings</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/lib/validation&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">updateUserSettings</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/lib/api&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useUserSettings</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/hooks/useUserSettings&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">UserSettingsForm</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">settings</span><span class="p">,</span><span class="w"> </span><span class="nx">isLoading</span><span class="o">:</span><span class="w"> </span><span class="kt">isLoadingSettings</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="kt">loadError</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useUserSettings</span><span class="p">();</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">submitError</span><span class="p">,</span><span class="w"> </span><span class="nx">setSubmitError</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">string</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="na">null</span><span class="p">&gt;(</span><span class="kc">null</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">submitSuccess</span><span class="p">,</span><span class="w"> </span><span class="nx">setSubmitSuccess</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">register</span><span class="p">,</span>
<span class="w">    </span><span class="nx">handleSubmit</span><span class="p">,</span>
<span class="w">    </span><span class="nx">reset</span><span class="p">,</span>
<span class="w">    </span><span class="nx">watch</span><span class="p">,</span>
<span class="w">    </span><span class="nx">formState</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">errors</span><span class="p">,</span><span class="w"> </span><span class="nx">isSubmitting</span><span class="p">,</span><span class="w"> </span><span class="nx">isDirty</span><span class="p">,</span><span class="w"> </span><span class="nx">isValid</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useForm</span><span class="p">&lt;</span><span class="nt">UserSettings</span><span class="p">&gt;({</span>
<span class="w">    </span><span class="nx">resolver</span><span class="o">:</span><span class="w"> </span><span class="kt">zodResolver</span><span class="p">(</span><span class="nx">userSettingsSchema</span><span class="p">),</span>
<span class="w">    </span><span class="nx">defaultValues</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">bio</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">emailNotifications</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
<span class="w">      </span><span class="nx">pushNotifications</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
<span class="w">      </span><span class="nx">password</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">confirmPassword</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nx">mode</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;onBlur&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Validate on blur, re-validate on change</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="c1">// Load initial data when settings are fetched</span>
<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">settings</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">reset</span><span class="p">(</span><span class="nx">settings</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">settings</span><span class="p">,</span><span class="w"> </span><span class="nx">reset</span><span class="p">]);</span>

<span class="w">  </span><span class="c1">// Watch bio field for character count</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">bio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">watch</span><span class="p">(</span><span class="s1">&#39;bio&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">bioLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">bio</span><span class="o">?</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">onSubmit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">UserSettings</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setSubmitError</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
<span class="w">    </span><span class="nx">setSubmitSuccess</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>

<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="nx">updateUserSettings</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="w">      </span><span class="nx">setSubmitSuccess</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// Clear success message after 3 seconds</span>
<span class="w">      </span><span class="nx">setTimeout</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSubmitSuccess</span><span class="p">(</span><span class="kc">false</span><span class="p">),</span><span class="w"> </span><span class="mf">3000</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// Clear password fields after successful update</span>
<span class="w">      </span><span class="nx">reset</span><span class="p">({</span>
<span class="w">        </span><span class="p">...</span><span class="nx">data</span><span class="p">,</span>
<span class="w">        </span><span class="nx">password</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">confirmPassword</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">setSubmitError</span><span class="p">(</span>
<span class="w">        </span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Failed to update settings&#39;</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="c1">// Loading state</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isLoadingSettings</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex items-center justify-center p-8&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mb-4 h-8 w-8 animate-spin rounded-full border-4 border-blue-600 border-t-transparent&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;text-gray-600&quot;</span><span class="p">&gt;</span><span class="nx">Loading</span><span class="w"> </span><span class="nx">your</span><span class="w"> </span><span class="nx">settings</span><span class="p">...&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Error state</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">loadError</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;rounded-lg border border-red-200 bg-red-50 p-4&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">h3</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;font-semibold text-red-800&quot;</span><span class="p">&gt;</span><span class="nx">Failed</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">load</span><span class="w"> </span><span class="nx">settings</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 text-sm text-red-600&quot;</span><span class="p">&gt;{</span><span class="nx">loadError</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">          </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">reload</span><span class="p">()}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-3 rounded bg-red-600 px-4 py-2 text-sm text-white hover:bg-red-700&quot;</span>
<span class="w">        </span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Retry</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">form</span><span class="w"> </span><span class="na">onSubmit</span><span class="o">=</span><span class="p">{</span><span class="nx">handleSubmit</span><span class="p">(</span><span class="nx">onSubmit</span><span class="p">)}</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;space-y-6&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="cm">/* Success message */</span><span class="p">}</span>
<span class="w">      </span><span class="p">{</span><span class="nx">submitSuccess</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;rounded-lg border border-green-200 bg-green-50 p-4&quot;</span>
<span class="w">          </span><span class="na">role</span><span class="o">=</span><span class="s">&quot;alert&quot;</span>
<span class="w">          </span><span class="na">aria-live</span><span class="o">=</span><span class="s">&quot;polite&quot;</span>
<span class="w">        </span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;font-semibold text-green-800&quot;</span><span class="p">&gt;</span>
<span class="w">            </span><span class="err">‚úì</span><span class="w"> </span><span class="nx">Settings</span><span class="w"> </span><span class="nx">updated</span><span class="w"> </span><span class="nx">successfully</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">)}</span>

<span class="w">      </span><span class="p">{</span><span class="cm">/* Error message */</span><span class="p">}</span>
<span class="w">      </span><span class="p">{</span><span class="nx">submitError</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;rounded-lg border border-red-200 bg-red-50 p-4&quot;</span>
<span class="w">          </span><span class="na">role</span><span class="o">=</span><span class="s">&quot;alert&quot;</span>
<span class="w">          </span><span class="na">aria-live</span><span class="o">=</span><span class="s">&quot;assertive&quot;</span>
<span class="w">        </span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;font-semibold text-red-800&quot;</span><span class="p">&gt;</span><span class="nx">Failed</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">update</span><span class="w"> </span><span class="nx">settings</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 text-sm text-red-600&quot;</span><span class="p">&gt;{</span><span class="nx">submitError</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">)}</span>

<span class="w">      </span><span class="p">{</span><span class="cm">/* Name field */</span><span class="p">}</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span>
<span class="w">          </span><span class="na">htmlFor</span><span class="o">=</span><span class="s">&quot;name&quot;</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;block text-sm font-medium text-gray-700&quot;</span>
<span class="w">        </span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Name</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;text-red-500&quot;</span><span class="p">&gt;</span><span class="o">*</span><span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;name&quot;</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
<span class="w">          </span><span class="p">{</span><span class="na">...register</span><span class="err">(&#39;</span><span class="na">name</span><span class="err">&#39;)</span><span class="p">}</span>
<span class="w">          </span><span class="na">aria-invalid</span><span class="o">=</span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;true&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;false&#39;</span><span class="p">}</span>
<span class="w">          </span><span class="na">aria-describedby</span><span class="o">=</span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;name-error&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">undefined</span><span class="p">}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`mt-1 block w-full rounded-lg border p-2.5 </span><span class="si">${</span>
<span class="w">            </span><span class="nx">errors</span><span class="p">.</span><span class="nx">name</span>
<span class="w">              </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;border-red-300 focus:border-red-500 focus:ring-red-500&#39;</span>
<span class="w">              </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;border-gray-300 focus:border-blue-500 focus:ring-blue-500&#39;</span>
<span class="w">          </span><span class="si">}</span><span class="sb">`</span><span class="p">}</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;name-error&quot;</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 text-sm text-red-600&quot;</span><span class="w"> </span><span class="na">role</span><span class="o">=</span><span class="s">&quot;alert&quot;</span><span class="p">&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">message</span><span class="p">}</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="cm">/* Email field */</span><span class="p">}</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span>
<span class="w">          </span><span class="na">htmlFor</span><span class="o">=</span><span class="s">&quot;email&quot;</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;block text-sm font-medium text-gray-700&quot;</span>
<span class="w">        </span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Email</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;text-red-500&quot;</span><span class="p">&gt;</span><span class="o">*</span><span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">          </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;email&quot;</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;email&quot;</span>
<span class="w">          </span><span class="p">{</span><span class="na">...register</span><span class="err">(&#39;</span><span class="na">email</span><span class="err">&#39;)</span><span class="p">}</span>
<span class="w">          </span><span class="na">aria-invalid</span><span class="o">=</span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">email</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;true&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;false&#39;</span><span class="p">}</span>
<span class="w">          </span><span class="na">aria-describedby</span><span class="o">=</span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">email</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;email-error&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">undefined</span><span class="p">}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`mt-1 block w-full rounded-lg border p-2.5 </span><span class="si">${</span>
<span class="w">            </span><span class="nx">errors</span><span class="p">.</span><span class="nx">email</span>
<span class="w">              </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;border-red-300 focus:border-red-500 focus:ring-red-500&#39;</span>
<span class="w">              </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;border-gray-300 focus:border-blue-500 focus:ring-blue-500&#39;</span>
<span class="w">          </span><span class="si">}</span><span class="sb">`</span><span class="p">}</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">email</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;email-error&quot;</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 text-sm text-red-600&quot;</span><span class="w"> </span><span class="na">role</span><span class="o">=</span><span class="s">&quot;alert&quot;</span><span class="p">&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">email</span><span class="p">.</span><span class="nx">message</span><span class="p">}</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="cm">/* Bio field with character count */</span><span class="p">}</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex items-center justify-between&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">label</span>
<span class="w">            </span><span class="na">htmlFor</span><span class="o">=</span><span class="s">&quot;bio&quot;</span>
<span class="w">            </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;block text-sm font-medium text-gray-700&quot;</span>
<span class="w">          </span><span class="p">&gt;</span>
<span class="w">            </span><span class="nx">Bio</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">span</span>
<span class="w">            </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`text-sm </span><span class="si">${</span>
<span class="w">              </span><span class="nx">bioLength</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">500</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;text-red-600&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;text-gray-500&#39;</span>
<span class="w">            </span><span class="si">}</span><span class="sb">`</span><span class="p">}</span>
<span class="w">            </span><span class="na">aria-live</span><span class="o">=</span><span class="s">&quot;polite&quot;</span>
<span class="w">          </span><span class="p">&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="nx">bioLength</span><span class="p">}</span><span class="o">/</span><span class="mf">500</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">textarea</span>
<span class="w">          </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;bio&quot;</span>
<span class="w">          </span><span class="p">{</span><span class="na">...register</span><span class="err">(&#39;</span><span class="na">bio</span><span class="err">&#39;)</span><span class="p">}</span>
<span class="w">          </span><span class="na">rows</span><span class="o">=</span><span class="p">{</span><span class="mf">4</span><span class="p">}</span>
<span class="w">          </span><span class="na">aria-invalid</span><span class="o">=</span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">bio</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;true&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;false&#39;</span><span class="p">}</span>
<span class="w">          </span><span class="na">aria-describedby</span><span class="o">=</span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">bio</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;bio-error&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;bio-hint&#39;</span><span class="p">}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`mt-1 block w-full rounded-lg border p-2.5 </span><span class="si">${</span>
<span class="w">            </span><span class="nx">errors</span><span class="p">.</span><span class="nx">bio</span>
<span class="w">              </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;border-red-300 focus:border-red-500 focus:ring-red-500&#39;</span>
<span class="w">              </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;border-gray-300 focus:border-blue-500 focus:ring-blue-500&#39;</span>
<span class="w">          </span><span class="si">}</span><span class="sb">`</span><span class="p">}</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">bio</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;bio-error&quot;</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 text-sm text-red-600&quot;</span><span class="w"> </span><span class="na">role</span><span class="o">=</span><span class="s">&quot;alert&quot;</span><span class="p">&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">bio</span><span class="p">.</span><span class="nx">message</span><span class="p">}</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;bio-hint&quot;</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 text-sm text-gray-500&quot;</span><span class="p">&gt;</span>
<span class="w">            </span><span class="nx">Tell</span><span class="w"> </span><span class="nx">us</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">bit</span><span class="w"> </span><span class="nx">about</span><span class="w"> </span><span class="nx">yourself</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="cm">/* Password fields */</span><span class="p">}</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;space-y-4 rounded-lg border border-gray-200 bg-gray-50 p-4&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">h3</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;font-medium text-gray-900&quot;</span><span class="p">&gt;</span><span class="nx">Change</span><span class="w"> </span><span class="nx">Password</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;text-sm text-gray-600&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Leave</span><span class="w"> </span><span class="nx">blank</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">keep</span><span class="w"> </span><span class="nx">your</span><span class="w"> </span><span class="nx">current</span><span class="w"> </span><span class="nx">password</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">label</span>
<span class="w">            </span><span class="na">htmlFor</span><span class="o">=</span><span class="s">&quot;password&quot;</span>
<span class="w">            </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;block text-sm font-medium text-gray-700&quot;</span>
<span class="w">          </span><span class="p">&gt;</span>
<span class="w">            </span><span class="nx">New</span><span class="w"> </span><span class="nx">Password</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">            </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;password&quot;</span>
<span class="w">            </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;password&quot;</span>
<span class="w">            </span><span class="p">{</span><span class="na">...register</span><span class="err">(&#39;</span><span class="na">password</span><span class="err">&#39;)</span><span class="p">}</span>
<span class="w">            </span><span class="na">aria-invalid</span><span class="o">=</span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">password</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;true&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;false&#39;</span><span class="p">}</span>
<span class="w">            </span><span class="na">aria-describedby</span><span class="o">=</span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">password</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;password-error&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;password-hint&#39;</span><span class="p">}</span>
<span class="w">            </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`mt-1 block w-full rounded-lg border p-2.5 </span><span class="si">${</span>
<span class="w">              </span><span class="nx">errors</span><span class="p">.</span><span class="nx">password</span>
<span class="w">                </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;border-red-300 focus:border-red-500 focus:ring-red-500&#39;</span>
<span class="w">                </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;border-gray-300 focus:border-blue-500 focus:ring-blue-500&#39;</span>
<span class="w">            </span><span class="si">}</span><span class="sb">`</span><span class="p">}</span>
<span class="w">          </span><span class="p">/&gt;</span>
<span class="w">          </span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">password</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;password-error&quot;</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 text-sm text-red-600&quot;</span><span class="w"> </span><span class="na">role</span><span class="o">=</span><span class="s">&quot;alert&quot;</span><span class="p">&gt;</span>
<span class="w">              </span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">password</span><span class="p">.</span><span class="nx">message</span><span class="p">}</span>
<span class="w">            </span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;password-hint&quot;</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 text-sm text-gray-500&quot;</span><span class="p">&gt;</span>
<span class="w">              </span><span class="nx">Must</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">at</span><span class="w"> </span><span class="nx">least</span><span class="w"> </span><span class="mf">8</span><span class="w"> </span><span class="nx">characters</span><span class="w"> </span><span class="kd">with</span><span class="w"> </span><span class="nx">uppercase</span><span class="p">,</span><span class="w"> </span><span class="nx">lowercase</span><span class="p">,</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="kt">number</span>
<span class="w">            </span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">)}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">label</span>
<span class="w">            </span><span class="na">htmlFor</span><span class="o">=</span><span class="s">&quot;confirmPassword&quot;</span>
<span class="w">            </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;block text-sm font-medium text-gray-700&quot;</span>
<span class="w">          </span><span class="p">&gt;</span>
<span class="w">            </span><span class="nx">Confirm</span><span class="w"> </span><span class="nx">Password</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">            </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;confirmPassword&quot;</span>
<span class="w">            </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;password&quot;</span>
<span class="w">            </span><span class="p">{</span><span class="na">...register</span><span class="err">(&#39;</span><span class="na">confirmPassword</span><span class="err">&#39;)</span><span class="p">}</span>
<span class="w">            </span><span class="na">aria-invalid</span><span class="o">=</span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">confirmPassword</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;true&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;false&#39;</span><span class="p">}</span>
<span class="w">            </span><span class="na">aria-describedby</span><span class="o">=</span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">confirmPassword</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;confirm-error&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">undefined</span><span class="p">}</span>
<span class="w">            </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`mt-1 block w-full rounded-lg border p-2.5 </span><span class="si">${</span>
<span class="w">              </span><span class="nx">errors</span><span class="p">.</span><span class="nx">confirmPassword</span>
<span class="w">                </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;border-red-300 focus:border-red-500 focus:ring-red-500&#39;</span>
<span class="w">                </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;border-gray-300 focus:border-blue-500 focus:ring-blue-500&#39;</span>
<span class="w">            </span><span class="si">}</span><span class="sb">`</span><span class="p">}</span>
<span class="w">          </span><span class="p">/&gt;</span>
<span class="w">          </span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">confirmPassword</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;confirm-error&quot;</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-1 text-sm text-red-600&quot;</span><span class="w"> </span><span class="na">role</span><span class="o">=</span><span class="s">&quot;alert&quot;</span><span class="p">&gt;</span>
<span class="w">              </span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">confirmPassword</span><span class="p">.</span><span class="nx">message</span><span class="p">}</span>
<span class="w">            </span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">)}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="cm">/* Notification preferences */</span><span class="p">}</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">fieldset</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;space-y-3&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">legend</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;text-sm font-medium text-gray-700&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Notification</span><span class="w"> </span><span class="nx">Preferences</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">legend</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex items-center&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">            </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;checkbox&quot;</span>
<span class="w">            </span><span class="p">{</span><span class="na">...register</span><span class="err">(&#39;</span><span class="na">emailNotifications</span><span class="err">&#39;)</span><span class="p">}</span>
<span class="w">            </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500&quot;</span>
<span class="w">          </span><span class="p">/&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;ml-2 text-sm text-gray-700&quot;</span><span class="p">&gt;</span>
<span class="w">            </span><span class="nx">Email</span><span class="w"> </span><span class="nx">notifications</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">label</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex items-center&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">            </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;checkbox&quot;</span>
<span class="w">            </span><span class="p">{</span><span class="na">...register</span><span class="err">(&#39;</span><span class="na">pushNotifications</span><span class="err">&#39;)</span><span class="p">}</span>
<span class="w">            </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500&quot;</span>
<span class="w">          </span><span class="p">/&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;ml-2 text-sm text-gray-700&quot;</span><span class="p">&gt;</span>
<span class="w">            </span><span class="nx">Push</span><span class="w"> </span><span class="nx">notifications</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">fieldset</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="cm">/* Submit button */</span><span class="p">}</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex items-center justify-between border-t pt-4&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span>
<span class="w">          </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">reset</span><span class="p">(</span><span class="nx">settings</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="kc">undefined</span><span class="p">)}</span>
<span class="w">          </span><span class="na">disabled</span><span class="o">=</span><span class="p">{</span><span class="o">!</span><span class="nx">isDirty</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">isSubmitting</span><span class="p">}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;rounded-lg border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50&quot;</span>
<span class="w">        </span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Reset</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">          </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span>
<span class="w">          </span><span class="na">disabled</span><span class="o">=</span><span class="p">{</span><span class="o">!</span><span class="nx">isDirty</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="nx">isValid</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">isSubmitting</span><span class="p">}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;rounded-lg bg-blue-600 px-6 py-2 text-sm font-medium text-white hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-50&quot;</span>
<span class="w">        </span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">{</span><span class="nx">isSubmitting</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex items-center&quot;</span><span class="p">&gt;</span>
<span class="w">              </span><span class="p">&lt;</span><span class="nt">svg</span>
<span class="w">                </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mr-2 h-4 w-4 animate-spin&quot;</span>
<span class="w">                </span><span class="na">viewBox</span><span class="o">=</span><span class="s">&quot;0 0 24 24&quot;</span>
<span class="w">                </span><span class="na">fill</span><span class="o">=</span><span class="s">&quot;none&quot;</span>
<span class="w">              </span><span class="p">&gt;</span>
<span class="w">                </span><span class="p">&lt;</span><span class="nt">circle</span>
<span class="w">                  </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;opacity-25&quot;</span>
<span class="w">                  </span><span class="na">cx</span><span class="o">=</span><span class="s">&quot;12&quot;</span>
<span class="w">                  </span><span class="na">cy</span><span class="o">=</span><span class="s">&quot;12&quot;</span>
<span class="w">                  </span><span class="na">r</span><span class="o">=</span><span class="s">&quot;10&quot;</span>
<span class="w">                  </span><span class="na">stroke</span><span class="o">=</span><span class="s">&quot;currentColor&quot;</span>
<span class="w">                  </span><span class="na">strokeWidth</span><span class="o">=</span><span class="s">&quot;4&quot;</span>
<span class="w">                </span><span class="p">/&gt;</span>
<span class="w">                </span><span class="p">&lt;</span><span class="nt">path</span>
<span class="w">                  </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;opacity-75&quot;</span>
<span class="w">                  </span><span class="na">fill</span><span class="o">=</span><span class="s">&quot;currentColor&quot;</span>
<span class="w">                  </span><span class="na">d</span><span class="o">=</span><span class="s">&quot;M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z&quot;</span>
<span class="w">                </span><span class="p">/&gt;</span>
<span class="w">              </span><span class="p">&lt;/</span><span class="nt">svg</span><span class="p">&gt;</span>
<span class="w">              </span><span class="nx">Saving</span><span class="p">...</span>
<span class="w">            </span><span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="s1">&#39;Save Changes&#39;</span>
<span class="w">          </span><span class="p">)}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="what-makes-this-production-ready">What Makes This Production-Ready?</h3>
<p>Let's break down the features:</p>
<h4 id="1-loading-initial-data">1. Loading Initial Data</h4>
<div class="codehilite"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">settings</span><span class="p">,</span><span class="w"> </span><span class="nx">isLoading</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useUserSettings</span><span class="p">();</span>

<span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">settings</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">reset</span><span class="p">(</span><span class="nx">settings</span><span class="p">);</span><span class="w"> </span><span class="c1">// Populate form with fetched data</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">settings</span><span class="p">,</span><span class="w"> </span><span class="nx">reset</span><span class="p">]);</span>
</code></pre></div>

<ul>
<li>Fetches existing settings on mount</li>
<li>Shows loading spinner while fetching</li>
<li>Populates form when data arrives</li>
<li>Handles fetch errors gracefully</li>
</ul>
<h4 id="2-loading-and-error-states">2. Loading and Error States</h4>
<div class="codehilite"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isLoadingSettings</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">LoadingSpinner</span><span class="w"> </span><span class="p">/&gt;;</span>
<span class="p">}</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">loadError</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">ErrorMessage</span><span class="w"> </span><span class="na">error</span><span class="o">=</span><span class="p">{</span><span class="nx">loadError</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;;</span>
<span class="p">}</span>
</code></pre></div>

<ul>
<li>User sees loading indicator, not empty form</li>
<li>Errors are displayed clearly with retry option</li>
<li>No flash of empty form before data loads</li>
</ul>
<h4 id="3-form-state-management">3. Form State Management</h4>
<div class="codehilite"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">isDirty</span><span class="p">,</span><span class="w"> </span><span class="nx">isValid</span><span class="p">,</span><span class="w"> </span><span class="nx">isSubmitting</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">formState</span><span class="p">;</span>

<span class="p">&lt;</span><span class="nt">button</span>
<span class="w">  </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span>
<span class="w">  </span><span class="na">disabled</span><span class="o">=</span><span class="p">{</span><span class="o">!</span><span class="nx">isDirty</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="nx">isValid</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">isSubmitting</span><span class="p">}</span>
<span class="p">&gt;</span>
<span class="w">  </span><span class="nx">Save</span><span class="w"> </span><span class="nx">Changes</span>
<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</code></pre></div>

<ul>
<li><code>isDirty</code>: Form has unsaved changes</li>
<li><code>isValid</code>: All validation passes</li>
<li><code>isSubmitting</code>: Submit in progress</li>
<li>Submit button disabled until form is valid and changed</li>
</ul>
<h4 id="4-success-and-error-feedback">4. Success and Error Feedback</h4>
<div class="codehilite"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">submitSuccess</span><span class="p">,</span><span class="w"> </span><span class="nx">setSubmitSuccess</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">submitError</span><span class="p">,</span><span class="w"> </span><span class="nx">setSubmitError</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">string</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="na">null</span><span class="p">&gt;(</span><span class="kc">null</span><span class="p">);</span>

<span class="c1">// After successful submit</span>
<span class="nx">setSubmitSuccess</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="nx">setTimeout</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setSubmitSuccess</span><span class="p">(</span><span class="kc">false</span><span class="p">),</span><span class="w"> </span><span class="mf">3000</span><span class="p">);</span>

<span class="c1">// After failed submit</span>
<span class="nx">setSubmitError</span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
</code></pre></div>

<ul>
<li>Success message appears for 3 seconds</li>
<li>Error messages persist until next submit</li>
<li>Both use ARIA live regions for screen readers</li>
</ul>
<h4 id="5-character-count">5. Character Count</h4>
<div class="codehilite"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">bio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">watch</span><span class="p">(</span><span class="s1">&#39;bio&#39;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">bioLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">bio</span><span class="o">?</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>

<span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="nx">bioLength</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">500</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;text-red-600&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;text-gray-500&#39;</span><span class="p">}&gt;</span>
<span class="w">  </span><span class="p">{</span><span class="nx">bioLength</span><span class="p">}</span><span class="o">/</span><span class="mf">500</span>
<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
</code></pre></div>

<ul>
<li>Real-time character count</li>
<li>Changes color when limit exceeded</li>
<li>Uses <code>watch()</code> to subscribe to field changes</li>
</ul>
<h4 id="6-accessibility-features">6. Accessibility Features</h4>
<div class="codehilite"><pre><span></span><code><span class="p">&lt;</span><span class="nt">input</span>
<span class="w">  </span><span class="na">aria-invalid</span><span class="o">=</span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;true&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;false&#39;</span><span class="p">}</span>
<span class="w">  </span><span class="na">aria-describedby</span><span class="o">=</span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;name-error&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">undefined</span><span class="p">}</span>
<span class="p">/&gt;</span>

<span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">id</span><span class="o">=</span><span class="s">&quot;name-error&quot;</span><span class="w"> </span><span class="na">role</span><span class="o">=</span><span class="s">&quot;alert&quot;</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">message</span><span class="p">}</span>
<span class="w">  </span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">)}</span>
</code></pre></div>

<ul>
<li><code>aria-invalid</code>: Marks invalid fields for screen readers</li>
<li><code>aria-describedby</code>: Links error messages to fields</li>
<li><code>role="alert"</code>: Announces errors immediately</li>
<li><code>aria-live</code>: Announces dynamic content changes</li>
<li>Proper label associations with <code>htmlFor</code></li>
</ul>
<h4 id="7-visual-error-states">7. Visual Error States</h4>
<div class="codehilite"><pre><span></span><code><span class="nx">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`border </span><span class="si">${</span>
<span class="w">  </span><span class="nx">errors</span><span class="p">.</span><span class="nx">name</span>
<span class="w">    </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;border-red-300 focus:border-red-500&#39;</span>
<span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;border-gray-300 focus:border-blue-500&#39;</span>
<span class="si">}</span><span class="sb">`</span><span class="p">}</span>
</code></pre></div>

<ul>
<li>Red border for invalid fields</li>
<li>Visual feedback matches validation state</li>
<li>Focus states remain accessible</li>
</ul>
<h4 id="8-reset-functionality">8. Reset Functionality</h4>
<div class="codehilite"><pre><span></span><code><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">  </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span>
<span class="w">  </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">reset</span><span class="p">(</span><span class="nx">settings</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="kc">undefined</span><span class="p">)}</span>
<span class="w">  </span><span class="na">disabled</span><span class="o">=</span><span class="p">{</span><span class="o">!</span><span class="nx">isDirty</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">isSubmitting</span><span class="p">}</span>
<span class="p">&gt;</span>
<span class="w">  </span><span class="nx">Reset</span>
<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</code></pre></div>

<ul>
<li>Resets form to last saved state</li>
<li>Disabled when no changes or submitting</li>
<li>Clears validation errors</li>
</ul>
<h4 id="9-password-field-clearing">9. Password Field Clearing</h4>
<div class="codehilite"><pre><span></span><code><span class="nx">reset</span><span class="p">({</span>
<span class="w">  </span><span class="p">...</span><span class="nx">data</span><span class="p">,</span>
<span class="w">  </span><span class="nx">password</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">confirmPassword</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="p">});</span>
</code></pre></div>

<ul>
<li>After successful update, password fields are cleared</li>
<li>Other fields retain their values</li>
<li>Security best practice</li>
</ul>
<h3 id="verification-testing-the-complete-form">Verification: Testing the Complete Form</h3>
<p><strong>Test 1: Initial load</strong>
- Open form
- See loading spinner
- Form populates with existing data
- All fields show current values</p>
<p><strong>Test 2: Validation</strong>
- Clear name field, blur
- See "Name is required" error
- Field border turns red
- Submit button is disabled</p>
<p><strong>Test 3: Character count</strong>
- Type in bio field
- See character count update in real-time
- Type 501 characters
- Count turns red
- See "Bio must be less than 500 characters" error</p>
<p><strong>Test 4: Password validation</strong>
- Enter password: "pass"
- Blur field
- See "Password must be at least 8 characters"
- Enter password: "password"
- See "Password must contain at least one uppercase letter"
- Enter password: "Password123"
- Error clears</p>
<p><strong>Test 5: Password confirmation</strong>
- Enter password: "Password123"
- Enter confirmation: "Password456"
- Blur confirmation
- See "Passwords do not match"
- Fix confirmation to "Password123"
- Error clears immediately</p>
<p><strong>Test 6: Submit success</strong>
- Make valid changes
- Click "Save Changes"
- Button shows "Saving..." with spinner
- Success message appears
- Password fields clear
- Other fields retain values
- Success message disappears after 3 seconds</p>
<p><strong>Test 7: Submit error</strong>
- Disconnect network
- Make changes and submit
- See error message
- Error persists until next submit</p>
<p><strong>Test 8: Reset</strong>
- Make changes
- Click "Reset"
- Form reverts to last saved state
- Validation errors clear</p>
<p><strong>Test 9: Accessibility</strong>
- Navigate form with Tab key
- All fields are reachable
- Error messages are announced by screen reader
- Submit button state is announced</p>
<h3 id="performance-characteristics">Performance Characteristics</h3>
<p><strong>Bundle Size Impact</strong>:
- React Hook Form: ~8KB gzipped
- Zod: ~10KB gzipped
- Total: ~18KB for complete form solution</p>
<p><strong>Runtime Performance</strong>:
- No re-renders on keystroke (uncontrolled inputs)
- Validation only on blur and submit
- Character count uses <code>watch()</code> (minimal re-renders)</p>
<p><strong>React DevTools Profiler Evidence</strong>:
- Typing in name field: 0 renders
- Blur name field: 1 render (validation)
- Typing in bio field: 1 render per keystroke (character count)
- Submit form: 2 renders (isSubmitting true ‚Üí false)</p>
<h3 id="common-failure-modes-and-their-signatures">Common Failure Modes and Their Signatures</h3>
<h4 id="symptom-form-doesnt-populate-with-initial-data">Symptom: Form doesn't populate with initial data</h4>
<p><strong>Browser behavior</strong>: Form shows empty fields despite data being fetched</p>
<p><strong>Console pattern</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">Warning</span><span class="o">:</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">changing</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">uncontrolled</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">controlled</span><span class="o">.</span>
</code></pre></div>

<p><strong>DevTools clues</strong>:
- <code>settings</code> state has data
- Form <code>defaultValues</code> are empty
- <code>reset()</code> not called after data loads</p>
<p><strong>Root cause</strong>: Missing <code>useEffect</code> to call <code>reset()</code> when data arrives</p>
<p><strong>Solution</strong>: Add effect to populate form:</p>
<div class="codehilite"><pre><span></span><code><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">settings</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">reset</span><span class="p">(</span><span class="nx">settings</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">settings</span><span class="p">,</span><span class="w"> </span><span class="nx">reset</span><span class="p">]);</span>
</code></pre></div>

<h4 id="symptom-submit-button-never-enables">Symptom: Submit button never enables</h4>
<p><strong>Browser behavior</strong>: Button stays disabled even with valid data</p>
<p><strong>DevTools clues</strong>:
- <code>formState.isValid</code> is <code>false</code>
- <code>formState.errors</code> is empty
- Form mode is <code>'onChange'</code></p>
<p><strong>Root cause</strong>: Form mode set to <code>'onChange'</code> but fields haven't been touched</p>
<p><strong>Solution</strong>: Change mode to <code>'onBlur'</code> or <code>'all'</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="nx">useForm</span><span class="p">({</span>
<span class="w">  </span><span class="nx">mode</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;onBlur&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Validate on blur, re-validate on change</span>
<span class="p">});</span>
</code></pre></div>

<h4 id="symptom-character-count-doesnt-update">Symptom: Character count doesn't update</h4>
<p><strong>Browser behavior</strong>: Count stays at 0 while typing</p>
<p><strong>Console pattern</strong>: No errors</p>
<p><strong>DevTools clues</strong>:
- Field value updates in form state
- Component doesn't re-render
- <code>watch()</code> not called</p>
<p><strong>Root cause</strong>: Not using <code>watch()</code> to subscribe to field changes</p>
<p><strong>Solution</strong>: Use <code>watch()</code> to track field:</p>
<div class="codehilite"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">bio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">watch</span><span class="p">(</span><span class="s1">&#39;bio&#39;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">bioLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">bio</span><span class="o">?</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
</code></pre></div>

<h4 id="symptom-password-fields-dont-clear-after-submit">Symptom: Password fields don't clear after submit</h4>
<p><strong>Browser behavior</strong>: Password remains visible after successful update</p>
<p><strong>DevTools clues</strong>:
- Submit succeeds
- Form state still contains password
- <code>reset()</code> not called with cleared passwords</p>
<p><strong>Root cause</strong>: Not clearing sensitive fields after submit</p>
<p><strong>Solution</strong>: Reset with cleared passwords:</p>
<div class="codehilite"><pre><span></span><code><span class="nx">reset</span><span class="p">({</span>
<span class="w">  </span><span class="p">...</span><span class="nx">data</span><span class="p">,</span>
<span class="w">  </span><span class="nx">password</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">confirmPassword</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="p">});</span>
</code></pre></div>

<h3 id="when-to-apply-this-pattern">When to Apply This Pattern</h3>
<p><strong>Use this complete pattern when</strong>:
- Building user-facing forms in production
- Form has 5+ fields
- Need validation, error handling, and loading states
- Accessibility is required
- Form edits existing data</p>
<p><strong>Simplify when</strong>:
- Prototyping or internal tools
- Form has 1-3 simple fields
- No need for loading states (no initial data fetch)
- Performance is critical (every KB matters)</p>
<p><strong>Decision Framework</strong>:</p>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Simple Form</th>
<th>Production Form</th>
</tr>
</thead>
<tbody>
<tr>
<td>Fields</td>
<td>1-3</td>
<td>5+</td>
</tr>
<tr>
<td>Validation</td>
<td>Built-in HTML5</td>
<td>Zod schema</td>
</tr>
<tr>
<td>Loading state</td>
<td>‚ùå</td>
<td>‚úÖ</td>
</tr>
<tr>
<td>Error handling</td>
<td>Basic</td>
<td>Comprehensive</td>
</tr>
<tr>
<td>Accessibility</td>
<td>Basic labels</td>
<td>Full ARIA</td>
</tr>
<tr>
<td>Character counts</td>
<td>‚ùå</td>
<td>‚úÖ</td>
</tr>
<tr>
<td>Reset functionality</td>
<td>‚ùå</td>
<td>‚úÖ</td>
</tr>
<tr>
<td>Success feedback</td>
<td>Alert</td>
<td>Inline message</td>
</tr>
<tr>
<td>Bundle size</td>
<td>~8KB</td>
<td>~18KB</td>
</tr>
<tr>
<td>Development time</td>
<td>30 min</td>
<td>2 hours</td>
</tr>
</tbody>
</table>
<h3 id="the-journey-from-naive-to-production">The Journey: From Naive to Production</h3>
<table>
<thead>
<tr>
<th>Iteration</th>
<th>Approach</th>
<th>Lines of Code</th>
<th>Features</th>
<th>Limitations</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Manual useState</td>
<td>150+</td>
<td>Basic form</td>
<td>No validation, prop drilling</td>
</tr>
<tr>
<td>1</td>
<td>Manual validation</td>
<td>200+</td>
<td>Field validation</td>
<td>Validation timing wrong</td>
</tr>
<tr>
<td>2</td>
<td>Touched state</td>
<td>250+</td>
<td>Smart validation</td>
<td>Maintenance nightmare</td>
</tr>
<tr>
<td>3</td>
<td>React Hook Form</td>
<td>80</td>
<td>Clean, validated</td>
<td>No cross-field validation</td>
</tr>
<tr>
<td>4</td>
<td>+ Zod</td>
<td>100</td>
<td>Type-safe, complex rules</td>
<td>No loading/error states</td>
</tr>
<tr>
<td>5</td>
<td>Production</td>
<td>200</td>
<td>Complete, accessible</td>
<td>More complex</td>
</tr>
</tbody>
</table>
<h3 id="lessons-learned">Lessons Learned</h3>
<p><strong>1. Don't reinvent form state management</strong>
- React Hook Form handles 90% of form complexity
- Manual state management doesn't scale past 3-4 fields
- The library is smaller than your custom solution</p>
<p><strong>2. Validation belongs in schemas</strong>
- Zod schemas are reusable across client and server
- Type inference eliminates duplicate type definitions
- Complex validation is easier to read and maintain</p>
<p><strong>3. Loading and error states are not optional</strong>
- Users need feedback at every stage
- Loading states prevent confusion
- Error states enable recovery</p>
<p><strong>4. Accessibility is built in, not bolted on</strong>
- ARIA attributes connect errors to fields
- Live regions announce dynamic changes
- Keyboard navigation must work</p>
<p><strong>5. UX polish matters</strong>
- Character counts guide users
- Disabled states prevent invalid submissions
- Success feedback confirms actions
- Reset functionality enables exploration</p>
<p><strong>6. Performance comes from architecture</strong>
- Uncontrolled inputs minimize re-renders
- Validation only when needed
- Watch only the fields you need</p>
<p>The difference between a form that works and a form that's production-ready is attention to these details. React Hook Form and Zod handle the hard parts. Your job is to connect them thoughtfully and handle the edge cases.</p>
        </div>
        <div class="footer">
            Generated on 2025-12-03 12:42:27 | Made with ‚ù§Ô∏è by GitHub Pages Generator
        </div>
    </div>
    <script>
        // Syntax highlighting for code blocks
        document.addEventListener('DOMContentLoaded', (event) => {
            // Highlight code blocks
            document.querySelectorAll('pre code').forEach((block) => {
                hljs.highlightElement(block);
            });
            
            // Add copy buttons to code blocks
            document.querySelectorAll('pre').forEach((pre) => {
                const button = document.createElement('button');
                button.className = 'copy-btn';
                button.textContent = 'Copy';
                
                button.addEventListener('click', () => {
                    const code = pre.querySelector('code').textContent;
                    navigator.clipboard.writeText(code).then(() => {
                        button.textContent = 'Copied!';
                        button.classList.add('copied');
                        setTimeout(() => {
                            button.textContent = 'Copy';
                            button.classList.remove('copied');
                        }, 2000);
                    }).catch(err => {
                        console.error('Failed to copy:', err);
                        button.textContent = 'Error';
                        setTimeout(() => {
                            button.textContent = 'Copy';
                        }, 2000);
                    });
                });
                
                pre.appendChild(button);
            });
        });
    </script>
</body>
</html>