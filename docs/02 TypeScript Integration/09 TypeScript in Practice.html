<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>09 TypeScript in Practice</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #8b5cf6;
            --bg-main: #0f172a;
            --bg-card: #1e293b;
            --bg-code: #0f172a;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #334155;
            --accent: #06b6d4;
            --success: #10b981;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            line-height: 1.7; 
            color: var(--text-primary); 
            background: var(--bg-main);
        }
        
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 20px; 
        }
        
        .home-btn { 
            position: fixed; 
            top: 20px; 
            right: 20px; 
            background: var(--accent);
            color: white; 
            width: 50px;
            height: 50px;
            border-radius: 50%;
            text-decoration: none; 
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(6, 182, 212, 0.4);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .home-btn:hover { 
            background: #0891b2;
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(6, 182, 212, 0.5);
        }
        
        .breadcrumb { 
            background: var(--bg-card);
            padding: 12px 0; 
            margin-bottom: 24px; 
            font-size: 14px;
            border-radius: 8px;
            border: 1px solid var(--border);
        }
        
        .breadcrumb a { 
            color: var(--accent);
            text-decoration: none;
            transition: color 0.2s;
        }
        
        .breadcrumb a:hover { 
            color: var(--primary);
            text-decoration: underline;
        }
        
        .content { 
            background: var(--bg-card);
            padding: 3rem; 
            border-radius: 16px; 
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border);
        }
        
        .file-list { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); 
            gap: 1.5rem; 
            margin: 2rem 0; 
        }
        
        .file-item { 
            padding: 1.5rem; 
            border: 1px solid var(--border);
            border-radius: 12px; 
            background: var(--bg-main);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .file-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .file-item:hover { 
            transform: translateY(-4px); 
            box-shadow: 0 8px 30px rgba(99, 102, 241, 0.3);
            border-color: var(--primary);
        }
        
        .file-item:hover::before {
            opacity: 1;
        }
        
        .file-item a { 
            color: var(--text-primary);
            text-decoration: none; 
            font-weight: 600; 
            display: block;
            font-size: 1.1rem;
        }
        
        .file-item a:hover { 
            color: var(--primary);
        }
        
        .file-type { 
            font-size: 13px; 
            color: var(--text-secondary);
            margin-top: 8px; 
            font-weight: 500;
        }
        
        /* Code Blocks */
        pre { 
            background: var(--bg-code);
            padding: 1.5rem; 
            border-radius: 12px; 
            overflow-x: auto;
            border: 1px solid var(--border);
            margin: 1.5rem 0;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            position: relative;
        }
        
        pre code { 
            background: none;
            padding: 0;
            font-family: 'Fira Code', 'Consolas', monospace;
            font-size: 0.9em;
            line-height: 1.6;
        }
        
        /* Copy Button */
        .copy-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: var(--primary);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.2s;
            opacity: 0.7;
            z-index: 10;
        }
        
        .copy-btn:hover {
            opacity: 1;
            background: var(--primary-dark);
            transform: translateY(-1px);
        }
        
        .copy-btn.copied {
            background: var(--success);
        }
        
        pre:hover .copy-btn {
            opacity: 1;
        }
        
        /* Inline Code */
        code { 
            background: var(--bg-code);
            color: #8b5cf6;
            padding: 3px 8px; 
            border-radius: 6px; 
            font-size: 1.1em;
            font-family: 'Fira Code', 'Consolas', monospace;
            border: 1px solid var(--border);
        }
        
        /* Headings */
        h1, h2, h3, h4, h5, h6 { 
            color: var(--text-primary);
            margin: 2rem 0 1rem 0;
            font-weight: 700;
            letter-spacing: -0.5px;
        }
        
        h1 { 
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            border-bottom: 3px solid var(--primary);
            padding-bottom: 12px;
            margin-bottom: 1.5rem;
        }
        
        h2 { 
            font-size: 2rem;
            color: var(--primary);
            border-bottom: 2px solid var(--border);
            padding-bottom: 8px;
        }
        
        h3 { 
            font-size: 1.5rem;
            color: var(--accent);
        }
        
        /* Links */
        a { 
            color: var(--accent);
            transition: color 0.2s;
        }
        
        a:hover { 
            color: var(--primary);
        }
        
        /* Paragraphs */
        p {
            margin: 1rem 0;
            color: var(--text-secondary);
        }
        
        /* Lists */
        ul, ol {
            margin: 1rem 0;
            padding-left: 2rem;
            color: var(--text-secondary);
        }
        
        li {
            margin: 0.5rem 0;
        }
        
        /* Tables */
        table { 
            border-collapse: collapse;
            width: 100%;
            margin: 1.5rem 0;
            background: var(--bg-main);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }
        
        th, td { 
            border: 1px solid var(--border);
            padding: 12px 16px;
            text-align: left;
        }
        
        th { 
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            font-weight: 600;
        }
        
        tr:hover {
            background: var(--bg-card);
        }
        
        /* Blockquotes */
        blockquote {
            border-left: 4px solid var(--primary);
            padding: 1rem 1.5rem;
            margin: 1.5rem 0;
            background: var(--bg-main);
            border-radius: 0 8px 8px 0;
            color: var(--text-secondary);
            font-style: italic;
        }
        
        /* Horizontal Rule */
        hr {
            border: none;
            border-top: 2px solid var(--border);
            margin: 2rem 0;
        }
        
        .footer { 
            text-align: center; 
            padding: 2rem; 
            color: var(--text-secondary);
            border-top: 1px solid var(--border);
            margin-top: 3rem; 
            font-size: 14px;
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--bg-main);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 6px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }
        
        @media (max-width: 768px) {
            .container { padding: 10px; }
            .file-list { grid-template-columns: 1fr; }
            .content { padding: 1.5rem; }
            h1 { font-size: 2rem; }
            h2 { font-size: 1.5rem; }
        }
    </style>
</head>
<body>
    <a href="../index.html" class="home-btn">üè†</a>
    <div class="container">
        <div class="breadcrumb">
            <div style="padding: 0 20px;">
                <a href="../index.html">üè† Home</a> <span style="color: #64748b;">/</span> <a href="index.html">02 TypeScript Integration</a>
            </div>
        </div>
        <div class="content">
            <h1 id="chapter-9-typescript-in-practice">Chapter 9: TypeScript in Practice</h1>
<h2 id="migrating-existing-javascript-code">Migrating existing JavaScript code</h2>
<h2 id="migrating-existing-javascript-code_1">Migrating Existing JavaScript Code</h2>
<p>In Chapter 8, we added TypeScript to our User Profile Dashboard from scratch. But what happens when you inherit a real codebase‚Äîthousands of lines of JavaScript, no types, and production traffic? You can't rewrite everything overnight.</p>
<p>This section demonstrates the <strong>incremental migration strategy</strong> that professional teams use: start with the most critical files, add types gradually, and let TypeScript guide you to hidden bugs.</p>
<h3 id="reference-implementation-the-legacy-product-catalog">Reference Implementation: The Legacy Product Catalog</h3>
<p>We're inheriting a JavaScript e-commerce component that's been in production for two years. It works‚Äîmostly. But every few months, a runtime error crashes the checkout flow because someone passed the wrong shape of data.</p>
<p><strong>Project Structure</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="nx">src</span><span class="o">/</span>
<span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">components</span><span class="o">/</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">ProductCard</span><span class="p">.</span><span class="nx">jsx</span><span class="w">          </span><span class="err">‚Üê</span><span class="w"> </span><span class="nx">Our</span><span class="w"> </span><span class="nx">migration</span><span class="w"> </span><span class="nx">target</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">ProductList</span><span class="p">.</span><span class="nx">jsx</span><span class="w">          </span><span class="err">‚Üê</span><span class="w"> </span><span class="nx">Depends</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">ProductCard</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">ShoppingCart</span><span class="p">.</span><span class="nx">jsx</span><span class="w">         </span><span class="err">‚Üê</span><span class="w"> </span><span class="nx">Uses</span><span class="w"> </span><span class="nx">product</span><span class="w"> </span><span class="nx">data</span>
<span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">utils</span><span class="o">/</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">formatPrice</span><span class="p">.</span><span class="nx">js</span><span class="w">           </span><span class="err">‚Üê</span><span class="w"> </span><span class="nx">Utility</span><span class="w"> </span><span class="nx">functions</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="kn">api</span><span class="p">.</span><span class="nx">js</span><span class="w">                   </span><span class="err">‚Üê</span><span class="w"> </span><span class="nx">API</span><span class="w"> </span><span class="nx">client</span>
<span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">types</span><span class="o">/</span>
<span class="w">    </span><span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">product</span><span class="p">.</span><span class="nx">ts</span><span class="w">               </span><span class="err">‚Üê</span><span class="w"> </span><span class="nx">We</span><span class="err">&#39;</span><span class="nx">ll</span><span class="w"> </span><span class="nx">create</span><span class="w"> </span><span class="nx">this</span>
</code></pre></div>

<p>Here's the working JavaScript code we're starting with:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/ProductCard.jsx</span>
<span class="k">import</span><span class="w"> </span><span class="nx">React</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">formatPrice</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../utils/formatPrice&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductCard</span><span class="p">({</span><span class="w"> </span><span class="nx">product</span><span class="p">,</span><span class="w"> </span><span class="nx">onAddToCart</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">onAddToCart</span><span class="p">(</span><span class="nx">product</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;product-card&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">img</span><span class="w"> </span><span class="na">src</span><span class="o">=</span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">imageUrl</span><span class="p">}</span><span class="w"> </span><span class="na">alt</span><span class="o">=</span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;{</span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="p">}&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;{</span><span class="nx">product</span><span class="p">.</span><span class="nx">description</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;price&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">onSale</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;original-price&quot;</span><span class="p">&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="nx">formatPrice</span><span class="p">(</span><span class="nx">product</span><span class="p">.</span><span class="nx">originalPrice</span><span class="p">)}</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;current-price&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">{</span><span class="nx">formatPrice</span><span class="p">(</span><span class="nx">product</span><span class="p">.</span><span class="nx">price</span><span class="p">)}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleClick</span><span class="p">}&gt;</span><span class="nx">Add</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">Cart</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">inStock</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;out-of-stock&quot;</span><span class="p">&gt;</span><span class="nx">Out</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">Stock</span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">)}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/utils/formatPrice.js</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">formatPrice</span><span class="p">(</span><span class="nx">price</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Intl</span><span class="p">.</span><span class="nx">NumberFormat</span><span class="p">(</span><span class="s1">&#39;en-US&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">style</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;currency&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">currency</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;USD&#39;</span>
<span class="w">  </span><span class="p">}).</span><span class="nx">format</span><span class="p">(</span><span class="nx">price</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/utils/api.js</span>
<span class="k">export</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">fetchProducts</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/api/products&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">addToCart</span><span class="p">(</span><span class="nx">productId</span><span class="p">,</span><span class="w"> </span><span class="nx">quantity</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/api/cart&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span><span class="w"> </span><span class="nx">productId</span><span class="p">,</span><span class="w"> </span><span class="nx">quantity</span><span class="w"> </span><span class="p">})</span>
<span class="w">  </span><span class="p">});</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>

<p>This code runs in production. Users can browse products and add them to their cart. But here's what happened last month:</p>
<p><strong>The Failure: Runtime Error in Production</strong></p>
<p>A product manager added a new product type to the database‚Äîa digital download with no physical inventory. The <code>inStock</code> field was <code>null</code> instead of <code>true</code> or <code>false</code>. The component rendered, but the checkout flow crashed when trying to validate inventory.</p>
<p><strong>Browser Console</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">TypeError</span><span class="o">:</span><span class="w"> </span><span class="n">Cannot</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">properties</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">(</span><span class="n">reading</span><span class="w"> </span><span class="s1">&#39;toString&#39;</span><span class="o">)</span>
<span class="w">  </span><span class="n">at</span><span class="w"> </span><span class="n">ShoppingCart</span><span class="o">.</span><span class="na">validateInventory</span><span class="w"> </span><span class="o">(</span><span class="n">ShoppingCart</span><span class="o">.</span><span class="na">jsx</span><span class="o">:</span><span class="mi">45</span><span class="o">)</span>
<span class="w">  </span><span class="n">at</span><span class="w"> </span><span class="n">ShoppingCart</span><span class="o">.</span><span class="na">handleCheckout</span><span class="w"> </span><span class="o">(</span><span class="n">ShoppingCart</span><span class="o">.</span><span class="na">jsx</span><span class="o">:</span><span class="mi">78</span><span class="o">)</span>
</code></pre></div>

<p><strong>The Problem</strong>: JavaScript allowed <code>null</code> to flow through the entire application until it hit a function that expected a boolean. No warning, no error‚Äîuntil a customer tried to check out.</p>
<p><strong>What We Need</strong>: TypeScript to catch this at compile time, not runtime.</p>
<h3 id="diagnostic-analysis-why-javascript-failed-us">Diagnostic Analysis: Why JavaScript Failed Us</h3>
<p><strong>Browser Behavior</strong>:
- Product card renders normally
- "Add to Cart" button works
- Checkout page loads
- Click "Complete Purchase" ‚Üí White screen, error overlay</p>
<p><strong>Browser Console Output</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">TypeError</span><span class="o">:</span><span class="w"> </span><span class="n">Cannot</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">properties</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">(</span><span class="n">reading</span><span class="w"> </span><span class="s1">&#39;toString&#39;</span><span class="o">)</span>
<span class="w">  </span><span class="n">at</span><span class="w"> </span><span class="n">ShoppingCart</span><span class="o">.</span><span class="na">validateInventory</span><span class="w"> </span><span class="o">(</span><span class="n">ShoppingCart</span><span class="o">.</span><span class="na">jsx</span><span class="o">:</span><span class="mi">45</span><span class="o">)</span>
<span class="w">  </span><span class="n">at</span><span class="w"> </span><span class="n">ShoppingCart</span><span class="o">.</span><span class="na">handleCheckout</span><span class="w"> </span><span class="o">(</span><span class="n">ShoppingCart</span><span class="o">.</span><span class="na">jsx</span><span class="o">:</span><span class="mi">78</span><span class="o">)</span>
<span class="w">  </span><span class="n">at</span><span class="w"> </span><span class="n">onClick</span><span class="w"> </span><span class="o">(</span><span class="n">ShoppingCart</span><span class="o">.</span><span class="na">jsx</span><span class="o">:</span><span class="mi">92</span><span class="o">)</span>
</code></pre></div>

<p><strong>React DevTools Evidence</strong>:
- <code>ProductCard</code> component rendered successfully
- Props: <code>{ product: { id: "123", name: "eBook", inStock: null, ... } }</code>
- No warnings, no errors‚ÄîReact doesn't know <code>null</code> is wrong</p>
<p><strong>Let's parse this evidence</strong>:</p>
<ol>
<li>
<p><strong>What the user experiences</strong>: Product appears normal, but checkout crashes with cryptic error</p>
</li>
<li>
<p><strong>What the console reveals</strong>: Error happens deep in the checkout flow, far from where the bad data entered</p>
</li>
<li>
<p><strong>What DevTools shows</strong>: The <code>null</code> value is visible in props, but nothing indicates it's problematic</p>
</li>
<li>
<p><strong>Root cause identified</strong>: JavaScript's type system allowed invalid data to propagate through multiple components</p>
</li>
<li>
<p><strong>Why JavaScript can't solve this</strong>: No compile-time checks, no editor warnings, no way to enforce data shape</p>
</li>
<li>
<p><strong>What we need</strong>: TypeScript to define the expected shape of <code>product</code> and catch mismatches before deployment</p>
</li>
</ol>
<h3 id="iteration-1-the-incremental-migration-strategy">Iteration 1: The Incremental Migration Strategy</h3>
<p><strong>Current state recap</strong>: We have working JavaScript code that occasionally fails with runtime type errors.</p>
<p><strong>Migration goal</strong>: Add TypeScript gradually without breaking existing functionality.</p>
<p><strong>The Strategy</strong>:
1. Rename <code>.jsx</code> ‚Üí <code>.tsx</code> (or <code>.js</code> ‚Üí <code>.ts</code>)
2. Add <code>// @ts-check</code> to get basic checking without full migration
3. Define types for the most critical data structures
4. Fix errors one file at a time
5. Gradually tighten <code>tsconfig.json</code> settings</p>
<p>Let's start with the most critical piece: the product data structure.</p>
<p><strong>Step 1: Define the Product Type</strong></p>
<p>Create a new file to define what a valid product looks like:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/types/product.ts</span>

<span class="cm">/**</span>
<span class="cm"> * Core product data structure used throughout the application.</span>
<span class="cm"> * This type represents products from our API and database.</span>
<span class="cm"> */</span>
<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">Product</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">imageUrl</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">inStock</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span><span class="w">  </span><span class="c1">// ‚Üê Must be boolean, not null</span>
<span class="w">  </span><span class="nx">onSale?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span><span class="w">  </span><span class="c1">// ‚Üê Optional: only present when on sale</span>
<span class="w">  </span><span class="nx">originalPrice?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w">  </span><span class="c1">// ‚Üê Optional: only present when on sale</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Type guard to validate unknown data is a valid Product.</span>
<span class="cm"> * Use this when receiving data from APIs or external sources.</span>
<span class="cm"> */</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">isProduct</span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">unknown</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">Product</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;object&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">unknown</span><span class="o">&gt;</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">    </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">    </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">description</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">    </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">price</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;number&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">    </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">imageUrl</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">    </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">inStock</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;boolean&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">    </span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">onSale</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="kc">undefined</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">onSale</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;boolean&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">    </span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">originalPrice</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="kc">undefined</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">originalPrice</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;number&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Step 2: Migrate ProductCard to TypeScript</strong></p>
<p>Rename <code>ProductCard.jsx</code> ‚Üí <code>ProductCard.tsx</code> and add type annotations:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/ProductCard.tsx</span>
<span class="k">import</span><span class="w"> </span><span class="nx">React</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">formatPrice</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../utils/formatPrice&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Product</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/product&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">ProductCardProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">product</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onAddToCart</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">product</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductCard</span><span class="p">({</span><span class="w"> </span><span class="nx">product</span><span class="p">,</span><span class="w"> </span><span class="nx">onAddToCart</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">ProductCardProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">onAddToCart</span><span class="p">(</span><span class="nx">product</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;product-card&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">img</span><span class="w"> </span><span class="na">src</span><span class="o">=</span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">imageUrl</span><span class="p">}</span><span class="w"> </span><span class="na">alt</span><span class="o">=</span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;{</span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="p">}&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;{</span><span class="nx">product</span><span class="p">.</span><span class="nx">description</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;price&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">onSale</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;original-price&quot;</span><span class="p">&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="nx">formatPrice</span><span class="p">(</span><span class="nx">product</span><span class="p">.</span><span class="nx">originalPrice</span><span class="o">!</span><span class="p">)}</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;current-price&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">{</span><span class="nx">formatPrice</span><span class="p">(</span><span class="nx">product</span><span class="p">.</span><span class="nx">price</span><span class="p">)}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleClick</span><span class="p">}&gt;</span><span class="nx">Add</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">Cart</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">inStock</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;out-of-stock&quot;</span><span class="p">&gt;</span><span class="nx">Out</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">Stock</span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">)}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Step 3: Attempt to Build</strong></p>
<p>Run the TypeScript compiler:</p>
<div class="codehilite"><pre><span></span><code>npx<span class="w"> </span>tsc<span class="w"> </span>--noEmit
</code></pre></div>

<p><strong>Terminal Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>src/components/ProductCard.tsx:18:25<span class="w"> </span>-<span class="w"> </span>error<span class="w"> </span>TS2532:
Object<span class="w"> </span>is<span class="w"> </span>possibly<span class="w"> </span><span class="s1">&#39;undefined&#39;</span>.

<span class="m">18</span><span class="w">           </span><span class="o">{</span>formatPrice<span class="o">(</span>product.originalPrice!<span class="o">)}</span>
<span class="w">                           </span>~~~~~~~~~~~~~~~~~~~~~

src/utils/formatPrice.js:1:1<span class="w"> </span>-<span class="w"> </span>error<span class="w"> </span>TS7016:
Could<span class="w"> </span>not<span class="w"> </span>find<span class="w"> </span>a<span class="w"> </span>declaration<span class="w"> </span>file<span class="w"> </span><span class="k">for</span><span class="w"> </span>module<span class="w"> </span><span class="s1">&#39;../utils/formatPrice&#39;</span>.
<span class="s1">&#39;/src/utils/formatPrice.js&#39;</span><span class="w"> </span>implicitly<span class="w"> </span>has<span class="w"> </span>an<span class="w"> </span><span class="s1">&#39;any&#39;</span><span class="w"> </span>type.

<span class="m">1</span><span class="w"> </span>import<span class="w"> </span><span class="o">{</span><span class="w"> </span>formatPrice<span class="w"> </span><span class="o">}</span><span class="w"> </span>from<span class="w"> </span><span class="s1">&#39;../utils/formatPrice&#39;</span><span class="p">;</span>
<span class="w">  </span>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Found<span class="w"> </span><span class="m">2</span><span class="w"> </span>errors.
</code></pre></div>

<p><strong>Diagnostic Analysis: Reading TypeScript's Feedback</strong></p>
<p><strong>Terminal Output</strong>: Two distinct errors</p>
<p><strong>Let's parse this evidence</strong>:</p>
<ol>
<li><strong>Error 1: <code>Object is possibly 'undefined'</code></strong></li>
<li>Location: Line 18, <code>product.originalPrice</code></li>
<li>Cause: We marked <code>originalPrice</code> as optional (<code>originalPrice?: number</code>)</li>
<li>TypeScript sees: "You're accessing a property that might not exist"</li>
<li>
<p>The <code>!</code> (non-null assertion) is a temporary workaround, but TypeScript still warns us</p>
</li>
<li>
<p><strong>Error 2: <code>Could not find a declaration file</code></strong></p>
</li>
<li>Location: Import statement for <code>formatPrice</code></li>
<li>Cause: <code>formatPrice.js</code> is still JavaScript, no type information</li>
<li>TypeScript sees: "I don't know what this function returns or what parameters it accepts"</li>
</ol>
<p><strong>Root cause identified</strong>: We're mixing TypeScript and JavaScript files, and TypeScript can't infer types across the boundary.</p>
<p><strong>What we need</strong>: Either migrate <code>formatPrice.js</code> to TypeScript, or add type declarations for it.</p>
<h3 id="iteration-2-fixing-the-type-errors">Iteration 2: Fixing the Type Errors</h3>
<p><strong>Current state recap</strong>: We've added types to <code>ProductCard</code>, but TypeScript found two issues: optional property access and untyped JavaScript imports.</p>
<p><strong>Current limitation</strong>: Can't build because of type errors.</p>
<p><strong>Solution 1: Fix the Optional Property Access</strong></p>
<p>The <code>originalPrice</code> is only present when <code>onSale</code> is true. We need to check both conditions:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/ProductCard.tsx (Fixed)</span>
<span class="k">import</span><span class="w"> </span><span class="nx">React</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">formatPrice</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../utils/formatPrice&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Product</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/product&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">ProductCardProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">product</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onAddToCart</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">product</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductCard</span><span class="p">({</span><span class="w"> </span><span class="nx">product</span><span class="p">,</span><span class="w"> </span><span class="nx">onAddToCart</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">ProductCardProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">onAddToCart</span><span class="p">(</span><span class="nx">product</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;product-card&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">img</span><span class="w"> </span><span class="na">src</span><span class="o">=</span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">imageUrl</span><span class="p">}</span><span class="w"> </span><span class="na">alt</span><span class="o">=</span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;{</span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="p">}&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;{</span><span class="nx">product</span><span class="p">.</span><span class="nx">description</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;price&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">onSale</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">product</span><span class="p">.</span><span class="nx">originalPrice</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="kc">undefined</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;original-price&quot;</span><span class="p">&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="nx">formatPrice</span><span class="p">(</span><span class="nx">product</span><span class="p">.</span><span class="nx">originalPrice</span><span class="p">)}</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;current-price&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">{</span><span class="nx">formatPrice</span><span class="p">(</span><span class="nx">product</span><span class="p">.</span><span class="nx">price</span><span class="p">)}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleClick</span><span class="p">}&gt;</span><span class="nx">Add</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">Cart</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">inStock</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;out-of-stock&quot;</span><span class="p">&gt;</span><span class="nx">Out</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">Stock</span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">)}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Solution 2: Migrate formatPrice to TypeScript</strong></p>
<p>Rename <code>formatPrice.js</code> ‚Üí <code>formatPrice.ts</code> and add type annotations:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/utils/formatPrice.ts</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">formatPrice</span><span class="p">(</span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Intl</span><span class="p">.</span><span class="nx">NumberFormat</span><span class="p">(</span><span class="s1">&#39;en-US&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">style</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;currency&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">currency</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;USD&#39;</span>
<span class="w">  </span><span class="p">}).</span><span class="nx">format</span><span class="p">(</span><span class="nx">price</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Verification: Build Again</strong></p>
<div class="codehilite"><pre><span></span><code>npx<span class="w"> </span>tsc<span class="w"> </span>--noEmit
</code></pre></div>

<p><strong>Terminal Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>‚úì<span class="w"> </span>No<span class="w"> </span>errors<span class="w"> </span>found
</code></pre></div>

<p><strong>Success!</strong> The component now compiles. But more importantly, let's see what TypeScript prevents:</p>
<p><strong>Attempting to Pass Invalid Data</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/ProductList.tsx</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">ProductCard</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./ProductCard&#39;</span><span class="p">;</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">ProductList</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// This would have caused a runtime error in JavaScript</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">invalidProduct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;123&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;eBook&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;A digital download&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="kt">9.99</span><span class="p">,</span>
<span class="w">    </span><span class="nx">imageUrl</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;/ebook.jpg&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">inStock</span><span class="o">:</span><span class="w"> </span><span class="kt">null</span><span class="p">,</span><span class="w">  </span><span class="c1">// ‚Üê TypeScript error!</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">ProductCard</span><span class="w"> </span>
<span class="w">      </span><span class="na">product</span><span class="o">=</span><span class="p">{</span><span class="nx">invalidProduct</span><span class="p">}</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">‚Üê</span><span class="w"> </span><span class="na">Error</span><span class="w"> </span><span class="na">here</span>
<span class="w">      </span><span class="na">onAddToCart</span><span class="o">=</span><span class="p">{(</span><span class="nx">p</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">p</span><span class="p">)}</span>
<span class="w">    </span><span class="p">/&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Terminal Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>src/components/ProductList.tsx:15:7<span class="w"> </span>-<span class="w"> </span>error<span class="w"> </span>TS2322:
Type<span class="w"> </span><span class="s1">&#39;null&#39;</span><span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>assignable<span class="w"> </span>to<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;boolean&#39;</span>.

<span class="m">15</span><span class="w">       </span>inStock:<span class="w"> </span>null,
<span class="w">         </span>~~~~~~~

src/components/ProductList.tsx:19:7<span class="w"> </span>-<span class="w"> </span>error<span class="w"> </span>TS2322:
Type<span class="w"> </span><span class="s1">&#39;{ id: string; name: string; ...; inStock: null; }&#39;</span><span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>assignable<span class="w"> </span>to<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;Product&#39;</span>.
<span class="w">  </span>Types<span class="w"> </span>of<span class="w"> </span>property<span class="w"> </span><span class="s1">&#39;inStock&#39;</span><span class="w"> </span>are<span class="w"> </span>incompatible.
<span class="w">    </span>Type<span class="w"> </span><span class="s1">&#39;null&#39;</span><span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>assignable<span class="w"> </span>to<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;boolean&#39;</span>.

<span class="m">19</span><span class="w">       </span><span class="nv">product</span><span class="o">={</span>invalidProduct<span class="o">}</span>
<span class="w">         </span>~~~~~~~
</code></pre></div>

<p><strong>Expected vs. Actual Improvement</strong>:</p>
<p><strong>Before (JavaScript)</strong>:
- Invalid data flows through the application
- Runtime error in checkout flow
- Customer sees white screen
- Error discovered in production</p>
<p><strong>After (TypeScript)</strong>:
- Invalid data caught at compile time
- Error shown in editor with red squiggle
- Build fails before deployment
- Error discovered during development</p>
<p><strong>When to Apply This Solution</strong>:</p>
<p><strong>What it optimizes for</strong>: Catching data shape errors before runtime</p>
<p><strong>What it sacrifices</strong>: Initial migration effort, learning curve</p>
<p><strong>When to choose this approach</strong>:
- You have a codebase with frequent runtime type errors
- Multiple developers work on the same data structures
- You want editor autocomplete and refactoring support
- You're building a long-lived application</p>
<p><strong>When to avoid this approach</strong>:
- Prototyping or throwaway code
- Very small projects (&lt; 500 lines)
- Team strongly resists TypeScript
- Tight deadline with no time for migration</p>
<p><strong>Code characteristics</strong>:
- Setup complexity: Medium (initial migration takes time)
- Maintenance burden: Lower (types document expected shapes)
- Performance impact: None (types are erased at runtime)</p>
<h3 id="iteration-3-migrating-the-api-client">Iteration 3: Migrating the API Client</h3>
<p><strong>Current state recap</strong>: We've migrated <code>ProductCard</code> and <code>formatPrice</code> to TypeScript, and TypeScript now catches invalid product data at compile time.</p>
<p><strong>Current limitation</strong>: The API client (<code>api.js</code>) still returns <code>any</code>, so we lose type safety at the data boundary.</p>
<p><strong>New scenario introduction</strong>: What happens when the API returns unexpected data?</p>
<p><strong>The Failure: API Returns Unexpected Shape</strong></p>
<p>The backend team deployed a change: they renamed <code>imageUrl</code> ‚Üí <code>image_url</code> (snake_case). The API now returns:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;123&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Laptop&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;image_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;laptop.jpg&quot;</span><span class="p">,</span><span class="w">  </span><span class="c1">// ‚Üê Changed from imageUrl</span>
<span class="w">  </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">999.99</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;inStock&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Browser Behavior</strong>:
- Product cards render
- Images don't load (broken image icon)
- No console errors
- No TypeScript errors</p>
<p><strong>Browser Console Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>GET http://localhost:3000/undefined 404 (Not Found)
</code></pre></div>

<p><strong>React DevTools Evidence</strong>:
- <code>ProductCard</code> props: <code>{ product: { ..., imageUrl: undefined, image_url: "laptop.jpg" } }</code>
- The component received the wrong property name</p>
<p><strong>Diagnostic Analysis: The Type Boundary Problem</strong></p>
<p><strong>Let's parse this evidence</strong>:</p>
<ol>
<li>
<p><strong>What the user experiences</strong>: Broken images, but no obvious error</p>
</li>
<li>
<p><strong>What the console reveals</strong>: 404 error for <code>undefined</code> URL‚Äîthe <code>imageUrl</code> property doesn't exist</p>
</li>
<li>
<p><strong>What DevTools shows</strong>: The API returned <code>image_url</code>, but our component expects <code>imageUrl</code></p>
</li>
<li>
<p><strong>Root cause identified</strong>: TypeScript can't validate data from external sources (APIs, localStorage, user input)</p>
</li>
<li>
<p><strong>Why the current approach can't solve this</strong>: The API client returns <code>any</code>, so TypeScript assumes the data is correct</p>
</li>
<li>
<p><strong>What we need</strong>: Runtime validation at the API boundary to ensure data matches our types</p>
</li>
</ol>
<h3 id="solution-type-safe-api-client-with-runtime-validation">Solution: Type-Safe API Client with Runtime Validation</h3>
<p>Migrate <code>api.js</code> ‚Üí <code>api.ts</code> and add runtime validation:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/utils/api.ts</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Product</span><span class="p">,</span><span class="w"> </span><span class="nx">isProduct</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/product&#39;</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * Custom error for API validation failures.</span>
<span class="cm"> * Includes the invalid data for debugging.</span>
<span class="cm"> */</span>
<span class="k">export</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nx">ValidationError</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kr">constructor</span><span class="p">(</span>
<span class="w">    </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">readonly</span><span class="w"> </span><span class="nx">invalidData</span><span class="o">:</span><span class="w"> </span><span class="kt">unknown</span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">super</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ValidationError&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Fetch all products from the API.</span>
<span class="cm"> * Validates each product matches the Product type.</span>
<span class="cm"> * @throws {ValidationError} if any product fails validation</span>
<span class="cm"> */</span>
<span class="k">export</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">fetchProducts</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Product</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/api/products&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`HTTP </span><span class="si">${</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="si">}</span><span class="sb">: </span><span class="si">${</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusText</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// Validate the response is an array</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">data</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">ValidationError</span><span class="p">(</span>
<span class="w">      </span><span class="s1">&#39;API returned non-array response&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">data</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Validate each product</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">products</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">isProduct</span><span class="p">(</span><span class="nx">item</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">ValidationError</span><span class="p">(</span>
<span class="w">        </span><span class="sb">`Invalid product at index </span><span class="si">${</span><span class="nx">i</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
<span class="w">        </span><span class="nx">item</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">products</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">products</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Add a product to the shopping cart.</span>
<span class="cm"> * @returns The updated cart data</span>
<span class="cm"> */</span>
<span class="k">export</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">addToCart</span><span class="p">(</span>
<span class="w">  </span><span class="nx">productId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<span class="w">  </span><span class="nx">quantity</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span>
<span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="p">{</span><span class="w"> </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span><span class="w"> </span><span class="nx">cartTotal</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">}</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/api/cart&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">({</span><span class="w"> </span><span class="nx">productId</span><span class="p">,</span><span class="w"> </span><span class="nx">quantity</span><span class="w"> </span><span class="p">})</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`HTTP </span><span class="si">${</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="si">}</span><span class="sb">: </span><span class="si">${</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusText</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// Validate the response shape</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;object&#39;</span><span class="w"> </span><span class="o">||</span>
<span class="w">    </span><span class="nx">data</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span>
<span class="w">    </span><span class="ow">typeof</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">any</span><span class="p">).</span><span class="nx">success</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;boolean&#39;</span><span class="w"> </span><span class="o">||</span>
<span class="w">    </span><span class="ow">typeof</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">any</span><span class="p">).</span><span class="nx">cartTotal</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;number&#39;</span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">ValidationError</span><span class="p">(</span>
<span class="w">      </span><span class="s1">&#39;Invalid cart response from API&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">data</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span><span class="w"> </span><span class="nx">cartTotal</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">};</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Verification: Catching API Shape Mismatches</strong></p>
<p>Now when the API returns the wrong shape:</p>
<p><strong>Browser Console Output</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">ValidationError</span><span class="p">:</span><span class="w"> </span><span class="n">Invalid</span><span class="w"> </span><span class="n">product</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="mi">0</span>
<span class="w">  </span><span class="n">at</span><span class="w"> </span><span class="n">fetchProducts</span><span class="w"> </span><span class="p">(</span><span class="n">api</span><span class="o">.</span><span class="n">ts</span><span class="p">:</span><span class="mi">45</span><span class="p">)</span>
<span class="w">  </span><span class="n">at</span><span class="w"> </span><span class="n">ProductList</span><span class="o">.</span><span class="n">loadProducts</span><span class="w"> </span><span class="p">(</span><span class="n">ProductList</span><span class="o">.</span><span class="n">tsx</span><span class="p">:</span><span class="mi">12</span><span class="p">)</span>

<span class="n">Invalid</span><span class="w"> </span><span class="n">data</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;123&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Laptop&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s2">&quot;image_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;laptop.jpg&quot;</span><span class="p">,</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="err">‚Üê</span><span class="w"> </span><span class="n">Wrong</span><span class="w"> </span><span class="n">property</span><span class="w"> </span><span class="n">name</span>
<span class="w">  </span><span class="s2">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">999.99</span><span class="p">,</span>
<span class="w">  </span><span class="s2">&quot;inStock&quot;</span><span class="p">:</span><span class="w"> </span><span class="bp">true</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Expected vs. Actual Improvement</strong>:</p>
<p><strong>Before (Untyped API)</strong>:
- API returns wrong shape
- Component receives <code>undefined</code> for <code>imageUrl</code>
- Broken images, no clear error
- Developer spends 30 minutes debugging</p>
<p><strong>After (Type-Safe API)</strong>:
- API returns wrong shape
- Runtime validation catches it immediately
- Clear error message with invalid data
- Developer sees exactly what's wrong in 30 seconds</p>
<p><strong>Limitation preview</strong>: This works great for simple types, but what about complex nested objects or third-party APIs with hundreds of fields? We'll address that in Section 9.2 with Zod.</p>
<h3 id="the-migration-journey-so-far">The Migration Journey So Far</h3>
<table>
<thead>
<tr>
<th>File</th>
<th>Status</th>
<th>Type Safety</th>
<th>Runtime Validation</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ProductCard.tsx</code></td>
<td>‚úÖ Migrated</td>
<td>Full</td>
<td>N/A (props validated by caller)</td>
</tr>
<tr>
<td><code>formatPrice.ts</code></td>
<td>‚úÖ Migrated</td>
<td>Full</td>
<td>N/A (simple function)</td>
</tr>
<tr>
<td><code>api.ts</code></td>
<td>‚úÖ Migrated</td>
<td>Full</td>
<td>‚úÖ Manual validation</td>
</tr>
<tr>
<td><code>ProductList.jsx</code></td>
<td>‚è≥ Pending</td>
<td>None</td>
<td>None</td>
</tr>
<tr>
<td><code>ShoppingCart.jsx</code></td>
<td>‚è≥ Pending</td>
<td>None</td>
<td>None</td>
</tr>
</tbody>
</table>
<h3 id="lessons-learned-incremental-migration-strategy">Lessons Learned: Incremental Migration Strategy</h3>
<p><strong>1. Start with data structures</strong>: Define types for your core domain objects first (Product, User, Order, etc.)</p>
<p><strong>2. Migrate from the inside out</strong>: Start with leaf components (ProductCard) before parent components (ProductList)</p>
<p><strong>3. Add runtime validation at boundaries</strong>: APIs, localStorage, user input‚Äîanywhere data enters your application</p>
<p><strong>4. Use type guards for validation</strong>: The <code>isProduct</code> function serves double duty: runtime validation and TypeScript type narrowing</p>
<p><strong>5. Don't use <code>any</code> as a crutch</strong>: If you don't know the type, use <code>unknown</code> and validate it</p>
<p><strong>6. Leverage TypeScript's incremental mode</strong>: You can mix <code>.js</code> and <code>.ts</code> files during migration‚ÄîTypeScript will check what it can</p>
<p><strong>Next</strong>: In Section 9.2, we'll replace our manual validation with Zod, a runtime validation library that generates TypeScript types automatically.</p>
<h2 id="type-safe-api-clients">Type-safe API clients</h2>
<h2 id="type-safe-api-clients_1">Type-Safe API Clients</h2>
<p>In Section 9.1, we manually wrote runtime validation for our API responses. It worked, but it was tedious and error-prone. For every new field, we had to:</p>
<ol>
<li>Add it to the TypeScript interface</li>
<li>Add a validation check in the type guard</li>
<li>Keep both in sync manually</li>
</ol>
<p>This doesn't scale. Professional teams use <strong>schema validation libraries</strong> that define the shape once and generate both runtime validation and TypeScript types automatically.</p>
<h3 id="the-problem-with-manual-validation">The Problem with Manual Validation</h3>
<p>Let's see what happens when our Product type grows:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/types/product.ts (Growing complexity)</span>
<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">Product</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">imageUrl</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">inStock</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onSale?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">originalPrice?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// New fields added over time</span>
<span class="w">  </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">tags</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">rating</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">reviewCount</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dimensions</span><span class="o">?:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">width</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">depth</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">weight</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="nx">variants?</span><span class="o">:</span><span class="w"> </span><span class="kt">Array</span><span class="o">&lt;</span><span class="p">{</span>
<span class="w">    </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">    </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">inStock</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// The type guard becomes a nightmare</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">isProduct</span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">unknown</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">Product</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;object&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">unknown</span><span class="o">&gt;</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Basic fields</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">description</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">price</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;number&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">imageUrl</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">inStock</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;boolean&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Optional fields</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">onSale</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="kc">undefined</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">onSale</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;boolean&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">originalPrice</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="kc">undefined</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">originalPrice</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;number&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// New fields</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">category</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">tags</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">obj</span><span class="p">.</span><span class="nx">tags</span><span class="p">.</span><span class="nx">every</span><span class="p">(</span><span class="nx">tag</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">rating</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;number&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">reviewCount</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;number&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Nested optional object</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">dimensions</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="kc">undefined</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">dimensions</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;object&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">dimensions</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">dims</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">dimensions</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">unknown</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">dims</span><span class="p">.</span><span class="nx">width</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;number&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">dims</span><span class="p">.</span><span class="nx">height</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;number&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">dims</span><span class="p">.</span><span class="nx">depth</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;number&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">dims</span><span class="p">.</span><span class="nx">weight</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;number&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Array of nested objects</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">variants</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="kc">undefined</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">variants</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">variant</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">variants</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">variant</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;object&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">variant</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">variant</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">unknown</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">v</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">v</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">v</span><span class="p">.</span><span class="nx">price</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;number&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">v</span><span class="p">.</span><span class="nx">inStock</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;boolean&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>The Failure: Validation and Types Drift Apart</strong></p>
<p>A developer adds a new field to the <code>Product</code> interface but forgets to update the type guard:</p>
<div class="codehilite"><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">Product</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// ... existing fields ...</span>
<span class="w">  </span><span class="nx">shippingWeight?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w">  </span><span class="c1">// ‚Üê Added to interface</span>
<span class="p">}</span>

<span class="c1">// Type guard NOT updated</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">isProduct</span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">unknown</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">Product</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// ... validation doesn&#39;t check shippingWeight ...</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Browser Behavior</strong>:
- API returns product with <code>shippingWeight: "5kg"</code> (string instead of number)
- Type guard passes (doesn't check this field)
- TypeScript thinks it's a number
- Shipping calculation crashes: <code>shippingWeight.toFixed(2)</code> fails</p>
<p><strong>Browser Console Output</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">TypeError</span><span class="o">:</span><span class="w"> </span><span class="n">shippingWeight</span><span class="o">.</span><span class="na">toFixed</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="kd">function</span>
<span class="w">  </span><span class="n">at</span><span class="w"> </span><span class="n">calculateShipping</span><span class="w"> </span><span class="o">(</span><span class="n">shipping</span><span class="o">.</span><span class="na">ts</span><span class="o">:</span><span class="mi">23</span><span class="o">)</span>
<span class="w">  </span><span class="n">at</span><span class="w"> </span><span class="n">ShoppingCart</span><span class="o">.</span><span class="na">render</span><span class="w"> </span><span class="o">(</span><span class="n">ShoppingCart</span><span class="o">.</span><span class="na">tsx</span><span class="o">:</span><span class="mi">45</span><span class="o">)</span>
</code></pre></div>

<p><strong>Diagnostic Analysis: The Sync Problem</strong></p>
<p><strong>Let's parse this evidence</strong>:</p>
<ol>
<li>
<p><strong>What the user experiences</strong>: Checkout crashes when calculating shipping</p>
</li>
<li>
<p><strong>What the console reveals</strong>: Trying to call <code>.toFixed()</code> on a string</p>
</li>
<li>
<p><strong>What DevTools shows</strong>: <code>shippingWeight</code> is <code>"5kg"</code> (string), but TypeScript thinks it's a number</p>
</li>
<li>
<p><strong>Root cause identified</strong>: Type definition and runtime validation are separate, manually maintained, and drifted apart</p>
</li>
<li>
<p><strong>Why manual validation can't solve this</strong>: Human error‚Äîit's too easy to update one without the other</p>
</li>
<li>
<p><strong>What we need</strong>: A single source of truth that generates both TypeScript types and runtime validation</p>
</li>
</ol>
<h3 id="iteration-1-introducing-zod">Iteration 1: Introducing Zod</h3>
<p><strong>Zod</strong> is a TypeScript-first schema validation library. You define the shape once, and Zod generates:
- Runtime validation
- TypeScript types
- Detailed error messages</p>
<p>Install Zod:</p>
<div class="codehilite"><pre><span></span><code>npm<span class="w"> </span>install<span class="w"> </span>zod
</code></pre></div>

<p>Let's rewrite our Product type using Zod:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/types/product.ts (Zod version)</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">z</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;zod&#39;</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * Product schema - single source of truth for shape and validation.</span>
<span class="cm"> * TypeScript types are inferred automatically from this schema.</span>
<span class="cm"> */</span>
<span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">ProductSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="nx">positive</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">imageUrl</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">().</span><span class="nx">url</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">inStock</span><span class="o">:</span><span class="w"> </span><span class="kt">z.boolean</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">onSale</span><span class="o">:</span><span class="w"> </span><span class="kt">z.boolean</span><span class="p">().</span><span class="nx">optional</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">originalPrice</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="nx">positive</span><span class="p">().</span><span class="nx">optional</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">tags</span><span class="o">:</span><span class="w"> </span><span class="kt">z.array</span><span class="p">(</span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">()),</span>
<span class="w">  </span><span class="nx">rating</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">max</span><span class="p">(</span><span class="mf">5</span><span class="p">),</span>
<span class="w">  </span><span class="nx">reviewCount</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="kr">int</span><span class="p">().</span><span class="nx">nonnegative</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">dimensions</span><span class="o">:</span><span class="w"> </span><span class="kt">z.object</span><span class="p">({</span>
<span class="w">    </span><span class="nx">width</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="nx">positive</span><span class="p">(),</span>
<span class="w">    </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="nx">positive</span><span class="p">(),</span>
<span class="w">    </span><span class="nx">depth</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="nx">positive</span><span class="p">(),</span>
<span class="w">    </span><span class="nx">weight</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="nx">positive</span><span class="p">(),</span>
<span class="w">  </span><span class="p">}).</span><span class="nx">optional</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">variants</span><span class="o">:</span><span class="w"> </span><span class="kt">z.array</span><span class="p">(</span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<span class="w">    </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">(),</span>
<span class="w">    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">(),</span>
<span class="w">    </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="nx">positive</span><span class="p">(),</span>
<span class="w">    </span><span class="nx">inStock</span><span class="o">:</span><span class="w"> </span><span class="kt">z.boolean</span><span class="p">(),</span>
<span class="w">  </span><span class="p">})).</span><span class="nx">optional</span><span class="p">(),</span>
<span class="p">});</span>

<span class="cm">/**</span>
<span class="cm"> * TypeScript type inferred from the schema.</span>
<span class="cm"> * This is automatically kept in sync with the schema.</span>
<span class="cm"> */</span>
<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">Product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">infer</span><span class="o">&lt;</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">ProductSchema</span><span class="o">&gt;</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * Validate unknown data against the Product schema.</span>
<span class="cm"> * Returns the validated data or throws a detailed error.</span>
<span class="cm"> */</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">validateProduct</span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">unknown</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Product</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">ProductSchema</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Safe validation that returns a result object instead of throwing.</span>
<span class="cm"> * Use this when you want to handle validation errors gracefully.</span>
<span class="cm"> */</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">safeValidateProduct</span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">unknown</span><span class="p">)</span><span class="o">:</span><span class="w"> </span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">;</span><span class="w"> </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">Product</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">;</span><span class="w"> </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="kt">z.ZodError</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ProductSchema</span><span class="p">.</span><span class="nx">safeParse</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">result</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Key Improvements</strong>:</p>
<ol>
<li><strong>Single source of truth</strong>: The schema defines both shape and validation</li>
<li><strong>Type inference</strong>: <code>type Product = z.infer&lt;typeof ProductSchema&gt;</code> automatically generates the TypeScript type</li>
<li><strong>Built-in validation</strong>: <code>.positive()</code>, <code>.url()</code>, <code>.min()</code>, <code>.max()</code> provide rich validation</li>
<li><strong>Detailed errors</strong>: Zod tells you exactly what's wrong and where</li>
</ol>
<p>Now let's update the API client to use Zod:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/utils/api.ts (Zod version)</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">z</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;zod&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Product</span><span class="p">,</span><span class="w"> </span><span class="nx">ProductSchema</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/product&#39;</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * Fetch all products from the API.</span>
<span class="cm"> * Validates each product using Zod schema.</span>
<span class="cm"> */</span>
<span class="k">export</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">fetchProducts</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Product</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/api/products&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`HTTP </span><span class="si">${</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="si">}</span><span class="sb">: </span><span class="si">${</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusText</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// Validate the entire response as an array of products</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">ProductArraySchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">array</span><span class="p">(</span><span class="nx">ProductSchema</span><span class="p">);</span>

<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">ProductArraySchema</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">ZodError</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Product validation failed:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">format</span><span class="p">());</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Invalid product data: </span><span class="si">${</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="nx">error</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Cart response schema</span>
<span class="cm"> */</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">CartResponseSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<span class="w">  </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kt">z.boolean</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">cartTotal</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="nx">nonnegative</span><span class="p">(),</span>
<span class="p">});</span>

<span class="k">export</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">addToCart</span><span class="p">(</span>
<span class="w">  </span><span class="nx">productId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<span class="w">  </span><span class="nx">quantity</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span>
<span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">z</span><span class="p">.</span><span class="nx">infer</span><span class="o">&lt;</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">CartResponseSchema</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/api/cart&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">({</span><span class="w"> </span><span class="nx">productId</span><span class="p">,</span><span class="w"> </span><span class="nx">quantity</span><span class="w"> </span><span class="p">})</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`HTTP </span><span class="si">${</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="si">}</span><span class="sb">: </span><span class="si">${</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusText</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">CartResponseSchema</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Verification: Catching Invalid Data with Detailed Errors</strong></p>
<p>When the API returns invalid data:</p>
<p><strong>Scenario 1: Wrong Type</strong></p>
<p>API returns:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;123&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Laptop&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;999.99&quot;</span><span class="p">,</span><span class="w">  </span><span class="c1">// ‚Üê String instead of number</span>
<span class="w">  </span><span class="nt">&quot;imageUrl&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;laptop.jpg&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;inStock&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;category&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;electronics&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;tags&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;laptop&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;computer&quot;</span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;rating&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">4.5</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;reviewCount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">42</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Browser Console Output</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="nx">Product</span><span class="w"> </span><span class="nx">validation</span><span class="w"> </span><span class="nx">failed</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">price</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">_errors</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">&#39;</span><span class="nx">Expected</span><span class="w"> </span><span class="nx">number</span><span class="p">,</span><span class="w"> </span><span class="nx">received</span><span class="w"> </span><span class="kt">string</span><span class="err">&#39;</span><span class="p">]</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="nx">Error</span><span class="p">:</span><span class="w"> </span><span class="nx">Invalid</span><span class="w"> </span><span class="nx">product</span><span class="w"> </span><span class="nx">data</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="s">&quot;code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;invalid_type&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;expected&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;number&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;received&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;string&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;path&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;price&quot;</span><span class="p">],</span>
<span class="w">    </span><span class="s">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Expected number, received string&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">]</span>
</code></pre></div>

<p><strong>Scenario 2: Missing Required Field</strong></p>
<p>API returns:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;123&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Laptop&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">999.99</span><span class="p">,</span>
<span class="w">  </span><span class="c1">// ‚Üê Missing imageUrl</span>
<span class="w">  </span><span class="nt">&quot;inStock&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;category&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;electronics&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;tags&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;laptop&quot;</span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;rating&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">4.5</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;reviewCount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">42</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Browser Console Output</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="nx">Product</span><span class="w"> </span><span class="nx">validation</span><span class="w"> </span><span class="nx">failed</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">imageUrl</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">_errors</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">&#39;</span><span class="nx">Required</span><span class="err">&#39;</span><span class="p">]</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="nx">Error</span><span class="p">:</span><span class="w"> </span><span class="nx">Invalid</span><span class="w"> </span><span class="nx">product</span><span class="w"> </span><span class="nx">data</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="s">&quot;code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;invalid_type&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;expected&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;string&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;received&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;undefined&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;path&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;imageUrl&quot;</span><span class="p">],</span>
<span class="w">    </span><span class="s">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Required&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">]</span>
</code></pre></div>

<p><strong>Scenario 3: Invalid URL Format</strong></p>
<p>API returns:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;123&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Laptop&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">999.99</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;imageUrl&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;not-a-url&quot;</span><span class="p">,</span><span class="w">  </span><span class="c1">// ‚Üê Invalid URL</span>
<span class="w">  </span><span class="nt">&quot;inStock&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;category&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;electronics&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;tags&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;laptop&quot;</span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;rating&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">4.5</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;reviewCount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">42</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Browser Console Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>Product validation failed: {
  imageUrl: {
    _errors: [&#39;Invalid url&#39;]
  }
}
</code></pre></div>

<p><strong>Expected vs. Actual Improvement</strong>:</p>
<p><strong>Before (Manual Validation)</strong>:
- 50+ lines of validation code
- Easy to forget fields
- Generic error messages
- Type and validation can drift apart</p>
<p><strong>After (Zod)</strong>:
- 20 lines of schema definition
- Impossible to forget fields (schema is the source of truth)
- Detailed, structured error messages
- Type and validation always in sync</p>
<h3 id="iteration-2-advanced-zod-patterns">Iteration 2: Advanced Zod Patterns</h3>
<p><strong>Current state recap</strong>: We're using Zod for basic validation, and it's already better than manual validation.</p>
<p><strong>Current limitation</strong>: Real-world APIs have more complex requirements‚Äîtransformations, conditional fields, custom validation.</p>
<p><strong>New scenario introduction</strong>: What if we need to:
- Transform API data (e.g., convert cents to dollars)
- Validate relationships between fields (e.g., <code>originalPrice</code> must be greater than <code>price</code> when <code>onSale</code> is true)
- Handle API versioning (different shapes for different API versions)</p>
<p>Let's add these capabilities:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/types/product.ts (Advanced Zod patterns)</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">z</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;zod&#39;</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * Product schema with transformations and custom validation</span>
<span class="cm"> */</span>
<span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">ProductSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Product name cannot be empty&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">(),</span>

<span class="w">  </span><span class="c1">// Transform: API returns price in cents, we want dollars</span>
<span class="w">  </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="kr">int</span><span class="p">().</span><span class="nx">positive</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="nx">transform</span><span class="p">(</span><span class="nx">cents</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">cents</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">100</span><span class="p">),</span>

<span class="w">  </span><span class="nx">imageUrl</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">().</span><span class="nx">url</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">inStock</span><span class="o">:</span><span class="w"> </span><span class="kt">z.boolean</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">onSale</span><span class="o">:</span><span class="w"> </span><span class="kt">z.boolean</span><span class="p">().</span><span class="nx">optional</span><span class="p">(),</span>

<span class="w">  </span><span class="c1">// Transform: API returns price in cents</span>
<span class="w">  </span><span class="nx">originalPrice</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="kr">int</span><span class="p">().</span><span class="nx">positive</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="nx">transform</span><span class="p">(</span><span class="nx">cents</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">cents</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">100</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="nx">optional</span><span class="p">(),</span>

<span class="w">  </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">tags</span><span class="o">:</span><span class="w"> </span><span class="kt">z.array</span><span class="p">(</span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">()),</span>

<span class="w">  </span><span class="c1">// Constrain rating to valid range</span>
<span class="w">  </span><span class="nx">rating</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">max</span><span class="p">(</span><span class="mf">5</span><span class="p">),</span>
<span class="w">  </span><span class="nx">reviewCount</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="kr">int</span><span class="p">().</span><span class="nx">nonnegative</span><span class="p">(),</span>

<span class="w">  </span><span class="nx">dimensions</span><span class="o">:</span><span class="w"> </span><span class="kt">z.object</span><span class="p">({</span>
<span class="w">    </span><span class="nx">width</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="nx">positive</span><span class="p">(),</span>
<span class="w">    </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="nx">positive</span><span class="p">(),</span>
<span class="w">    </span><span class="nx">depth</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="nx">positive</span><span class="p">(),</span>
<span class="w">    </span><span class="nx">weight</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="nx">positive</span><span class="p">(),</span>
<span class="w">  </span><span class="p">}).</span><span class="nx">optional</span><span class="p">(),</span>

<span class="w">  </span><span class="nx">variants</span><span class="o">:</span><span class="w"> </span><span class="kt">z.array</span><span class="p">(</span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<span class="w">    </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">(),</span>
<span class="w">    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">(),</span>
<span class="w">    </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="kr">int</span><span class="p">().</span><span class="nx">positive</span><span class="p">()</span>
<span class="w">      </span><span class="p">.</span><span class="nx">transform</span><span class="p">(</span><span class="nx">cents</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">cents</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">100</span><span class="p">),</span>
<span class="w">    </span><span class="nx">inStock</span><span class="o">:</span><span class="w"> </span><span class="kt">z.boolean</span><span class="p">(),</span>
<span class="w">  </span><span class="p">})).</span><span class="nx">optional</span><span class="p">(),</span>
<span class="p">})</span>
<span class="w">  </span><span class="c1">// Custom validation: if onSale is true, originalPrice must exist and be greater than price</span>
<span class="w">  </span><span class="p">.</span><span class="nx">refine</span><span class="p">(</span>
<span class="w">    </span><span class="p">(</span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">onSale</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">originalPrice</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="kc">undefined</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">originalPrice</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">price</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;When onSale is true, originalPrice must be greater than price&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">path</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;originalPrice&quot;</span><span class="p">],</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">);</span>

<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">Product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">infer</span><span class="o">&lt;</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">ProductSchema</span><span class="o">&gt;</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * API v1 schema - older API version with different field names</span>
<span class="cm"> */</span>
<span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">ProductSchemaV1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<span class="w">  </span><span class="nx">product_id</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">product_name</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">price_cents</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="kr">int</span><span class="p">().</span><span class="nx">positive</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">image_url</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">().</span><span class="nx">url</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">in_stock</span><span class="o">:</span><span class="w"> </span><span class="kt">z.boolean</span><span class="p">(),</span>
<span class="w">  </span><span class="c1">// ... other fields</span>
<span class="p">})</span>
<span class="w">  </span><span class="c1">// Transform to match our internal Product type</span>
<span class="w">  </span><span class="p">.</span><span class="nx">transform</span><span class="p">((</span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
<span class="w">    </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">data.product_id</span><span class="p">,</span>
<span class="w">    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">data.product_name</span><span class="p">,</span>
<span class="w">    </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="kt">data.price_cents</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span>
<span class="w">    </span><span class="nx">imageUrl</span><span class="o">:</span><span class="w"> </span><span class="kt">data.image_url</span><span class="p">,</span>
<span class="w">    </span><span class="nx">inStock</span><span class="o">:</span><span class="w"> </span><span class="kt">data.in_stock</span><span class="p">,</span>
<span class="w">    </span><span class="c1">// ... map other fields</span>
<span class="w">  </span><span class="p">}));</span>

<span class="cm">/**</span>
<span class="cm"> * Union type for handling multiple API versions</span>
<span class="cm"> */</span>
<span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">ProductSchemaAnyVersion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">union</span><span class="p">([</span>
<span class="w">  </span><span class="nx">ProductSchema</span><span class="p">,</span>
<span class="w">  </span><span class="nx">ProductSchemaV1</span><span class="p">,</span>
<span class="p">]);</span>
</code></pre></div>

<p><strong>Verification: Advanced Validation in Action</strong></p>
<p><strong>Scenario 1: Price Transformation</strong></p>
<p>API returns:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;123&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Laptop&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">99999</span><span class="p">,</span><span class="w">  </span><span class="c1">// ‚Üê 999.99 dollars in cents</span>
<span class="w">  </span><span class="nt">&quot;imageUrl&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://example.com/laptop.jpg&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;inStock&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;category&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;electronics&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;tags&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;laptop&quot;</span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;rating&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">4.5</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;reviewCount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">42</span>
<span class="p">}</span>
</code></pre></div>

<p>After validation:</p>
<div class="codehilite"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ProductSchema</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">apiData</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">product</span><span class="p">.</span><span class="nx">price</span><span class="p">);</span><span class="w">  </span><span class="c1">// 999.99 (transformed from cents)</span>
</code></pre></div>

<p><strong>Scenario 2: Custom Validation Failure</strong></p>
<p>API returns:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;123&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Laptop&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">99999</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;imageUrl&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://example.com/laptop.jpg&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;inStock&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;onSale&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;originalPrice&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">99999</span><span class="p">,</span><span class="w">  </span><span class="c1">// ‚Üê Same as price, should be higher</span>
<span class="w">  </span><span class="nt">&quot;category&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;electronics&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;tags&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;laptop&quot;</span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;rating&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">4.5</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;reviewCount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">42</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Browser Console Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>Product validation failed: {
  originalPrice: {
    _errors: [&#39;When onSale is true, originalPrice must be greater than price&#39;]
  }
}
</code></pre></div>

<p><strong>Scenario 3: API Version Handling</strong></p>
<p>Old API returns:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;product_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;123&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;product_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Laptop&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;price_cents&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">99999</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;image_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://example.com/laptop.jpg&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;in_stock&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ProductSchemaAnyVersion</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">oldApiData</span><span class="p">);</span>
<span class="c1">// Automatically transformed to match Product type</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">product</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span><span class="w">        </span><span class="c1">// &quot;123&quot;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span><span class="w">      </span><span class="c1">// &quot;Laptop&quot;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">product</span><span class="p">.</span><span class="nx">price</span><span class="p">);</span><span class="w">     </span><span class="c1">// 999.99</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">product</span><span class="p">.</span><span class="nx">imageUrl</span><span class="p">);</span><span class="w">  </span><span class="c1">// &quot;https://example.com/laptop.jpg&quot;</span>
</code></pre></div>

<h3 id="iteration-3-type-safe-api-client-with-error-handling">Iteration 3: Type-Safe API Client with Error Handling</h3>
<p><strong>Current state recap</strong>: We have powerful Zod schemas with transformations and custom validation.</p>
<p><strong>Current limitation</strong>: When validation fails, we throw errors. But in production, we want graceful degradation‚Äîshow cached data, retry, or display a user-friendly error.</p>
<p><strong>Solution: Structured Error Handling</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/utils/api.ts (Production-ready version)</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">z</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;zod&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Product</span><span class="p">,</span><span class="w"> </span><span class="nx">ProductSchema</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/product&#39;</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * API error types for structured error handling</span>
<span class="cm"> */</span>
<span class="k">export</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nx">NetworkError</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kr">constructor</span><span class="p">(</span>
<span class="w">    </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">readonly</span><span class="w"> </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">,</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">readonly</span><span class="w"> </span><span class="nx">statusText</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">super</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;NetworkError&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nx">ValidationError</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kr">constructor</span><span class="p">(</span>
<span class="w">    </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">readonly</span><span class="w"> </span><span class="nx">zodError</span><span class="o">:</span><span class="w"> </span><span class="kt">z.ZodError</span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">super</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ValidationError&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Result type for operations that can fail</span>
<span class="cm"> */</span>
<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">Result</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span><span class="w"> </span><span class="nx">E</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ne">Error</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">;</span><span class="w"> </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">T</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">;</span><span class="w"> </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="kt">E</span><span class="w"> </span><span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Fetch products with structured error handling.</span>
<span class="cm"> * Returns a Result type instead of throwing.</span>
<span class="cm"> */</span>
<span class="k">export</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">fetchProducts</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Result</span><span class="o">&lt;</span><span class="nx">Product</span><span class="p">[],</span><span class="w"> </span><span class="nx">NetworkError</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nx">ValidationError</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/api/products&#39;</span><span class="p">);</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nx">NetworkError</span><span class="p">(</span>
<span class="w">          </span><span class="sb">`Failed to fetch products`</span><span class="p">,</span>
<span class="w">          </span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="p">,</span>
<span class="w">          </span><span class="nx">response</span><span class="p">.</span><span class="nx">statusText</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">ProductArraySchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">array</span><span class="p">(</span><span class="nx">ProductSchema</span><span class="p">);</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ProductArraySchema</span><span class="p">.</span><span class="nx">safeParse</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">result</span><span class="p">.</span><span class="nx">success</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nx">ValidationError</span><span class="p">(</span>
<span class="w">          </span><span class="s1">&#39;Invalid product data from API&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">result</span><span class="p">.</span><span class="nx">error</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">result.data</span><span class="w"> </span><span class="p">};</span>

<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Network error (fetch failed)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
<span class="w">      </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nx">NetworkError</span><span class="p">(</span>
<span class="w">        </span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown network error&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="mf">0</span><span class="p">,</span>
<span class="w">        </span><span class="s1">&#39;Network request failed&#39;</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Add to cart with structured error handling</span>
<span class="cm"> */</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">CartResponseSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<span class="w">  </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kt">z.boolean</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">cartTotal</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="nx">nonnegative</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">itemCount</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="kr">int</span><span class="p">().</span><span class="nx">nonnegative</span><span class="p">(),</span>
<span class="p">});</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">CartResponse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">infer</span><span class="o">&lt;</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">CartResponseSchema</span><span class="o">&gt;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">addToCart</span><span class="p">(</span>
<span class="w">  </span><span class="nx">productId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<span class="w">  </span><span class="nx">quantity</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span>
<span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Result</span><span class="o">&lt;</span><span class="nx">CartResponse</span><span class="p">,</span><span class="w"> </span><span class="nx">NetworkError</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nx">ValidationError</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/api/cart&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="w"> </span><span class="p">},</span>
<span class="w">      </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">({</span><span class="w"> </span><span class="nx">productId</span><span class="p">,</span><span class="w"> </span><span class="nx">quantity</span><span class="w"> </span><span class="p">})</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nx">NetworkError</span><span class="p">(</span>
<span class="w">          </span><span class="s1">&#39;Failed to add to cart&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="p">,</span>
<span class="w">          </span><span class="nx">response</span><span class="p">.</span><span class="nx">statusText</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">CartResponseSchema</span><span class="p">.</span><span class="nx">safeParse</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">result</span><span class="p">.</span><span class="nx">success</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nx">ValidationError</span><span class="p">(</span>
<span class="w">          </span><span class="s1">&#39;Invalid cart response from API&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">result</span><span class="p">.</span><span class="nx">error</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">result.data</span><span class="w"> </span><span class="p">};</span>

<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
<span class="w">      </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nx">NetworkError</span><span class="p">(</span>
<span class="w">        </span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unknown error&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="mf">0</span><span class="p">,</span>
<span class="w">        </span><span class="s1">&#39;Request failed&#39;</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Using the Type-Safe API Client in Components</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/ProductList.tsx</span>
<span class="k">import</span><span class="w"> </span><span class="nx">React</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useEffect</span><span class="p">,</span><span class="w"> </span><span class="nx">useState</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">fetchProducts</span><span class="p">,</span><span class="w"> </span><span class="nx">NetworkError</span><span class="p">,</span><span class="w"> </span><span class="nx">ValidationError</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../utils/api&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Product</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../types/product&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">ProductCard</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./ProductCard&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ProductList</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">products</span><span class="p">,</span><span class="w"> </span><span class="nx">setProducts</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">Product</span><span class="err">[]</span><span class="p">&gt;([]);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">isLoading</span><span class="p">,</span><span class="w"> </span><span class="nx">setIsLoading</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">error</span><span class="p">,</span><span class="w"> </span><span class="nx">setError</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">string</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="na">null</span><span class="p">&gt;(</span><span class="kc">null</span><span class="p">);</span>

<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">loadProducts</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">setIsLoading</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="w">      </span><span class="nx">setError</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>

<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetchProducts</span><span class="p">();</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">success</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">setProducts</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Handle different error types</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="nx">NetworkError</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">404</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">setError</span><span class="p">(</span><span class="s1">&#39;Products not found. Please try again later.&#39;</span><span class="p">);</span>
<span class="w">          </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">500</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">setError</span><span class="p">(</span><span class="s1">&#39;Server error. Please try again later.&#39;</span><span class="p">);</span>
<span class="w">          </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">setError</span><span class="p">(</span><span class="s1">&#39;Failed to load products. Please check your connection.&#39;</span><span class="p">);</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="nx">ValidationError</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="c1">// Log detailed validation errors for debugging</span>
<span class="w">          </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Validation error:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">result</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">zodError</span><span class="p">.</span><span class="nx">format</span><span class="p">());</span>
<span class="w">          </span><span class="nx">setError</span><span class="p">(</span><span class="s1">&#39;Received invalid data from server. Please contact support.&#39;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nx">setError</span><span class="p">(</span><span class="s1">&#39;An unexpected error occurred.&#39;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="nx">setIsLoading</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">loadProducts</span><span class="p">();</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isLoading</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;loading&quot;</span><span class="p">&gt;</span><span class="nx">Loading</span><span class="w"> </span><span class="nx">products</span><span class="p">...&lt;/</span><span class="nt">div</span><span class="p">&gt;;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;error&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;{</span><span class="nx">error</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">reload</span><span class="p">()}&gt;</span>
<span class="w">          </span><span class="nx">Retry</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;product-list&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">products</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">product</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">ProductCard</span>
<span class="w">          </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span>
<span class="w">          </span><span class="na">product</span><span class="o">=</span><span class="p">{</span><span class="nx">product</span><span class="p">}</span>
<span class="w">          </span><span class="na">onAddToCart</span><span class="o">=</span><span class="p">{(</span><span class="nx">p</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Add to cart:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">)}</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">))}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Expected vs. Actual Improvement</strong>:</p>
<p><strong>Before (Throwing Errors)</strong>:
- Errors crash the component
- Generic error messages
- No way to distinguish network vs. validation errors
- Hard to implement retry logic</p>
<p><strong>After (Result Type)</strong>:
- Errors are values, not exceptions
- Specific error messages for different failure modes
- Type-safe error handling
- Easy to implement retry, fallback, or caching</p>
<p><strong>When to Apply This Solution</strong>:</p>
<p><strong>What it optimizes for</strong>: Robust error handling, user experience, debuggability</p>
<p><strong>What it sacrifices</strong>: More verbose code, need to handle Result type everywhere</p>
<p><strong>When to choose this approach</strong>:
- Production applications with real users
- APIs you don't control (third-party, microservices)
- Need to distinguish different error types
- Want to implement retry logic or fallbacks</p>
<p><strong>When to avoid this approach</strong>:
- Internal tools with controlled APIs
- Prototypes where errors are acceptable
- Simple CRUD apps with minimal error handling needs</p>
<p><strong>Code characteristics</strong>:
- Setup complexity: Medium (need to define error types and Result type)
- Maintenance burden: Lower (errors are explicit and type-safe)
- Performance impact: None (just different error handling pattern)</p>
<h3 id="the-type-safe-api-journey">The Type-Safe API Journey</h3>
<table>
<thead>
<tr>
<th>Iteration</th>
<th>Validation Approach</th>
<th>Type Safety</th>
<th>Error Handling</th>
<th>Lines of Code</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>None</td>
<td>None</td>
<td>Crashes</td>
<td>10</td>
</tr>
<tr>
<td>1</td>
<td>Manual type guards</td>
<td>Partial</td>
<td>Throws</td>
<td>50+</td>
</tr>
<tr>
<td>2</td>
<td>Zod schemas</td>
<td>Full</td>
<td>Throws</td>
<td>20</td>
</tr>
<tr>
<td>3</td>
<td>Zod + Result type</td>
<td>Full</td>
<td>Structured</td>
<td>30</td>
</tr>
</tbody>
</table>
<h3 id="lessons-learned-type-safe-api-clients">Lessons Learned: Type-Safe API Clients</h3>
<p><strong>1. Use schema validation libraries</strong>: Don't write manual type guards‚Äîuse Zod, Yup, or io-ts</p>
<p><strong>2. Single source of truth</strong>: Define the schema once, infer TypeScript types from it</p>
<p><strong>3. Validate at boundaries</strong>: APIs, localStorage, user input‚Äîanywhere data enters your application</p>
<p><strong>4. Transform data early</strong>: Convert API shapes to your internal types at the boundary</p>
<p><strong>5. Handle errors as values</strong>: Use Result types instead of throwing for better error handling</p>
<p><strong>6. Provide detailed errors</strong>: Zod's error messages are excellent for debugging‚Äîlog them in development</p>
<p><strong>7. Version your schemas</strong>: Use union types to handle multiple API versions gracefully</p>
<p><strong>Next</strong>: In Section 9.3, we'll tackle third-party libraries that don't have TypeScript types.</p>
<h2 id="handling-third-party-library-types">Handling third-party library types</h2>
<h2 id="handling-third-party-library-types_1">Handling Third-Party Library Types</h2>
<p>You've built a type-safe application. Your components are typed, your API client validates data, and TypeScript catches bugs before they reach production. Then you install a third-party library, and suddenly:</p>
<div class="codehilite"><pre><span></span><code>npm<span class="w"> </span>install<span class="w"> </span>awesome-charts
</code></pre></div>

<p><strong>Terminal Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>Could<span class="w"> </span>not<span class="w"> </span>find<span class="w"> </span>a<span class="w"> </span>declaration<span class="w"> </span>file<span class="w"> </span><span class="k">for</span><span class="w"> </span>module<span class="w"> </span><span class="s1">&#39;awesome-charts&#39;</span>.
<span class="s1">&#39;/node_modules/awesome-charts/index.js&#39;</span><span class="w"> </span>implicitly<span class="w"> </span>has<span class="w"> </span>an<span class="w"> </span><span class="s1">&#39;any&#39;</span><span class="w"> </span>type.

Try<span class="w"> </span><span class="sb">`</span>npm<span class="w"> </span>i<span class="w"> </span>--save-dev<span class="w"> </span>@types/awesome-charts<span class="sb">`</span><span class="w"> </span><span class="k">if</span><span class="w"> </span>it<span class="w"> </span>exists<span class="w"> </span>or<span class="w"> </span>add<span class="w"> </span>a<span class="w"> </span>new
declaration<span class="w"> </span><span class="o">(</span>.d.ts<span class="o">)</span><span class="w"> </span>file<span class="w"> </span>containing<span class="w"> </span><span class="sb">`</span><span class="nb">declare</span><span class="w"> </span>module<span class="w"> </span><span class="s1">&#39;awesome-charts&#39;</span><span class="p">;</span><span class="sb">`</span>
</code></pre></div>

<p>Your type safety just hit a wall. The library works at runtime, but TypeScript doesn't know what types it exports.</p>
<h3 id="the-three-scenarios">The Three Scenarios</h3>
<p>When you install a third-party library, you'll encounter one of three situations:</p>
<ol>
<li><strong>Built-in types</strong>: The library includes TypeScript definitions (<code>.d.ts</code> files)</li>
<li><strong>DefinitelyTyped</strong>: Community-maintained types available via <code>@types/package-name</code></li>
<li><strong>No types</strong>: No types exist‚Äîyou need to write them yourself</li>
</ol>
<p>Let's handle each scenario with a concrete example.</p>
<h3 id="reference-implementation-analytics-dashboard">Reference Implementation: Analytics Dashboard</h3>
<p>We're building an analytics dashboard that needs:
- A charting library (no built-in types)
- A date manipulation library (has DefinitelyTyped types)
- A custom utility library (we'll write types)</p>
<p><strong>Project Structure</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="nx">src</span><span class="o">/</span>
<span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">components</span><span class="o">/</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">AnalyticsDashboard</span><span class="p">.</span><span class="nx">tsx</span><span class="w">   </span><span class="err">‚Üê</span><span class="w"> </span><span class="nx">Our</span><span class="w"> </span><span class="nx">main</span><span class="w"> </span><span class="nx">component</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">SalesChart</span><span class="p">.</span><span class="nx">tsx</span><span class="w">            </span><span class="err">‚Üê</span><span class="w"> </span><span class="nx">Uses</span><span class="w"> </span><span class="nx">charting</span><span class="w"> </span><span class="kn">library</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">DateRangePicker</span><span class="p">.</span><span class="nx">tsx</span><span class="w">       </span><span class="err">‚Üê</span><span class="w"> </span><span class="nx">Uses</span><span class="w"> </span><span class="nx">date</span><span class="w"> </span><span class="kn">library</span>
<span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">utils</span><span class="o">/</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">analytics</span><span class="p">.</span><span class="nx">js</span><span class="w">              </span><span class="err">‚Üê</span><span class="w"> </span><span class="nx">Legacy</span><span class="w"> </span><span class="nx">utility</span><span class="w"> </span><span class="p">(</span><span class="nx">no</span><span class="w"> </span><span class="nx">types</span><span class="p">)</span>
<span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">types</span><span class="o">/</span>
<span class="w">    </span><span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">awesome</span><span class="o">-</span><span class="nx">charts</span><span class="p">.</span><span class="nx">d</span><span class="p">.</span><span class="nx">ts</span><span class="w">       </span><span class="err">‚Üê</span><span class="w"> </span><span class="nx">We</span><span class="err">&#39;</span><span class="nx">ll</span><span class="w"> </span><span class="nx">create</span><span class="w"> </span><span class="nx">this</span>
<span class="w">    </span><span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">analytics</span><span class="p">.</span><span class="nx">d</span><span class="p">.</span><span class="nx">ts</span><span class="w">            </span><span class="err">‚Üê</span><span class="w"> </span><span class="nx">We</span><span class="err">&#39;</span><span class="nx">ll</span><span class="w"> </span><span class="nx">create</span><span class="w"> </span><span class="nx">this</span>
</code></pre></div>

<h3 id="scenario-1-library-with-no-types">Scenario 1: Library with No Types</h3>
<p><strong>The Failure: TypeScript Can't Infer Anything</strong></p>
<p>We install a charting library:</p>
<div class="codehilite"><pre><span></span><code>npm<span class="w"> </span>install<span class="w"> </span>awesome-charts
</code></pre></div>

<p>Try to use it:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/SalesChart.tsx (Attempt 1)</span>
<span class="k">import</span><span class="w"> </span><span class="nx">React</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">LineChart</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;awesome-charts&#39;</span><span class="p">;</span><span class="w">  </span><span class="c1">// ‚Üê Error</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">SalesChartProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">Array</span><span class="o">&lt;</span><span class="p">{</span><span class="w"> </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w"> </span><span class="nx">sales</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">}</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">SalesChart</span><span class="p">({</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">SalesChartProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">LineChart</span>
<span class="w">      </span><span class="na">data</span><span class="o">=</span><span class="p">{</span><span class="nx">data</span><span class="p">}</span>
<span class="w">      </span><span class="na">xKey</span><span class="o">=</span><span class="s">&quot;date&quot;</span>
<span class="w">      </span><span class="na">yKey</span><span class="o">=</span><span class="s">&quot;sales&quot;</span>
<span class="w">      </span><span class="na">width</span><span class="o">=</span><span class="p">{</span><span class="mf">600</span><span class="p">}</span>
<span class="w">      </span><span class="na">height</span><span class="o">=</span><span class="p">{</span><span class="mf">400</span><span class="p">}</span>
<span class="w">    </span><span class="p">/&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Terminal Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>src/components/SalesChart.tsx:2:10<span class="w"> </span>-<span class="w"> </span>error<span class="w"> </span>TS7016:
Could<span class="w"> </span>not<span class="w"> </span>find<span class="w"> </span>a<span class="w"> </span>declaration<span class="w"> </span>file<span class="w"> </span><span class="k">for</span><span class="w"> </span>module<span class="w"> </span><span class="s1">&#39;awesome-charts&#39;</span>.
<span class="s1">&#39;/node_modules/awesome-charts/index.js&#39;</span><span class="w"> </span>implicitly<span class="w"> </span>has<span class="w"> </span>an<span class="w"> </span><span class="s1">&#39;any&#39;</span><span class="w"> </span>type.

<span class="m">2</span><span class="w"> </span>import<span class="w"> </span><span class="o">{</span><span class="w"> </span>LineChart<span class="w"> </span><span class="o">}</span><span class="w"> </span>from<span class="w"> </span><span class="s1">&#39;awesome-charts&#39;</span><span class="p">;</span>
<span class="w">           </span>~~~~~~~~~~

Try<span class="w"> </span><span class="sb">`</span>npm<span class="w"> </span>i<span class="w"> </span>--save-dev<span class="w"> </span>@types/awesome-charts<span class="sb">`</span><span class="w"> </span><span class="k">if</span><span class="w"> </span>it<span class="w"> </span>exists<span class="w"> </span>or<span class="w"> </span>add<span class="w"> </span>a<span class="w"> </span>new
declaration<span class="w"> </span><span class="o">(</span>.d.ts<span class="o">)</span><span class="w"> </span>file<span class="w"> </span>containing<span class="w"> </span><span class="sb">`</span><span class="nb">declare</span><span class="w"> </span>module<span class="w"> </span><span class="s1">&#39;awesome-charts&#39;</span><span class="p">;</span><span class="sb">`</span>
</code></pre></div>

<p><strong>Diagnostic Analysis: The Missing Types Problem</strong></p>
<p><strong>Let's parse this evidence</strong>:</p>
<ol>
<li>
<p><strong>What TypeScript sees</strong>: A JavaScript file with no type information</p>
</li>
<li>
<p><strong>What the error reveals</strong>: TypeScript defaults to <code>any</code> for untyped imports, which defeats the purpose of TypeScript</p>
</li>
<li>
<p><strong>Root cause identified</strong>: The library author didn't include TypeScript definitions</p>
</li>
<li>
<p><strong>Why we can't ignore this</strong>: Using <code>any</code> types means no autocomplete, no type checking, no refactoring support</p>
</li>
<li>
<p><strong>What we need</strong>: Type definitions that describe the library's API</p>
</li>
</ol>
<h3 id="solution-writing-declaration-files">Solution: Writing Declaration Files</h3>
<p><strong>Step 1: Check if @types exists</strong></p>
<p>First, try installing community types:</p>
<div class="codehilite"><pre><span></span><code>npm<span class="w"> </span>install<span class="w"> </span>--save-dev<span class="w"> </span>@types/awesome-charts
</code></pre></div>

<p>If this fails (package not found), you need to write types yourself.</p>
<p><strong>Step 2: Create a declaration file</strong></p>
<p>Create <code>src/types/awesome-charts.d.ts</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/types/awesome-charts.d.ts</span>

<span class="cm">/**</span>
<span class="cm"> * Type definitions for awesome-charts</span>
<span class="cm"> * Project: https://github.com/example/awesome-charts</span>
<span class="cm"> * Definitions by: Your Name</span>
<span class="cm"> */</span>

<span class="kr">declare</span><span class="w"> </span><span class="nx">module</span><span class="w"> </span><span class="s1">&#39;awesome-charts&#39;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">ReactElement</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * Common props shared by all chart components</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="kd">interface</span><span class="w"> </span><span class="nx">BaseChartProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cm">/** Chart width in pixels */</span>
<span class="w">    </span><span class="nx">width?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="cm">/** Chart height in pixels */</span>
<span class="w">    </span><span class="nx">height?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="cm">/** CSS class name */</span>
<span class="w">    </span><span class="nx">className?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">    </span><span class="cm">/** Chart title */</span>
<span class="w">    </span><span class="nx">title?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * Props for LineChart component</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="kd">interface</span><span class="w"> </span><span class="nx">LineChartProps</span><span class="o">&lt;</span><span class="nx">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">any</span><span class="o">&gt;</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nx">BaseChartProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cm">/** Array of data points */</span>
<span class="w">    </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">T</span><span class="p">[];</span>
<span class="w">    </span><span class="cm">/** Key in data object for x-axis values */</span>
<span class="w">    </span><span class="nx">xKey</span><span class="o">:</span><span class="w"> </span><span class="kt">keyof</span><span class="w"> </span><span class="nx">T</span><span class="p">;</span>
<span class="w">    </span><span class="cm">/** Key in data object for y-axis values */</span>
<span class="w">    </span><span class="nx">yKey</span><span class="o">:</span><span class="w"> </span><span class="kt">keyof</span><span class="w"> </span><span class="nx">T</span><span class="p">;</span>
<span class="w">    </span><span class="cm">/** Line color (hex or CSS color name) */</span>
<span class="w">    </span><span class="nx">color?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">    </span><span class="cm">/** Show data point markers */</span>
<span class="w">    </span><span class="nx">showMarkers?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">    </span><span class="cm">/** Smooth line curves */</span>
<span class="w">    </span><span class="nx">smooth?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * Line chart component</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">LineChart</span><span class="o">&lt;</span><span class="nx">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">any</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">props</span><span class="o">:</span><span class="w"> </span><span class="kt">LineChartProps</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">ReactElement</span><span class="p">;</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * Props for BarChart component</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="kd">interface</span><span class="w"> </span><span class="nx">BarChartProps</span><span class="o">&lt;</span><span class="nx">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">any</span><span class="o">&gt;</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nx">BaseChartProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">T</span><span class="p">[];</span>
<span class="w">    </span><span class="nx">xKey</span><span class="o">:</span><span class="w"> </span><span class="kt">keyof</span><span class="w"> </span><span class="nx">T</span><span class="p">;</span>
<span class="w">    </span><span class="nx">yKey</span><span class="o">:</span><span class="w"> </span><span class="kt">keyof</span><span class="w"> </span><span class="nx">T</span><span class="p">;</span>
<span class="w">    </span><span class="cm">/** Bar color */</span>
<span class="w">    </span><span class="nx">color?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">    </span><span class="cm">/** Horizontal bars instead of vertical */</span>
<span class="w">    </span><span class="nx">horizontal?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * Bar chart component</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">BarChart</span><span class="o">&lt;</span><span class="nx">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">any</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">props</span><span class="o">:</span><span class="w"> </span><span class="kt">BarChartProps</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">ReactElement</span><span class="p">;</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * Props for PieChart component</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="kd">interface</span><span class="w"> </span><span class="nx">PieChartProps</span><span class="o">&lt;</span><span class="nx">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">any</span><span class="o">&gt;</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nx">BaseChartProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">T</span><span class="p">[];</span>
<span class="w">    </span><span class="cm">/** Key for slice labels */</span>
<span class="w">    </span><span class="nx">labelKey</span><span class="o">:</span><span class="w"> </span><span class="kt">keyof</span><span class="w"> </span><span class="nx">T</span><span class="p">;</span>
<span class="w">    </span><span class="cm">/** Key for slice values */</span>
<span class="w">    </span><span class="nx">valueKey</span><span class="o">:</span><span class="w"> </span><span class="kt">keyof</span><span class="w"> </span><span class="nx">T</span><span class="p">;</span>
<span class="w">    </span><span class="cm">/** Show percentage labels */</span>
<span class="w">    </span><span class="nx">showPercentages?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * Pie chart component</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">PieChart</span><span class="o">&lt;</span><span class="nx">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">any</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">props</span><span class="o">:</span><span class="w"> </span><span class="kt">PieChartProps</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">ReactElement</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Step 3: Configure TypeScript to find the types</strong></p>
<p>Update <code>tsconfig.json</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;compilerOptions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;target&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ES2020&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;lib&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;ES2020&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;DOM&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;DOM.Iterable&quot;</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;jsx&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;react-jsx&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ESNext&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;moduleResolution&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bundler&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;resolveJsonModule&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;allowImportingTsExtensions&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;strict&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;esModuleInterop&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;skipLibCheck&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;forceConsistentCasingInFileNames&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>

<span class="w">    </span><span class="c1">// Tell TypeScript where to find custom type definitions</span>
<span class="w">    </span><span class="nt">&quot;typeRoots&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;./node_modules/@types&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;./src/types&quot;</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;types&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;include&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Verification: Types Now Work</strong></p>
<p>Now the component compiles with full type safety:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/SalesChart.tsx (Working version)</span>
<span class="k">import</span><span class="w"> </span><span class="nx">React</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">LineChart</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;awesome-charts&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">SalesData</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">sales</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">SalesChartProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">SalesData</span><span class="p">[];</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">SalesChart</span><span class="p">({</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">SalesChartProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">LineChart</span><span class="err">&lt;</span><span class="na">SalesData</span><span class="p">&gt;</span>
<span class="w">      </span><span class="nx">data</span><span class="o">=</span><span class="p">{</span><span class="nx">data</span><span class="p">}</span>
<span class="w">      </span><span class="nx">xKey</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="w">        </span><span class="c1">// ‚Üê TypeScript knows this must be a key of SalesData</span>
<span class="w">      </span><span class="nx">yKey</span><span class="o">=</span><span class="s2">&quot;sales&quot;</span><span class="w">       </span><span class="c1">// ‚Üê TypeScript knows this must be a key of SalesData</span>
<span class="w">      </span><span class="nx">width</span><span class="o">=</span><span class="p">{</span><span class="mf">600</span><span class="p">}</span>
<span class="w">      </span><span class="nx">height</span><span class="o">=</span><span class="p">{</span><span class="mf">400</span><span class="p">}</span>
<span class="w">      </span><span class="nx">color</span><span class="o">=</span><span class="s2">&quot;#3b82f6&quot;</span>
<span class="w">      </span><span class="nx">showMarkers</span><span class="o">=</span><span class="p">{</span><span class="kc">true</span><span class="p">}</span>
<span class="w">      </span><span class="nx">smooth</span><span class="o">=</span><span class="p">{</span><span class="kc">true</span><span class="p">}</span>
<span class="w">    </span><span class="o">/&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Expected vs. Actual Improvement</strong>:</p>
<p><strong>Before (No Types)</strong>:
- No autocomplete for props
- No error if you pass wrong prop names
- No type checking for data structure
- Runtime errors from typos</p>
<p><strong>After (Custom Types)</strong>:
- Full autocomplete in editor
- TypeScript catches typos: <code>xKey="datte"</code> ‚Üí error
- Type-safe data access: <code>xKey</code> must be a key of <code>SalesData</code>
- Compile-time errors instead of runtime crashes</p>
<p><strong>Attempting to Use Wrong Props</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// This now produces TypeScript errors:</span>
<span class="p">&lt;</span><span class="nt">LineChart</span><span class="err">&lt;</span><span class="na">SalesData</span><span class="p">&gt;</span>
<span class="w">  </span><span class="nx">data</span><span class="o">=</span><span class="p">{</span><span class="nx">data</span><span class="p">}</span>
<span class="w">  </span><span class="nx">xKey</span><span class="o">=</span><span class="s2">&quot;datte&quot;</span><span class="w">        </span><span class="c1">// ‚Üê Error: &quot;datte&quot; is not a key of SalesData</span>
<span class="w">  </span><span class="nx">yKey</span><span class="o">=</span><span class="s2">&quot;revenue&quot;</span><span class="w">      </span><span class="c1">// ‚Üê Error: &quot;revenue&quot; is not a key of SalesData</span>
<span class="w">  </span><span class="nx">invalidProp</span><span class="o">=</span><span class="p">{</span><span class="kc">true</span><span class="p">}</span><span class="w">  </span><span class="c1">// ‚Üê Error: Property &#39;invalidProp&#39; does not exist</span>
<span class="err">/&gt;</span>
</code></pre></div>

<p><strong>Terminal Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>src/components/SalesChart.tsx:12:3<span class="w"> </span>-<span class="w"> </span>error<span class="w"> </span>TS2322:
Type<span class="w"> </span><span class="s1">&#39;&quot;datte&quot;&#39;</span><span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>assignable<span class="w"> </span>to<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;&quot;date&quot; | &quot;sales&quot;&#39;</span>.

<span class="m">12</span><span class="w">   </span><span class="nv">xKey</span><span class="o">=</span><span class="s2">&quot;datte&quot;</span>
<span class="w">     </span>~~~~

src/components/SalesChart.tsx:13:3<span class="w"> </span>-<span class="w"> </span>error<span class="w"> </span>TS2322:
Type<span class="w"> </span><span class="s1">&#39;&quot;revenue&quot;&#39;</span><span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>assignable<span class="w"> </span>to<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;&quot;date&quot; | &quot;sales&quot;&#39;</span>.

<span class="m">13</span><span class="w">   </span><span class="nv">yKey</span><span class="o">=</span><span class="s2">&quot;revenue&quot;</span>
<span class="w">     </span>~~~~

src/components/SalesChart.tsx:14:3<span class="w"> </span>-<span class="w"> </span>error<span class="w"> </span>TS2353:
Object<span class="w"> </span>literal<span class="w"> </span>may<span class="w"> </span>only<span class="w"> </span>specify<span class="w"> </span>known<span class="w"> </span>properties,<span class="w"> </span>and<span class="w"> </span><span class="s1">&#39;invalidProp&#39;</span><span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>exist<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;LineChartProps&lt;SalesData&gt;&#39;</span>.

<span class="m">14</span><span class="w">   </span><span class="nv">invalidProp</span><span class="o">={</span>true<span class="o">}</span>
<span class="w">     </span>~~~~~~~~~~~
</code></pre></div>

<h3 id="scenario-2-library-with-definitelytyped-types">Scenario 2: Library with DefinitelyTyped Types</h3>
<p><strong>The Success Story: date-fns</strong></p>
<p>Many popular libraries have community-maintained types on DefinitelyTyped. Let's use <code>date-fns</code> for date manipulation:</p>
<div class="codehilite"><pre><span></span><code>npm<span class="w"> </span>install<span class="w"> </span>date-fns
npm<span class="w"> </span>install<span class="w"> </span>--save-dev<span class="w"> </span>@types/date-fns
</code></pre></div>

<p><strong>No additional work needed!</strong> TypeScript automatically finds the types:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/DateRangePicker.tsx</span>
<span class="k">import</span><span class="w"> </span><span class="nx">React</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">format</span><span class="p">,</span><span class="w"> </span><span class="nx">subDays</span><span class="p">,</span><span class="w"> </span><span class="nx">startOfWeek</span><span class="p">,</span><span class="w"> </span><span class="nx">endOfWeek</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;date-fns&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">DateRange</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">start</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">end</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">DateRangePicker</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">range</span><span class="p">,</span><span class="w"> </span><span class="nx">setRange</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">DateRange</span><span class="p">&gt;({</span>
<span class="w">    </span><span class="nx">start</span><span class="o">:</span><span class="w"> </span><span class="kt">subDays</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(),</span><span class="w"> </span><span class="mf">7</span><span class="p">),</span>
<span class="w">    </span><span class="nx">end</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(),</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">presets</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="s1">&#39;Last 7 days&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">start</span><span class="o">:</span><span class="w"> </span><span class="kt">subDays</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(),</span><span class="w"> </span><span class="mf">7</span><span class="p">),</span>
<span class="w">      </span><span class="nx">end</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(),</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="s1">&#39;This week&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">start</span><span class="o">:</span><span class="w"> </span><span class="kt">startOfWeek</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">()),</span>
<span class="w">      </span><span class="nx">end</span><span class="o">:</span><span class="w"> </span><span class="kt">endOfWeek</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">()),</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;date-range-picker&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;current-range&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">format</span><span class="p">(</span><span class="nx">range</span><span class="p">.</span><span class="nx">start</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;MMM d, yyyy&#39;</span><span class="p">)}</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">{</span><span class="nx">format</span><span class="p">(</span><span class="nx">range</span><span class="p">.</span><span class="nx">end</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;MMM d, yyyy&#39;</span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;presets&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nb">Object</span><span class="p">.</span><span class="nx">entries</span><span class="p">(</span><span class="nx">presets</span><span class="p">).</span><span class="nx">map</span><span class="p">(([</span><span class="nx">label</span><span class="p">,</span><span class="w"> </span><span class="nx">preset</span><span class="p">])</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">label</span><span class="p">}</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setRange</span><span class="p">(</span><span class="nx">preset</span><span class="p">)}&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="nx">label</span><span class="p">}</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">))}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Full type safety with zero effort</strong>:
- <code>format()</code> autocompletes format strings
- <code>subDays()</code> requires a number, not a string
- <code>Date</code> objects are properly typed throughout</p>
<h3 id="scenario-3-legacy-internal-code">Scenario 3: Legacy Internal Code</h3>
<p><strong>The Failure: Your Own Untyped Code</strong></p>
<p>You have a legacy utility file that other developers wrote in JavaScript:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/utils/analytics.js (Legacy code)</span>

<span class="cm">/**</span>
<span class="cm"> * Calculate percentage change between two values</span>
<span class="cm"> */</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">calculateChange</span><span class="p">(</span><span class="nx">current</span><span class="p">,</span><span class="w"> </span><span class="nx">previous</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">previous</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">((</span><span class="nx">current</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">previous</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">previous</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">100</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Format a number as a percentage</span>
<span class="cm"> */</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">formatPercentage</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span><span class="w"> </span><span class="nx">decimals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">value</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="nx">decimals</span><span class="p">)</span><span class="si">}</span><span class="sb">%`</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Group data by time period</span>
<span class="cm"> */</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">groupByPeriod</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span><span class="w"> </span><span class="nx">period</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">groups</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>

<span class="w">  </span><span class="nx">data</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">item</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">period</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;day&#39;</span><span class="w"> </span>
<span class="w">      </span><span class="o">?</span><span class="w"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">date</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)[</span><span class="mf">0</span><span class="p">]</span>
<span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">date</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">7</span><span class="p">);</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">groups</span><span class="p">[</span><span class="nx">key</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">groups</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">groups</span><span class="p">[</span><span class="nx">key</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">groups</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Calculate moving average</span>
<span class="cm"> */</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">movingAverage</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span><span class="w"> </span><span class="nx">windowSize</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">windowSize</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nb">window</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">acc</span><span class="p">,</span><span class="w"> </span><span class="nx">val</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">acc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">val</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>
<span class="w">    </span><span class="nx">result</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">sum</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">result</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Attempting to Use It</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/AnalyticsDashboard.tsx (Attempt 1)</span>
<span class="k">import</span><span class="w"> </span><span class="nx">React</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">calculateChange</span><span class="p">,</span><span class="w"> </span><span class="nx">formatPercentage</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../utils/analytics&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">AnalyticsDashboardProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">currentSales</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">previousSales</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">AnalyticsDashboard</span><span class="p">({</span><span class="w"> </span><span class="nx">currentSales</span><span class="p">,</span><span class="w"> </span><span class="nx">previousSales</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">AnalyticsDashboardProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">change</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">calculateChange</span><span class="p">(</span><span class="nx">currentSales</span><span class="p">,</span><span class="w"> </span><span class="nx">previousSales</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">formatted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">formatPercentage</span><span class="p">(</span><span class="nx">change</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;analytics-dashboard&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;metric&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;label&quot;</span><span class="p">&gt;</span><span class="nx">Sales</span><span class="w"> </span><span class="nx">Change</span><span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;value&quot;</span><span class="p">&gt;{</span><span class="nx">formatted</span><span class="p">}&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Terminal Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>src/components/AnalyticsDashboard.tsx:2:10<span class="w"> </span>-<span class="w"> </span>error<span class="w"> </span>TS7016:
Could<span class="w"> </span>not<span class="w"> </span>find<span class="w"> </span>a<span class="w"> </span>declaration<span class="w"> </span>file<span class="w"> </span><span class="k">for</span><span class="w"> </span>module<span class="w"> </span><span class="s1">&#39;../utils/analytics&#39;</span>.
<span class="s1">&#39;/src/utils/analytics.js&#39;</span><span class="w"> </span>implicitly<span class="w"> </span>has<span class="w"> </span>an<span class="w"> </span><span class="s1">&#39;any&#39;</span><span class="w"> </span>type.

<span class="m">2</span><span class="w"> </span>import<span class="w"> </span><span class="o">{</span><span class="w"> </span>calculateChange,<span class="w"> </span>formatPercentage<span class="w"> </span><span class="o">}</span><span class="w"> </span>from<span class="w"> </span><span class="s1">&#39;../utils/analytics&#39;</span><span class="p">;</span>
<span class="w">           </span>~~~~~~~~~~~~~~~
</code></pre></div>

<p><strong>Solution: Add Type Declarations for Legacy Code</strong></p>
<p>Create <code>src/types/analytics.d.ts</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/types/analytics.d.ts</span>

<span class="cm">/**</span>
<span class="cm"> * Type definitions for legacy analytics utilities</span>
<span class="cm"> */</span>
<span class="kr">declare</span><span class="w"> </span><span class="nx">module</span><span class="w"> </span><span class="s1">&#39;../utils/analytics&#39;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * Calculate percentage change between two values.</span>
<span class="cm">   * Returns 0 if previous value is 0 to avoid division by zero.</span>
<span class="cm">   * </span>
<span class="cm">   * @param current - Current value</span>
<span class="cm">   * @param previous - Previous value</span>
<span class="cm">   * @returns Percentage change (e.g., 25 for 25% increase)</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">calculateChange</span><span class="p">(</span><span class="nx">current</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">,</span><span class="w"> </span><span class="nx">previous</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * Format a number as a percentage string.</span>
<span class="cm">   * </span>
<span class="cm">   * @param value - Numeric value to format</span>
<span class="cm">   * @param decimals - Number of decimal places (default: 1)</span>
<span class="cm">   * @returns Formatted percentage string (e.g., &quot;25.5%&quot;)</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">formatPercentage</span><span class="p">(</span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">,</span><span class="w"> </span><span class="nx">decimals?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * Time period for grouping data</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">TimePeriod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;day&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;month&#39;</span><span class="p">;</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * Data point with date and value</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">DataPoint</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">    </span><span class="p">[</span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * Group data points by time period.</span>
<span class="cm">   * </span>
<span class="cm">   * @param data - Array of data points with date strings</span>
<span class="cm">   * @param period - Time period to group by (&#39;day&#39; or &#39;month&#39;)</span>
<span class="cm">   * @returns Object mapping period keys to arrays of data points</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">groupByPeriod</span><span class="p">(</span>
<span class="w">    </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">DataPoint</span><span class="p">[],</span>
<span class="w">    </span><span class="nx">period</span><span class="o">:</span><span class="w"> </span><span class="kt">TimePeriod</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">DataPoint</span><span class="p">[]</span><span class="o">&gt;</span><span class="p">;</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * Calculate moving average over a sliding window.</span>
<span class="cm">   * </span>
<span class="cm">   * @param data - Array of numeric values</span>
<span class="cm">   * @param windowSize - Size of the moving window</span>
<span class="cm">   * @returns Array of averaged values (same length as input)</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">movingAverage</span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[],</span><span class="w"> </span><span class="nx">windowSize</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[];</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Verification: Legacy Code Now Type-Safe</strong></p>
<p>The component now has full type safety:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/AnalyticsDashboard.tsx (Working version)</span>
<span class="k">import</span><span class="w"> </span><span class="nx">React</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">  </span><span class="nx">calculateChange</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="nx">formatPercentage</span><span class="p">,</span>
<span class="w">  </span><span class="nx">groupByPeriod</span><span class="p">,</span>
<span class="w">  </span><span class="nx">movingAverage</span><span class="p">,</span>
<span class="w">  </span><span class="kr">type</span><span class="w"> </span><span class="nx">DataPoint</span><span class="p">,</span>
<span class="w">  </span><span class="kr">type</span><span class="w"> </span><span class="nx">TimePeriod</span>
<span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../utils/analytics&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">AnalyticsDashboardProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">currentSales</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">previousSales</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">historicalData</span><span class="o">:</span><span class="w"> </span><span class="kt">DataPoint</span><span class="p">[];</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">AnalyticsDashboard</span><span class="p">({</span><span class="w"> </span>
<span class="w">  </span><span class="nx">currentSales</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="nx">previousSales</span><span class="p">,</span>
<span class="w">  </span><span class="nx">historicalData</span><span class="w"> </span>
<span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">AnalyticsDashboardProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">change</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">calculateChange</span><span class="p">(</span><span class="nx">currentSales</span><span class="p">,</span><span class="w"> </span><span class="nx">previousSales</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">formatted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">formatPercentage</span><span class="p">(</span><span class="nx">change</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">);</span><span class="w">  </span><span class="c1">// ‚Üê TypeScript knows decimals is optional</span>

<span class="w">  </span><span class="c1">// Group data by month</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">monthlyData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">groupByPeriod</span><span class="p">(</span><span class="nx">historicalData</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;month&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Calculate 7-day moving average</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">salesValues</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">historicalData</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">sales</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">smoothed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">movingAverage</span><span class="p">(</span><span class="nx">salesValues</span><span class="p">,</span><span class="w"> </span><span class="mf">7</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;analytics-dashboard&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;metric&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;label&quot;</span><span class="p">&gt;</span><span class="nx">Sales</span><span class="w"> </span><span class="nx">Change</span><span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;value&quot;</span><span class="p">&gt;{</span><span class="nx">formatted</span><span class="p">}&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="cm">/* ... render charts with smoothed data ... */</span><span class="p">}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Attempting to Use Wrong Types</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// These now produce TypeScript errors:</span>
<span class="nx">calculateChange</span><span class="p">(</span><span class="s2">&quot;100&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;90&quot;</span><span class="p">);</span><span class="w">           </span><span class="c1">// ‚Üê Error: Expected number, got string</span>
<span class="nx">formatPercentage</span><span class="p">(</span><span class="nx">change</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;2&quot;</span><span class="p">);</span><span class="w">          </span><span class="c1">// ‚Üê Error: Expected number, got string</span>
<span class="nx">groupByPeriod</span><span class="p">(</span><span class="nx">historicalData</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;year&#39;</span><span class="p">);</span><span class="w">  </span><span class="c1">// ‚Üê Error: &#39;year&#39; not in TimePeriod</span>
<span class="nx">movingAverage</span><span class="p">(</span><span class="nx">historicalData</span><span class="p">,</span><span class="w"> </span><span class="mf">7</span><span class="p">);</span><span class="w">       </span><span class="c1">// ‚Üê Error: Expected number[], got DataPoint[]</span>
</code></pre></div>

<p><strong>Terminal Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>src/components/AnalyticsDashboard.tsx:15:18<span class="w"> </span>-<span class="w"> </span>error<span class="w"> </span>TS2345:
Argument<span class="w"> </span>of<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>assignable<span class="w"> </span>to<span class="w"> </span>parameter<span class="w"> </span>of<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;number&#39;</span>.

<span class="m">15</span><span class="w">   </span>calculateChange<span class="o">(</span><span class="s2">&quot;100&quot;</span>,<span class="w"> </span><span class="s2">&quot;90&quot;</span><span class="o">)</span><span class="p">;</span>
<span class="w">                      </span>~~~~~

src/components/AnalyticsDashboard.tsx:16:30<span class="w"> </span>-<span class="w"> </span>error<span class="w"> </span>TS2345:
Argument<span class="w"> </span>of<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>assignable<span class="w"> </span>to<span class="w"> </span>parameter<span class="w"> </span>of<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;number | undefined&#39;</span>.

<span class="m">16</span><span class="w">   </span>formatPercentage<span class="o">(</span>change,<span class="w"> </span><span class="s2">&quot;2&quot;</span><span class="o">)</span><span class="p">;</span>
<span class="w">                                </span>~~~

src/components/AnalyticsDashboard.tsx:17:38<span class="w"> </span>-<span class="w"> </span>error<span class="w"> </span>TS2345:
Argument<span class="w"> </span>of<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;&quot;year&quot;&#39;</span><span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>assignable<span class="w"> </span>to<span class="w"> </span>parameter<span class="w"> </span>of<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;TimePeriod&#39;</span>.

<span class="m">17</span><span class="w">   </span>groupByPeriod<span class="o">(</span>historicalData,<span class="w"> </span><span class="s1">&#39;year&#39;</span><span class="o">)</span><span class="p">;</span>
<span class="w">                                    </span>~~~~~~

src/components/AnalyticsDashboard.tsx:18:17<span class="w"> </span>-<span class="w"> </span>error<span class="w"> </span>TS2345:
Argument<span class="w"> </span>of<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;DataPoint[]&#39;</span><span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>assignable<span class="w"> </span>to<span class="w"> </span>parameter<span class="w"> </span>of<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;number[]&#39;</span>.

<span class="m">18</span><span class="w">   </span>movingAverage<span class="o">(</span>historicalData,<span class="w"> </span><span class="m">7</span><span class="o">)</span><span class="p">;</span>
<span class="w">                   </span>~~~~~~~~~~~~~~
</code></pre></div>

<h3 id="when-to-apply-each-solution">When to Apply Each Solution</h3>
<table>
<thead>
<tr>
<th>Scenario</th>
<th>Solution</th>
<th>Effort</th>
<th>Maintenance</th>
</tr>
</thead>
<tbody>
<tr>
<td>Library with built-in types</td>
<td>None needed</td>
<td>None</td>
<td>None</td>
</tr>
<tr>
<td>Library on DefinitelyTyped</td>
<td><code>npm i @types/package</code></td>
<td>Minimal</td>
<td>Community maintains</td>
</tr>
<tr>
<td>Popular library, no types</td>
<td>Write <code>.d.ts</code>, contribute to DefinitelyTyped</td>
<td>Medium</td>
<td>You maintain initially, then community</td>
</tr>
<tr>
<td>Internal legacy code</td>
<td>Write <code>.d.ts</code> alongside code</td>
<td>Low</td>
<td>You maintain</td>
</tr>
<tr>
<td>Prototype/throwaway code</td>
<td>Use <code>any</code> or <code>// @ts-ignore</code></td>
<td>None</td>
<td>Not recommended for production</td>
</tr>
</tbody>
</table>
<h3 id="best-practices-for-writing-declaration-files">Best Practices for Writing Declaration Files</h3>
<p><strong>1. Start minimal, expand as needed</strong></p>
<p>Don't try to type the entire library at once. Type only what you use:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Start with this:</span>
<span class="kr">declare</span><span class="w"> </span><span class="nx">module</span><span class="w"> </span><span class="s1">&#39;awesome-charts&#39;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">LineChart</span><span class="p">(</span><span class="nx">props</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Expand as you use more features:</span>
<span class="kr">declare</span><span class="w"> </span><span class="nx">module</span><span class="w"> </span><span class="s1">&#39;awesome-charts&#39;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">interface</span><span class="w"> </span><span class="nx">LineChartProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">[];</span>
<span class="w">    </span><span class="nx">xKey</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">    </span><span class="nx">yKey</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">LineChart</span><span class="p">(</span><span class="nx">props</span><span class="o">:</span><span class="w"> </span><span class="kt">LineChartProps</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">React</span><span class="p">.</span><span class="nx">ReactElement</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>2. Use generics for flexible types</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Good: Generic type parameter</span>
<span class="kd">interface</span><span class="w"> </span><span class="nx">ChartProps</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">T</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">xKey</span><span class="o">:</span><span class="w"> </span><span class="kt">keyof</span><span class="w"> </span><span class="nx">T</span><span class="p">;</span>
<span class="w">  </span><span class="nx">yKey</span><span class="o">:</span><span class="w"> </span><span class="kt">keyof</span><span class="w"> </span><span class="nx">T</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Bad: Hardcoded type</span>
<span class="kd">interface</span><span class="w"> </span><span class="nx">ChartProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">xKey</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">yKey</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>3. Document with JSDoc comments</strong></p>
<div class="codehilite"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * Calculate percentage change between two values.</span>
<span class="cm"> * </span>
<span class="cm"> * @param current - Current value</span>
<span class="cm"> * @param previous - Previous value</span>
<span class="cm"> * @returns Percentage change (e.g., 25 for 25% increase)</span>
<span class="cm"> * @throws {Error} If previous is negative</span>
<span class="cm"> * </span>
<span class="cm"> * @example</span>
<span class="cm"> * ```ts</span>
<span class="cm"> * calculateChange(125, 100)  // Returns 25</span>
<span class="cm"> * calculateChange(75, 100)   // Returns -25</span>
<span class="cm"> * ```</span>
<span class="cm"> */</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">calculateChange</span><span class="p">(</span><span class="nx">current</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">,</span><span class="w"> </span><span class="nx">previous</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
</code></pre></div>

<p><strong>4. Use <code>unknown</code> instead of <code>any</code> when possible</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Good: Forces type checking</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">processData</span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">unknown</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;object&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Now TypeScript knows data is an object</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Bad: Bypasses type checking</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">processData</span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// TypeScript allows anything</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>5. Contribute back to DefinitelyTyped</strong></p>
<p>If you write types for a popular library, contribute them:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Fork DefinitelyTyped repo</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/DefinitelyTyped/DefinitelyTyped.git

<span class="c1"># Create types</span>
<span class="nb">cd</span><span class="w"> </span>DefinitelyTyped/types
mkdir<span class="w"> </span>awesome-charts
<span class="nb">cd</span><span class="w"> </span>awesome-charts

<span class="c1"># Copy your .d.ts file</span>
cp<span class="w"> </span>~/my-project/src/types/awesome-charts.d.ts<span class="w"> </span>index.d.ts

<span class="c1"># Add package.json and tsconfig.json</span>
<span class="c1"># Submit pull request</span>
</code></pre></div>

<h3 id="the-third-party-types-journey">The Third-Party Types Journey</h3>
<table>
<thead>
<tr>
<th>Scenario</th>
<th>Before</th>
<th>After</th>
<th>Effort</th>
</tr>
</thead>
<tbody>
<tr>
<td>Built-in types</td>
<td>‚úÖ Works</td>
<td>‚úÖ Works</td>
<td>None</td>
</tr>
<tr>
<td>DefinitelyTyped</td>
<td>‚ùå No types</td>
<td>‚úÖ Full types</td>
<td><code>npm install</code></td>
</tr>
<tr>
<td>No types available</td>
<td>‚ùå <code>any</code> everywhere</td>
<td>‚úÖ Custom types</td>
<td>Write <code>.d.ts</code></td>
</tr>
<tr>
<td>Legacy internal code</td>
<td>‚ùå <code>any</code> everywhere</td>
<td>‚úÖ Typed</td>
<td>Write <code>.d.ts</code></td>
</tr>
</tbody>
</table>
<h3 id="lessons-learned-handling-third-party-types">Lessons Learned: Handling Third-Party Types</h3>
<p><strong>1. Check for types first</strong>: Always try <code>npm i @types/package-name</code> before writing your own</p>
<p><strong>2. Start minimal</strong>: Type only what you use, expand as needed</p>
<p><strong>3. Use generics</strong>: Make your types flexible and reusable</p>
<p><strong>4. Document thoroughly</strong>: JSDoc comments help future developers (including yourself)</p>
<p><strong>5. Contribute back</strong>: If you write types for a popular library, share them with the community</p>
<p><strong>6. Don't use <code>any</code> as a permanent solution</strong>: It defeats the purpose of TypeScript</p>
<p><strong>7. Prefer <code>unknown</code> over <code>any</code></strong>: Forces you to validate types before use</p>
<p><strong>Next</strong>: In Section 9.4, we'll configure <code>tsconfig.json</code> for optimal type checking and developer experience.</p>
<h2 id="tsconfig-settings-that-matter">tsconfig settings that matter</h2>
<h2 id="tsconfig-settings-that-matter_1">tsconfig Settings That Matter</h2>
<p>You've migrated your code to TypeScript, added types for third-party libraries, and everything compiles. But TypeScript has <strong>dozens</strong> of compiler options, and the defaults are often too permissive for production code.</p>
<p>This section focuses on the <strong>20% of settings that give you 80% of the value</strong>‚Äîthe options that catch real bugs and improve developer experience.</p>
<h3 id="the-problem-with-default-settings">The Problem with Default Settings</h3>
<p><strong>The Failure: TypeScript Allows Unsafe Code</strong></p>
<p>Here's code that compiles with default TypeScript settings but crashes at runtime:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// This compiles with default tsconfig.json</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">getUserName</span><span class="p">(</span><span class="nx">user</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">user</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">getUserName</span><span class="p">(</span><span class="nx">user</span><span class="p">);</span><span class="w">  </span><span class="c1">// ‚Üê Runtime crash</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
</code></pre></div>

<p><strong>Browser Console Output</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">TypeError</span><span class="o">:</span><span class="w"> </span><span class="n">Cannot</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">properties</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">(</span><span class="n">reading</span><span class="w"> </span><span class="s1">&#39;name&#39;</span><span class="o">)</span>
<span class="w">  </span><span class="n">at</span><span class="w"> </span><span class="n">getUserName</span><span class="w"> </span><span class="o">(</span><span class="n">index</span><span class="o">.</span><span class="na">ts</span><span class="o">:</span><span class="mi">2</span><span class="o">)</span>
<span class="w">  </span><span class="n">at</span><span class="w"> </span><span class="n">index</span><span class="o">.</span><span class="na">ts</span><span class="o">:</span><span class="mi">6</span>
</code></pre></div>

<p><strong>Diagnostic Analysis: Why TypeScript Didn't Catch This</strong></p>
<p><strong>Let's parse this evidence</strong>:</p>
<ol>
<li>
<p><strong>What the developer expected</strong>: TypeScript to catch the <code>null</code> access</p>
</li>
<li>
<p><strong>What TypeScript allowed</strong>: <code>any</code> type bypasses all type checking</p>
</li>
<li>
<p><strong>Root cause identified</strong>: Default <code>tsconfig.json</code> is too permissive</p>
</li>
<li>
<p><strong>Why default settings fail</strong>: They prioritize ease of migration over safety</p>
</li>
<li>
<p><strong>What we need</strong>: Stricter compiler options that catch these bugs</p>
</li>
</ol>
<h3 id="iteration-1-the-essential-strict-settings">Iteration 1: The Essential Strict Settings</h3>
<p><strong>Current state recap</strong>: Default TypeScript settings allow unsafe code to compile.</p>
<p><strong>Goal</strong>: Enable strict type checking to catch bugs at compile time.</p>
<p><strong>The Minimal Production tsconfig.json</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;compilerOptions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cm">/* Language and Environment */</span>
<span class="w">    </span><span class="nt">&quot;target&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ES2020&quot;</span><span class="p">,</span><span class="w">                    </span><span class="c1">// Modern JavaScript features</span>
<span class="w">    </span><span class="nt">&quot;lib&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;ES2020&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;DOM&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;DOM.Iterable&quot;</span><span class="p">],</span><span class="w">  </span><span class="c1">// Available APIs</span>
<span class="w">    </span><span class="nt">&quot;jsx&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;react-jsx&quot;</span><span class="p">,</span><span class="w">                    </span><span class="c1">// React 17+ JSX transform</span>

<span class="w">    </span><span class="cm">/* Modules */</span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ESNext&quot;</span><span class="p">,</span><span class="w">                    </span><span class="c1">// Use ES modules</span>
<span class="w">    </span><span class="nt">&quot;moduleResolution&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bundler&quot;</span><span class="p">,</span><span class="w">         </span><span class="c1">// For Vite/modern bundlers</span>
<span class="w">    </span><span class="nt">&quot;resolveJsonModule&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">             </span><span class="c1">// Import JSON files</span>
<span class="w">    </span><span class="nt">&quot;allowImportingTsExtensions&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">    </span><span class="c1">// Import .ts/.tsx files</span>

<span class="w">    </span><span class="cm">/* Type Checking - THE MOST IMPORTANT SECTION */</span>
<span class="w">    </span><span class="nt">&quot;strict&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">                        </span><span class="c1">// Enable all strict checks</span>
<span class="w">    </span><span class="nt">&quot;noUncheckedIndexedAccess&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">      </span><span class="c1">// Array access returns T | undefined</span>
<span class="w">    </span><span class="nt">&quot;noImplicitOverride&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">            </span><span class="c1">// Require &#39;override&#39; keyword</span>
<span class="w">    </span><span class="nt">&quot;noPropertyAccessFromIndexSignature&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">  </span><span class="c1">// Prevent typos in property access</span>

<span class="w">    </span><span class="cm">/* Emit */</span>
<span class="w">    </span><span class="nt">&quot;noEmit&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">                        </span><span class="c1">// Let Vite handle compilation</span>
<span class="w">    </span><span class="nt">&quot;sourceMap&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">                     </span><span class="c1">// Generate source maps for debugging</span>

<span class="w">    </span><span class="cm">/* Interop Constraints */</span>
<span class="w">    </span><span class="nt">&quot;esModuleInterop&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">               </span><span class="c1">// Better CommonJS interop</span>
<span class="w">    </span><span class="nt">&quot;allowSyntheticDefaultImports&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">  </span><span class="c1">// Allow default imports from modules</span>
<span class="w">    </span><span class="nt">&quot;forceConsistentCasingInFileNames&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">  </span><span class="c1">// Prevent case-sensitivity issues</span>

<span class="w">    </span><span class="cm">/* Skip Lib Check */</span>
<span class="w">    </span><span class="nt">&quot;skipLibCheck&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">                   </span><span class="c1">// Skip type checking of .d.ts files</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;include&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;exclude&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;node_modules&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;dist&quot;</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>What <code>"strict": true</code> Actually Enables</strong></p>
<p>The <code>strict</code> flag is a shorthand that enables these individual checks:</p>
<ol>
<li><strong><code>strictNullChecks</code></strong>: <code>null</code> and <code>undefined</code> are not assignable to other types</li>
<li><strong><code>strictFunctionTypes</code></strong>: Function parameters are checked contravariantly</li>
<li><strong><code>strictBindCallApply</code></strong>: <code>bind</code>, <code>call</code>, <code>apply</code> are type-checked</li>
<li><strong><code>strictPropertyInitialization</code></strong>: Class properties must be initialized</li>
<li><strong><code>noImplicitAny</code></strong>: Variables must have explicit or inferred types</li>
<li><strong><code>noImplicitThis</code></strong>: <code>this</code> must have an explicit type</li>
<li><strong><code>alwaysStrict</code></strong>: Emit <code>"use strict"</code> in output</li>
<li><strong><code>useUnknownInCatchVariables</code></strong>: Catch variables are <code>unknown</code> instead of <code>any</code></li>
</ol>
<p>Let's see each in action.</p>
<h3 id="strict-check-1-strictnullchecks">Strict Check 1: strictNullChecks</h3>
<p><strong>Before (Disabled)</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Compiles without strictNullChecks</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">getUserName</span><span class="p">(</span><span class="nx">user</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">user</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span><span class="w">  </span><span class="c1">// ‚Üê No error, crashes at runtime</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>After (Enabled)</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Error with strictNullChecks</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">getUserName</span><span class="p">(</span><span class="nx">user</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">user</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span><span class="w">  </span><span class="c1">// ‚Üê Error: Object is possibly &#39;null&#39;</span>
<span class="p">}</span>

<span class="c1">// Fixed version</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">getUserName</span><span class="p">(</span><span class="nx">user</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">user</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;Anonymous&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">user</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span><span class="w">  </span><span class="c1">// ‚Üê Now safe</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Terminal Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>src/utils.ts:2:10<span class="w"> </span>-<span class="w"> </span>error<span class="w"> </span>TS2531:
Object<span class="w"> </span>is<span class="w"> </span>possibly<span class="w"> </span><span class="s1">&#39;null&#39;</span>.

<span class="m">2</span><span class="w">   </span><span class="k">return</span><span class="w"> </span>user.name.toUpperCase<span class="o">()</span><span class="p">;</span>
<span class="w">           </span>~~~~
</code></pre></div>

<h3 id="strict-check-2-noimplicitany">Strict Check 2: noImplicitAny</h3>
<p><strong>Before (Disabled)</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Compiles without noImplicitAny</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">calculateTotal</span><span class="p">(</span><span class="nx">items</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// ‚Üê items is implicitly &#39;any&#39;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">items</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">item</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">price</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>After (Enabled)</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Error with noImplicitAny</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">calculateTotal</span><span class="p">(</span><span class="nx">items</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// ‚Üê Error: Parameter &#39;items&#39; implicitly has an &#39;any&#39; type</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">items</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">item</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">price</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Fixed version</span>
<span class="kd">interface</span><span class="w"> </span><span class="nx">Item</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">calculateTotal</span><span class="p">(</span><span class="nx">items</span><span class="o">:</span><span class="w"> </span><span class="kt">Item</span><span class="p">[])</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">items</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">item</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">price</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Terminal Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>src/utils.ts:1:24<span class="w"> </span>-<span class="w"> </span>error<span class="w"> </span>TS7006:
Parameter<span class="w"> </span><span class="s1">&#39;items&#39;</span><span class="w"> </span>implicitly<span class="w"> </span>has<span class="w"> </span>an<span class="w"> </span><span class="s1">&#39;any&#39;</span><span class="w"> </span>type.

<span class="m">1</span><span class="w"> </span><span class="k">function</span><span class="w"> </span>calculateTotal<span class="o">(</span>items<span class="o">)</span><span class="w"> </span><span class="o">{</span>
<span class="w">                          </span>~~~~~
</code></pre></div>

<h3 id="strict-check-3-strictpropertyinitialization">Strict Check 3: strictPropertyInitialization</h3>
<p><strong>Before (Disabled)</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Compiles without strictPropertyInitialization</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">UserProfile</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">  </span><span class="c1">// ‚Üê Not initialized, will be undefined</span>
<span class="w">  </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>

<span class="w">  </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// Forgot to initialize email</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nx">sendEmail</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">email</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span><span class="w">  </span><span class="c1">// ‚Üê Crashes: undefined.toLowerCase()</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>After (Enabled)</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Error with strictPropertyInitialization</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">UserProfile</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">  </span><span class="c1">// ‚Üê Error: Property &#39;email&#39; has no initializer</span>

<span class="w">  </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Fixed version 1: Initialize in constructor</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">UserProfile</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>

<span class="w">  </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">;</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">email</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Fixed version 2: Provide default value</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">UserProfile</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span><span class="w">  </span><span class="c1">// ‚Üê Default value</span>

<span class="w">  </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Fixed version 3: Mark as optional</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">UserProfile</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">email?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">  </span><span class="c1">// ‚Üê Optional property</span>

<span class="w">  </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nx">sendEmail</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">email</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// ‚Üê Must check before use</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">email</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;Email not set&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Terminal Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>src/models/UserProfile.ts:3:3<span class="w"> </span>-<span class="w"> </span>error<span class="w"> </span>TS2564:
Property<span class="w"> </span><span class="s1">&#39;email&#39;</span><span class="w"> </span>has<span class="w"> </span>no<span class="w"> </span>initializer<span class="w"> </span>and<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>definitely<span class="w"> </span>assigned<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>constructor.

<span class="m">3</span><span class="w">   </span>email:<span class="w"> </span>string<span class="p">;</span>
<span class="w">    </span>~~~~~
</code></pre></div>

<h3 id="iteration-2-additional-safety-checks">Iteration 2: Additional Safety Checks</h3>
<p><strong>Current state recap</strong>: We've enabled <code>strict: true</code>, which catches most common bugs.</p>
<p><strong>Current limitation</strong>: There are additional checks that aren't included in <code>strict</code> but are valuable for production code.</p>
<p><strong>Additional Recommended Settings</strong>:</p>
<h3 id="check-4-nouncheckedindexedaccess">Check 4: noUncheckedIndexedAccess</h3>
<p><strong>The Problem</strong>: Array access can return <code>undefined</code>, but TypeScript doesn't enforce checking.</p>
<p><strong>Before (Disabled)</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Compiles without noUncheckedIndexedAccess</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Bob&#39;</span><span class="p">];</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">thirdUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">users</span><span class="p">[</span><span class="mf">2</span><span class="p">];</span><span class="w">  </span><span class="c1">// ‚Üê undefined, but TypeScript thinks it&#39;s string</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">thirdUser</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">());</span><span class="w">  </span><span class="c1">// ‚Üê Crashes</span>
</code></pre></div>

<p><strong>After (Enabled)</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Error with noUncheckedIndexedAccess</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Bob&#39;</span><span class="p">];</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">thirdUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">users</span><span class="p">[</span><span class="mf">2</span><span class="p">];</span><span class="w">  </span><span class="c1">// ‚Üê Type is string | undefined</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">thirdUser</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">());</span><span class="w">  </span><span class="c1">// ‚Üê Error: Object is possibly &#39;undefined&#39;</span>

<span class="c1">// Fixed version</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Bob&#39;</span><span class="p">];</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">thirdUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">users</span><span class="p">[</span><span class="mf">2</span><span class="p">];</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">thirdUser</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="kc">undefined</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">thirdUser</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">());</span>
<span class="p">}</span>

<span class="c1">// Or use optional chaining</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">users</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">?</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">());</span>
</code></pre></div>

<p><strong>Terminal Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>src/utils.ts:3:13<span class="w"> </span>-<span class="w"> </span>error<span class="w"> </span>TS2532:
Object<span class="w"> </span>is<span class="w"> </span>possibly<span class="w"> </span><span class="s1">&#39;undefined&#39;</span>.

<span class="m">3</span><span class="w"> </span>console.log<span class="o">(</span>thirdUser.toUpperCase<span class="o">())</span><span class="p">;</span>
<span class="w">              </span>~~~~~~~~~~
</code></pre></div>

<h3 id="check-5-nopropertyaccessfromindexsignature">Check 5: noPropertyAccessFromIndexSignature</h3>
<p><strong>The Problem</strong>: Typos in property names go undetected.</p>
<p><strong>Before (Disabled)</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Compiles without noPropertyAccessFromIndexSignature</span>
<span class="kd">interface</span><span class="w"> </span><span class="nx">Config</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">apiUrl</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">timeout</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="p">[</span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="p">;</span><span class="w">  </span><span class="c1">// ‚Üê Index signature allows any property</span>
<span class="p">}</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">config</span><span class="o">:</span><span class="w"> </span><span class="kt">Config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">apiUrl</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;https://api.example.com&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">timeout</span><span class="o">:</span><span class="w"> </span><span class="kt">5000</span><span class="p">,</span>
<span class="p">};</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">config</span><span class="p">.</span><span class="nx">apiUrl</span><span class="p">);</span><span class="w">   </span><span class="c1">// ‚Üê OK</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">config</span><span class="p">.</span><span class="nx">apiUrll</span><span class="p">);</span><span class="w">  </span><span class="c1">// ‚Üê Typo, but compiles (returns undefined)</span>
</code></pre></div>

<p><strong>After (Enabled)</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Error with noPropertyAccessFromIndexSignature</span>
<span class="kd">interface</span><span class="w"> </span><span class="nx">Config</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">apiUrl</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">timeout</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="p">[</span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="nx">any</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">config</span><span class="o">:</span><span class="w"> </span><span class="kt">Config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">apiUrl</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;https://api.example.com&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">timeout</span><span class="o">:</span><span class="w"> </span><span class="kt">5000</span><span class="p">,</span>
<span class="p">};</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">config</span><span class="p">.</span><span class="nx">apiUrl</span><span class="p">);</span><span class="w">   </span><span class="c1">// ‚Üê OK (known property)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">config</span><span class="p">.</span><span class="nx">apiUrll</span><span class="p">);</span><span class="w">  </span><span class="c1">// ‚Üê Error: Property &#39;apiUrll&#39; does not exist</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">config</span><span class="p">[</span><span class="s1">&#39;apiUrll&#39;</span><span class="p">]);</span><span class="w">  </span><span class="c1">// ‚Üê OK (explicit index access)</span>
</code></pre></div>

<p><strong>Terminal Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>src/config.ts:11:20<span class="w"> </span>-<span class="w"> </span>error<span class="w"> </span>TS2339:
Property<span class="w"> </span><span class="s1">&#39;apiUrll&#39;</span><span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>exist<span class="w"> </span>on<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;Config&#39;</span>.
Did<span class="w"> </span>you<span class="w"> </span>mean<span class="w"> </span><span class="s1">&#39;apiUrl&#39;</span>?

<span class="m">11</span><span class="w"> </span>console.log<span class="o">(</span>config.apiUrll<span class="o">)</span><span class="p">;</span>
<span class="w">                      </span>~~~~~~~~
</code></pre></div>

<h3 id="check-6-noimplicitoverride">Check 6: noImplicitOverride</h3>
<p><strong>The Problem</strong>: Accidentally overriding parent class methods without realizing it.</p>
<p><strong>Before (Disabled)</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Compiles without noImplicitOverride</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">BaseComponent</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">render</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;&lt;div&gt;Base&lt;/div&gt;&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nx">CustomComponent</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nx">BaseComponent</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Typo: meant to override render(), but wrote rendor()</span>
<span class="w">  </span><span class="nx">rendor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// ‚Üê New method, not an override</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;&lt;div&gt;Custom&lt;/div&gt;&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">component</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">CustomComponent</span><span class="p">();</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">component</span><span class="p">.</span><span class="nx">render</span><span class="p">());</span><span class="w">  </span><span class="c1">// ‚Üê Still calls base class method</span>
</code></pre></div>

<p><strong>After (Enabled)</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Error with noImplicitOverride</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">BaseComponent</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">render</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;&lt;div&gt;Base&lt;/div&gt;&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nx">CustomComponent</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nx">BaseComponent</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">override</span><span class="w"> </span><span class="nx">render</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// ‚Üê Must use &#39;override&#39; keyword</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;&lt;div&gt;Custom&lt;/div&gt;&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// If you typo the method name:</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">CustomComponent</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nx">BaseComponent</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">override</span><span class="w"> </span><span class="nx">rendor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// ‚Üê Error: Method &#39;rendor&#39; does not override any base class method</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;&lt;div&gt;Custom&lt;/div&gt;&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Terminal Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>src/components/CustomComponent.ts:8:12<span class="w"> </span>-<span class="w"> </span>error<span class="w"> </span>TS4113:
This<span class="w"> </span>member<span class="w"> </span>cannot<span class="w"> </span>have<span class="w"> </span>an<span class="w"> </span><span class="s1">&#39;override&#39;</span><span class="w"> </span>modifier<span class="w"> </span>because<span class="w"> </span>it<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>declared<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>base<span class="w"> </span>class<span class="w"> </span><span class="s1">&#39;BaseComponent&#39;</span>.

<span class="m">8</span><span class="w">   </span>override<span class="w"> </span>rendor<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">             </span>~~~~~~
</code></pre></div>

<h3 id="iteration-3-performance-and-developer-experience-settings">Iteration 3: Performance and Developer Experience Settings</h3>
<p><strong>Current state recap</strong>: We have strict type checking enabled, catching most bugs at compile time.</p>
<p><strong>Goal</strong>: Optimize TypeScript for faster compilation and better editor experience.</p>
<p><strong>Performance Settings</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;compilerOptions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cm">/* ... previous settings ... */</span>

<span class="w">    </span><span class="cm">/* Performance */</span>
<span class="w">    </span><span class="nt">&quot;skipLibCheck&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">              </span><span class="c1">// Skip type checking of .d.ts files (huge speedup)</span>
<span class="w">    </span><span class="nt">&quot;incremental&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">               </span><span class="c1">// Enable incremental compilation</span>
<span class="w">    </span><span class="nt">&quot;tsBuildInfoFile&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;.tsbuildinfo&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Cache file for incremental builds</span>

<span class="w">    </span><span class="cm">/* Editor Experience */</span>
<span class="w">    </span><span class="nt">&quot;noErrorTruncation&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">         </span><span class="c1">// Show full error messages</span>
<span class="w">    </span><span class="nt">&quot;pretty&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">                    </span><span class="c1">// Colorize error messages</span>

<span class="w">    </span><span class="cm">/* Path Mapping (for cleaner imports) */</span>
<span class="w">    </span><span class="nt">&quot;baseUrl&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;paths&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;@/*&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;src/*&quot;</span><span class="p">],</span>
<span class="w">      </span><span class="nt">&quot;@components/*&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;src/components/*&quot;</span><span class="p">],</span>
<span class="w">      </span><span class="nt">&quot;@utils/*&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;src/utils/*&quot;</span><span class="p">],</span>
<span class="w">      </span><span class="nt">&quot;@types/*&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;src/types/*&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Using Path Mapping</strong>:</p>
<p><strong>Before</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Ugly relative imports</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">ProductCard</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../../../components/ProductCard&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">formatPrice</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../../../utils/formatPrice&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Product</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../../../types/product&#39;</span><span class="p">;</span>
</code></pre></div>

<p><strong>After</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Clean absolute imports</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">ProductCard</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@components/ProductCard&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">formatPrice</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@utils/formatPrice&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Product</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@types/product&#39;</span><span class="p">;</span>
</code></pre></div>

<p><strong>Note</strong>: You also need to configure your bundler (Vite, Webpack) to resolve these paths:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// vite.config.ts</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">defineConfig</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;vite&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="nx">react</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@vitejs/plugin-react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="nx">path</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;path&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="nx">defineConfig</span><span class="p">({</span>
<span class="w">  </span><span class="nx">plugins</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nx">react</span><span class="p">()],</span>
<span class="w">  </span><span class="nx">resolve</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">alias</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="s1">&#39;@&#39;</span><span class="o">:</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;./src&#39;</span><span class="p">),</span>
<span class="w">      </span><span class="s1">&#39;@components&#39;</span><span class="o">:</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;./src/components&#39;</span><span class="p">),</span>
<span class="w">      </span><span class="s1">&#39;@utils&#39;</span><span class="o">:</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;./src/utils&#39;</span><span class="p">),</span>
<span class="w">      </span><span class="s1">&#39;@types&#39;</span><span class="o">:</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;./src/types&#39;</span><span class="p">),</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">  </span><span class="p">},</span>
<span class="p">});</span>
</code></pre></div>

<h3 id="the-complete-production-tsconfigjson">The Complete Production tsconfig.json</h3>
<p>Here's the final, production-ready configuration:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;compilerOptions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cm">/* Language and Environment */</span>
<span class="w">    </span><span class="nt">&quot;target&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ES2020&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;lib&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;ES2020&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;DOM&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;DOM.Iterable&quot;</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;jsx&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;react-jsx&quot;</span><span class="p">,</span>

<span class="w">    </span><span class="cm">/* Modules */</span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ESNext&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;moduleResolution&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bundler&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;resolveJsonModule&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;allowImportingTsExtensions&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>

<span class="w">    </span><span class="cm">/* Type Checking - Maximum Safety */</span>
<span class="w">    </span><span class="nt">&quot;strict&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;noUncheckedIndexedAccess&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;noImplicitOverride&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;noPropertyAccessFromIndexSignature&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;noFallthroughCasesInSwitch&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;noUnusedLocals&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;noUnusedParameters&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;exactOptionalPropertyTypes&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>

<span class="w">    </span><span class="cm">/* Emit */</span>
<span class="w">    </span><span class="nt">&quot;noEmit&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;sourceMap&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>

<span class="w">    </span><span class="cm">/* Interop Constraints */</span>
<span class="w">    </span><span class="nt">&quot;esModuleInterop&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;allowSyntheticDefaultImports&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;forceConsistentCasingInFileNames&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;isolatedModules&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>

<span class="w">    </span><span class="cm">/* Performance */</span>
<span class="w">    </span><span class="nt">&quot;skipLibCheck&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;incremental&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;tsBuildInfoFile&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;.tsbuildinfo&quot;</span><span class="p">,</span>

<span class="w">    </span><span class="cm">/* Editor Experience */</span>
<span class="w">    </span><span class="nt">&quot;noErrorTruncation&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;pretty&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>

<span class="w">    </span><span class="cm">/* Path Mapping */</span>
<span class="w">    </span><span class="nt">&quot;baseUrl&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;paths&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;@/*&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;src/*&quot;</span><span class="p">],</span>
<span class="w">      </span><span class="nt">&quot;@components/*&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;src/components/*&quot;</span><span class="p">],</span>
<span class="w">      </span><span class="nt">&quot;@utils/*&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;src/utils/*&quot;</span><span class="p">],</span>
<span class="w">      </span><span class="nt">&quot;@types/*&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;src/types/*&quot;</span><span class="p">],</span>
<span class="w">      </span><span class="nt">&quot;@hooks/*&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;src/hooks/*&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;include&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;exclude&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;node_modules&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;dist&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;build&quot;</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="settings-to-avoid-common-mistakes">Settings to Avoid (Common Mistakes)</h3>
<p><strong>1. Don't disable strict checks in production</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1">// ‚ùå Bad: Defeats the purpose of TypeScript</span>
<span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;compilerOptions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;strict&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;noImplicitAny&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;strictNullChecks&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>2. Don't use <code>any</code> as an escape hatch</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1">// ‚ùå Bad: Bypasses type checking</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">processData</span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">// ‚úÖ Good: Use unknown and validate</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">processData</span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">unknown</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;object&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s1">&#39;value&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kt">unknown</span><span class="w"> </span><span class="p">};</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;Invalid data&#39;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>3. Don't ignore errors with @ts-ignore</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1">// ‚ùå Bad: Hides the problem</span>
<span class="c1">// @ts-ignore</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">user</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span>

<span class="c1">// ‚úÖ Good: Fix the problem</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">user</span><span class="o">?</span><span class="p">.</span><span class="nx">name</span><span class="o">?</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s1">&#39;Anonymous&#39;</span><span class="p">;</span>
</code></pre></div>

<p><strong>4. Don't set target too low</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1">// ‚ùå Bad: Generates bloated code</span>
<span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;compilerOptions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;target&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ES5&quot;</span><span class="w">  </span><span class="c1">// Transpiles async/await to generators</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// ‚úÖ Good: Modern target for modern browsers</span>
<span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;compilerOptions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;target&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ES2020&quot;</span><span class="w">  </span><span class="c1">// Native async/await, optional chaining, etc.</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="when-to-relax-strict-settings">When to Relax Strict Settings</h3>
<p><strong>Scenario 1: Migrating Large Codebase</strong></p>
<p>Start with loose settings, gradually tighten:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Phase 1: Basic TypeScript</span>
<span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;compilerOptions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;strict&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;noImplicitAny&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">  </span><span class="c1">// Start with just this</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Phase 2: Add null checks</span>
<span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;compilerOptions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;strict&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;noImplicitAny&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;strictNullChecks&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Phase 3: Full strict mode</span>
<span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;compilerOptions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;strict&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Scenario 2: Third-Party Library Issues</strong></p>
<p>Use <code>skipLibCheck</code> to ignore type errors in dependencies:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;compilerOptions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;strict&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;skipLibCheck&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">  </span><span class="c1">// Ignore errors in node_modules</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Scenario 3: Prototyping</strong></p>
<p>For throwaway code, you can be more permissive:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;compilerOptions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;strict&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;noImplicitAny&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>But <strong>never</strong> deploy this to production.</p>
<h3 id="the-tsconfig-journey">The tsconfig Journey</h3>
<table>
<thead>
<tr>
<th>Phase</th>
<th>Settings</th>
<th>Bugs Caught</th>
<th>Compile Time</th>
<th>Developer Experience</th>
</tr>
</thead>
<tbody>
<tr>
<td>Default</td>
<td>Minimal</td>
<td>Few</td>
<td>Fast</td>
<td>Poor (no autocomplete)</td>
</tr>
<tr>
<td>Basic</td>
<td><code>noImplicitAny</code></td>
<td>Some</td>
<td>Fast</td>
<td>Better</td>
</tr>
<tr>
<td>Strict</td>
<td><code>strict: true</code></td>
<td>Most</td>
<td>Medium</td>
<td>Good</td>
</tr>
<tr>
<td>Production</td>
<td>All checks</td>
<td>Maximum</td>
<td>Medium</td>
<td>Excellent</td>
</tr>
</tbody>
</table>
<h3 id="verification-measuring-the-impact">Verification: Measuring the Impact</h3>
<p><strong>Before (Loose Settings)</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Compile time</span>
tsc<span class="w"> </span>--noEmit:<span class="w"> </span><span class="m">2</span>.3s

<span class="c1"># Bugs caught at compile time: 12</span>
<span class="c1"># Bugs found in production: 8</span>
</code></pre></div>

<p><strong>After (Strict Settings)</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Compile time</span>
tsc<span class="w"> </span>--noEmit:<span class="w"> </span><span class="m">2</span>.8s<span class="w"> </span><span class="o">(</span><span class="m">20</span>%<span class="w"> </span>slower,<span class="w"> </span>but<span class="w"> </span>worth<span class="w"> </span>it<span class="o">)</span>

<span class="c1"># Bugs caught at compile time: 20</span>
<span class="c1"># Bugs found in production: 0</span>
</code></pre></div>

<p><strong>Expected vs. Actual Improvement</strong>:</p>
<p><strong>Before (Default Settings)</strong>:
- Fast compilation
- Many runtime errors
- Poor editor experience
- Frequent production bugs</p>
<p><strong>After (Strict Settings)</strong>:
- Slightly slower compilation (20%)
- Most bugs caught at compile time
- Excellent editor experience (autocomplete, refactoring)
- Rare production bugs</p>
<h3 id="lessons-learned-tsconfig-settings">Lessons Learned: tsconfig Settings</h3>
<p><strong>1. Start strict</strong>: Enable <code>strict: true</code> from day one on new projects</p>
<p><strong>2. Add extra checks</strong>: <code>noUncheckedIndexedAccess</code>, <code>noImplicitOverride</code>, <code>noPropertyAccessFromIndexSignature</code></p>
<p><strong>3. Use path mapping</strong>: Clean imports improve readability and refactoring</p>
<p><strong>4. Skip lib check</strong>: <code>skipLibCheck: true</code> dramatically speeds up compilation</p>
<p><strong>5. Never use <code>any</code></strong>: Use <code>unknown</code> and validate instead</p>
<p><strong>6. Don't ignore errors</strong>: Fix them or use proper type guards</p>
<p><strong>7. Measure the impact</strong>: Track bugs caught at compile time vs. runtime</p>
<p><strong>8. Migrate gradually</strong>: For large codebases, tighten settings incrementally</p>
<p><strong>9. Document exceptions</strong>: If you must relax a setting, document why</p>
<p><strong>10. Review regularly</strong>: As TypeScript evolves, new checks become available</p>
<h3 id="the-complete-typescript-journey-chapters-8-9">The Complete TypeScript Journey (Chapters 8-9)</h3>
<table>
<thead>
<tr>
<th>Chapter</th>
<th>Focus</th>
<th>Key Takeaway</th>
</tr>
</thead>
<tbody>
<tr>
<td>8</td>
<td>TypeScript Essentials</td>
<td>Types prevent runtime errors</td>
</tr>
<tr>
<td>9.1</td>
<td>Migrating JavaScript</td>
<td>Incremental migration strategy</td>
</tr>
<tr>
<td>9.2</td>
<td>Type-Safe APIs</td>
<td>Zod for runtime validation</td>
</tr>
<tr>
<td>9.3</td>
<td>Third-Party Types</td>
<td>Write <code>.d.ts</code> when needed</td>
</tr>
<tr>
<td>9.4</td>
<td>tsconfig Settings</td>
<td>Strict settings catch bugs</td>
</tr>
</tbody>
</table>
<h3 id="final-implementation-production-ready-typescript-setup">Final Implementation: Production-Ready TypeScript Setup</h3>
<p><strong>Project Structure</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="nx">my</span><span class="o">-</span><span class="nx">app</span><span class="o">/</span>
<span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">src</span><span class="o">/</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">components</span><span class="o">/</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">ProductCard</span><span class="p">.</span><span class="nx">tsx</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">ProductList</span><span class="p">.</span><span class="nx">tsx</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">AnalyticsDashboard</span><span class="p">.</span><span class="nx">tsx</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">utils</span><span class="o">/</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="kn">api</span><span class="p">.</span><span class="nx">ts</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">formatPrice</span><span class="p">.</span><span class="nx">ts</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">types</span><span class="o">/</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">product</span><span class="p">.</span><span class="nx">ts</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">awesome</span><span class="o">-</span><span class="nx">charts</span><span class="p">.</span><span class="nx">d</span><span class="p">.</span><span class="nx">ts</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">analytics</span><span class="p">.</span><span class="nx">d</span><span class="p">.</span><span class="nx">ts</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">hooks</span><span class="o">/</span>
<span class="err">‚îÇ</span><span class="w">       </span><span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">useProducts</span><span class="p">.</span><span class="nx">ts</span>
<span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">tsconfig</span><span class="p">.</span><span class="nx">json</span><span class="w">              </span><span class="err">‚Üê</span><span class="w"> </span><span class="nx">Strict</span><span class="w"> </span><span class="nx">settings</span>
<span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">vite</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">ts</span><span class="w">             </span><span class="err">‚Üê</span><span class="w"> </span><span class="nx">Path</span><span class="w"> </span><span class="nx">aliases</span>
<span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="kn">package</span><span class="p">.</span><span class="nx">json</span>
</code></pre></div>

<p><strong>tsconfig.json</strong> (Final):</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;compilerOptions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;target&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ES2020&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;lib&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;ES2020&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;DOM&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;DOM.Iterable&quot;</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;jsx&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;react-jsx&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ESNext&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;moduleResolution&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bundler&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;resolveJsonModule&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;allowImportingTsExtensions&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;strict&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;noUncheckedIndexedAccess&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;noImplicitOverride&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;noPropertyAccessFromIndexSignature&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;noFallthroughCasesInSwitch&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;noUnusedLocals&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;noUnusedParameters&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;exactOptionalPropertyTypes&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;noEmit&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;sourceMap&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;esModuleInterop&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;allowSyntheticDefaultImports&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;forceConsistentCasingInFileNames&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;isolatedModules&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;skipLibCheck&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;incremental&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;tsBuildInfoFile&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;.tsbuildinfo&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;noErrorTruncation&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;pretty&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;baseUrl&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;paths&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;@/*&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;src/*&quot;</span><span class="p">],</span>
<span class="w">      </span><span class="nt">&quot;@components/*&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;src/components/*&quot;</span><span class="p">],</span>
<span class="w">      </span><span class="nt">&quot;@utils/*&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;src/utils/*&quot;</span><span class="p">],</span>
<span class="w">      </span><span class="nt">&quot;@types/*&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;src/types/*&quot;</span><span class="p">],</span>
<span class="w">      </span><span class="nt">&quot;@hooks/*&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;src/hooks/*&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;include&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;exclude&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;node_modules&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;dist&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;build&quot;</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Decision Framework: TypeScript Configuration</strong></p>
<table>
<thead>
<tr>
<th>Scenario</th>
<th>Recommended Settings</th>
<th>Rationale</th>
</tr>
</thead>
<tbody>
<tr>
<td>New project</td>
<td>Full strict mode</td>
<td>Catch bugs early, best DX</td>
</tr>
<tr>
<td>Large migration</td>
<td>Gradual tightening</td>
<td>Avoid overwhelming team</td>
</tr>
<tr>
<td>Prototype</td>
<td>Loose settings</td>
<td>Speed over safety</td>
</tr>
<tr>
<td>Production app</td>
<td>Full strict + extras</td>
<td>Maximum safety</td>
</tr>
<tr>
<td>Library</td>
<td>Strict + declaration emit</td>
<td>Type safety for consumers</td>
</tr>
</tbody>
</table>
<h3 id="what-weve-accomplished">What We've Accomplished</h3>
<p><strong>Chapter 9 Journey</strong>:</p>
<ol>
<li><strong>Section 9.1</strong>: Migrated JavaScript to TypeScript incrementally</li>
<li><strong>Section 9.2</strong>: Built type-safe API clients with Zod</li>
<li><strong>Section 9.3</strong>: Added types for third-party libraries</li>
<li><strong>Section 9.4</strong>: Configured TypeScript for maximum safety</li>
</ol>
<p><strong>From Zero to Hero</strong>:
- Started with untyped JavaScript
- Added basic TypeScript types
- Implemented runtime validation
- Handled third-party libraries
- Configured strict type checking
- Built a production-ready TypeScript setup</p>
<p><strong>The Result</strong>: A fully type-safe React application that catches bugs at compile time, provides excellent developer experience, and rarely crashes in production.</p>
<p><strong>Next Steps</strong>: In Part III (Chapters 11-13), we'll tackle state management‚Äîlocal state, global state with Zustand, and server state with React Query. TypeScript will make all of these patterns safer and more maintainable.</p>
        </div>
        <div class="footer">
            Generated on 2025-12-03 12:42:28 | Made with ‚ù§Ô∏è by GitHub Pages Generator
        </div>
    </div>
    <script>
        // Syntax highlighting for code blocks
        document.addEventListener('DOMContentLoaded', (event) => {
            // Highlight code blocks
            document.querySelectorAll('pre code').forEach((block) => {
                hljs.highlightElement(block);
            });
            
            // Add copy buttons to code blocks
            document.querySelectorAll('pre').forEach((pre) => {
                const button = document.createElement('button');
                button.className = 'copy-btn';
                button.textContent = 'Copy';
                
                button.addEventListener('click', () => {
                    const code = pre.querySelector('code').textContent;
                    navigator.clipboard.writeText(code).then(() => {
                        button.textContent = 'Copied!';
                        button.classList.add('copied');
                        setTimeout(() => {
                            button.textContent = 'Copy';
                            button.classList.remove('copied');
                        }, 2000);
                    }).catch(err => {
                        console.error('Failed to copy:', err);
                        button.textContent = 'Error';
                        setTimeout(() => {
                            button.textContent = 'Copy';
                        }, 2000);
                    });
                });
                
                pre.appendChild(button);
            });
        });
    </script>
</body>
</html>