<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>08 Advanced TypeScript Patterns</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #8b5cf6;
            --bg-main: #0f172a;
            --bg-card: #1e293b;
            --bg-code: #0f172a;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #334155;
            --accent: #06b6d4;
            --success: #10b981;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            line-height: 1.7; 
            color: var(--text-primary); 
            background: var(--bg-main);
        }
        
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 20px; 
        }
        
        .home-btn { 
            position: fixed; 
            top: 20px; 
            right: 20px; 
            background: var(--accent);
            color: white; 
            width: 50px;
            height: 50px;
            border-radius: 50%;
            text-decoration: none; 
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(6, 182, 212, 0.4);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .home-btn:hover { 
            background: #0891b2;
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(6, 182, 212, 0.5);
        }
        
        .breadcrumb { 
            background: var(--bg-card);
            padding: 12px 0; 
            margin-bottom: 24px; 
            font-size: 14px;
            border-radius: 8px;
            border: 1px solid var(--border);
        }
        
        .breadcrumb a { 
            color: var(--accent);
            text-decoration: none;
            transition: color 0.2s;
        }
        
        .breadcrumb a:hover { 
            color: var(--primary);
            text-decoration: underline;
        }
        
        .content { 
            background: var(--bg-card);
            padding: 3rem; 
            border-radius: 16px; 
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border);
        }
        
        .file-list { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); 
            gap: 1.5rem; 
            margin: 2rem 0; 
        }
        
        .file-item { 
            padding: 1.5rem; 
            border: 1px solid var(--border);
            border-radius: 12px; 
            background: var(--bg-main);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .file-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .file-item:hover { 
            transform: translateY(-4px); 
            box-shadow: 0 8px 30px rgba(99, 102, 241, 0.3);
            border-color: var(--primary);
        }
        
        .file-item:hover::before {
            opacity: 1;
        }
        
        .file-item a { 
            color: var(--text-primary);
            text-decoration: none; 
            font-weight: 600; 
            display: block;
            font-size: 1.1rem;
        }
        
        .file-item a:hover { 
            color: var(--primary);
        }
        
        .file-type { 
            font-size: 13px; 
            color: var(--text-secondary);
            margin-top: 8px; 
            font-weight: 500;
        }
        
        /* Code Blocks */
        pre { 
            background: var(--bg-code);
            padding: 1.5rem; 
            border-radius: 12px; 
            overflow-x: auto;
            border: 1px solid var(--border);
            margin: 1.5rem 0;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            position: relative;
        }
        
        pre code { 
            background: none;
            padding: 0;
            font-family: 'Fira Code', 'Consolas', monospace;
            font-size: 0.9em;
            line-height: 1.6;
        }
        
        /* Copy Button */
        .copy-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: var(--primary);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.2s;
            opacity: 0.7;
            z-index: 10;
        }
        
        .copy-btn:hover {
            opacity: 1;
            background: var(--primary-dark);
            transform: translateY(-1px);
        }
        
        .copy-btn.copied {
            background: var(--success);
        }
        
        pre:hover .copy-btn {
            opacity: 1;
        }
        
        /* Inline Code */
        code { 
            background: var(--bg-code);
            color: #8b5cf6;
            padding: 3px 8px; 
            border-radius: 6px; 
            font-size: 1.1em;
            font-family: 'Fira Code', 'Consolas', monospace;
            border: 1px solid var(--border);
        }
        
        /* Headings */
        h1, h2, h3, h4, h5, h6 { 
            color: var(--text-primary);
            margin: 2rem 0 1rem 0;
            font-weight: 700;
            letter-spacing: -0.5px;
        }
        
        h1 { 
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            border-bottom: 3px solid var(--primary);
            padding-bottom: 12px;
            margin-bottom: 1.5rem;
        }
        
        h2 { 
            font-size: 2rem;
            color: var(--primary);
            border-bottom: 2px solid var(--border);
            padding-bottom: 8px;
        }
        
        h3 { 
            font-size: 1.5rem;
            color: var(--accent);
        }
        
        /* Links */
        a { 
            color: var(--accent);
            transition: color 0.2s;
        }
        
        a:hover { 
            color: var(--primary);
        }
        
        /* Paragraphs */
        p {
            margin: 1rem 0;
            color: var(--text-secondary);
        }
        
        /* Lists */
        ul, ol {
            margin: 1rem 0;
            padding-left: 2rem;
            color: var(--text-secondary);
        }
        
        li {
            margin: 0.5rem 0;
        }
        
        /* Tables */
        table { 
            border-collapse: collapse;
            width: 100%;
            margin: 1.5rem 0;
            background: var(--bg-main);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }
        
        th, td { 
            border: 1px solid var(--border);
            padding: 12px 16px;
            text-align: left;
        }
        
        th { 
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            font-weight: 600;
        }
        
        tr:hover {
            background: var(--bg-card);
        }
        
        /* Blockquotes */
        blockquote {
            border-left: 4px solid var(--primary);
            padding: 1rem 1.5rem;
            margin: 1.5rem 0;
            background: var(--bg-main);
            border-radius: 0 8px 8px 0;
            color: var(--text-secondary);
            font-style: italic;
        }
        
        /* Horizontal Rule */
        hr {
            border: none;
            border-top: 2px solid var(--border);
            margin: 2rem 0;
        }
        
        .footer { 
            text-align: center; 
            padding: 2rem; 
            color: var(--text-secondary);
            border-top: 1px solid var(--border);
            margin-top: 3rem; 
            font-size: 14px;
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--bg-main);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 6px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }
        
        @media (max-width: 768px) {
            .container { padding: 10px; }
            .file-list { grid-template-columns: 1fr; }
            .content { padding: 1.5rem; }
            h1 { font-size: 2rem; }
            h2 { font-size: 1.5rem; }
        }
    </style>
</head>
<body>
    <a href="../index.html" class="home-btn">üè†</a>
    <div class="container">
        <div class="breadcrumb">
            <div style="padding: 0 20px;">
                <a href="../index.html">üè† Home</a> <span style="color: #64748b;">/</span> <a href="index.html">02 TypeScript Integration</a>
            </div>
        </div>
        <div class="content">
            <h1 id="chapter-8-advanced-typescript-patterns">Chapter 8: Advanced TypeScript Patterns</h1>
<h2 id="discriminated-unions-for-component-variants">Discriminated unions for component variants</h2>
<h2 id="discriminated-unions-for-component-variants_1">Discriminated unions for component variants</h2>
<p>In Chapter 7, we built a type-safe User Profile Dashboard. It worked well for simple cases, but as our application grew, we encountered a common problem: components that need to behave differently based on their configuration.</p>
<p>Let's introduce our reference implementation for this chapter: a <strong>Notification System</strong> that displays different types of alerts to users. This will be our anchor example, and we'll refine it through multiple iterations as we discover the limitations of naive approaches.</p>
<p><strong>Project Structure</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="nx">src</span><span class="o">/</span>
<span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">components</span><span class="o">/</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">Notification</span><span class="p">.</span><span class="nx">tsx</span><span class="w">      </span><span class="err">‚Üê</span><span class="w"> </span><span class="nx">Our</span><span class="w"> </span><span class="nx">reference</span><span class="w"> </span><span class="nx">implementation</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">NotificationList</span><span class="p">.</span><span class="nx">tsx</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">Dashboard</span><span class="p">.</span><span class="nx">tsx</span>
<span class="err">‚îú‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">types</span><span class="o">/</span>
<span class="err">‚îÇ</span><span class="w">   </span><span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">notifications</span><span class="p">.</span><span class="nx">ts</span>
<span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">app</span><span class="o">/</span>
<span class="w">    </span><span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="nx">page</span><span class="p">.</span><span class="nx">tsx</span>
</code></pre></div>

<h3 id="phase-1-the-naive-approach-boolean-flags-everywhere">Phase 1: The Naive Approach - Boolean Flags Everywhere</h3>
<p>Let's start with how most developers initially approach component variants: using boolean flags.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/Notification.tsx - Version 1 (Naive)</span>
<span class="kd">interface</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">isSuccess?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">isError?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">isWarning?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">isInfo?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">showIcon?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">isDismissible?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onDismiss</span><span class="o">?:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="nx">actionLabel?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onAction</span><span class="o">?:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">Notification</span><span class="p">({</span>
<span class="w">  </span><span class="nx">message</span><span class="p">,</span>
<span class="w">  </span><span class="nx">isSuccess</span><span class="p">,</span>
<span class="w">  </span><span class="nx">isError</span><span class="p">,</span>
<span class="w">  </span><span class="nx">isWarning</span><span class="p">,</span>
<span class="w">  </span><span class="nx">isInfo</span><span class="p">,</span>
<span class="w">  </span><span class="nx">showIcon</span><span class="p">,</span>
<span class="w">  </span><span class="nx">isDismissible</span><span class="p">,</span>
<span class="w">  </span><span class="nx">onDismiss</span><span class="p">,</span>
<span class="w">  </span><span class="nx">actionLabel</span><span class="p">,</span>
<span class="w">  </span><span class="nx">onAction</span><span class="p">,</span>
<span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">getBackgroundColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isSuccess</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;bg-green-100&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isError</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;bg-red-100&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isWarning</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;bg-yellow-100&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isInfo</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;bg-blue-100&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;bg-gray-100&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">getIcon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">showIcon</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isSuccess</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;‚úì&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isError</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;‚úó&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isWarning</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;‚ö†&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isInfo</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;‚Ñπ&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`p-4 rounded </span><span class="si">${</span><span class="nx">getBackgroundColor</span><span class="p">()</span><span class="si">}</span><span class="sb">`</span><span class="p">}&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex items-start gap-3&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">getIcon</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;text-xl&quot;</span><span class="p">&gt;{</span><span class="nx">getIcon</span><span class="p">()}&lt;/</span><span class="nt">span</span><span class="p">&gt;}</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex-1&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;{</span><span class="nx">message</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">{</span><span class="nx">actionLabel</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">onAction</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">              </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">onAction</span><span class="p">}</span>
<span class="w">              </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-2 text-sm underline&quot;</span>
<span class="w">            </span><span class="p">&gt;</span>
<span class="w">              </span><span class="p">{</span><span class="nx">actionLabel</span><span class="p">}</span>
<span class="w">            </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">)}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">isDismissible</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">onDismiss</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">onDismiss</span><span class="p">}</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;text-gray-500&quot;</span><span class="p">&gt;</span>
<span class="w">            </span><span class="err">√ó</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/app/page.tsx - Using the naive component</span>
<span class="s1">&#39;use client&#39;</span><span class="p">;</span>

<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Notification</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/components/Notification&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">DashboardPage</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">notifications</span><span class="p">,</span><span class="w"> </span><span class="nx">setNotifications</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">([</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">1</span><span class="p">,</span><span class="w"> </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Profile updated successfully&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">isSuccess</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">2</span><span class="p">,</span><span class="w"> </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Failed to load user data&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">isError</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">3</span><span class="p">,</span><span class="w"> </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Your session expires in 5 minutes&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">isWarning</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="p">]);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;p-8 space-y-4&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h1</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;text-2xl font-bold&quot;</span><span class="p">&gt;</span><span class="nx">Dashboard</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">notif</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">Notification</span>
<span class="w">          </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">notif</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span>
<span class="w">          </span><span class="na">message</span><span class="o">=</span><span class="p">{</span><span class="nx">notif</span><span class="p">.</span><span class="nx">message</span><span class="p">}</span>
<span class="w">          </span><span class="na">isSuccess</span><span class="o">=</span><span class="p">{</span><span class="nx">notif</span><span class="p">.</span><span class="nx">isSuccess</span><span class="p">}</span>
<span class="w">          </span><span class="na">isError</span><span class="o">=</span><span class="p">{</span><span class="nx">notif</span><span class="p">.</span><span class="nx">isError</span><span class="p">}</span>
<span class="w">          </span><span class="na">isWarning</span><span class="o">=</span><span class="p">{</span><span class="nx">notif</span><span class="p">.</span><span class="nx">isWarning</span><span class="p">}</span>
<span class="w">          </span><span class="na">showIcon</span>
<span class="w">          </span><span class="na">isDismissible</span>
<span class="w">          </span><span class="na">onDismiss</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">setNotifications</span><span class="p">(</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">n</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">notif</span><span class="p">.</span><span class="nx">id</span><span class="p">));</span>
<span class="w">          </span><span class="p">}}</span>
<span class="w">        </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">))}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>This works, but let's see what happens when we try to use it in more complex scenarios.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/app/page.tsx - Attempting to add an action button</span>
<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">DashboardPage</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;p-8 space-y-4&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="cm">/* This compiles but creates an invalid state */</span><span class="p">}</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">Notification</span>
<span class="w">        </span><span class="na">message</span><span class="o">=</span><span class="s">&quot;Payment failed&quot;</span>
<span class="w">        </span><span class="na">isError</span><span class="o">=</span><span class="p">{</span><span class="kc">true</span><span class="p">}</span>
<span class="w">        </span><span class="na">isSuccess</span><span class="o">=</span><span class="p">{</span><span class="kc">true</span><span class="p">}</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">‚Üê</span><span class="w"> </span><span class="na">Both</span><span class="w"> </span><span class="na">error</span><span class="w"> </span><span class="na">AND</span><span class="w"> </span><span class="na">success</span><span class="err">?</span>
<span class="w">        </span><span class="na">showIcon</span>
<span class="w">        </span><span class="na">actionLabel</span><span class="o">=</span><span class="s">&quot;Retry&quot;</span>
<span class="w">        </span><span class="err">//</span><span class="w"> </span><span class="err">‚Üê</span><span class="w"> </span><span class="na">Forgot</span><span class="w"> </span><span class="na">onAction</span><span class="w"> </span><span class="na">handler</span><span class="err">,</span><span class="w"> </span><span class="na">but</span><span class="w"> </span><span class="na">TypeScript</span><span class="w"> </span><span class="na">doesn</span><span class="err">&#39;</span><span class="na">t</span><span class="w"> </span><span class="na">complain</span>
<span class="w">      </span><span class="p">/&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="cm">/* This also compiles but makes no sense */</span><span class="p">}</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">Notification</span>
<span class="w">        </span><span class="na">message</span><span class="o">=</span><span class="s">&quot;Click to continue&quot;</span>
<span class="w">        </span><span class="err">//</span><span class="w"> </span><span class="err">‚Üê</span><span class="w"> </span><span class="na">No</span><span class="w"> </span><span class="na">type</span><span class="w"> </span><span class="na">specified</span><span class="err">,</span><span class="w"> </span><span class="na">but</span><span class="w"> </span><span class="na">has</span><span class="w"> </span><span class="na">an</span><span class="w"> </span><span class="na">action</span>
<span class="w">        </span><span class="na">actionLabel</span><span class="o">=</span><span class="s">&quot;Continue&quot;</span>
<span class="w">        </span><span class="na">onAction</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;clicked&#39;</span><span class="p">)}</span>
<span class="w">      </span><span class="p">/&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="diagnostic-analysis-reading-the-failure">Diagnostic Analysis: Reading the Failure</h3>
<p><strong>Browser Behavior</strong>:
The component renders, but the behavior is unpredictable. The first notification shows a success background (green) because <code>isSuccess</code> is checked first in the conditional logic, even though <code>isError</code> is also true. The second notification has an action button but no visual indication of what type of notification it is.</p>
<p><strong>Browser Console Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>(No errors - this is the problem!)
</code></pre></div>

<p><strong>TypeScript Compiler Output</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># TypeScript compiles successfully</span>
<span class="c1"># No type errors detected</span>
</code></pre></div>

<p><strong>Let's parse this evidence</strong>:</p>
<ol>
<li>
<p><strong>What the developer experiences</strong>: Code compiles and runs without errors, but the component behaves inconsistently. Multiple boolean flags can be true simultaneously, creating impossible states.</p>
</li>
<li>
<p><strong>What TypeScript reveals</strong>: Nothing. The type system accepts any combination of boolean flags because they're all optional and independent.</p>
</li>
<li>
<p><strong>Root cause identified</strong>: Boolean flags create <strong>2^n possible states</strong> where n is the number of flags. With 4 type flags (<code>isSuccess</code>, <code>isError</code>, <code>isWarning</code>, <code>isInfo</code>), we have 16 possible combinations, but only 4 are valid.</p>
</li>
<li>
<p><strong>Why the current approach can't solve this</strong>: Optional boolean props are independent. TypeScript has no way to express "exactly one of these must be true" or "if actionLabel is provided, onAction must also be provided."</p>
</li>
<li>
<p><strong>What we need</strong>: A type system that makes <strong>invalid states unrepresentable</strong>. We need TypeScript to enforce that only valid combinations of props can exist.</p>
</li>
</ol>
<h3 id="iteration-1-introducing-discriminated-unions">Iteration 1: Introducing Discriminated Unions</h3>
<p>A <strong>discriminated union</strong> (also called a tagged union) is a TypeScript pattern where a single property (the "discriminant" or "tag") determines which other properties are valid.</p>
<p>Let's refactor our notification component to use this pattern.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/types/notifications.ts - Version 2</span>
<span class="c1">// Define each notification variant as a separate type</span>
<span class="kr">type</span><span class="w"> </span><span class="nx">SuccessNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="p">;</span><span class="w">  </span><span class="c1">// ‚Üê The discriminant</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dismissible?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="p">};</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">ErrorNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dismissible?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">action</span><span class="o">?:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">label</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">    </span><span class="nx">onClick</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">};</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">WarningNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;warning&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dismissible?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="p">};</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">InfoNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;info&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dismissible?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// Union type: a notification is ONE of these types</span>
<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">SuccessNotification</span><span class="w"> </span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">ErrorNotification</span><span class="w"> </span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">WarningNotification</span><span class="w"> </span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">InfoNotification</span><span class="p">;</span>
</code></pre></div>

<p>Now let's update our component to use this discriminated union:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/Notification.tsx - Version 2</span>
<span class="k">import</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/types/notifications&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">Notification</span><span class="p">(</span><span class="nx">props</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// TypeScript knows which properties exist based on the variant</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">getBackgroundColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;bg-green-100&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;bg-red-100&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;warning&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;bg-yellow-100&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;info&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;bg-blue-100&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">getIcon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;‚úì&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;‚úó&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;warning&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;‚ö†&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;info&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;‚Ñπ&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`p-4 rounded </span><span class="si">${</span><span class="nx">getBackgroundColor</span><span class="p">()</span><span class="si">}</span><span class="sb">`</span><span class="p">}&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex items-start gap-3&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;text-xl&quot;</span><span class="p">&gt;{</span><span class="nx">getIcon</span><span class="p">()}&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex-1&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;{</span><span class="nx">props</span><span class="p">.</span><span class="nx">message</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>

<span class="w">          </span><span class="p">{</span><span class="cm">/* TypeScript knows &#39;action&#39; only exists on error variant */</span><span class="p">}</span>
<span class="w">          </span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">props</span><span class="p">.</span><span class="nx">action</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">              </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">action</span><span class="p">.</span><span class="nx">onClick</span><span class="p">}</span>
<span class="w">              </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-2 text-sm underline&quot;</span>
<span class="w">            </span><span class="p">&gt;</span>
<span class="w">              </span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">action</span><span class="p">.</span><span class="nx">label</span><span class="p">}</span>
<span class="w">            </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">)}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">dismissible</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span>
<span class="w">            </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="cm">/* dismiss logic */</span><span class="p">}}</span><span class="w"> </span>
<span class="w">            </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;text-gray-500&quot;</span>
<span class="w">          </span><span class="p">&gt;</span>
<span class="w">            </span><span class="err">√ó</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>Now let's try to create those invalid states again:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/app/page.tsx - Attempting invalid states with discriminated unions</span>
<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">DashboardPage</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;p-8 space-y-4&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="cm">/* ‚úó TypeScript error: Cannot have both &#39;success&#39; and &#39;error&#39; */</span><span class="p">}</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">Notification</span>
<span class="w">        </span><span class="na">variant</span><span class="o">=</span><span class="s">&quot;success&quot;</span>
<span class="w">        </span><span class="na">variant</span><span class="o">=</span><span class="s">&quot;error&quot;</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">‚Üê</span><span class="w"> </span><span class="na">Error</span><span class="err">:</span><span class="w"> </span><span class="na">Duplicate</span><span class="w"> </span><span class="na">identifier</span><span class="w"> </span><span class="err">&#39;</span><span class="na">variant</span><span class="err">&#39;</span>
<span class="w">        </span><span class="na">message</span><span class="o">=</span><span class="s">&quot;This won&#39;t compile&quot;</span>
<span class="w">      </span><span class="p">/&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="cm">/* ‚úó TypeScript error: &#39;action&#39; doesn&#39;t exist on success variant */</span><span class="p">}</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">Notification</span>
<span class="w">        </span><span class="na">variant</span><span class="o">=</span><span class="s">&quot;success&quot;</span>
<span class="w">        </span><span class="na">message</span><span class="o">=</span><span class="s">&quot;Payment successful&quot;</span>
<span class="w">        </span><span class="na">action</span><span class="o">=</span><span class="p">{{</span><span class="w">  </span><span class="c1">// ‚Üê Error: Object literal may only specify known properties</span>
<span class="w">          </span><span class="nx">label</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;View Receipt&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">onClick</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{}</span>
<span class="w">        </span><span class="p">}}</span>
<span class="w">      </span><span class="p">/&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="cm">/* ‚úì This is valid - error variant can have an action */</span><span class="p">}</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">Notification</span>
<span class="w">        </span><span class="na">variant</span><span class="o">=</span><span class="s">&quot;error&quot;</span>
<span class="w">        </span><span class="na">message</span><span class="o">=</span><span class="s">&quot;Payment failed&quot;</span>
<span class="w">        </span><span class="na">action</span><span class="o">=</span><span class="p">{{</span>
<span class="w">          </span><span class="nx">label</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Retry&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">onClick</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;retrying&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}}</span>
<span class="w">      </span><span class="p">/&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>TypeScript Compiler Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>src/app/page.tsx:6:9<span class="w"> </span>-<span class="w"> </span>error<span class="w"> </span>TS1117:<span class="w"> </span>
An<span class="w"> </span>object<span class="w"> </span>literal<span class="w"> </span>cannot<span class="w"> </span>have<span class="w"> </span>multiple<span class="w"> </span>properties<span class="w"> </span>with<span class="w"> </span>the<span class="w"> </span>same<span class="w"> </span>name.

<span class="m">6</span><span class="w">         </span><span class="nv">variant</span><span class="o">=</span><span class="s2">&quot;error&quot;</span>
<span class="w">          </span>~~~~~~~

src/app/page.tsx:14:9<span class="w"> </span>-<span class="w"> </span>error<span class="w"> </span>TS2353:
Object<span class="w"> </span>literal<span class="w"> </span>may<span class="w"> </span>only<span class="w"> </span>specify<span class="w"> </span>known<span class="w"> </span>properties,<span class="w"> </span>and<span class="w"> </span><span class="s1">&#39;action&#39;</span><span class="w"> </span>
does<span class="w"> </span>not<span class="w"> </span>exist<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;SuccessNotification&#39;</span>.

<span class="m">14</span><span class="w">        </span><span class="nv">action</span><span class="o">={{</span>
<span class="w">          </span>~~~~~~

Found<span class="w"> </span><span class="m">2</span><span class="w"> </span>errors<span class="w"> </span><span class="k">in</span><span class="w"> </span>src/app/page.tsx
</code></pre></div>

<p><strong>Expected vs. Actual improvement</strong>: 
- <strong>Before</strong>: Invalid states compiled successfully, causing runtime bugs
- <strong>After</strong>: Invalid states are caught at compile time, preventing bugs before they reach the browser
- <strong>Concrete evidence</strong>: TypeScript now prevents us from creating notifications that are both success and error, or adding action buttons to notification types that don't support them</p>
<h3 id="the-power-of-exhaustiveness-checking">The Power of Exhaustiveness Checking</h3>
<p>One of the most powerful features of discriminated unions is <strong>exhaustiveness checking</strong>. TypeScript can verify that you've handled all possible variants.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/Notification.tsx - Demonstrating exhaustiveness checking</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">Notification</span><span class="p">(</span><span class="nx">props</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">getBackgroundColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;bg-green-100&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;bg-red-100&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;warning&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;bg-yellow-100&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="c1">// ‚Üê Forgot &#39;info&#39; case</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="c1">// TypeScript error: Function lacks ending return statement </span>
<span class="w">    </span><span class="c1">// and return type does not include &#39;undefined&#39;</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="c1">// Better: Use a helper to enforce exhaustiveness</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">assertNever</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kt">never</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">never</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Unhandled variant: </span><span class="si">${</span><span class="nx">value</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">getBackgroundColorSafe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;bg-green-100&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;bg-red-100&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;warning&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;bg-yellow-100&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;info&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;bg-blue-100&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">default</span><span class="o">:</span>
<span class="w">        </span><span class="c1">// If we add a new variant and forget to handle it,</span>
<span class="w">        </span><span class="c1">// TypeScript will error here</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">assertNever</span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`p-4 rounded </span><span class="si">${</span><span class="nx">getBackgroundColorSafe</span><span class="p">()</span><span class="si">}</span><span class="sb">`</span><span class="p">}&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="cm">/* ... */</span><span class="p">}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>Now let's add a new notification variant and see exhaustiveness checking in action:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/types/notifications.ts - Adding a new variant</span>
<span class="kr">type</span><span class="w"> </span><span class="nx">SuccessNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dismissible?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="p">};</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">ErrorNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dismissible?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">action</span><span class="o">?:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">label</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">    </span><span class="nx">onClick</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">};</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">WarningNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;warning&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dismissible?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="p">};</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">InfoNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;info&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dismissible?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// New variant added</span>
<span class="kr">type</span><span class="w"> </span><span class="nx">LoadingNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;loading&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">SuccessNotification</span><span class="w"> </span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">ErrorNotification</span><span class="w"> </span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">WarningNotification</span><span class="w"> </span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">InfoNotification</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">LoadingNotification</span><span class="p">;</span><span class="w">  </span><span class="c1">// ‚Üê Added to union</span>
</code></pre></div>

<p><strong>TypeScript Compiler Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>src/components/Notification.tsx:28:16<span class="w"> </span>-<span class="w"> </span>error<span class="w"> </span>TS2345:
Argument<span class="w"> </span>of<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;LoadingNotification&#39;</span><span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>assignable<span class="w"> </span>to<span class="w"> </span>parameter<span class="w"> </span>of<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;never&#39;</span>.

<span class="m">28</span><span class="w">        </span><span class="k">return</span><span class="w"> </span>assertNever<span class="o">(</span>props.variant<span class="o">)</span><span class="p">;</span>
<span class="w">                  </span>~~~~~~~~~~~

Found<span class="w"> </span><span class="m">1</span><span class="w"> </span>error<span class="w"> </span><span class="k">in</span><span class="w"> </span>src/components/Notification.tsx
</code></pre></div>

<p>TypeScript immediately tells us we forgot to handle the new <code>loading</code> variant. This is <strong>exhaustiveness checking</strong> in action‚Äîthe compiler ensures we handle all cases.</p>
<p>Let's fix it:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/Notification.tsx - Version 3 (handling all variants)</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">Notification</span><span class="p">(</span><span class="nx">props</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">assertNever</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kt">never</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">never</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Unhandled variant: </span><span class="si">${</span><span class="nx">value</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">getBackgroundColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;bg-green-100&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;bg-red-100&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;warning&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;bg-yellow-100&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;info&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;bg-blue-100&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;loading&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;bg-gray-100&#39;</span><span class="p">;</span><span class="w">  </span><span class="c1">// ‚Üê Added</span>
<span class="w">      </span><span class="nx">default</span><span class="o">:</span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span><span class="nx">assertNever</span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">getIcon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;‚úì&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;‚úó&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;warning&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;‚ö†&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;info&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;‚Ñπ&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;loading&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;‚ü≥&#39;</span><span class="p">;</span><span class="w">  </span><span class="c1">// ‚Üê Added</span>
<span class="w">      </span><span class="nx">default</span><span class="o">:</span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span><span class="nx">assertNever</span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`p-4 rounded </span><span class="si">${</span><span class="nx">getBackgroundColor</span><span class="p">()</span><span class="si">}</span><span class="sb">`</span><span class="p">}&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex items-start gap-3&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;text-xl&quot;</span><span class="p">&gt;{</span><span class="nx">getIcon</span><span class="p">()}&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex-1&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;{</span><span class="nx">props</span><span class="p">.</span><span class="nx">message</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>

<span class="w">          </span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">props</span><span class="p">.</span><span class="nx">action</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">              </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">action</span><span class="p">.</span><span class="nx">onClick</span><span class="p">}</span>
<span class="w">              </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-2 text-sm underline&quot;</span>
<span class="w">            </span><span class="p">&gt;</span>
<span class="w">              </span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">action</span><span class="p">.</span><span class="nx">label</span><span class="p">}</span>
<span class="w">            </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">)}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">dismissible</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;text-gray-500&quot;</span><span class="p">&gt;</span><span class="err">√ó</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="iteration-2-narrowing-with-type-guards">Iteration 2: Narrowing with Type Guards</h3>
<p>TypeScript's <strong>type narrowing</strong> automatically understands which properties are available after checking the discriminant. This is called <strong>control flow analysis</strong>.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/NotificationList.tsx - Demonstrating type narrowing</span>
<span class="k">import</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/types/notifications&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Notification</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./Notification&#39;</span><span class="p">;</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">NotificationWithId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">NotificationList</span><span class="p">({</span><span class="w"> </span>
<span class="w">  </span><span class="nx">notifications</span><span class="w"> </span>
<span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">  </span><span class="nx">notifications</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationWithId</span><span class="p">[]</span><span class="w"> </span>
<span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Filter to only error notifications with actions</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">actionableErrors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">notifications</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">notif</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// After this check, TypeScript knows notif is ErrorNotification</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">notif</span><span class="p">.</span><span class="nx">variant</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// TypeScript knows &#39;action&#39; exists on ErrorNotification</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">notif</span><span class="p">.</span><span class="nx">action</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="kc">undefined</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="c1">// TypeScript infers the type as ErrorNotification[]</span>
<span class="w">  </span><span class="c1">// because we filtered by variant === &#39;error&#39;</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">errorCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">actionableErrors</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;space-y-4&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">errorCount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;p-4 bg-red-50 rounded&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;font-semibold&quot;</span><span class="p">&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="nx">errorCount</span><span class="p">}</span><span class="w"> </span><span class="nx">error</span><span class="p">{</span><span class="nx">errorCount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;s&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">}</span><span class="w"> </span><span class="nx">require</span><span class="w"> </span><span class="nx">attention</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">)}</span>

<span class="w">      </span><span class="p">{</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">notif</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">Notification</span><span class="w"> </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">notif</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="w"> </span><span class="p">{</span><span class="na">...notif</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">))}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="iteration-3-complex-discriminated-unions">Iteration 3: Complex Discriminated Unions</h3>
<p>Let's extend our notification system to handle more complex scenarios. We'll add a notification type that requires user confirmation before dismissing.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/types/notifications.ts - Version 3 (complex variants)</span>
<span class="kr">type</span><span class="w"> </span><span class="nx">SuccessNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dismissible?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="p">};</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">ErrorNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dismissible?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">action</span><span class="o">?:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">label</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">    </span><span class="nx">onClick</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">};</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">WarningNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;warning&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dismissible?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="p">};</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">InfoNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;info&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dismissible?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="p">};</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">LoadingNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;loading&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// New: Confirmation required before dismissing</span>
<span class="kr">type</span><span class="w"> </span><span class="nx">ConfirmationNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;confirmation&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">confirmText</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">cancelText</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onConfirm</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onCancel</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="nx">severity</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;warning&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;danger&#39;</span><span class="p">;</span><span class="w">  </span><span class="c1">// ‚Üê Nested discriminated union</span>
<span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">SuccessNotification</span><span class="w"> </span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">ErrorNotification</span><span class="w"> </span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">WarningNotification</span><span class="w"> </span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">InfoNotification</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">LoadingNotification</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">ConfirmationNotification</span><span class="p">;</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/Notification.tsx - Version 4 (handling confirmation)</span>
<span class="k">import</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/types/notifications&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">Notification</span><span class="p">(</span><span class="nx">props</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">assertNever</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kt">never</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">never</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Unhandled variant: </span><span class="si">${</span><span class="nx">value</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">getBackgroundColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;bg-green-100&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;bg-red-100&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;warning&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;bg-yellow-100&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;info&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;bg-blue-100&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;loading&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;bg-gray-100&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;confirmation&#39;</span><span class="o">:</span>
<span class="w">        </span><span class="c1">// Nested discriminated union</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">props</span><span class="p">.</span><span class="nx">severity</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;danger&#39;</span><span class="w"> </span>
<span class="w">          </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;bg-red-100&#39;</span><span class="w"> </span>
<span class="w">          </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;bg-yellow-100&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="nx">default</span><span class="o">:</span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span><span class="nx">assertNever</span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">getIcon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;‚úì&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;‚úó&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;warning&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;‚ö†&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;info&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;‚Ñπ&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;loading&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;‚ü≥&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;confirmation&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;?&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="nx">default</span><span class="o">:</span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span><span class="nx">assertNever</span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`p-4 rounded </span><span class="si">${</span><span class="nx">getBackgroundColor</span><span class="p">()</span><span class="si">}</span><span class="sb">`</span><span class="p">}&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex items-start gap-3&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;text-xl&quot;</span><span class="p">&gt;{</span><span class="nx">getIcon</span><span class="p">()}&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex-1&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;{</span><span class="nx">props</span><span class="p">.</span><span class="nx">message</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>

<span class="w">          </span><span class="p">{</span><span class="cm">/* Error action button */</span><span class="p">}</span>
<span class="w">          </span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">props</span><span class="p">.</span><span class="nx">action</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">              </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">action</span><span class="p">.</span><span class="nx">onClick</span><span class="p">}</span>
<span class="w">              </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-2 text-sm underline&quot;</span>
<span class="w">            </span><span class="p">&gt;</span>
<span class="w">              </span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">action</span><span class="p">.</span><span class="nx">label</span><span class="p">}</span>
<span class="w">            </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">)}</span>

<span class="w">          </span><span class="p">{</span><span class="cm">/* Confirmation buttons */</span><span class="p">}</span>
<span class="w">          </span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;confirmation&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-3 flex gap-2&quot;</span><span class="p">&gt;</span>
<span class="w">              </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">                </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">onConfirm</span><span class="p">}</span>
<span class="w">                </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`px-4 py-2 rounded text-white </span><span class="si">${</span>
<span class="w">                  </span><span class="nx">props</span><span class="p">.</span><span class="nx">severity</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;danger&#39;</span><span class="w"> </span>
<span class="w">                    </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;bg-red-600 hover:bg-red-700&#39;</span><span class="w"> </span>
<span class="w">                    </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;bg-yellow-600 hover:bg-yellow-700&#39;</span>
<span class="w">                </span><span class="si">}</span><span class="sb">`</span><span class="p">}</span>
<span class="w">              </span><span class="p">&gt;</span>
<span class="w">                </span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">confirmText</span><span class="p">}</span>
<span class="w">              </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">              </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">                </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">onCancel</span><span class="p">}</span>
<span class="w">                </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;px-4 py-2 rounded bg-gray-200 hover:bg-gray-300&quot;</span>
<span class="w">              </span><span class="p">&gt;</span>
<span class="w">                </span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">cancelText</span><span class="p">}</span>
<span class="w">              </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">            </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">)}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">{</span><span class="cm">/* Only show dismiss button for dismissible variants */</span><span class="p">}</span>
<span class="w">        </span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;confirmation&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>
<span class="w">         </span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;loading&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>
<span class="w">         </span><span class="nx">props</span><span class="p">.</span><span class="nx">dismissible</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;text-gray-500&quot;</span><span class="p">&gt;</span><span class="err">√ó</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>Now let's use the confirmation notification:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/app/page.tsx - Using confirmation notifications</span>
<span class="s1">&#39;use client&#39;</span><span class="p">;</span>

<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Notification</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/components/Notification&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/types/notifications&#39;</span><span class="p">;</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">NotificationWithId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">DashboardPage</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">notifications</span><span class="p">,</span><span class="w"> </span><span class="nx">setNotifications</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">NotificationWithId</span><span class="err">[]</span><span class="p">&gt;([</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Profile updated successfully&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">dismissible</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;confirmation&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Are you sure you want to delete your account? This action cannot be undone.&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">confirmText</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Delete Account&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">cancelText</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Cancel&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">severity</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;danger&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">onConfirm</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Account deleted&#39;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">setNotifications</span><span class="p">(</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">n</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="p">));</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nx">onCancel</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Deletion cancelled&#39;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">setNotifications</span><span class="p">(</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">n</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="p">));</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">  </span><span class="p">]);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;p-8 space-y-4&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h1</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;text-2xl font-bold&quot;</span><span class="p">&gt;</span><span class="nx">Dashboard</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">notif</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">Notification</span><span class="w"> </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">notif</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="w"> </span><span class="p">{</span><span class="na">...notif</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">      </span><span class="p">))}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Expected vs. Actual improvement</strong>:
- <strong>Before</strong>: Confirmation logic mixed with dismissible logic, easy to create invalid states
- <strong>After</strong>: Confirmation notifications are a distinct type with required callbacks, impossible to create a confirmation without both confirm and cancel handlers
- <strong>Concrete evidence</strong>: TypeScript enforces that confirmation notifications must have <code>onConfirm</code>, <code>onCancel</code>, <code>confirmText</code>, <code>cancelText</code>, and <code>severity</code> properties</p>
<h3 id="when-to-apply-this-solution">When to Apply This Solution</h3>
<p><strong>What it optimizes for</strong>:
- Type safety: Invalid states become unrepresentable
- Maintainability: Adding new variants forces you to handle them everywhere
- Clarity: The type system documents valid combinations</p>
<p><strong>What it sacrifices</strong>:
- Initial setup complexity: More types to define upfront
- Verbosity: More code than simple boolean flags</p>
<p><strong>When to choose this approach</strong>:
- Components with multiple distinct behaviors (buttons, alerts, modals)
- Data that can be in one of several mutually exclusive states
- When you need exhaustiveness checking (handling all cases)
- When invalid combinations would cause bugs</p>
<p><strong>When to avoid this approach</strong>:
- Simple components with independent boolean flags (e.g., <code>disabled</code>, <code>loading</code>)
- When variants share 90%+ of the same properties
- Prototyping phase where requirements are still changing rapidly</p>
<p><strong>Code characteristics</strong>:
- Setup: Medium complexity (define union types upfront)
- Maintenance: Low burden (TypeScript guides you through changes)
- Performance: Zero runtime cost (types are erased at compile time)</p>
<h3 id="limitation-preview">Limitation preview</h3>
<p>Our notification system now has strong type safety, but we're still manually handling the discriminant checks in every function. In the next section, we'll explore <strong>utility types</strong> that can help us extract and manipulate these discriminated unions more elegantly.</p>
<h2 id="utility-types-that-actually-matter">Utility types that actually matter</h2>
<h2 id="utility-types-that-actually-matter_1">Utility types that actually matter</h2>
<p>TypeScript includes dozens of built-in utility types, but most developers only need to know a handful. In this section, we'll focus on the utility types that solve real problems in React applications, using our notification system as the reference implementation.</p>
<h3 id="the-problem-extracting-specific-variants">The Problem: Extracting Specific Variants</h3>
<p>Our notification system works well, but what if we need to work with only error notifications? Or only notifications that can be dismissed?</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/ErrorSummary.tsx - Naive approach</span>
<span class="k">import</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/types/notifications&#39;</span><span class="p">;</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">NotificationWithId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ErrorSummary</span><span class="p">({</span><span class="w"> </span>
<span class="w">  </span><span class="nx">notifications</span><span class="w"> </span>
<span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">  </span><span class="nx">notifications</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationWithId</span><span class="p">[]</span><span class="w"> </span>
<span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// We want only error notifications, but TypeScript doesn&#39;t know that</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">errors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">notifications</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">n</span><span class="p">.</span><span class="nx">variant</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// TypeScript error: Property &#39;action&#39; does not exist on type &#39;NotificationWithId&#39;</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">actionableErrors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">e</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">action</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="kc">undefined</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">actionableErrors</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">error</span><span class="p">.</span><span class="nx">id</span><span class="p">}&gt;</span>
<span class="w">          </span><span class="p">{</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">}</span>
<span class="w">          </span><span class="p">{</span><span class="cm">/* TypeScript still doesn&#39;t know &#39;action&#39; exists */</span><span class="p">}</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">error</span><span class="p">.</span><span class="nx">action</span><span class="p">.</span><span class="nx">onClick</span><span class="p">}&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="nx">error</span><span class="p">.</span><span class="nx">action</span><span class="p">.</span><span class="nx">label</span><span class="p">}</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">))}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>TypeScript Compiler Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>src/components/ErrorSummary.tsx:14:38<span class="w"> </span>-<span class="w"> </span>error<span class="w"> </span>TS2339:
Property<span class="w"> </span><span class="s1">&#39;action&#39;</span><span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>exist<span class="w"> </span>on<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;NotificationWithId&#39;</span>.

<span class="m">14</span><span class="w">   </span>const<span class="w"> </span><span class="nv">actionableErrors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>errors.filter<span class="o">(</span><span class="nv">e</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>e.action<span class="w"> </span>!<span class="o">==</span><span class="w"> </span>undefined<span class="o">)</span><span class="p">;</span>
<span class="w">                                        </span>~~~~~~~~

src/components/ErrorSummary.tsx:20:28<span class="w"> </span>-<span class="w"> </span>error<span class="w"> </span>TS2339:
Property<span class="w"> </span><span class="s1">&#39;action&#39;</span><span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>exist<span class="w"> </span>on<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;NotificationWithId&#39;</span>.

<span class="m">20</span><span class="w">           </span>&lt;button<span class="w"> </span><span class="nv">onClick</span><span class="o">={</span>error.action.onClick<span class="o">}</span>&gt;
<span class="w">                              </span>~~~~~~~~~~~~

Found<span class="w"> </span><span class="m">2</span><span class="w"> </span>errors<span class="w"> </span><span class="k">in</span><span class="w"> </span>src/components/ErrorSummary.tsx
</code></pre></div>

<p><strong>Root cause</strong>: TypeScript's <code>filter</code> method doesn't narrow the type. Even though we filtered by <code>variant === 'error'</code>, TypeScript still thinks <code>errors</code> is an array of all notification types.</p>
<h3 id="iteration-1-extract-pulling-out-specific-union-members">Iteration 1: Extract - Pulling Out Specific Union Members</h3>
<p>The <code>Extract</code> utility type lets us pull out specific members of a union based on a condition.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/types/notifications.ts - Adding helper types</span>
<span class="kr">type</span><span class="w"> </span><span class="nx">SuccessNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dismissible?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="p">};</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">ErrorNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dismissible?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">action</span><span class="o">?:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">label</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">    </span><span class="nx">onClick</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">};</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">WarningNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;warning&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dismissible?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="p">};</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">InfoNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;info&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dismissible?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="p">};</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">LoadingNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;loading&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">};</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">ConfirmationNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;confirmation&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">confirmText</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">cancelText</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onConfirm</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onCancel</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="nx">severity</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;warning&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;danger&#39;</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">SuccessNotification</span><span class="w"> </span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">ErrorNotification</span><span class="w"> </span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">WarningNotification</span><span class="w"> </span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">InfoNotification</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">LoadingNotification</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">ConfirmationNotification</span><span class="p">;</span>

<span class="c1">// Extract specific variants</span>
<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">ErrorNotificationOnly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Extract</span><span class="o">&lt;</span>
<span class="w">  </span><span class="nx">NotificationProps</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="w"> </span><span class="p">}</span>
<span class="o">&gt;</span><span class="p">;</span>
<span class="c1">// Result: ErrorNotification</span>

<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">DismissibleNotifications</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Extract</span><span class="o">&lt;</span>
<span class="w">  </span><span class="nx">NotificationProps</span><span class="p">,</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">dismissible?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="p">}</span>
<span class="o">&gt;</span><span class="p">;</span>
<span class="c1">// Result: SuccessNotification | ErrorNotification | WarningNotification | InfoNotification</span>

<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">NotificationsWithActions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Extract</span><span class="o">&lt;</span>
<span class="w">  </span><span class="nx">NotificationProps</span><span class="p">,</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">action?</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="w"> </span><span class="p">}</span>
<span class="o">&gt;</span><span class="p">;</span>
<span class="c1">// Result: ErrorNotification</span>
</code></pre></div>

<p>Now let's use <code>Extract</code> to fix our error summary component:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/ErrorSummary.tsx - Version 2 (using Extract)</span>
<span class="k">import</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="p">,</span><span class="w"> </span><span class="nx">ErrorNotificationOnly</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/types/notifications&#39;</span><span class="p">;</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">NotificationWithId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">};</span>
<span class="kr">type</span><span class="w"> </span><span class="nx">ErrorWithId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ErrorNotificationOnly</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ErrorSummary</span><span class="p">({</span><span class="w"> </span>
<span class="w">  </span><span class="nx">notifications</span><span class="w"> </span>
<span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">  </span><span class="nx">notifications</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationWithId</span><span class="p">[]</span><span class="w"> </span>
<span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Type assertion after filtering</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">errors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">notifications</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span>
<span class="w">    </span><span class="p">(</span><span class="nx">n</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">ErrorWithId</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">n</span><span class="p">.</span><span class="nx">variant</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;error&#39;</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Now TypeScript knows errors is ErrorWithId[]</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">actionableErrors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">e</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">action</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="kc">undefined</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;space-y-2&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h2</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;text-lg font-semibold text-red-600&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="nx">Errors</span><span class="w"> </span><span class="p">({</span><span class="nx">errors</span><span class="p">.</span><span class="nx">length</span><span class="p">})</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">actionableErrors</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">error</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;p-3 bg-red-50 rounded&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;{</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">{</span><span class="nx">error</span><span class="p">.</span><span class="nx">action</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span>
<span class="w">              </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">error</span><span class="p">.</span><span class="nx">action</span><span class="p">.</span><span class="nx">onClick</span><span class="p">}</span>
<span class="w">              </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-2 text-sm underline&quot;</span>
<span class="w">            </span><span class="p">&gt;</span>
<span class="w">              </span><span class="p">{</span><span class="nx">error</span><span class="p">.</span><span class="nx">action</span><span class="p">.</span><span class="nx">label</span><span class="p">}</span>
<span class="w">            </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">)}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">))}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Expected vs. Actual improvement</strong>:
- <strong>Before</strong>: TypeScript couldn't understand that filtered array contained only error notifications
- <strong>After</strong>: Using type predicate <code>(n): n is ErrorWithId</code> tells TypeScript exactly what type the filtered array contains
- <strong>Concrete evidence</strong>: No more type errors when accessing <code>error.action</code></p>
<h3 id="iteration-2-exclude-removing-specific-union-members">Iteration 2: Exclude - Removing Specific Union Members</h3>
<p>The opposite of <code>Extract</code> is <code>Exclude</code>, which removes specific members from a union.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/types/notifications.ts - Using Exclude</span>
<span class="c1">// Get all notifications except loading</span>
<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">InteractiveNotifications</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Exclude</span><span class="o">&lt;</span>
<span class="w">  </span><span class="nx">NotificationProps</span><span class="p">,</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;loading&#39;</span><span class="w"> </span><span class="p">}</span>
<span class="o">&gt;</span><span class="p">;</span>
<span class="c1">// Result: All notification types except LoadingNotification</span>

<span class="c1">// Get all notifications except confirmation and loading</span>
<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">SimpleNotifications</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Exclude</span><span class="o">&lt;</span>
<span class="w">  </span><span class="nx">NotificationProps</span><span class="p">,</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;loading&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;confirmation&#39;</span><span class="w"> </span><span class="p">}</span>
<span class="o">&gt;</span><span class="p">;</span>
<span class="c1">// Result: SuccessNotification | ErrorNotification | WarningNotification | InfoNotification</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/NotificationList.tsx - Using Exclude</span>
<span class="k">import</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="p">,</span><span class="w"> </span><span class="nx">InteractiveNotifications</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/types/notifications&#39;</span><span class="p">;</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">NotificationWithId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">};</span>
<span class="kr">type</span><span class="w"> </span><span class="nx">InteractiveWithId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">InteractiveNotifications</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">NotificationList</span><span class="p">({</span><span class="w"> </span>
<span class="w">  </span><span class="nx">notifications</span><span class="w"> </span>
<span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">  </span><span class="nx">notifications</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationWithId</span><span class="p">[]</span><span class="w"> </span>
<span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Filter out loading notifications</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">interactive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">notifications</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span>
<span class="w">    </span><span class="p">(</span><span class="nx">n</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">InteractiveWithId</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">n</span><span class="p">.</span><span class="nx">variant</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;loading&#39;</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;space-y-4&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">interactive</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">notif</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">notif</span><span class="p">.</span><span class="nx">id</span><span class="p">}&gt;</span>
<span class="w">          </span><span class="p">{</span><span class="cm">/* We know these notifications can be interacted with */</span><span class="p">}</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">Notification</span><span class="w"> </span><span class="p">{</span><span class="na">...notif</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">))}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="iteration-3-pick-and-omit-selecting-or-removing-properties">Iteration 3: Pick and Omit - Selecting or Removing Properties</h3>
<p><code>Pick</code> and <code>Omit</code> work on object properties rather than union members.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/types/notifications.ts - Using Pick and Omit</span>
<span class="c1">// Pick only specific properties</span>
<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">NotificationPreview</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Pick</span><span class="o">&lt;</span>
<span class="w">  </span><span class="nx">ErrorNotification</span><span class="p">,</span>
<span class="w">  </span><span class="s1">&#39;variant&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;message&#39;</span>
<span class="o">&gt;</span><span class="p">;</span>
<span class="c1">// Result: { variant: &#39;error&#39;; message: string; }</span>

<span class="c1">// Omit specific properties</span>
<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">NotificationWithoutActions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Omit</span><span class="o">&lt;</span>
<span class="w">  </span><span class="nx">ErrorNotification</span><span class="p">,</span>
<span class="w">  </span><span class="s1">&#39;action&#39;</span>
<span class="o">&gt;</span><span class="p">;</span>
<span class="c1">// Result: { variant: &#39;error&#39;; message: string; dismissible?: boolean; }</span>
</code></pre></div>

<p>Let's use these to create a notification preview component that shows only essential information:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/NotificationPreview.tsx</span>
<span class="k">import</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/types/notifications&#39;</span><span class="p">;</span>

<span class="c1">// Create a preview type that only includes variant and message</span>
<span class="kr">type</span><span class="w"> </span><span class="nx">NotificationPreview</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Pick</span><span class="p">&lt;</span><span class="nt">NotificationProps</span><span class="err">,</span><span class="w"> </span><span class="err">&#39;</span><span class="na">variant</span><span class="err">&#39;</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="err">&#39;</span><span class="na">message</span><span class="err">&#39;</span><span class="p">&gt;;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">NotificationPreview</span><span class="p">({</span><span class="w"> </span>
<span class="w">  </span><span class="nx">variant</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="nx">message</span><span class="w"> </span>
<span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="nx">NotificationPreview</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">getIcon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">variant</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;‚úì&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;‚úó&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;warning&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;‚ö†&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;info&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;‚Ñπ&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;loading&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;‚ü≥&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;confirmation&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;?&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex items-center gap-2 text-sm&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">span</span><span class="p">&gt;{</span><span class="nx">getIcon</span><span class="p">()}&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;truncate&quot;</span><span class="p">&gt;{</span><span class="nx">message</span><span class="p">}&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="iteration-4-partial-and-required-making-properties-optional-or-required">Iteration 4: Partial and Required - Making Properties Optional or Required</h3>
<p><code>Partial</code> makes all properties optional. <code>Required</code> makes all properties required.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/types/notifications.ts - Using Partial and Required</span>
<span class="c1">// Make all properties optional (useful for updates)</span>
<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">NotificationUpdate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Partial</span><span class="o">&lt;</span><span class="nx">ErrorNotification</span><span class="o">&gt;</span><span class="p">;</span>
<span class="c1">// Result: All properties are optional</span>

<span class="c1">// Make all properties required (useful for validation)</span>
<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">CompleteErrorNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Required</span><span class="o">&lt;</span><span class="nx">ErrorNotification</span><span class="o">&gt;</span><span class="p">;</span>
<span class="c1">// Result: { </span>
<span class="c1">//   variant: &#39;error&#39;; </span>
<span class="c1">//   message: string; </span>
<span class="c1">//   dismissible: boolean;  // ‚Üê No longer optional</span>
<span class="c1">//   action: {              // ‚Üê No longer optional</span>
<span class="c1">//     label: string; </span>
<span class="c1">//     onClick: () =&gt; void; </span>
<span class="c1">//   }; </span>
<span class="c1">// }</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/hooks/useNotifications.ts - Using Partial for updates</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/types/notifications&#39;</span><span class="p">;</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">NotificationWithId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">};</span>
<span class="kr">type</span><span class="w"> </span><span class="nx">NotificationUpdate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Partial</span><span class="p">&lt;</span><span class="nt">NotificationProps</span><span class="p">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">useNotifications</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">notifications</span><span class="p">,</span><span class="w"> </span><span class="nx">setNotifications</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">NotificationWithId</span><span class="err">[]</span><span class="p">&gt;([]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">addNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">notification</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationProps</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">().</span><span class="nx">toString</span><span class="p">(</span><span class="mf">36</span><span class="p">).</span><span class="nx">substr</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">9</span><span class="p">);</span>
<span class="w">    </span><span class="nx">setNotifications</span><span class="p">([...</span><span class="nx">notifications</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="nx">notification</span><span class="p">,</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="p">}]);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="c1">// Update only specific properties of a notification</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">updateNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">update</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationUpdate</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setNotifications</span><span class="p">(</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">notif</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span>
<span class="w">      </span><span class="nx">notif</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">update</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span>
<span class="w">        </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="nx">notif</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="nx">update</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="c1">// Merge update into existing notification</span>
<span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="nx">notif</span>
<span class="w">    </span><span class="p">));</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">removeNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setNotifications</span><span class="p">(</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">n</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">id</span><span class="p">));</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">notifications</span><span class="p">,</span>
<span class="w">    </span><span class="nx">addNotification</span><span class="p">,</span>
<span class="w">    </span><span class="nx">updateNotification</span><span class="p">,</span>
<span class="w">    </span><span class="nx">removeNotification</span><span class="p">,</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/app/page.tsx - Using the hook with partial updates</span>
<span class="s1">&#39;use client&#39;</span><span class="p">;</span>

<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useNotifications</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/hooks/useNotifications&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Notification</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/components/Notification&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">DashboardPage</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">notifications</span><span class="p">,</span><span class="w"> </span><span class="nx">addNotification</span><span class="p">,</span><span class="w"> </span><span class="nx">updateNotification</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useNotifications</span><span class="p">();</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleAddError</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">addNotification</span><span class="p">({</span>
<span class="w">      </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Failed to save changes&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">dismissible</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
<span class="w">      </span><span class="nx">action</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">label</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Retry&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">onClick</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Retrying...&#39;</span><span class="p">),</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleUpdateMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Only update the message, keep everything else the same</span>
<span class="w">    </span><span class="nx">updateNotification</span><span class="p">({</span>
<span class="w">      </span><span class="nx">id</span><span class="p">,</span>
<span class="w">      </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Updated message&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;p-8 space-y-4&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span>
<span class="w">        </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleAddError</span><span class="p">}</span>
<span class="w">        </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;px-4 py-2 bg-blue-600 text-white rounded&quot;</span>
<span class="w">      </span><span class="p">&gt;</span>
<span class="w">        </span><span class="nx">Add</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="nx">Notification</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">notif</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">notif</span><span class="p">.</span><span class="nx">id</span><span class="p">}&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">Notification</span><span class="w"> </span><span class="p">{</span><span class="na">...notif</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">            </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">handleUpdateMessage</span><span class="p">(</span><span class="nx">notif</span><span class="p">.</span><span class="nx">id</span><span class="p">)}</span>
<span class="w">            </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-2 text-sm text-blue-600&quot;</span>
<span class="w">          </span><span class="p">&gt;</span>
<span class="w">            </span><span class="nx">Update</span><span class="w"> </span><span class="nx">Message</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">))}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="iteration-5-record-creating-object-types-with-specific-keys">Iteration 5: Record - Creating Object Types with Specific Keys</h3>
<p><code>Record&lt;Keys, Type&gt;</code> creates an object type where all keys are of type <code>Keys</code> and all values are of type <code>Type</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/types/notifications.ts - Using Record</span>
<span class="c1">// Map each variant to its configuration</span>
<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">NotificationConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Record</span><span class="o">&lt;</span>
<span class="w">  </span><span class="nx">NotificationProps</span><span class="p">[</span><span class="s1">&#39;variant&#39;</span><span class="p">],</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="nx">icon</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">    </span><span class="nx">backgroundColor</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">    </span><span class="nx">textColor</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="o">&gt;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">notificationConfig</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">icon</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;‚úì&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">backgroundColor</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;bg-green-100&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">textColor</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;text-green-800&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">icon</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;‚úó&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">backgroundColor</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;bg-red-100&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">textColor</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;text-red-800&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nx">warning</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">icon</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;‚ö†&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">backgroundColor</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;bg-yellow-100&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">textColor</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;text-yellow-800&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nx">info</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">icon</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;‚Ñπ&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">backgroundColor</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;bg-blue-100&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">textColor</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;text-blue-800&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nx">loading</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">icon</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;‚ü≥&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">backgroundColor</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;bg-gray-100&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">textColor</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;text-gray-800&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nx">confirmation</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">icon</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;?&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">backgroundColor</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;bg-purple-100&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">textColor</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;text-purple-800&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="p">},</span>
<span class="p">};</span>
</code></pre></div>

<p>Now let's refactor our Notification component to use this configuration:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/Notification.tsx - Version 5 (using Record config)</span>
<span class="k">import</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/types/notifications&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">notificationConfig</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/types/notifications&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">Notification</span><span class="p">(</span><span class="nx">props</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Get configuration based on variant</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">notificationConfig</span><span class="p">[</span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="p">];</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`p-4 rounded </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">backgroundColor</span><span class="si">}</span><span class="sb">`</span><span class="p">}&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex items-start gap-3&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`text-xl </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">textColor</span><span class="si">}</span><span class="sb">`</span><span class="p">}&gt;</span>
<span class="w">          </span><span class="p">{</span><span class="nx">config</span><span class="p">.</span><span class="nx">icon</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex-1&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="nx">config</span><span class="p">.</span><span class="nx">textColor</span><span class="p">}&gt;{</span><span class="nx">props</span><span class="p">.</span><span class="nx">message</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>

<span class="w">          </span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">props</span><span class="p">.</span><span class="nx">action</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">              </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">action</span><span class="p">.</span><span class="nx">onClick</span><span class="p">}</span>
<span class="w">              </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-2 text-sm underline&quot;</span>
<span class="w">            </span><span class="p">&gt;</span>
<span class="w">              </span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">action</span><span class="p">.</span><span class="nx">label</span><span class="p">}</span>
<span class="w">            </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">)}</span>

<span class="w">          </span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;confirmation&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-3 flex gap-2&quot;</span><span class="p">&gt;</span>
<span class="w">              </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">                </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">onConfirm</span><span class="p">}</span>
<span class="w">                </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`px-4 py-2 rounded text-white </span><span class="si">${</span>
<span class="w">                  </span><span class="nx">props</span><span class="p">.</span><span class="nx">severity</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;danger&#39;</span><span class="w"> </span>
<span class="w">                    </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;bg-red-600 hover:bg-red-700&#39;</span><span class="w"> </span>
<span class="w">                    </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;bg-yellow-600 hover:bg-yellow-700&#39;</span>
<span class="w">                </span><span class="si">}</span><span class="sb">`</span><span class="p">}</span>
<span class="w">              </span><span class="p">&gt;</span>
<span class="w">                </span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">confirmText</span><span class="p">}</span>
<span class="w">              </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">              </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">                </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">onCancel</span><span class="p">}</span>
<span class="w">                </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;px-4 py-2 rounded bg-gray-200 hover:bg-gray-300&quot;</span>
<span class="w">              </span><span class="p">&gt;</span>
<span class="w">                </span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">cancelText</span><span class="p">}</span>
<span class="w">              </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">            </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">)}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;confirmation&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>
<span class="w">         </span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;loading&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>
<span class="w">         </span><span class="nx">props</span><span class="p">.</span><span class="nx">dismissible</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;text-gray-500&quot;</span><span class="p">&gt;</span><span class="err">√ó</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Expected vs. Actual improvement</strong>:
- <strong>Before</strong>: Configuration logic scattered across multiple switch statements
- <strong>After</strong>: Single source of truth for variant configuration, easier to maintain and extend
- <strong>Concrete evidence</strong>: Adding a new variant now requires updating only the <code>NotificationConfig</code> type and the <code>notificationConfig</code> object</p>
<h3 id="iteration-6-returntype-and-parameters-extracting-function-types">Iteration 6: ReturnType and Parameters - Extracting Function Types</h3>
<p><code>ReturnType</code> extracts the return type of a function. <code>Parameters</code> extracts the parameter types.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/types/notifications.ts - Using ReturnType and Parameters</span>
<span class="c1">// Extract the return type of a function</span>
<span class="kr">type</span><span class="w"> </span><span class="nx">NotificationHookReturn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ReturnType</span><span class="o">&lt;</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">useNotifications</span><span class="o">&gt;</span><span class="p">;</span>
<span class="c1">// Result: {</span>
<span class="c1">//   notifications: NotificationWithId[];</span>
<span class="c1">//   addNotification: (notification: NotificationProps) =&gt; void;</span>
<span class="c1">//   updateNotification: (update: NotificationUpdate) =&gt; void;</span>
<span class="c1">//   removeNotification: (id: string) =&gt; void;</span>
<span class="c1">// }</span>

<span class="c1">// Extract parameter types</span>
<span class="kr">type</span><span class="w"> </span><span class="nx">AddNotificationParams</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Parameters</span><span class="o">&lt;</span><span class="nx">NotificationHookReturn</span><span class="p">[</span><span class="s1">&#39;addNotification&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="p">;</span>
<span class="c1">// Result: [notification: NotificationProps]</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">UpdateNotificationParams</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Parameters</span><span class="o">&lt;</span><span class="nx">NotificationHookReturn</span><span class="p">[</span><span class="s1">&#39;updateNotification&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="p">;</span>
<span class="c1">// Result: [update: NotificationUpdate]</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/NotificationManager.tsx - Using extracted types</span>
<span class="k">import</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">ReturnType</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useNotifications</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/hooks/useNotifications&#39;</span><span class="p">;</span>

<span class="c1">// Extract the hook&#39;s return type</span>
<span class="kr">type</span><span class="w"> </span><span class="nx">NotificationHookReturn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ReturnType</span><span class="p">&lt;</span><span class="nt">typeof</span><span class="w"> </span><span class="na">useNotifications</span><span class="p">&gt;;</span>

<span class="c1">// Create a component that accepts the hook&#39;s return value</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">NotificationManager</span><span class="p">({</span><span class="w"> </span>
<span class="w">  </span><span class="nx">notificationSystem</span><span class="w"> </span>
<span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">  </span><span class="nx">notificationSystem</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationHookReturn</span><span class="w"> </span>
<span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">notifications</span><span class="p">,</span><span class="w"> </span><span class="nx">addNotification</span><span class="p">,</span><span class="w"> </span><span class="nx">removeNotification</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">notificationSystem</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;space-y-4&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex gap-2&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">          </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">addNotification</span><span class="p">({</span>
<span class="w">            </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="p">,</span>
<span class="w">            </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Operation completed&#39;</span><span class="p">,</span>
<span class="w">            </span><span class="nx">dismissible</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
<span class="w">          </span><span class="p">})}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;px-4 py-2 bg-green-600 text-white rounded&quot;</span>
<span class="w">        </span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Add</span><span class="w"> </span><span class="nx">Success</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">          </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">addNotification</span><span class="p">({</span>
<span class="w">            </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">,</span>
<span class="w">            </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Operation failed&#39;</span><span class="p">,</span>
<span class="w">            </span><span class="nx">dismissible</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
<span class="w">          </span><span class="p">})}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;px-4 py-2 bg-red-600 text-white rounded&quot;</span>
<span class="w">        </span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Add</span><span class="w"> </span><span class="ne">Error</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">{</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">notif</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">notif</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex items-center gap-2&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">Notification</span><span class="w"> </span><span class="p">{</span><span class="na">...notif</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">            </span><span class="na">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">removeNotification</span><span class="p">(</span><span class="nx">notif</span><span class="p">.</span><span class="nx">id</span><span class="p">)}</span>
<span class="w">            </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;text-red-600&quot;</span>
<span class="w">          </span><span class="p">&gt;</span>
<span class="w">            </span><span class="nx">Remove</span>
<span class="w">          </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">))}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="when-to-apply-these-utility-types">When to Apply These Utility Types</h3>
<p><strong>Extract</strong>:
- <strong>Use when</strong>: You need to work with specific members of a discriminated union
- <strong>Example</strong>: Filtering notifications by variant and maintaining type safety</p>
<p><strong>Exclude</strong>:
- <strong>Use when</strong>: You need to remove specific members from a union
- <strong>Example</strong>: Getting all notifications except loading states</p>
<p><strong>Pick</strong>:
- <strong>Use when</strong>: You need only a subset of an object's properties
- <strong>Example</strong>: Creating preview components that show limited information</p>
<p><strong>Omit</strong>:
- <strong>Use when</strong>: You need most properties except a few
- <strong>Example</strong>: Creating types for API responses that exclude client-only properties</p>
<p><strong>Partial</strong>:
- <strong>Use when</strong>: You need to make all properties optional
- <strong>Example</strong>: Update operations where only changed fields are provided</p>
<p><strong>Required</strong>:
- <strong>Use when</strong>: You need to ensure all properties are present
- <strong>Example</strong>: Validation functions that require complete data</p>
<p><strong>Record</strong>:
- <strong>Use when</strong>: You need an object with specific keys and consistent value types
- <strong>Example</strong>: Configuration objects, lookup tables, mappings</p>
<p><strong>ReturnType</strong>:
- <strong>Use when</strong>: You need to reference a function's return type without duplicating it
- <strong>Example</strong>: Passing hook return values between components</p>
<p><strong>Parameters</strong>:
- <strong>Use when</strong>: You need to reference a function's parameter types
- <strong>Example</strong>: Creating wrapper functions that accept the same parameters</p>
<h3 id="limitation-preview_1">Limitation preview</h3>
<p>We've now mastered discriminated unions and utility types for our notification system. But what happens when we need to share this notification state across multiple components? In the next section, we'll explore how to type React Context and custom hooks properly.</p>
<h2 id="typing-context-and-custom-hooks">Typing context and custom hooks</h2>
<h2 id="typing-context-and-custom-hooks_1">Typing context and custom hooks</h2>
<p>Our notification system works well within a single component, but real applications need to share notification state across multiple components. This is where React Context comes in‚Äîbut Context introduces new TypeScript challenges.</p>
<h3 id="the-problem-context-with-undefined-initial-value">The Problem: Context with Undefined Initial Value</h3>
<p>Let's try to create a notification context using the naive approach:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/contexts/NotificationContext.tsx - Naive approach</span>
<span class="s1">&#39;use client&#39;</span><span class="p">;</span>

<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">createContext</span><span class="p">,</span><span class="w"> </span><span class="nx">useContext</span><span class="p">,</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">ReactNode</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/types/notifications&#39;</span><span class="p">;</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">NotificationWithId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">};</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">NotificationContextType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">notifications</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationWithId</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">addNotification</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">notification</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationProps</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="nx">removeNotification</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// ‚ùå Problem: We have to provide an initial value, but we don&#39;t have one yet</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">NotificationContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createContext</span><span class="p">&lt;</span><span class="nt">NotificationContextType</span><span class="p">&gt;({</span>
<span class="w">  </span><span class="nx">notifications</span><span class="o">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">  </span><span class="nx">addNotification</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{},</span><span class="w">  </span><span class="c1">// ‚Üê Dummy function</span>
<span class="w">  </span><span class="nx">removeNotification</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{},</span><span class="w"> </span><span class="c1">// ‚Üê Dummy function</span>
<span class="p">});</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">NotificationProvider</span><span class="p">({</span><span class="w"> </span><span class="nx">children</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">children</span><span class="o">:</span><span class="w"> </span><span class="kt">ReactNode</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">notifications</span><span class="p">,</span><span class="w"> </span><span class="nx">setNotifications</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">NotificationWithId</span><span class="err">[]</span><span class="p">&gt;([]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">addNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">notification</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationProps</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">().</span><span class="nx">toString</span><span class="p">(</span><span class="mf">36</span><span class="p">).</span><span class="nx">substr</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">9</span><span class="p">);</span>
<span class="w">    </span><span class="nx">setNotifications</span><span class="p">([...</span><span class="nx">notifications</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="nx">notification</span><span class="p">,</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="p">}]);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">removeNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setNotifications</span><span class="p">(</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">n</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">id</span><span class="p">));</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">NotificationContext</span><span class="p">.</span><span class="na">Provider</span><span class="w"> </span>
<span class="w">      </span><span class="na">value</span><span class="o">=</span><span class="p">{{</span><span class="w"> </span><span class="nx">notifications</span><span class="p">,</span><span class="w"> </span><span class="nx">addNotification</span><span class="p">,</span><span class="w"> </span><span class="nx">removeNotification</span><span class="w"> </span><span class="p">}}</span>
<span class="w">    </span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">children</span><span class="p">}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">NotificationContext</span><span class="p">.</span><span class="na">Provider</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">useNotifications</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">useContext</span><span class="p">(</span><span class="nx">NotificationContext</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>This compiles, but there's a subtle problem. Let's try to use it:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/SomeComponent.tsx - Using the context</span>
<span class="s1">&#39;use client&#39;</span><span class="p">;</span>

<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useNotifications</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/contexts/NotificationContext&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">SomeComponent</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">addNotification</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useNotifications</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// This works, but what if we use the context outside the provider?</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">addNotification</span><span class="p">({</span>
<span class="w">      </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Button clicked&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleClick</span><span class="p">}&gt;</span><span class="nx">Click</span><span class="w"> </span><span class="nx">me</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;;</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/app/page.tsx - Forgetting to wrap with provider</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">SomeComponent</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/components/SomeComponent&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">Page</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// ‚ùå Forgot to wrap with NotificationProvider</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">SomeComponent</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Browser Behavior</strong>:
When you click the button, nothing happens. The notification is not added.</p>
<p><strong>Browser Console Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>(No errors - the dummy function silently does nothing)
</code></pre></div>

<p><strong>Root cause</strong>: The dummy functions in the initial context value are called instead of the real functions from the provider. TypeScript doesn't warn us because the types match.</p>
<h3 id="diagnostic-analysis-reading-the-failure_1">Diagnostic Analysis: Reading the Failure</h3>
<p><strong>Let's parse this evidence</strong>:</p>
<ol>
<li>
<p><strong>What the developer experiences</strong>: Code compiles and runs, but context functions don't work when used outside the provider. No error message, just silent failure.</p>
</li>
<li>
<p><strong>What TypeScript reveals</strong>: Nothing. The dummy functions have the correct type signature, so TypeScript is satisfied.</p>
</li>
<li>
<p><strong>Root cause identified</strong>: We provided dummy implementations to satisfy TypeScript's requirement for an initial value, but those dummy implementations can actually be called if the context is used outside the provider.</p>
</li>
<li>
<p><strong>Why the current approach can't solve this</strong>: TypeScript can't distinguish between "dummy function that should never be called" and "real function from provider."</p>
</li>
<li>
<p><strong>What we need</strong>: A way to make the context value <code>undefined</code> initially, and force consumers to check for <code>undefined</code> before using it. Or better yet, throw a helpful error if the context is used outside the provider.</p>
</li>
</ol>
<h3 id="iteration-1-context-with-undefined-and-runtime-check">Iteration 1: Context with Undefined and Runtime Check</h3>
<p>The solution is to make the context value potentially <code>undefined</code>, and add a runtime check in the hook.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/contexts/NotificationContext.tsx - Version 2 (with undefined)</span>
<span class="s1">&#39;use client&#39;</span><span class="p">;</span>

<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">createContext</span><span class="p">,</span><span class="w"> </span><span class="nx">useContext</span><span class="p">,</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">ReactNode</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/types/notifications&#39;</span><span class="p">;</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">NotificationWithId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">};</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">NotificationContextType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">notifications</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationWithId</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">addNotification</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">notification</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationProps</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="nx">removeNotification</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// ‚úì Context value can be undefined</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">NotificationContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createContext</span><span class="p">&lt;</span><span class="nt">NotificationContextType</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="na">undefined</span><span class="p">&gt;(</span>
<span class="w">  </span><span class="kc">undefined</span>
<span class="p">);</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">NotificationProvider</span><span class="p">({</span><span class="w"> </span><span class="nx">children</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">children</span><span class="o">:</span><span class="w"> </span><span class="kt">ReactNode</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">notifications</span><span class="p">,</span><span class="w"> </span><span class="nx">setNotifications</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">NotificationWithId</span><span class="err">[]</span><span class="p">&gt;([]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">addNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">notification</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationProps</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">().</span><span class="nx">toString</span><span class="p">(</span><span class="mf">36</span><span class="p">).</span><span class="nx">substr</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">9</span><span class="p">);</span>
<span class="w">    </span><span class="nx">setNotifications</span><span class="p">([...</span><span class="nx">notifications</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="nx">notification</span><span class="p">,</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="p">}]);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">removeNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setNotifications</span><span class="p">(</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">n</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">id</span><span class="p">));</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">NotificationContext</span><span class="p">.</span><span class="na">Provider</span><span class="w"> </span>
<span class="w">      </span><span class="na">value</span><span class="o">=</span><span class="p">{{</span><span class="w"> </span><span class="nx">notifications</span><span class="p">,</span><span class="w"> </span><span class="nx">addNotification</span><span class="p">,</span><span class="w"> </span><span class="nx">removeNotification</span><span class="w"> </span><span class="p">}}</span>
<span class="w">    </span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">children</span><span class="p">}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">NotificationContext</span><span class="p">.</span><span class="na">Provider</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">useNotifications</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">context</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useContext</span><span class="p">(</span><span class="nx">NotificationContext</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Runtime check with helpful error message</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">context</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="kc">undefined</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span>
<span class="w">      </span><span class="s1">&#39;useNotifications must be used within a NotificationProvider&#39;</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">context</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p>Now let's try to use it outside the provider:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/app/page.tsx - Using context outside provider</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">SomeComponent</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/components/SomeComponent&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">Page</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Still forgot to wrap with NotificationProvider</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">SomeComponent</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Browser Behavior</strong>:
The page crashes immediately when <code>SomeComponent</code> tries to use the context.</p>
<p><strong>Browser Console Output</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">Error</span><span class="o">:</span><span class="w"> </span><span class="n">useNotifications</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">NotificationProvider</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">useNotifications</span><span class="w"> </span><span class="o">(</span><span class="n">NotificationContext</span><span class="o">.</span><span class="na">tsx</span><span class="o">:</span><span class="mi">38</span><span class="o">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">SomeComponent</span><span class="w"> </span><span class="o">(</span><span class="n">SomeComponent</span><span class="o">.</span><span class="na">tsx</span><span class="o">:</span><span class="mi">6</span><span class="o">)</span>
</code></pre></div>

<p><strong>React Error Overlay</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">Unhandled</span><span class="w"> </span><span class="n">Runtime</span><span class="w"> </span><span class="n">Error</span>
<span class="n">Error</span><span class="p">:</span><span class="w"> </span><span class="n">useNotifications</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">NotificationProvider</span>

<span class="n">Source</span>
<span class="n">src</span><span class="o">/</span><span class="n">contexts</span><span class="o">/</span><span class="n">NotificationContext</span><span class="o">.</span><span class="n">tsx</span><span class="w"> </span><span class="p">(</span><span class="mi">38</span><span class="p">:</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="err">@</span><span class="w"> </span><span class="n">useNotifications</span>

<span class="w">  </span><span class="mi">36</span><span class="w"> </span><span class="o">|</span><span class="w">   </span><span class="k">const</span><span class="w"> </span><span class="n">context</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">useContext</span><span class="p">(</span><span class="n">NotificationContext</span><span class="p">);</span>
<span class="w">  </span><span class="mi">37</span><span class="w"> </span><span class="o">|</span><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="n">undefined</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="o">&gt;</span><span class="w"> </span><span class="mi">38</span><span class="w"> </span><span class="o">|</span><span class="w">     </span><span class="n">throw</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">Error</span><span class="p">(</span>
<span class="w">     </span><span class="o">|</span><span class="w">          </span><span class="o">^</span>
<span class="w">  </span><span class="mi">39</span><span class="w"> </span><span class="o">|</span><span class="w">       </span><span class="s1">&#39;useNotifications must be used within a NotificationProvider&#39;</span>
<span class="w">  </span><span class="mi">40</span><span class="w"> </span><span class="o">|</span><span class="w">     </span><span class="p">);</span>
<span class="w">  </span><span class="mi">41</span><span class="w"> </span><span class="o">|</span><span class="w">   </span><span class="p">}</span>
</code></pre></div>

<p><strong>Expected vs. Actual improvement</strong>:
- <strong>Before</strong>: Silent failure, no indication of what went wrong
- <strong>After</strong>: Clear error message immediately points to the problem
- <strong>Concrete evidence</strong>: Developer knows exactly what to fix‚Äîwrap the component tree with <code>NotificationProvider</code></p>
<p>Let's fix it properly:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/app/layout.tsx - Wrapping with provider</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">NotificationProvider</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/contexts/NotificationContext&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">RootLayout</span><span class="p">({</span>
<span class="w">  </span><span class="nx">children</span><span class="p">,</span>
<span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">children</span><span class="o">:</span><span class="w"> </span><span class="kt">React.ReactNode</span><span class="p">;</span>
<span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">html</span><span class="w"> </span><span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">NotificationProvider</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">{</span><span class="nx">children</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">NotificationProvider</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="iteration-2-typing-custom-hooks-with-generics">Iteration 2: Typing Custom Hooks with Generics</h3>
<p>Now let's create a more sophisticated custom hook that can work with different types of notifications. We'll use generics to make it reusable.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/hooks/useFilteredNotifications.ts</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useMemo</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/types/notifications&#39;</span><span class="p">;</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">NotificationWithId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">};</span>

<span class="c1">// Generic hook that filters notifications by variant</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">useFilteredNotifications</span><span class="o">&lt;</span><span class="nx">T</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="p">[</span><span class="s1">&#39;variant&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">  </span><span class="nx">notifications</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationWithId</span><span class="p">[],</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="kt">T</span>
<span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Extract</span><span class="o">&lt;</span><span class="nx">NotificationWithId</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="kt">T</span><span class="w"> </span><span class="p">}</span><span class="o">&gt;</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">notifications</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span>
<span class="w">      </span><span class="p">(</span><span class="nx">n</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">Extract</span><span class="o">&lt;</span><span class="nx">NotificationWithId</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="kt">T</span><span class="w"> </span><span class="p">}</span><span class="o">&gt;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span>
<span class="w">        </span><span class="nx">n</span><span class="p">.</span><span class="nx">variant</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">variant</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">notifications</span><span class="p">,</span><span class="w"> </span><span class="nx">variant</span><span class="p">]);</span>
<span class="p">}</span>
</code></pre></div>

<p>Let's use this generic hook:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/ErrorList.tsx - Using generic hook</span>
<span class="s1">&#39;use client&#39;</span><span class="p">;</span>

<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useNotifications</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/contexts/NotificationContext&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useFilteredNotifications</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/hooks/useFilteredNotifications&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ErrorList</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">notifications</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useNotifications</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// TypeScript infers the return type as ErrorNotification[]</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">errors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useFilteredNotifications</span><span class="p">(</span><span class="nx">notifications</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;space-y-2&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h2</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;text-lg font-semibold text-red-600&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="nx">Errors</span><span class="w"> </span><span class="p">({</span><span class="nx">errors</span><span class="p">.</span><span class="nx">length</span><span class="p">})</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">errors</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">error</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;p-3 bg-red-50 rounded&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;{</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">{</span><span class="cm">/* TypeScript knows &#39;action&#39; exists on error variant */</span><span class="p">}</span>
<span class="w">          </span><span class="p">{</span><span class="nx">error</span><span class="p">.</span><span class="nx">action</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span>
<span class="w">              </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">error</span><span class="p">.</span><span class="nx">action</span><span class="p">.</span><span class="nx">onClick</span><span class="p">}</span>
<span class="w">              </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-2 text-sm underline&quot;</span>
<span class="w">            </span><span class="p">&gt;</span>
<span class="w">              </span><span class="p">{</span><span class="nx">error</span><span class="p">.</span><span class="nx">action</span><span class="p">.</span><span class="nx">label</span><span class="p">}</span>
<span class="w">            </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">)}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">))}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/SuccessList.tsx - Same hook, different type</span>
<span class="s1">&#39;use client&#39;</span><span class="p">;</span>

<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useNotifications</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/contexts/NotificationContext&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useFilteredNotifications</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/hooks/useFilteredNotifications&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">SuccessList</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">notifications</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useNotifications</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// TypeScript infers the return type as SuccessNotification[]</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">successes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useFilteredNotifications</span><span class="p">(</span><span class="nx">notifications</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;space-y-2&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">h2</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;text-lg font-semibold text-green-600&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="nx">Success</span><span class="w"> </span><span class="p">({</span><span class="nx">successes</span><span class="p">.</span><span class="nx">length</span><span class="p">})</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">successes</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">success</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">success</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;p-3 bg-green-50 rounded&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;{</span><span class="nx">success</span><span class="p">.</span><span class="nx">message</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">{</span><span class="cm">/* TypeScript knows &#39;action&#39; does NOT exist on success variant */</span><span class="p">}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">))}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="iteration-3-complex-hook-with-multiple-return-types">Iteration 3: Complex Hook with Multiple Return Types</h3>
<p>Let's create a more complex hook that returns different types based on its configuration.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/hooks/useNotificationManager.ts</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useCallback</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/types/notifications&#39;</span><span class="p">;</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">NotificationWithId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">};</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">UseNotificationManagerOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">maxNotifications?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">autoRemoveDelay?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">};</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">NotificationManager</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">notifications</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationWithId</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">addNotification</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">notification</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationProps</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">removeNotification</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="nx">clearAll</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="nx">getNotificationById</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">NotificationWithId</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">undefined</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">useNotificationManager</span><span class="p">(</span>
<span class="w">  </span><span class="nx">options</span><span class="o">:</span><span class="w"> </span><span class="kt">UseNotificationManagerOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">NotificationManager</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">maxNotifications</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="nx">autoRemoveDelay</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">options</span><span class="p">;</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">notifications</span><span class="p">,</span><span class="w"> </span><span class="nx">setNotifications</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="o">&lt;</span><span class="nx">NotificationWithId</span><span class="p">[]</span><span class="o">&gt;</span><span class="p">([]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">addNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">((</span><span class="nx">notification</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationProps</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">().</span><span class="nx">toString</span><span class="p">(</span><span class="mf">36</span><span class="p">).</span><span class="nx">substr</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">9</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">newNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="nx">notification</span><span class="p">,</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="p">};</span>

<span class="w">    </span><span class="nx">setNotifications</span><span class="p">((</span><span class="nx">prev</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">updated</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[...</span><span class="nx">prev</span><span class="p">,</span><span class="w"> </span><span class="nx">newNotification</span><span class="p">];</span>
<span class="w">      </span><span class="c1">// Enforce max notifications</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">updated</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">maxNotifications</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">updated</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="o">-</span><span class="nx">maxNotifications</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">updated</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="c1">// Auto-remove after delay if specified</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">autoRemoveDelay</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">setTimeout</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">removeNotification</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
<span class="w">      </span><span class="p">},</span><span class="w"> </span><span class="nx">autoRemoveDelay</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">id</span><span class="p">;</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">maxNotifications</span><span class="p">,</span><span class="w"> </span><span class="nx">autoRemoveDelay</span><span class="p">]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">removeNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">((</span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setNotifications</span><span class="p">((</span><span class="nx">prev</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">prev</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">n</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">n</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">id</span><span class="p">));</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">clearAll</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setNotifications</span><span class="p">([]);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">getNotificationById</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">((</span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">notifications</span><span class="p">.</span><span class="nx">find</span><span class="p">((</span><span class="nx">n</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">n</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">id</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">notifications</span><span class="p">]);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">notifications</span><span class="p">,</span>
<span class="w">    </span><span class="nx">addNotification</span><span class="p">,</span>
<span class="w">    </span><span class="nx">removeNotification</span><span class="p">,</span>
<span class="w">    </span><span class="nx">clearAll</span><span class="p">,</span>
<span class="w">    </span><span class="nx">getNotificationById</span><span class="p">,</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">}</span>
</code></pre></div>

<p>Now let's use this hook in a component:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/NotificationDemo.tsx</span>
<span class="s1">&#39;use client&#39;</span><span class="p">;</span>

<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useNotificationManager</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/hooks/useNotificationManager&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Notification</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./Notification&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">NotificationDemo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">manager</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useNotificationManager</span><span class="p">({</span>
<span class="w">    </span><span class="nx">maxNotifications</span><span class="o">:</span><span class="w"> </span><span class="kt">3</span><span class="p">,</span>
<span class="w">    </span><span class="nx">autoRemoveDelay</span><span class="o">:</span><span class="w"> </span><span class="kt">5000</span><span class="p">,</span><span class="w"> </span><span class="c1">// Auto-remove after 5 seconds</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleAddSuccess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">manager</span><span class="p">.</span><span class="nx">addNotification</span><span class="p">({</span>
<span class="w">      </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Operation completed successfully&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">dismissible</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Added notification with id:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">id</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleAddError</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">manager</span><span class="p">.</span><span class="nx">addNotification</span><span class="p">({</span>
<span class="w">      </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Operation failed&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">dismissible</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
<span class="w">      </span><span class="nx">action</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">label</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Retry&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">onClick</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Retrying...&#39;</span><span class="p">),</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;p-8 space-y-4&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex gap-2&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">          </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleAddSuccess</span><span class="p">}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;px-4 py-2 bg-green-600 text-white rounded&quot;</span>
<span class="w">        </span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Add</span><span class="w"> </span><span class="nx">Success</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">          </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleAddError</span><span class="p">}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;px-4 py-2 bg-red-600 text-white rounded&quot;</span>
<span class="w">        </span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Add</span><span class="w"> </span><span class="ne">Error</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">          </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">manager</span><span class="p">.</span><span class="nx">clearAll</span><span class="p">}</span>
<span class="w">          </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;px-4 py-2 bg-gray-600 text-white rounded&quot;</span>
<span class="w">        </span><span class="p">&gt;</span>
<span class="w">          </span><span class="nx">Clear</span><span class="w"> </span><span class="nx">All</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;space-y-2&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="nx">manager</span><span class="p">.</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">notif</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">Notification</span><span class="w"> </span><span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">notif</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="w"> </span><span class="p">{</span><span class="na">...notif</span><span class="p">}</span><span class="w"> </span><span class="p">/&gt;</span>
<span class="w">        </span><span class="p">))}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;text-sm text-gray-600&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="nx">Showing</span><span class="w"> </span><span class="p">{</span><span class="nx">manager</span><span class="p">.</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">length</span><span class="p">}</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">max</span><span class="w"> </span><span class="mf">3</span><span class="w"> </span><span class="nx">notifications</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="iteration-4-typing-hooks-with-overloads">Iteration 4: Typing Hooks with Overloads</h3>
<p>Sometimes a hook needs to return different types based on its parameters. We can use function overloads for this.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/hooks/useNotification.ts - Hook with overloads</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useEffect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/types/notifications&#39;</span><span class="p">;</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">NotificationWithId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">};</span>

<span class="c1">// Overload signatures</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">useNotification</span><span class="p">(</span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">NotificationWithId</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">useNotification</span><span class="p">(</span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">NotificationWithId</span><span class="p">;</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">useNotification</span><span class="p">(</span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">required</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">NotificationWithId</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>

<span class="c1">// Implementation</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">useNotification</span><span class="p">(</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<span class="w">  </span><span class="nx">required?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span>
<span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">NotificationWithId</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">notification</span><span class="p">,</span><span class="w"> </span><span class="nx">setNotification</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="o">&lt;</span><span class="nx">NotificationWithId</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="o">&gt;</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>

<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Simulate fetching notification by id</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">fetchNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// In real app, this would be an API call</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">mockNotification</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationWithId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">id</span><span class="p">,</span>
<span class="w">        </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;info&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="sb">`Notification </span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
<span class="w">        </span><span class="nx">dismissible</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
<span class="w">      </span><span class="p">};</span>
<span class="w">      </span><span class="nx">setNotification</span><span class="p">(</span><span class="nx">mockNotification</span><span class="p">);</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="nx">fetchNotification</span><span class="p">();</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">id</span><span class="p">]);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">required</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">notification</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Notification with id </span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb"> is required but not found`</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">notification</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/NotificationDetail.tsx - Using overloaded hook</span>
<span class="s1">&#39;use client&#39;</span><span class="p">;</span>

<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useNotification</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/hooks/useNotification&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">NotificationDetail</span><span class="p">({</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// TypeScript knows this can be null</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">notification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useNotification</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">notification</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span><span class="nx">Loading</span><span class="p">...&lt;/</span><span class="nt">div</span><span class="p">&gt;;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;p-4 border rounded&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;{</span><span class="nx">notification</span><span class="p">.</span><span class="nx">message</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">RequiredNotificationDetail</span><span class="p">({</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// TypeScript knows this is never null (will throw if not found)</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">notification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useNotification</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// No null check needed</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;p-4 border rounded&quot;</span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;{</span><span class="nx">notification</span><span class="p">.</span><span class="nx">message</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="when-to-apply-these-patterns">When to Apply These Patterns</h3>
<p><strong>Context with undefined + runtime check</strong>:
- <strong>Use when</strong>: Creating context that should only be used within a provider
- <strong>What it optimizes for</strong>: Clear error messages when context is misused
- <strong>What it sacrifices</strong>: Extra runtime check on every hook call
- <strong>When to choose</strong>: Always, for any context that requires a provider</p>
<p><strong>Generic hooks</strong>:
- <strong>Use when</strong>: Hook logic is the same but types vary based on parameters
- <strong>What it optimizes for</strong>: Code reuse without sacrificing type safety
- <strong>What it sacrifices</strong>: Slightly more complex type signatures
- <strong>When to choose</strong>: When you find yourself duplicating hook logic for different types</p>
<p><strong>Hooks with overloads</strong>:
- <strong>Use when</strong>: Hook behavior changes significantly based on parameters
- <strong>What it optimizes for</strong>: Type safety for different usage patterns
- <strong>What it sacrifices</strong>: More complex type definitions
- <strong>When to choose</strong>: When a hook has distinct modes of operation (e.g., required vs. optional)</p>
<p><strong>Code characteristics</strong>:
- Setup: Medium complexity (requires understanding of generics and overloads)
- Maintenance: Low burden (TypeScript guides you through changes)
- Performance: Zero runtime cost (types are erased at compile time)</p>
<h3 id="limitation-preview_2">Limitation preview</h3>
<p>We've now mastered typing context and custom hooks, making our notification system fully type-safe across component boundaries. But there's one more TypeScript topic we need to address: when is it actually okay to use <code>any</code>? In the next section, we'll explore the pragmatic use of <code>any</code> and its safer alternatives.</p>
<h2 id="when-to-use-any-yes-really">When to use <code>any</code> (yes, really)</h2>
<h2 id="when-to-use-any-yes-really_1">When to use <code>any</code> (yes, really)</h2>
<p>TypeScript purists will tell you to never use <code>any</code>. They're wrong. There are legitimate cases where <code>any</code> is the pragmatic choice. The key is knowing when to use it, and more importantly, how to contain its impact.</p>
<h3 id="the-problem-third-party-libraries-without-types">The Problem: Third-Party Libraries Without Types</h3>
<p>Let's extend our notification system to integrate with a third-party analytics library that doesn't have TypeScript definitions.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Imagine this is from &#39;legacy-analytics&#39; package</span>
<span class="c1">// No @types/legacy-analytics exists</span>
<span class="kr">declare</span><span class="w"> </span><span class="nx">module</span><span class="w"> </span><span class="s1">&#39;legacy-analytics&#39;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">track</span><span class="p">(</span><span class="nx">event</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">identify</span><span class="p">(</span><span class="nx">userId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">traits</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/hooks/useNotificationAnalytics.ts - Naive approach</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useEffect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">track</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;legacy-analytics&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/types/notifications&#39;</span><span class="p">;</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">NotificationWithId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">useNotificationAnalytics</span><span class="p">(</span><span class="nx">notification</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationWithId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ‚ùå TypeScript error: &#39;notification&#39; is not assignable to parameter of type &#39;any&#39;</span>
<span class="w">    </span><span class="c1">// Actually, it IS assignable, but we&#39;re trying to be too strict</span>
<span class="w">    </span><span class="nx">track</span><span class="p">(</span><span class="s1">&#39;notification_shown&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="kt">notification.variant</span><span class="p">,</span>
<span class="w">      </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">notification.message</span><span class="p">,</span>
<span class="w">      </span><span class="nx">hasAction</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;action&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nx">notification</span><span class="p">,</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">notification</span><span class="p">]);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>TypeScript Compiler Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>src/hooks/useNotificationAnalytics.ts:12:5<span class="w"> </span>-<span class="w"> </span>error<span class="w"> </span>TS2345:
Argument<span class="w"> </span>of<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;{ variant: &quot;success&quot; | &quot;error&quot; | &quot;warning&quot; | &quot;info&quot; | &quot;loading&quot; | &quot;confirmation&quot;; message: string; hasAction: boolean; }&#39;</span><span class="w"> </span>
is<span class="w"> </span>not<span class="w"> </span>assignable<span class="w"> </span>to<span class="w"> </span>parameter<span class="w"> </span>of<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;any&#39;</span>.

<span class="m">12</span><span class="w">     </span>track<span class="o">(</span><span class="s1">&#39;notification_shown&#39;</span>,<span class="w"> </span><span class="o">{</span>
<span class="w">       </span>~~~~~

Found<span class="w"> </span><span class="m">1</span><span class="w"> </span>error<span class="w"> </span><span class="k">in</span><span class="w"> </span>src/hooks/useNotificationAnalytics.ts
</code></pre></div>

<p>Wait, that error message doesn't make sense. The library accepts <code>any</code>, so why is TypeScript complaining?</p>
<h3 id="diagnostic-analysis-reading-the-failure_2">Diagnostic Analysis: Reading the Failure</h3>
<p><strong>Let's parse this evidence</strong>:</p>
<ol>
<li>
<p><strong>What the developer experiences</strong>: TypeScript rejects perfectly valid code because the third-party library uses <code>any</code> in its type definitions.</p>
</li>
<li>
<p><strong>What TypeScript reveals</strong>: The error message is confusing‚Äîit says our object "is not assignable to parameter of type 'any'", which seems impossible since <code>any</code> accepts anything.</p>
</li>
<li>
<p><strong>Root cause identified</strong>: This is actually a different issue‚ÄîTypeScript is being overly strict about object literal types. The real problem is that we're trying to avoid <code>any</code> when the library explicitly uses it.</p>
</li>
<li>
<p><strong>Why fighting <code>any</code> here is wrong</strong>: The library doesn't have types. We could spend hours creating type definitions for it, or we could accept that this boundary is untyped and move on.</p>
</li>
<li>
<p><strong>What we need</strong>: A pragmatic approach to using <code>any</code> at library boundaries while keeping the rest of our code type-safe.</p>
</li>
</ol>
<h3 id="iteration-1-strategic-use-of-any-at-boundaries">Iteration 1: Strategic Use of <code>any</code> at Boundaries</h3>
<p>The solution is to use <code>any</code> at the boundary with the untyped library, but keep everything else type-safe.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/hooks/useNotificationAnalytics.ts - Version 2 (pragmatic)</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useEffect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">track</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;legacy-analytics&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/types/notifications&#39;</span><span class="p">;</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">NotificationWithId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">};</span>

<span class="c1">// Helper function that explicitly accepts any for the properties</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">trackNotification</span><span class="p">(</span><span class="nx">event</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">track</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="nx">properties</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">useNotificationAnalytics</span><span class="p">(</span><span class="nx">notification</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationWithId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ‚úì Our code is type-safe, we just pass it to the untyped boundary</span>
<span class="w">    </span><span class="nx">trackNotification</span><span class="p">(</span><span class="s1">&#39;notification_shown&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="kt">notification.variant</span><span class="p">,</span>
<span class="w">      </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">notification.message</span><span class="p">,</span>
<span class="w">      </span><span class="nx">hasAction</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;action&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nx">notification</span><span class="p">,</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">notification</span><span class="p">]);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Expected vs. Actual improvement</strong>:
- <strong>Before</strong>: Fighting TypeScript to avoid <code>any</code>, creating friction
- <strong>After</strong>: Accept <code>any</code> at the library boundary, keep our code type-safe
- <strong>Concrete evidence</strong>: Code compiles, analytics work, and we didn't waste time creating type definitions for a library we don't control</p>
<h3 id="iteration-2-unknown-the-safer-alternative">Iteration 2: <code>unknown</code> - The Safer Alternative</h3>
<p>When you receive data from an external source (API, localStorage, third-party library), use <code>unknown</code> instead of <code>any</code>. <code>unknown</code> forces you to validate the data before using it.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/utils/storage.ts - Using unknown for external data</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">getStoredNotifications</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nx">unknown</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">stored</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s1">&#39;notifications&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">stored</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// ‚úì Return unknown, not any</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">stored</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Type guard to validate the data</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">isNotificationArray</span><span class="p">(</span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kt">unknown</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">NotificationWithId</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">value</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">value</span><span class="p">.</span><span class="nx">every</span><span class="p">((</span><span class="nx">item</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">      </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">item</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;object&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">      </span><span class="nx">item</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">      </span><span class="s1">&#39;id&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nx">item</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">      </span><span class="s1">&#39;variant&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nx">item</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">      </span><span class="s1">&#39;message&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nx">item</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">      </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">      </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;string&#39;</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">});</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">loadNotifications</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nx">NotificationWithId</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">stored</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">getStoredNotifications</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// ‚úì Must validate before using</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isNotificationArray</span><span class="p">(</span><span class="nx">stored</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">stored</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">[];</span>
<span class="p">}</span>
</code></pre></div>

<p>Let's see what happens if we try to use <code>unknown</code> without validation:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/utils/storage.ts - Attempting to use unknown without validation</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">loadNotificationsBad</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nx">NotificationWithId</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">stored</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">getStoredNotifications</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// ‚ùå TypeScript error: Type &#39;unknown&#39; is not assignable to type &#39;NotificationWithId[]&#39;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">stored</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>TypeScript Compiler Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>src/utils/storage.ts:45:10<span class="w"> </span>-<span class="w"> </span>error<span class="w"> </span>TS2322:
Type<span class="w"> </span><span class="s1">&#39;unknown&#39;</span><span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>assignable<span class="w"> </span>to<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;NotificationWithId[]&#39;</span>.

<span class="m">45</span><span class="w">   </span><span class="k">return</span><span class="w"> </span>stored<span class="p">;</span>
<span class="w">            </span>~~~~~~

Found<span class="w"> </span><span class="m">1</span><span class="w"> </span>error<span class="w"> </span><span class="k">in</span><span class="w"> </span>src/utils/storage.ts
</code></pre></div>

<p>This is exactly what we want‚ÄîTypeScript forces us to validate the data.</p>
<h3 id="iteration-3-as-any-the-escape-hatch">Iteration 3: <code>as any</code> - The Escape Hatch</h3>
<p>Sometimes you need to tell TypeScript "trust me, I know what I'm doing." Use <code>as any</code> sparingly, and always leave a comment explaining why.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/NotificationPortal.tsx - Using as any for DOM manipulation</span>
<span class="s1">&#39;use client&#39;</span><span class="p">;</span>

<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useEffect</span><span class="p">,</span><span class="w"> </span><span class="nx">useRef</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">createPortal</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react-dom&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">ReactNode</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">NotificationPortal</span><span class="p">({</span><span class="w"> </span><span class="nx">children</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">children</span><span class="o">:</span><span class="w"> </span><span class="kt">ReactNode</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">portalRoot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useRef</span><span class="p">&lt;</span><span class="nt">HTMLElement</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="na">null</span><span class="p">&gt;(</span><span class="kc">null</span><span class="p">);</span>

<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Create portal root if it doesn&#39;t exist</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;notification-portal&#39;</span><span class="p">);</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">root</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="nx">root</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;notification-portal&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">root</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">portalRoot</span><span class="p">.</span><span class="nx">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">root</span><span class="p">;</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// Cleanup: remove portal root if it&#39;s empty</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">root</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">root</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// TypeScript doesn&#39;t know that root.parentNode exists</span>
<span class="w">        </span><span class="c1">// because it could be null if the element was removed</span>
<span class="w">        </span><span class="c1">// We know it exists because we just checked root</span>
<span class="w">        </span><span class="p">(</span><span class="nx">root</span><span class="p">.</span><span class="nx">parentNode</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">any</span><span class="p">)</span><span class="o">?</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">root</span><span class="p">);</span>
<span class="w">        </span><span class="c1">// Alternative: Use type assertion with explanation</span>
<span class="w">        </span><span class="c1">// root.parentNode?.removeChild(root); // TypeScript error</span>
<span class="w">        </span><span class="c1">// (root.parentNode as HTMLElement).removeChild(root); // Better</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">portalRoot</span><span class="p">.</span><span class="nx">current</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">createPortal</span><span class="p">(</span><span class="nx">children</span><span class="p">,</span><span class="w"> </span><span class="nx">portalRoot</span><span class="p">.</span><span class="nx">current</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>Actually, let's refactor that to avoid <code>as any</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/NotificationPortal.tsx - Version 2 (better)</span>
<span class="s1">&#39;use client&#39;</span><span class="p">;</span>

<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useEffect</span><span class="p">,</span><span class="w"> </span><span class="nx">useRef</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">createPortal</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react-dom&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">ReactNode</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">NotificationPortal</span><span class="p">({</span><span class="w"> </span><span class="nx">children</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">children</span><span class="o">:</span><span class="w"> </span><span class="kt">ReactNode</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">portalRoot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useRef</span><span class="p">&lt;</span><span class="nt">HTMLElement</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="na">null</span><span class="p">&gt;(</span><span class="kc">null</span><span class="p">);</span>

<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;notification-portal&#39;</span><span class="p">);</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">root</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="nx">root</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;notification-portal&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">root</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">portalRoot</span><span class="p">.</span><span class="nx">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">root</span><span class="p">;</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// Better: Check if parentNode exists before using it</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">root</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">root</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">root</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">root</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">root</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">portalRoot</span><span class="p">.</span><span class="nx">current</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">createPortal</span><span class="p">(</span><span class="nx">children</span><span class="p">,</span><span class="w"> </span><span class="nx">portalRoot</span><span class="p">.</span><span class="nx">current</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="iteration-4-when-any-is-actually-the-right-choice">Iteration 4: When <code>any</code> Is Actually the Right Choice</h3>
<p>Here are legitimate cases where <code>any</code> is the pragmatic choice:</p>
<p><strong>1. Prototyping</strong>: When you're exploring an idea and types would slow you down</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/experiments/notification-ai.ts - Prototyping</span>
<span class="c1">// TODO: Add proper types once we decide on the API</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">generateNotificationMessage</span><span class="p">(</span><span class="nx">context</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Experimenting with AI-generated messages</span>
<span class="w">  </span><span class="c1">// Will add proper types once we finalize the context structure</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="sb">`Generated message based on </span><span class="si">${</span><span class="nx">context</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>2. Gradual migration</strong>: When converting JavaScript to TypeScript</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/legacy/old-notification-system.ts - Gradual migration</span>
<span class="c1">// This file is being migrated from JavaScript</span>
<span class="c1">// Using any temporarily to get it compiling, will add types incrementally</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">legacyNotificationHandler</span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// TODO: Type this properly</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Legacy handler:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>3. Truly dynamic data</strong>: When the shape of data is genuinely unknowable</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/utils/debug.ts - Truly dynamic data</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">debugLog</span><span class="p">(</span><span class="nx">label</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// This is a debug utility that accepts literally anything</span>
<span class="w">  </span><span class="c1">// Using any is appropriate here</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`[</span><span class="si">${</span><span class="nx">label</span><span class="si">}</span><span class="sb">]`</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>4. Working around TypeScript limitations</strong>: When TypeScript's type system can't express what you need</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/utils/deep-merge.ts - TypeScript limitation</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">deepMerge</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">target</span><span class="o">:</span><span class="w"> </span><span class="kt">T</span><span class="p">,</span><span class="w"> </span><span class="nx">source</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">T</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Deep merge is genuinely hard to type correctly</span>
<span class="w">  </span><span class="c1">// The proper type would be incredibly complex</span>
<span class="w">  </span><span class="c1">// Using any here is pragmatic</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">target</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;object&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">source</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;object&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">source</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="nx">target</span><span class="w"> </span><span class="p">};</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">key</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nx">source</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">source</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">key</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">source</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;object&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">source</span><span class="p">[</span><span class="nx">key</span><span class="p">]))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">(</span><span class="nx">result</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">any</span><span class="p">)[</span><span class="nx">key</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">deepMerge</span><span class="p">((</span><span class="nx">target</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">any</span><span class="p">)[</span><span class="nx">key</span><span class="p">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">{},</span><span class="w"> </span><span class="nx">source</span><span class="p">[</span><span class="nx">key</span><span class="p">]);</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">(</span><span class="nx">result</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">any</span><span class="p">)[</span><span class="nx">key</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">source</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">result</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="the-rules-of-any">The Rules of <code>any</code></h3>
<p><strong>Rule 1: Contain the blast radius</strong></p>
<p>When you use <code>any</code>, limit its scope. Don't let it leak into the rest of your codebase.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// ‚ùå Bad: any leaks everywhere</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">processNotification</span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">data</span><span class="p">;</span><span class="w">  </span><span class="c1">// Returns any</span>
<span class="p">}</span>

<span class="c1">// ‚úì Good: any is contained</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">processNotification</span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Validate and transform to proper type</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="kt">data.variant</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;info&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">data.message</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;No message&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">dismissible</span><span class="o">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">dismissible</span><span class="p">),</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Rule 2: Document why you used <code>any</code></strong></p>
<p>Always leave a comment explaining why <code>any</code> was necessary.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// ‚úì Good: Documented</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">trackEvent</span><span class="p">(</span><span class="nx">event</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Using any because the analytics library doesn&#39;t have types</span>
<span class="w">  </span><span class="c1">// and the property shape varies by event type</span>
<span class="w">  </span><span class="nx">analytics</span><span class="p">.</span><span class="nx">track</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="nx">properties</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Rule 3: Prefer <code>unknown</code> when receiving external data</strong></p>
<p>Use <code>unknown</code> instead of <code>any</code> when you don't know the type yet but will validate it.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// ‚ùå Bad: Using any for external data</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">parseApiResponse</span><span class="p">(</span><span class="nx">response</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">response</span><span class="p">;</span><span class="w">  </span><span class="c1">// No validation</span>
<span class="p">}</span>

<span class="c1">// ‚úì Good: Using unknown with validation</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">parseApiResponse</span><span class="p">(</span><span class="nx">response</span><span class="o">:</span><span class="w"> </span><span class="kt">unknown</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">isValidNotification</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;Invalid notification data&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">response</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">isValidNotification</span><span class="p">(</span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kt">unknown</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Validation logic</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;object&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">    </span><span class="nx">value</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">    </span><span class="s1">&#39;variant&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">    </span><span class="s1">&#39;message&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nx">value</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Rule 4: Use type assertions instead of <code>any</code> when possible</strong></p>
<p>If you know the type but TypeScript doesn't, use a type assertion instead of <code>any</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// ‚ùå Bad: Using any</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">element</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;root&#39;</span><span class="p">)</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">any</span><span class="p">;</span>
<span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;red&#39;</span><span class="p">;</span>

<span class="c1">// ‚úì Good: Using type assertion</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">element</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;root&#39;</span><span class="p">)</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">HTMLElement</span><span class="p">;</span>
<span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;red&#39;</span><span class="p">;</span>

<span class="c1">// ‚úì Better: Using type guard</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">element</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;root&#39;</span><span class="p">);</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">element</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="nx">HTMLElement</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;red&#39;</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="when-to-apply-any-vs-alternatives">When to Apply <code>any</code> vs. Alternatives</h3>
<table>
<thead>
<tr>
<th>Situation</th>
<th>Use</th>
<th>Why</th>
</tr>
</thead>
<tbody>
<tr>
<td>External library without types</td>
<td><code>any</code> at boundary</td>
<td>Pragmatic, contained</td>
</tr>
<tr>
<td>Receiving external data</td>
<td><code>unknown</code></td>
<td>Forces validation</td>
</tr>
<tr>
<td>Prototyping</td>
<td><code>any</code> with TODO</td>
<td>Speed over safety</td>
</tr>
<tr>
<td>Gradual migration</td>
<td><code>any</code> with TODO</td>
<td>Incremental improvement</td>
</tr>
<tr>
<td>Debug utilities</td>
<td><code>any</code></td>
<td>Genuinely accepts anything</td>
</tr>
<tr>
<td>TypeScript limitation</td>
<td><code>any</code> with comment</td>
<td>Workaround documented</td>
</tr>
<tr>
<td>You know the type</td>
<td>Type assertion</td>
<td>More specific than <code>any</code></td>
</tr>
<tr>
<td>DOM manipulation</td>
<td>Type guard or assertion</td>
<td>Safer than <code>any</code></td>
</tr>
</tbody>
</table>
<h3 id="the-complete-journey-from-naive-to-professional">The Complete Journey: From Naive to Professional</h3>
<p>Let's look at how our notification system evolved through this chapter:</p>
<table>
<thead>
<tr>
<th>Iteration</th>
<th>Problem</th>
<th>Solution</th>
<th>Type Safety Impact</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Boolean flags everywhere</td>
<td>Naive approach</td>
<td>Invalid states compile</td>
</tr>
<tr>
<td>1</td>
<td>Invalid combinations possible</td>
<td>Discriminated unions</td>
<td>Invalid states unrepresentable</td>
</tr>
<tr>
<td>2</td>
<td>Adding new variants breaks code</td>
<td>Exhaustiveness checking</td>
<td>Compiler forces handling all cases</td>
</tr>
<tr>
<td>3</td>
<td>Need to extract specific variants</td>
<td>Extract/Exclude utilities</td>
<td>Type-safe filtering</td>
</tr>
<tr>
<td>4</td>
<td>Context used outside provider</td>
<td>undefined + runtime check</td>
<td>Clear error messages</td>
</tr>
<tr>
<td>5</td>
<td>Generic filtering logic</td>
<td>Generic hooks</td>
<td>Reusable, type-safe</td>
</tr>
<tr>
<td>6</td>
<td>Third-party library without types</td>
<td>Strategic <code>any</code> at boundary</td>
<td>Pragmatic compromise</td>
</tr>
<tr>
<td>7</td>
<td>External data validation</td>
<td><code>unknown</code> + type guards</td>
<td>Safe external data handling</td>
</tr>
</tbody>
</table>
<h3 id="final-implementation-production-ready-notification-system">Final Implementation: Production-Ready Notification System</h3>
<p>Here's our complete, production-ready notification system with all the TypeScript patterns we've learned:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// src/types/notifications.ts - Final version</span>
<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">SuccessNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dismissible?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">ErrorNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dismissible?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">action</span><span class="o">?:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">label</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">    </span><span class="nx">onClick</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">WarningNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;warning&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dismissible?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">InfoNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;info&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dismissible?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">LoadingNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;loading&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">ConfirmationNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;confirmation&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">confirmText</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">cancelText</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onConfirm</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onCancel</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="nx">severity</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;warning&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;danger&#39;</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">SuccessNotification</span><span class="w"> </span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">ErrorNotification</span><span class="w"> </span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">WarningNotification</span><span class="w"> </span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">InfoNotification</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">LoadingNotification</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">ConfirmationNotification</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">NotificationWithId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">};</span>

<span class="c1">// Utility types</span>
<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">ErrorNotificationOnly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Extract</span><span class="o">&lt;</span><span class="nx">NotificationProps</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="w"> </span><span class="p">}</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">DismissibleNotifications</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Extract</span><span class="o">&lt;</span><span class="nx">NotificationProps</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">dismissible?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="p">}</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">InteractiveNotifications</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Exclude</span><span class="o">&lt;</span><span class="nx">NotificationProps</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">variant</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;loading&#39;</span><span class="w"> </span><span class="p">}</span><span class="o">&gt;</span><span class="p">;</span>

<span class="c1">// Configuration</span>
<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">NotificationConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Record</span><span class="o">&lt;</span>
<span class="w">  </span><span class="nx">NotificationProps</span><span class="p">[</span><span class="s1">&#39;variant&#39;</span><span class="p">],</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="nx">icon</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">    </span><span class="nx">backgroundColor</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">    </span><span class="nx">textColor</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="o">&gt;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">notificationConfig</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">icon</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;‚úì&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">backgroundColor</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;bg-green-100&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">textColor</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;text-green-800&#39;</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">icon</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;‚úó&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">backgroundColor</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;bg-red-100&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">textColor</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;text-red-800&#39;</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="nx">warning</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">icon</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;‚ö†&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">backgroundColor</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;bg-yellow-100&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">textColor</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;text-yellow-800&#39;</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="nx">info</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">icon</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;‚Ñπ&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">backgroundColor</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;bg-blue-100&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">textColor</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;text-blue-800&#39;</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="nx">loading</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">icon</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;‚ü≥&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">backgroundColor</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;bg-gray-100&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">textColor</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;text-gray-800&#39;</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="nx">confirmation</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">icon</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;?&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">backgroundColor</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;bg-purple-100&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">textColor</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;text-purple-800&#39;</span><span class="w"> </span><span class="p">},</span>
<span class="p">};</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/contexts/NotificationContext.tsx - Final version</span>
<span class="s1">&#39;use client&#39;</span><span class="p">;</span>

<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">createContext</span><span class="p">,</span><span class="w"> </span><span class="nx">useContext</span><span class="p">,</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">,</span><span class="w"> </span><span class="nx">ReactNode</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="p">,</span><span class="w"> </span><span class="nx">NotificationWithId</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/types/notifications&#39;</span><span class="p">;</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">NotificationContextType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">notifications</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationWithId</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">addNotification</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">notification</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationProps</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">removeNotification</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">  </span><span class="nx">clearAll</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="p">};</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">NotificationContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createContext</span><span class="p">&lt;</span><span class="nt">NotificationContextType</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="na">undefined</span><span class="p">&gt;(</span><span class="kc">undefined</span><span class="p">);</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">NotificationProvider</span><span class="p">({</span><span class="w"> </span><span class="nx">children</span><span class="w"> </span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">children</span><span class="o">:</span><span class="w"> </span><span class="kt">ReactNode</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">notifications</span><span class="p">,</span><span class="w"> </span><span class="nx">setNotifications</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">&lt;</span><span class="nt">NotificationWithId</span><span class="err">[]</span><span class="p">&gt;([]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">addNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">((</span><span class="nx">notification</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationProps</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">().</span><span class="nx">toString</span><span class="p">(</span><span class="mf">36</span><span class="p">).</span><span class="nx">substr</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">9</span><span class="p">);</span>
<span class="w">    </span><span class="nx">setNotifications</span><span class="p">((</span><span class="nx">prev</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[...</span><span class="nx">prev</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="nx">notification</span><span class="p">,</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="p">}]);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">id</span><span class="p">;</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">removeNotification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">((</span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setNotifications</span><span class="p">((</span><span class="nx">prev</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">prev</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">n</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">n</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">id</span><span class="p">));</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">clearAll</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setNotifications</span><span class="p">([]);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">NotificationContext</span><span class="p">.</span><span class="na">Provider</span><span class="w"> </span>
<span class="w">      </span><span class="na">value</span><span class="o">=</span><span class="p">{{</span><span class="w"> </span><span class="nx">notifications</span><span class="p">,</span><span class="w"> </span><span class="nx">addNotification</span><span class="p">,</span><span class="w"> </span><span class="nx">removeNotification</span><span class="p">,</span><span class="w"> </span><span class="nx">clearAll</span><span class="w"> </span><span class="p">}}</span>
<span class="w">    </span><span class="p">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">children</span><span class="p">}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">NotificationContext</span><span class="p">.</span><span class="na">Provider</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">useNotifications</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">context</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useContext</span><span class="p">(</span><span class="nx">NotificationContext</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">context</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="kc">undefined</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;useNotifications must be used within a NotificationProvider&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">context</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// src/components/Notification.tsx - Final version</span>
<span class="k">import</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">NotificationProps</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/types/notifications&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">notificationConfig</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@/types/notifications&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">Notification</span><span class="p">(</span><span class="nx">props</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationProps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">notificationConfig</span><span class="p">[</span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="p">];</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">assertNever</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kt">never</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">never</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Unhandled variant: </span><span class="si">${</span><span class="nx">value</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`p-4 rounded </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">backgroundColor</span><span class="si">}</span><span class="sb">`</span><span class="p">}&gt;</span>
<span class="w">      </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex items-start gap-3&quot;</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">span</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`text-xl </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">textColor</span><span class="si">}</span><span class="sb">`</span><span class="p">}&gt;{</span><span class="nx">config</span><span class="p">.</span><span class="nx">icon</span><span class="p">}&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;flex-1&quot;</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">p</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="nx">config</span><span class="p">.</span><span class="nx">textColor</span><span class="p">}&gt;{</span><span class="nx">props</span><span class="p">.</span><span class="nx">message</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>

<span class="w">          </span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">props</span><span class="p">.</span><span class="nx">action</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">              </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">action</span><span class="p">.</span><span class="nx">onClick</span><span class="p">}</span>
<span class="w">              </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-2 text-sm underline&quot;</span>
<span class="w">            </span><span class="p">&gt;</span>
<span class="w">              </span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">action</span><span class="p">.</span><span class="nx">label</span><span class="p">}</span>
<span class="w">            </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">)}</span>

<span class="w">          </span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;confirmation&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="p">&lt;</span><span class="nt">div</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;mt-3 flex gap-2&quot;</span><span class="p">&gt;</span>
<span class="w">              </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">                </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">onConfirm</span><span class="p">}</span>
<span class="w">                </span><span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`px-4 py-2 rounded text-white </span><span class="si">${</span>
<span class="w">                  </span><span class="nx">props</span><span class="p">.</span><span class="nx">severity</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;danger&#39;</span><span class="w"> </span>
<span class="w">                    </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;bg-red-600 hover:bg-red-700&#39;</span><span class="w"> </span>
<span class="w">                    </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;bg-yellow-600 hover:bg-yellow-700&#39;</span>
<span class="w">                </span><span class="si">}</span><span class="sb">`</span><span class="p">}</span>
<span class="w">              </span><span class="p">&gt;</span>
<span class="w">                </span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">confirmText</span><span class="p">}</span>
<span class="w">              </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">              </span><span class="p">&lt;</span><span class="nt">button</span>
<span class="w">                </span><span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">onCancel</span><span class="p">}</span>
<span class="w">                </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;px-4 py-2 rounded bg-gray-200 hover:bg-gray-300&quot;</span>
<span class="w">              </span><span class="p">&gt;</span>
<span class="w">                </span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">cancelText</span><span class="p">}</span>
<span class="w">              </span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">            </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">          </span><span class="p">)}</span>
<span class="w">        </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="w">        </span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;confirmation&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>
<span class="w">         </span><span class="nx">props</span><span class="p">.</span><span class="nx">variant</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;loading&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>
<span class="w">         </span><span class="nx">props</span><span class="p">.</span><span class="nx">dismissible</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="p">&lt;</span><span class="nt">button</span><span class="w"> </span><span class="na">className</span><span class="o">=</span><span class="s">&quot;text-gray-500&quot;</span><span class="p">&gt;</span><span class="err">√ó</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="w">        </span><span class="p">)}</span>
<span class="w">      </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="lessons-learned">Lessons Learned</h3>
<p><strong>1. Make invalid states unrepresentable</strong>
Use discriminated unions to ensure only valid combinations of properties can exist. TypeScript becomes your design validator.</p>
<p><strong>2. Utility types are your friends</strong>
<code>Extract</code>, <code>Exclude</code>, <code>Pick</code>, <code>Omit</code>, <code>Partial</code>, <code>Required</code>, and <code>Record</code> solve 90% of type manipulation needs. Learn them well.</p>
<p><strong>3. Context needs runtime checks</strong>
Always make context values potentially <code>undefined</code> and add runtime checks in the hook. Clear error messages save debugging time.</p>
<p><strong>4. Generics enable reusable, type-safe code</strong>
Generic hooks and functions let you write code once and use it with multiple types, without sacrificing type safety.</p>
<p><strong>5. <code>any</code> is a tool, not a failure</strong>
Use <code>any</code> strategically at boundaries with untyped code. Document why, contain the scope, and prefer <code>unknown</code> for external data.</p>
<p><strong>6. TypeScript is a design tool</strong>
The type system isn't just for catching bugs‚Äîit's for designing better APIs. If your types are hard to use, your API probably is too.</p>
<p><strong>7. Exhaustiveness checking prevents bugs</strong>
Use the <code>assertNever</code> pattern to ensure you handle all cases of a discriminated union. When you add a new variant, TypeScript will tell you everywhere you need to update.</p>
<p>This notification system demonstrates professional TypeScript patterns that scale to real-world applications. The types guide you toward correct usage, catch mistakes at compile time, and document the API for other developers.</p>
        </div>
        <div class="footer">
            Generated on 2025-12-03 12:42:28 | Made with ‚ù§Ô∏è by GitHub Pages Generator
        </div>
    </div>
    <script>
        // Syntax highlighting for code blocks
        document.addEventListener('DOMContentLoaded', (event) => {
            // Highlight code blocks
            document.querySelectorAll('pre code').forEach((block) => {
                hljs.highlightElement(block);
            });
            
            // Add copy buttons to code blocks
            document.querySelectorAll('pre').forEach((pre) => {
                const button = document.createElement('button');
                button.className = 'copy-btn';
                button.textContent = 'Copy';
                
                button.addEventListener('click', () => {
                    const code = pre.querySelector('code').textContent;
                    navigator.clipboard.writeText(code).then(() => {
                        button.textContent = 'Copied!';
                        button.classList.add('copied');
                        setTimeout(() => {
                            button.textContent = 'Copy';
                            button.classList.remove('copied');
                        }, 2000);
                    }).catch(err => {
                        console.error('Failed to copy:', err);
                        button.textContent = 'Error';
                        setTimeout(() => {
                            button.textContent = 'Copy';
                        }, 2000);
                    });
                });
                
                pre.appendChild(button);
            });
        });
    </script>
</body>
</html>